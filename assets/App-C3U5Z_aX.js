const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-D8CP2BIb.js","assets/index-Cns7NKWW.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-3UCvtYMU.js","assets/InfoModal-Bvyee4_k.js"])))=>i.map(i=>d[i]);
import{r as u,j as ce,b as wn,R as Jt,c as Ra,g as Ta,d as Aa,a as Ba,L as po,_ as Pi}from"./index-Cns7NKWW.js";function Un(t){"@babel/helpers - typeof";return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Un(t)}function za(t,e){if(Un(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,e);if(Un(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ua(t){var e=za(t,"string");return Un(e)=="symbol"?e:e+""}function z(t,e,r){return(e=Ua(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fi,ho;function Fa(){if(ho)return fi;ho=1;var t=function(r,o,l,f,p,h,m,E){if(!r){var L;if(o===void 0)L=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var b=[l,f,p,h,m,E],P=0;L=new Error(o.replace(/%s/g,function(){return b[P++]})),L.name="Invariant Violation"}throw L.framesToPop=1,L}};return fi=t,fi}var Ka=Fa(),We=qs(Ka),xe=u.createContext(null);function Na(){We(!!u.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=u.useContext(xe);return We(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function qa(t,e,r){return Object.keys(t).reduce(function(l,f){return e(l,t[f],f)},r)}function Wa(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function Za(t,e,r,o){var l={},f=(p,h)=>{var m=r[h];m!==e[h]&&(l[h]=m,p(o,m))};return Wa(t,f),l}function Va(t,e,r){var o=qa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return o}function $a(t){google.maps.event.removeListener(t)}function je(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach($a)}function Oe(t){var{updaterMap:e,eventMap:r,prevProps:o,nextProps:l,instance:f}=t,p=Va(l,f,r);return Za(e,o,l,f),p}var go={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},mo={extraMapTypes(t,e){e.forEach(function(o,l){t.mapTypes.set(String(l),o)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ha(t){var{children:e,options:r,id:o,mapContainerStyle:l,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:E,onDragEnd:L,onDragStart:b,onMouseMove:P,onMouseOut:R,onMouseOver:k,onMouseDown:W,onMouseUp:q,onRightClick:G,onCenterChanged:V,onLoad:se,onUnmount:K}=t,[B,I]=u.useState(null),F=u.useRef(null),[ie,N]=u.useState(null),[re,J]=u.useState(null),[ae,de]=u.useState(null),[fe,le]=u.useState(null),[me,Se]=u.useState(null),[he,ve]=u.useState(null),[ye,Me]=u.useState(null),[De,pe]=u.useState(null),[Be,T]=u.useState(null),[Pe,Ae]=u.useState(null),[Ce,ne]=u.useState(null),[ge,Ie]=u.useState(null);return u.useEffect(()=>{r&&B!==null&&B.setOptions(r)},[B,r]),u.useEffect(()=>{B!==null&&typeof p<"u"&&B.setCenter(p)},[B,p]),u.useEffect(()=>{B&&m&&(re!==null&&google.maps.event.removeListener(re),J(google.maps.event.addListener(B,"dblclick",m)))},[m]),u.useEffect(()=>{B&&L&&(ae!==null&&google.maps.event.removeListener(ae),de(google.maps.event.addListener(B,"dragend",L)))},[L]),u.useEffect(()=>{B&&b&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(B,"dragstart",b)))},[b]),u.useEffect(()=>{B&&W&&(me!==null&&google.maps.event.removeListener(me),Se(google.maps.event.addListener(B,"mousedown",W)))},[W]),u.useEffect(()=>{B&&P&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(B,"mousemove",P)))},[P]),u.useEffect(()=>{B&&R&&(ye!==null&&google.maps.event.removeListener(ye),Me(google.maps.event.addListener(B,"mouseout",R)))},[R]),u.useEffect(()=>{B&&k&&(De!==null&&google.maps.event.removeListener(De),pe(google.maps.event.addListener(B,"mouseover",k)))},[k]),u.useEffect(()=>{B&&q&&(Be!==null&&google.maps.event.removeListener(Be),T(google.maps.event.addListener(B,"mouseup",q)))},[q]),u.useEffect(()=>{B&&G&&(Pe!==null&&google.maps.event.removeListener(Pe),Ae(google.maps.event.addListener(B,"rightclick",G)))},[G]),u.useEffect(()=>{B&&h&&(Ce!==null&&google.maps.event.removeListener(Ce),ne(google.maps.event.addListener(B,"click",h)))},[h]),u.useEffect(()=>{B&&E&&(ge!==null&&google.maps.event.removeListener(ge),Ie(google.maps.event.addListener(B,"drag",E)))},[E]),u.useEffect(()=>{B&&V&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(B,"center_changed",V)))},[h]),u.useEffect(()=>{var Ee=F.current===null?null:new google.maps.Map(F.current,r);return I(Ee),Ee!==null&&se&&se(Ee),()=>{Ee!==null&&K&&K(Ee)}},[]),ce.jsx("div",{id:o,ref:F,style:l,className:f,children:ce.jsx(xe.Provider,{value:B,children:B!==null?e:null})})}u.memo(Ha);class Ga extends u.PureComponent{constructor(){super(...arguments),z(this,"state",{map:null}),z(this,"registeredEvents",[]),z(this,"mapRef",null),z(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),z(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),z(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),z(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=Oe({updaterMap:mo,eventMap:go,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:mo,eventMap:go,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),je(this.registeredEvents))}render(){return ce.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:ce.jsx(xe.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function vo(t,e,r,o,l,f,p){try{var h=t[f](p),m=h.value}catch(E){return void r(E)}h.done?e(m):Promise.resolve(m).then(o,l)}function Ws(t){return function(){var e=this,r=arguments;return new Promise(function(o,l){var f=t.apply(e,r);function p(m){vo(f,o,l,p,h,"next",m)}function h(m){vo(f,o,l,p,h,"throw",m)}p(void 0)})}}function Zs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:o="weekly",language:l,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:E,apiUrl:L="https://maps.googleapis.com"}=t,b=[];return We(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?b.push("key=".concat(e)):r&&b.push("client=".concat(r)),o&&b.push("v=".concat(o)),l&&b.push("language=".concat(l)),f&&b.push("region=".concat(f)),p&&p.length&&b.push("libraries=".concat(p.sort().join(","))),h&&b.push("channel=".concat(h)),m&&m.length&&b.push("map_ids=".concat(m.join(","))),E&&b.push("auth_referrer_policy=".concat(E)),b.push("loading=async"),b.push("callback=initMap"),"".concat(L,"/maps/api/js?").concat(b.join("&"))}var Ft=typeof document<"u";function Vs(t){var{url:e,id:r,nonce:o}=t;return Ft?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var E=h.getAttribute("data-state");if(h.src===e&&E!=="error"){if(E==="ready")return f(r);var L=m.initMap,b=h.onerror;m.initMap=function(){L&&L(),f(r)},h.onerror=function(R){b&&b(R),p(R)};return}else h.remove()}var P=document.createElement("script");P.type="text/javascript",P.src=e,P.id=r,P.async=!0,P.nonce=o||"",P.onerror=function(k){P.setAttribute("data-state","error"),p(k)},m.initMap=function(){P.setAttribute("data-state","ready"),f(r)},document.head.appendChild(P)}).catch(l=>{throw console.error("injectScript error: ",l),l}):Promise.reject(new Error("document is undefined"))}function yo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function _i(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(l,f){return yo(l)||Reflect.apply(e,t,[l,f]),l};var r=t.appendChild.bind(t);t.appendChild=function(l){return yo(l)||Reflect.apply(r,t,[l]),l}}}var Rn=!1;function $s(){return ce.jsx("div",{children:"Loading..."})}var Fn={id:"script-loader",version:"weekly"};class Ya extends u.PureComponent{constructor(){super(...arguments),z(this,"check",null),z(this,"state",{loaded:!1}),z(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),z(this,"isCleaningUp",Ws(function*(){function e(r){if(!Rn)r();else if(Ft)var o=window.setInterval(function(){Rn||(window.clearInterval(o),r())},1)}return new Promise(e)})),z(this,"cleanup",()=>{Rn=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(o){return typeof o.src=="string"&&o.src.includes("maps.googleapis")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(o){return o.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(o){return o.innerText!==void 0&&o.innerText.length>0&&o.innerText.includes(".gm-")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)})}),z(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&_i(),We(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Zs(this.props)};Vs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),z(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Ft){if(window.google&&window.google.maps&&!Rn){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Ft&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Ft){this.cleanup();var e=()=>{this.check||(delete window.google,Rn=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return ce.jsxs(ce.Fragment,{children:[ce.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||ce.jsx($s,{})]})}}z(Ya,"defaultProps",Fn);function Xa(t,e){if(t==null)return{};var r={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;r[o]=t[o]}return r}function Oi(t,e){if(t==null)return{};var r,o,l=Xa(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(o=0;o<f.length;o++)r=f[o],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(l[r]=t[r])}return l}var bo;function Qa(t){var{id:e=Fn.id,version:r=Fn.version,nonce:o,googleMapsApiKey:l,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:E,channel:L,mapIds:b,authReferrerPolicy:P,apiUrl:R="https://maps.googleapis.com"}=t,k=u.useRef(!1),[W,q]=u.useState(!1),[G,V]=u.useState(void 0);u.useEffect(function(){return k.current=!0,()=>{k.current=!1}},[]),u.useEffect(function(){Ft&&E&&_i()},[E]),u.useEffect(function(){W&&We(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[W]);var se=Zs({version:r,googleMapsApiKey:l,googleMapsClientId:f,language:p,region:h,libraries:m,channel:L,mapIds:b,authReferrerPolicy:P,apiUrl:R});u.useEffect(function(){if(!Ft)return;function I(){k.current&&(q(!0),bo=se)}if(window.google&&window.google.maps&&bo===se){I();return}Vs({id:e,url:se,nonce:o}).then(I).catch(function(ie){k.current&&V(ie),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(l||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(ie)})},[e,se,o]);var K=u.useRef(void 0);return u.useEffect(function(){K.current&&m!==K.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),K.current=m},[m]),{isLoaded:W,loadError:G,url:se}}var Ja=["loadingElement","onLoad","onError","onUnmount","children"],el=ce.jsx($s,{});function tl(t){var{loadingElement:e,onLoad:r,onError:o,onUnmount:l,children:f}=t,p=Oi(t,Ja),{isLoaded:h,loadError:m}=Qa(p);return u.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),u.useEffect(function(){m&&typeof o=="function"&&o(m)},[m,o]),u.useEffect(function(){return()=>{l&&l()}},[l]),h?f:e||el}u.memo(tl);function nl(t,e,r,o){function l(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(L){try{E(o.next(L))}catch(b){p(b)}}function m(L){try{E(o.throw(L))}catch(b){p(b)}}function E(L){L.done?f(L.value):l(L.value).then(h,m)}E((o=o.apply(t,[])).next())})}function rl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var il=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,l,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(l=o;l--!==0;)if(!t(e[l],r[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[l]))return!1;for(l=o;l--!==0;){var p=f[l];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},ol=rl(il),wo="__googleMapsScriptId",vn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(vn||(vn={}));class Qt{constructor(e){var{apiKey:r,authReferrerPolicy:o,channel:l,client:f,id:p=wo,language:h,libraries:m=[],mapIds:E,nonce:L,region:b,retries:P=3,url:R="https://maps.googleapis.com/maps/api/js",version:k}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=o,this.channel=l,this.client=f,this.id=p||wo,this.language=h,this.libraries=m,this.mapIds=E,this.nonce=L,this.region=b,this.retries=P,this.url=R,this.version=k,Qt.instance){if(!ol(this.options,Qt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Qt.instance.options)));return Qt.instance}Qt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?vn.FAILURE:this.done?vn.SUCCESS:this.loading?vn.LOADING:vn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(o=>{o?r(o.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var o={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(o).forEach(f=>!o[f]&&delete o[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,E="The Google Maps JavaScript API",L="google",b="importLibrary",P="__ib__",R=document,k=window;k=k[L]||(k[L]={});var W=k.maps||(k.maps={}),q=new Set,G=new URLSearchParams,V=()=>p||(p=new Promise((se,K)=>nl(this,void 0,void 0,function*(){var B;yield h=R.createElement("script"),h.id=this.id,G.set("libraries",[...q]+"");for(m in f)G.set(m.replace(/[A-Z]/g,I=>"_"+I[0].toLowerCase()),f[m]);G.set("callback",L+".maps."+P),h.src=this.url+"?"+G,W[P]=se,h.onerror=()=>p=K(Error(E+" could not load.")),h.nonce=this.nonce||((B=R.querySelector("script[nonce]"))===null||B===void 0?void 0:B.nonce)||"",R.head.append(h)})));W[b]?console.warn(E+" only loads once. Ignoring:",f):W[b]=function(se){for(var K=arguments.length,B=new Array(K>1?K-1:0),I=1;I<K;I++)B[I-1]=arguments[I];return q.add(se)&&V().then(()=>W[b](se,...B))}})(o);var l=this.libraries.map(f=>this.importLibrary(f));l.length||l.push(this.importLibrary("core")),Promise.all(l).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var sl=["maps"];function al(t){var{id:e=Fn.id,version:r=Fn.version,nonce:o,googleMapsApiKey:l,language:f,region:p,libraries:h=sl,preventGoogleFontsLoading:m,mapIds:E,authReferrerPolicy:L}=t,b=u.useRef(!1),[P,R]=u.useState(!1),[k,W]=u.useState(void 0);u.useEffect(function(){return b.current=!0,()=>{b.current=!1}},[]);var q=u.useMemo(()=>new Qt({id:e,apiKey:l,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:E||[],nonce:o||"",authReferrerPolicy:L||"origin"}),[e,l,r,h,f,p,E,o,L]);u.useEffect(function(){P||q.load().then(()=>{b.current&&R(!0)}).catch(se=>{W(se)})},[]),u.useEffect(()=>{Ft&&m&&_i()},[m]);var G=u.useRef();return u.useEffect(()=>{G.current&&h!==G.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),G.current=h},[h]),{isLoaded:P,loadError:k}}function Lo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Co={},xo={options(t,e){t.setOptions(e)}};function ll(t){var{options:e,onLoad:r,onUnmount:o}=t,l=u.useContext(xe),[f,p]=u.useState(null);return u.useEffect(()=>{f!==null&&f.setMap(l)},[l]),u.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),u.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:l}));return p(h),r&&r(h),()=>{f!==null&&(o&&o(f),f.setMap(null))}},[]),null}u.memo(ll);class ul extends u.PureComponent{constructor(){super(...arguments),z(this,"state",{trafficLayer:null}),z(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),z(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:xo,eventMap:Co,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:xo,eventMap:Co,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),je(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}z(ul,"contextType",xe);function cl(t){var{onLoad:e,onUnmount:r}=t,o=u.useContext(xe),[l,f]=u.useState(null);return u.useEffect(()=>{l!==null&&l.setMap(o)},[o]),u.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(o),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}u.memo(cl);class fl extends u.PureComponent{constructor(){super(...arguments),z(this,"state",{bicyclingLayer:null}),z(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}z(fl,"contextType",xe);function dl(t){var{onLoad:e,onUnmount:r}=t,o=u.useContext(xe),[l,f]=u.useState(null);return u.useEffect(()=>{l!==null&&l.setMap(o)},[o]),u.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(o),e&&e(p),()=>{l!==null&&(r&&r(l),l.setMap(null))}},[]),null}u.memo(dl);class pl extends u.PureComponent{constructor(){super(...arguments),z(this,"state",{transitLayer:null}),z(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}z(pl,"contextType",xe);function Eo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function xr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Eo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Eo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ko={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},So={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function hl(t){var{options:e,drawingMode:r,onCircleComplete:o,onMarkerComplete:l,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:E,onUnmount:L}=t,b=u.useContext(xe),[P,R]=u.useState(null),[k,W]=u.useState(null),[q,G]=u.useState(null),[V,se]=u.useState(null),[K,B]=u.useState(null),[I,F]=u.useState(null),[ie,N]=u.useState(null);return u.useEffect(()=>{P!==null&&P.setMap(b)},[b]),u.useEffect(()=>{e&&P!==null&&P.setOptions(e)},[P,e]),u.useEffect(()=>{P!==null&&P.setDrawingMode(r??null)},[P,r]),u.useEffect(()=>{P&&o&&(k!==null&&google.maps.event.removeListener(k),W(google.maps.event.addListener(P,"circlecomplete",o)))},[P,o]),u.useEffect(()=>{P&&l&&(q!==null&&google.maps.event.removeListener(q),G(google.maps.event.addListener(P,"markercomplete",l)))},[P,l]),u.useEffect(()=>{P&&f&&(V!==null&&google.maps.event.removeListener(V),se(google.maps.event.addListener(P,"overlaycomplete",f)))},[P,f]),u.useEffect(()=>{P&&p&&(K!==null&&google.maps.event.removeListener(K),B(google.maps.event.addListener(P,"polygoncomplete",p)))},[P,p]),u.useEffect(()=>{P&&h&&(I!==null&&google.maps.event.removeListener(I),F(google.maps.event.addListener(P,"polylinecomplete",h)))},[P,h]),u.useEffect(()=>{P&&m&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(P,"rectanglecomplete",m)))},[P,m]),u.useEffect(()=>{We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var re=new google.maps.drawing.DrawingManager(xr(xr({},e),{},{map:b}));return r&&re.setDrawingMode(r),o&&W(google.maps.event.addListener(re,"circlecomplete",o)),l&&G(google.maps.event.addListener(re,"markercomplete",l)),f&&se(google.maps.event.addListener(re,"overlaycomplete",f)),p&&B(google.maps.event.addListener(re,"polygoncomplete",p)),h&&F(google.maps.event.addListener(re,"polylinecomplete",h)),m&&N(google.maps.event.addListener(re,"rectanglecomplete",m)),R(re),E&&E(re),()=>{P!==null&&(k&&google.maps.event.removeListener(k),q&&google.maps.event.removeListener(q),V&&google.maps.event.removeListener(V),K&&google.maps.event.removeListener(K),I&&google.maps.event.removeListener(I),ie&&google.maps.event.removeListener(ie),L&&L(P),P.setMap(null))}},[]),null}u.memo(hl);class gl extends u.PureComponent{constructor(e){super(e),z(this,"registeredEvents",[]),z(this,"state",{drawingManager:null}),z(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(xr(xr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:So,eventMap:ko,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:So,eventMap:ko,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),je(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}z(gl,"contextType",xe);function Mo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function yn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Po={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},_o={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Er={};function ml(t){var{position:e,options:r,clusterer:o,noClustererRedraw:l,children:f,draggable:p,visible:h,animation:m,clickable:E,cursor:L,icon:b,label:P,opacity:R,shape:k,title:W,zIndex:q,onClick:G,onDblClick:V,onDrag:se,onDragEnd:K,onDragStart:B,onMouseOut:I,onMouseOver:F,onMouseUp:ie,onMouseDown:N,onRightClick:re,onClickableChanged:J,onCursorChanged:ae,onAnimationChanged:de,onDraggableChanged:fe,onFlatChanged:le,onIconChanged:me,onPositionChanged:Se,onShapeChanged:he,onTitleChanged:ve,onVisibleChanged:ye,onZindexChanged:Me,onLoad:De,onUnmount:pe}=t,Be=u.useContext(xe),[T,Pe]=u.useState(null),[Ae,Ce]=u.useState(null),[ne,ge]=u.useState(null),[Ie,Ee]=u.useState(null),[Ye,Nt]=u.useState(null),[Re,Zn]=u.useState(null),[nn,Vn]=u.useState(null),[rn,on]=u.useState(null),[Xe,Ln]=u.useState(null),[ut,Cn]=u.useState(null),[St,ct]=u.useState(null),[ot,sn]=u.useState(null),[ft,an]=u.useState(null),[yt,dt]=u.useState(null),[bt,ln]=u.useState(null),[Je,ue]=u.useState(null),[pt,ht]=u.useState(null),[wt,te]=u.useState(null),[un,xn]=u.useState(null),[Mt,En]=u.useState(null),[Pt,$n]=u.useState(null),[cn,Lt]=u.useState(null);u.useEffect(()=>{T!==null&&T.setMap(Be)},[Be]),u.useEffect(()=>{typeof r<"u"&&T!==null&&T.setOptions(r)},[T,r]),u.useEffect(()=>{typeof p<"u"&&T!==null&&T.setDraggable(p)},[T,p]),u.useEffect(()=>{e&&T!==null&&T.setPosition(e)},[T,e]),u.useEffect(()=>{typeof h<"u"&&T!==null&&T.setVisible(h)},[T,h]),u.useEffect(()=>{T?.setAnimation(m)},[T,m]),u.useEffect(()=>{T&&E!==void 0&&T.setClickable(E)},[T,E]),u.useEffect(()=>{T&&L!==void 0&&T.setCursor(L)},[T,L]),u.useEffect(()=>{T&&b!==void 0&&T.setIcon(b)},[T,b]),u.useEffect(()=>{T&&P!==void 0&&T.setLabel(P)},[T,P]),u.useEffect(()=>{T&&R!==void 0&&T.setOpacity(R)},[T,R]),u.useEffect(()=>{T&&k!==void 0&&T.setShape(k)},[T,k]),u.useEffect(()=>{T&&W!==void 0&&T.setTitle(W)},[T,W]),u.useEffect(()=>{T&&q!==void 0&&T.setZIndex(q)},[T,q]),u.useEffect(()=>{T&&V&&(Ae!==null&&google.maps.event.removeListener(Ae),Ce(google.maps.event.addListener(T,"dblclick",V)))},[V]),u.useEffect(()=>{T&&K&&(ne!==null&&google.maps.event.removeListener(ne),ge(google.maps.event.addListener(T,"dragend",K)))},[K]),u.useEffect(()=>{T&&B&&(Ie!==null&&google.maps.event.removeListener(Ie),Ee(google.maps.event.addListener(T,"dragstart",B)))},[B]),u.useEffect(()=>{T&&N&&(Ye!==null&&google.maps.event.removeListener(Ye),Nt(google.maps.event.addListener(T,"mousedown",N)))},[N]),u.useEffect(()=>{T&&I&&(Re!==null&&google.maps.event.removeListener(Re),Zn(google.maps.event.addListener(T,"mouseout",I)))},[I]),u.useEffect(()=>{T&&F&&(nn!==null&&google.maps.event.removeListener(nn),Vn(google.maps.event.addListener(T,"mouseover",F)))},[F]),u.useEffect(()=>{T&&ie&&(rn!==null&&google.maps.event.removeListener(rn),on(google.maps.event.addListener(T,"mouseup",ie)))},[ie]),u.useEffect(()=>{T&&re&&(Xe!==null&&google.maps.event.removeListener(Xe),Ln(google.maps.event.addListener(T,"rightclick",re)))},[re]),u.useEffect(()=>{T&&G&&(ut!==null&&google.maps.event.removeListener(ut),Cn(google.maps.event.addListener(T,"click",G)))},[G]),u.useEffect(()=>{T&&se&&(St!==null&&google.maps.event.removeListener(St),ct(google.maps.event.addListener(T,"drag",se)))},[se]),u.useEffect(()=>{T&&J&&(ot!==null&&google.maps.event.removeListener(ot),sn(google.maps.event.addListener(T,"clickable_changed",J)))},[J]),u.useEffect(()=>{T&&ae&&(ft!==null&&google.maps.event.removeListener(ft),an(google.maps.event.addListener(T,"cursor_changed",ae)))},[ae]),u.useEffect(()=>{T&&de&&(yt!==null&&google.maps.event.removeListener(yt),dt(google.maps.event.addListener(T,"animation_changed",de)))},[de]),u.useEffect(()=>{T&&fe&&(bt!==null&&google.maps.event.removeListener(bt),ln(google.maps.event.addListener(T,"draggable_changed",fe)))},[fe]),u.useEffect(()=>{T&&le&&(Je!==null&&google.maps.event.removeListener(Je),ue(google.maps.event.addListener(T,"flat_changed",le)))},[le]),u.useEffect(()=>{T&&me&&(pt!==null&&google.maps.event.removeListener(pt),ht(google.maps.event.addListener(T,"icon_changed",me)))},[me]),u.useEffect(()=>{T&&Se&&(wt!==null&&google.maps.event.removeListener(wt),te(google.maps.event.addListener(T,"position_changed",Se)))},[Se]),u.useEffect(()=>{T&&he&&(un!==null&&google.maps.event.removeListener(un),xn(google.maps.event.addListener(T,"shape_changed",he)))},[he]),u.useEffect(()=>{T&&ve&&(Mt!==null&&google.maps.event.removeListener(Mt),En(google.maps.event.addListener(T,"title_changed",ve)))},[ve]),u.useEffect(()=>{T&&ye&&(Pt!==null&&google.maps.event.removeListener(Pt),$n(google.maps.event.addListener(T,"visible_changed",ye)))},[ye]),u.useEffect(()=>{T&&Me&&(cn!==null&&google.maps.event.removeListener(cn),Lt(google.maps.event.addListener(T,"zindex_changed",Me)))},[Me]),u.useEffect(()=>{var Ct=yn(yn(yn({},r||Er),o?Er:{map:Be}),{},{position:e}),be=new google.maps.Marker(Ct);return o?o.addMarker(be,!!l):be.setMap(Be),e&&be.setPosition(e),typeof h<"u"&&be.setVisible(h),typeof p<"u"&&be.setDraggable(p),typeof E<"u"&&be.setClickable(E),typeof L=="string"&&be.setCursor(L),b&&be.setIcon(b),typeof P<"u"&&be.setLabel(P),typeof R<"u"&&be.setOpacity(R),k&&be.setShape(k),typeof W=="string"&&be.setTitle(W),typeof q=="number"&&be.setZIndex(q),V&&Ce(google.maps.event.addListener(be,"dblclick",V)),K&&ge(google.maps.event.addListener(be,"dragend",K)),B&&Ee(google.maps.event.addListener(be,"dragstart",B)),N&&Nt(google.maps.event.addListener(be,"mousedown",N)),I&&Zn(google.maps.event.addListener(be,"mouseout",I)),F&&Vn(google.maps.event.addListener(be,"mouseover",F)),ie&&on(google.maps.event.addListener(be,"mouseup",ie)),re&&Ln(google.maps.event.addListener(be,"rightclick",re)),G&&Cn(google.maps.event.addListener(be,"click",G)),se&&ct(google.maps.event.addListener(be,"drag",se)),J&&sn(google.maps.event.addListener(be,"clickable_changed",J)),ae&&an(google.maps.event.addListener(be,"cursor_changed",ae)),de&&dt(google.maps.event.addListener(be,"animation_changed",de)),fe&&ln(google.maps.event.addListener(be,"draggable_changed",fe)),le&&ue(google.maps.event.addListener(be,"flat_changed",le)),me&&ht(google.maps.event.addListener(be,"icon_changed",me)),Se&&te(google.maps.event.addListener(be,"position_changed",Se)),he&&xn(google.maps.event.addListener(be,"shape_changed",he)),ve&&En(google.maps.event.addListener(be,"title_changed",ve)),ye&&$n(google.maps.event.addListener(be,"visible_changed",ye)),Me&&Lt(google.maps.event.addListener(be,"zindex_changed",Me)),Pe(be),De&&De(be),()=>{Ae!==null&&google.maps.event.removeListener(Ae),ne!==null&&google.maps.event.removeListener(ne),Ie!==null&&google.maps.event.removeListener(Ie),Ye!==null&&google.maps.event.removeListener(Ye),Re!==null&&google.maps.event.removeListener(Re),nn!==null&&google.maps.event.removeListener(nn),rn!==null&&google.maps.event.removeListener(rn),Xe!==null&&google.maps.event.removeListener(Xe),ut!==null&&google.maps.event.removeListener(ut),ot!==null&&google.maps.event.removeListener(ot),ft!==null&&google.maps.event.removeListener(ft),yt!==null&&google.maps.event.removeListener(yt),bt!==null&&google.maps.event.removeListener(bt),Je!==null&&google.maps.event.removeListener(Je),pt!==null&&google.maps.event.removeListener(pt),wt!==null&&google.maps.event.removeListener(wt),Mt!==null&&google.maps.event.removeListener(Mt),Pt!==null&&google.maps.event.removeListener(Pt),cn!==null&&google.maps.event.removeListener(cn),pe&&pe(be),o?o.removeMarker(be,!!l):be&&be.setMap(null)}},[]);var _t=u.useMemo(()=>f?u.Children.map(f,Ct=>{if(!u.isValidElement(Ct))return Ct;var be=Ct;return u.cloneElement(be,{anchor:T})}):null,[f,T]);return ce.jsx(ce.Fragment,{children:_t})||null}u.memo(ml);class vl extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[])}componentDidMount(){var e=this;return Ws(function*(){var r=yn(yn(yn({},e.props.options||Er),e.props.clusterer?Er:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=Oe({updaterMap:_o,eventMap:Po,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:_o,eventMap:Po,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),je(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?u.Children.map(this.props.children,r=>{if(!u.isValidElement(r))return r;var o=r;return u.cloneElement(o,{anchor:this.marker})}):null;return e||null}}z(vl,"contextType",xe);var yl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var o=r.getMaxZoom(),l=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(l),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(l);var h=p.getZoom()||0;o!==null&&h>o&&p.setZoom(o+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,o,l,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),E=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),L=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),b=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(b!==null?"".concat(b.y,"px"):"0","; left: ").concat(b!==null?"".concat(b.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var P=document.createElement("img");P.alt=h,P.src=this.url,P.width=this.width,P.height=this.height,P.setAttribute("style","position: absolute; top: ".concat(L,"px; left: ").concat(E,"px")),this.cluster.getClusterer().enableRetinaIcons||(P.style.clip="rect(-".concat(L,"px, -").concat(E+this.width,"px, -").concat(L+this.height,", -").concat(E,")"));var R=document.createElement("div");R.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((o=this.sums)===null||o===void 0)&&o.text&&(R.innerText="".concat((l=this.sums)===null||l===void 0?void 0:l.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(R.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(P),this.div.appendChild(R),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),o=r[Math.min(r.length-1,Math.max(0,e.index-1))];o&&(this.url=o.url,this.height=o.height,this.width=o.width,o.className&&(this.className="".concat(this.clusterClassName," ").concat(o.className)),this.anchorText=o.anchorText||[0,0],this.anchorIcon=o.anchorIcon||[this.height/2,this.width/2],this.textColor=o.textColor||"black",this.textSize=o.textSize||11,this.textDecoration=o.textDecoration||"none",this.fontWeight=o.fontWeight||"bold",this.fontStyle=o.fontStyle||"normal",this.fontFamily=o.fontFamily||"Arial,sans-serif",this.backgroundPosition=o.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),bl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new yl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),o=0,l=r;o<l.length;o++){var f=l[o],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var o=e.getPosition();if(o){var l=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(l-1)+o.lat())/l,(this.center.lng()*(l-1)+o.lng())/l),this.calculateBounds()}}}else{var o=e.getPosition();o&&(this.center=o,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,E=this.markers;m<E.length;m++){var L=E[m];L.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,o=this.markerClusterer.getMaxZoom(),l=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(o!==null&&typeof l<"u"&&l>o){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function wl(t,e){var r=t.length,o=r.toString().length,l=Math.min(o,e);return{text:r.toString(),index:l,title:""}}var Ll=2e3,Cl=500,xl="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",El="png",kl=[53,56,66,78,90],Sl="cluster",Hs=(function(){function t(e,r,o){r===void 0&&(r=[]),o===void 0&&(o={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=o.gridSize||60,this.minClusterSize=o.minimumClusterSize||2,this.maxZoom=o.maxZoom||null,this.styles=o.styles||[],this.title=o.title||"",this.zoomOnClick=!0,o.zoomOnClick!==void 0&&(this.zoomOnClick=o.zoomOnClick),this.averageCenter=!1,o.averageCenter!==void 0&&(this.averageCenter=o.averageCenter),this.ignoreHidden=!1,o.ignoreHidden!==void 0&&(this.ignoreHidden=o.ignoreHidden),this.enableRetinaIcons=!1,o.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=o.enableRetinaIcons),this.imagePath=o.imagePath||xl,this.imageExtension=o.imageExtension||El,this.imageSizes=o.imageSizes||kl,this.calculator=o.calculator||wl,this.batchSize=o.batchSize||Ll,this.batchSizeIE=o.batchSizeIE||Cl,this.clusterClass=o.clusterClass||Sl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var o=r[e];o.getMap()!==this.activeMap&&o.setMap(this.activeMap)}for(var l=0,f=this.clusters;l<f.length;l++){var p=f[l];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var E=m[h];google.maps.event.removeListener(E)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,o=0,l=e;o<l.length;o++){var f=l[o],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=e[o];l&&this.pushMarkerTo(l)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var o=0;o<this.markers.length;o++)if(e===this.markers[o]){r=o;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var o=this.removeMarker_(e);return!r&&o&&this.repaint(),o},t.prototype.removeMarkers=function(e,r){for(var o=!1,l=0,f=e;l<f.length;l++){var p=f[l];o=o||this.removeMarker_(p)}return!r&&o&&this.repaint(),o},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var o=0,l=e;o<l.length;o++){var f=l[o];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),o=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));o!==null&&(o.x+=this.gridSize,o.y-=this.gridSize);var l=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(l!==null&&(l.x-=this.gridSize,l.y+=this.gridSize),o!==null){var f=r.fromDivPixelToLatLng(o);f!==null&&e.extend(f)}if(l!==null){var p=r.fromDivPixelToLatLng(l);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,o=this.clusters;r<o.length;r++){var l=o[r];l.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var o=6371,l=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return o*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var o=e.getPosition();return o?r.contains(o):!1},t.prototype.addToClosestCluster=function(e){for(var r,o=4e4,l=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),E=e.getPosition();if(m&&E){var L=this.distanceBetweenPoints(m,E);L<o&&(o=L,l=r)}}l&&l.isMarkerInClusterBounds(e)?l.addMarker(e):(r=new bl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var o=this.getMap(),l=o!==null&&("getBounds"in o)?o.getBounds():null,f=o?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(l?.getSouthWest(),l?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),E=e;E<m;E++){var L=this.markers[E];L&&!L.isAdded&&this.isMarkerInBounds(L,h)&&(!this.ignoreHidden||this.ignoreHidden&&L.getVisible())&&this.addToClosestCluster(L)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var b=0,P=this.clusters;b<P.length;b++){var R=P[b];R.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(l){for(var f in l.prototype){var p=f;this.prototype[p]=l.prototype[p]}return this}).apply(e,[r])},t})();function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Ml(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var at={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Ue={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Pl={};function _l(t){var{children:e,options:r,averageCenter:o,batchSizeIE:l,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:E,imageExtension:L,imagePath:b,imageSizes:P,maxZoom:R,minimumClusterSize:k,styles:W,title:q,zoomOnClick:G,onClick:V,onClusteringBegin:se,onClusteringEnd:K,onMouseOver:B,onMouseOut:I,onLoad:F,onUnmount:ie}=t,[N,re]=u.useState(null),J=u.useContext(xe),[ae,de]=u.useState(null),[fe,le]=u.useState(null),[me,Se]=u.useState(null),[he,ve]=u.useState(null),[ye,Me]=u.useState(null);return u.useEffect(()=>{N&&I&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(N,at.onMouseOut,I)))},[I]),u.useEffect(()=>{N&&B&&(ye!==null&&google.maps.event.removeListener(ye),Me(google.maps.event.addListener(N,at.onMouseOver,B)))},[B]),u.useEffect(()=>{N&&V&&(ae!==null&&google.maps.event.removeListener(ae),de(google.maps.event.addListener(N,at.onClick,V)))},[V]),u.useEffect(()=>{N&&se&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(N,at.onClusteringBegin,se)))},[se]),u.useEffect(()=>{N&&K&&(me!==null&&google.maps.event.removeListener(me),le(google.maps.event.addListener(N,at.onClusteringEnd,K)))},[K]),u.useEffect(()=>{typeof o<"u"&&N!==null&&Ue.averageCenter(N,o)},[N,o]),u.useEffect(()=>{typeof l<"u"&&N!==null&&Ue.batchSizeIE(N,l)},[N,l]),u.useEffect(()=>{typeof f<"u"&&N!==null&&Ue.calculator(N,f)},[N,f]),u.useEffect(()=>{typeof p<"u"&&N!==null&&Ue.clusterClass(N,p)},[N,p]),u.useEffect(()=>{typeof h<"u"&&N!==null&&Ue.enableRetinaIcons(N,h)},[N,h]),u.useEffect(()=>{typeof m<"u"&&N!==null&&Ue.gridSize(N,m)},[N,m]),u.useEffect(()=>{typeof E<"u"&&N!==null&&Ue.ignoreHidden(N,E)},[N,E]),u.useEffect(()=>{typeof L<"u"&&N!==null&&Ue.imageExtension(N,L)},[N,L]),u.useEffect(()=>{typeof b<"u"&&N!==null&&Ue.imagePath(N,b)},[N,b]),u.useEffect(()=>{typeof P<"u"&&N!==null&&Ue.imageSizes(N,P)},[N,P]),u.useEffect(()=>{typeof R<"u"&&N!==null&&Ue.maxZoom(N,R)},[N,R]),u.useEffect(()=>{typeof k<"u"&&N!==null&&Ue.minimumClusterSize(N,k)},[N,k]),u.useEffect(()=>{typeof W<"u"&&N!==null&&Ue.styles(N,W)},[N,W]),u.useEffect(()=>{typeof q<"u"&&N!==null&&Ue.title(N,q)},[N,q]),u.useEffect(()=>{typeof G<"u"&&N!==null&&Ue.zoomOnClick(N,G)},[N,G]),u.useEffect(()=>{if(J){var De=Ml({},r||Pl),pe=new Hs(J,[],De);return o&&Ue.averageCenter(pe,o),l&&Ue.batchSizeIE(pe,l),f&&Ue.calculator(pe,f),p&&Ue.clusterClass(pe,p),h&&Ue.enableRetinaIcons(pe,h),m&&Ue.gridSize(pe,m),E&&Ue.ignoreHidden(pe,E),L&&Ue.imageExtension(pe,L),b&&Ue.imagePath(pe,b),P&&Ue.imageSizes(pe,P),R&&Ue.maxZoom(pe,R),k&&Ue.minimumClusterSize(pe,k),W&&Ue.styles(pe,W),q&&Ue.title(pe,q),G&&Ue.zoomOnClick(pe,G),I&&ve(google.maps.event.addListener(pe,at.onMouseOut,I)),B&&Me(google.maps.event.addListener(pe,at.onMouseOver,B)),V&&de(google.maps.event.addListener(pe,at.onClick,V)),se&&le(google.maps.event.addListener(pe,at.onClusteringBegin,se)),K&&Se(google.maps.event.addListener(pe,at.onClusteringEnd,K)),re(pe),F&&F(pe),()=>{he!==null&&google.maps.event.removeListener(he),ye!==null&&google.maps.event.removeListener(ye),ae!==null&&google.maps.event.removeListener(ae),fe!==null&&google.maps.event.removeListener(fe),me!==null&&google.maps.event.removeListener(me),ie&&ie(pe)}}},[]),N!==null&&e(N)||null}u.memo(_l);class Ol extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{markerClusterer:null}),z(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Hs(this.context,[],this.props.options);this.registeredEvents=Oe({updaterMap:Ue,eventMap:at,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ue,eventMap:at,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),je(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}z(Ol,"contextType",xe);function Do(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Gs=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(L){L.returnValue=!1,L.preventDefault&&L.preventDefault(),e.enableEventPropagation||Do(L)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var o=this.getPanes();if(o!==null&&o[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var l=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-l.left-l.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,Do))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var o=0,l=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,E=this.pixelOffset.width,L=this.pixelOffset.height,b=this.div.offsetWidth,P=this.div.offsetHeight,R=this.infoBoxClearance.width,k=this.infoBoxClearance.height,W=this.getProjection(),q=W.fromLatLngToContainerPixel(this.position);q!==null&&(q.x<-E+R?o=q.x+E-R:q.x+b+E+R>h&&(o=q.x+b+E+R-h),this.alignBottom?q.y<-L+k+P?l=q.y+L-k-P:q.y+L+k>m&&(l=q.y+L+k-m):q.y<-L+k?l=q.y+L-k:q.y+P+L+k>m&&(l=q.y+P+L+k-m)),o===0&&l===0||r.panBy(o,l)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var o=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+o*100+')"',this.div.style.filter="alpha(opacity="+o*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,o=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;o&&(e.top=parseInt(o.borderTopWidth||"",10)||0,e.bottom=parseInt(o.borderBottomWidth||"",10)||0,e.left=parseInt(o.borderLeftWidth||"",10)||0,e.right=parseInt(o.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var l=this.div.currentStyle;l&&(e.top=parseInt(l.borderTopWidth||"",10)||0,e.bottom=parseInt(l.borderBottomWidth||"",10)||0,e.left=parseInt(l.borderLeftWidth||"",10)||0,e.right=parseInt(l.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var o=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var l=r.getPosition();o.setPosition(l)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){o.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var o=r[e];google.maps.event.removeListener(o)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(l){for(var f in l.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=l.prototype[f]);return this}).apply(e,[r])},t})(),Dl=["position"],Il=["position"];function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var jo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Ro={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},jl={};function Rl(t){var{children:e,anchor:r,options:o,position:l,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:E,onZindexChanged:L,onLoad:b,onUnmount:P}=t,R=u.useContext(xe),[k,W]=u.useState(null),[q,G]=u.useState(null),[V,se]=u.useState(null),[K,B]=u.useState(null),[I,F]=u.useState(null),[ie,N]=u.useState(null),re=u.useRef(null);return u.useEffect(()=>{R&&k!==null&&(k.close(),r?k.open(R,r):k.getPosition()&&k.open(R))},[R,k,r]),u.useEffect(()=>{o&&k!==null&&k.setOptions(o)},[k,o]),u.useEffect(()=>{if(l&&k!==null){var J=l instanceof google.maps.LatLng?l:new google.maps.LatLng(l.lat,l.lng);k.setPosition(J)}},[l]),u.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),u.useEffect(()=>{k&&p&&(q!==null&&google.maps.event.removeListener(q),G(google.maps.event.addListener(k,"closeclick",p)))},[p]),u.useEffect(()=>{k&&h&&(V!==null&&google.maps.event.removeListener(V),se(google.maps.event.addListener(k,"domready",h)))},[h]),u.useEffect(()=>{k&&m&&(K!==null&&google.maps.event.removeListener(K),B(google.maps.event.addListener(k,"content_changed",m)))},[m]),u.useEffect(()=>{k&&E&&(I!==null&&google.maps.event.removeListener(I),F(google.maps.event.addListener(k,"position_changed",E)))},[E]),u.useEffect(()=>{k&&L&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(k,"zindex_changed",L)))},[L]),u.useEffect(()=>{if(R){var J=o||jl,{position:ae}=J,de=Oi(J,Dl),fe;ae&&!(ae instanceof google.maps.LatLng)&&(fe=new google.maps.LatLng(ae.lat,ae.lng));var le=new Gs(kr(kr({},de),fe?{position:fe}:{}));re.current=document.createElement("div"),W(le),p&&G(google.maps.event.addListener(le,"closeclick",p)),h&&se(google.maps.event.addListener(le,"domready",h)),m&&B(google.maps.event.addListener(le,"content_changed",m)),E&&F(google.maps.event.addListener(le,"position_changed",E)),L&&N(google.maps.event.addListener(le,"zindex_changed",L)),le.setContent(re.current),r?le.open(R,r):le.getPosition()?le.open(R):We(!1,"You must provide either an anchor or a position prop for <InfoBox>."),b&&b(le)}return()=>{k!==null&&(q&&google.maps.event.removeListener(q),K&&google.maps.event.removeListener(K),V&&google.maps.event.removeListener(V),I&&google.maps.event.removeListener(I),ie&&google.maps.event.removeListener(ie),P&&P(k),k.close())}},[]),re.current?wn.createPortal(u.Children.only(e),re.current):null}u.memo(Rl);class Tl extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",null),z(this,"state",{infoBox:null}),z(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):We(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),z(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,o=Oi(e,Il),l;r&&!(r instanceof google.maps.LatLng)&&(l=new google.maps.LatLng(r.lat,r.lng));var f=new Gs(kr(kr({},o),l?{position:l}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=Oe({updaterMap:Ro,eventMap:jo,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ro,eventMap:jo,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),je(this.registeredEvents),r.close())}render(){return this.containerElement?wn.createPortal(u.Children.only(this.props.children),this.containerElement):null}}z(Tl,"contextType",xe);var di,To;function Al(){return To||(To=1,di=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,l,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(l=o;l--!==0;)if(!t(e[l],r[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[l]))return!1;for(l=o;l--!==0;){var p=f[l];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),di}var Bl=Al(),Ao=qs(Bl),Bo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],pi=1,Tn=8;class Di{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,o]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var l=o>>4;if(l!==pi)throw new Error("Got v".concat(l," data when expected v").concat(pi,"."));var f=Bo[o&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new Di(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,l=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=Bo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(o,"."));l&&l instanceof ArrayBuffer?(this.data=l,this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Tn+p+h+m),this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(pi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=r,o}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return bi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],E=[];m.length;){var L=m.pop()||0,b=m.pop()||0,P=m.pop()||0;if(b-P<=h){for(var R=P;R<=b;R++){var k=p[2*R],W=p[2*R+1];k>=e&&k<=o&&W>=r&&W<=l&&E.push(f[R])}continue}var q=P+b>>1,G=p[2*q],V=p[2*q+1];G>=e&&G<=o&&V>=r&&V<=l&&E.push(f[q]),(L===0?e<=G:r<=V)&&(m.push(P),m.push(q-1),m.push(1-L)),(L===0?o>=G:l>=V)&&(m.push(q+1),m.push(b),m.push(1-L))}return E}within(e,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:l,coords:f,nodeSize:p}=this,h=[0,l.length-1,0],m=[],E=o*o;h.length;){var L=h.pop()||0,b=h.pop()||0,P=h.pop()||0;if(b-P<=p){for(var R=P;R<=b;R++)zo(f[2*R],f[2*R+1],e,r)<=E&&m.push(l[R]);continue}var k=P+b>>1,W=f[2*k],q=f[2*k+1];zo(W,q,e,r)<=E&&m.push(l[k]),(L===0?e-o<=W:r-o<=q)&&(h.push(P),h.push(k-1),h.push(1-L)),(L===0?e+o>=W:r+o>=q)&&(h.push(k+1),h.push(b),h.push(1-L))}return m}}function bi(t,e,r,o,l,f){if(!(l-o<=r)){var p=o+l>>1;Ys(t,e,p,o,l,f),bi(t,e,r,o,p-1,1-f),bi(t,e,r,p+1,l,1-f)}}function Ys(t,e,r,o,l,f){for(;l>o;){if(l-o>600){var p=l-o+1,h=r-o+1,m=Math.log(p),E=.5*Math.exp(2*m/3),L=.5*Math.sqrt(m*E*(p-E)/p)*(h-p/2<0?-1:1),b=Math.max(o,Math.floor(r-h*E/p+L)),P=Math.min(l,Math.floor(r+(p-h)*E/p+L));Ys(t,e,r,b,P,f)}var R=e[2*r+f],k=o,W=l;for(An(t,e,o,r),e[2*l+f]>R&&An(t,e,o,l);k<W;){for(An(t,e,k,W),k++,W--;e[2*k+f]<R;)k++;for(;e[2*W+f]>R;)W--}e[2*o+f]===R?An(t,e,o,W):(W++,An(t,e,W,l)),W<=r&&(o=W+1),r<=W&&(l=W-1)}}function An(t,e,r,o){hi(t,r,o),hi(e,2*r,2*o),hi(e,2*r+1,2*o+1)}function hi(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function zo(t,e,r,o){var l=t-r,f=e-o;return l*l+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Uo=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Gt=2,Ut=3,gi=4,zt=5,Xs=6;class Ul{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:o,maxZoom:l}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[E,L]=m.geometry.coordinates,b=Uo(mr(E)),P=Uo(vr(L));p.push(b,P,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var R=this.trees[l+1]=this._createTree(p);r&&console.timeEnd(f);for(var k=l;k>=o;k--){var W=+Date.now();R=this.trees[k]=this._createTree(this._cluster(R,k)),r&&console.log("z%d: %d clusters in %dms",k,R.numItems,+Date.now()-W)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var o=((e[0]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)o=-180,f=180;else if(o>f){var h=this.getClusters([o,l,180,p],r),m=this.getClusters([-180,l,f,p],r);return h.concat(m)}var E=this.trees[this._limitZoom(r)],L=E.range(mr(o),vr(p),mr(f),vr(l)),b=E.data,P=[];for(var R of L){var k=this.stride*R;P.push(b[k+zt]>1?Fo(b,k,this.clusterProps):this.points[b[k+Ut]])}return P}getChildren(e){var r=this._getOriginId(e),o=this._getOriginZoom(e),l="No cluster with the specified id.",f=this.trees[o];if(!f)throw new Error(l);var p=f.data;if(r*this.stride>=p.length)throw new Error(l);var h=this.options.radius/(this.options.extent*Math.pow(2,o-1)),m=p[r*this.stride],E=p[r*this.stride+1],L=f.within(m,E,h),b=[];for(var P of L){var R=P*this.stride;p[R+gi]===e&&b.push(p[R+zt]>1?Fo(p,R,this.clusterProps):this.points[p[R+Ut]])}if(b.length===0)throw new Error(l);return b}getLeaves(e,r,o){r=r||10,o=o||0;var l=[];return this._appendLeaves(l,e,r,o,0),l}getTile(e,r,o){var l=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,E=(o-m)/f,L=(o+1+m)/f,b={features:[]};return this._addTileFeatures(l.range((r-m)/f,E,(r+1+m)/f,L),l.data,r,o,f,b),r===0&&this._addTileFeatures(l.range(1-m/f,E,1,L),l.data,f,o,f,b),r===f-1&&this._addTileFeatures(l.range(0,E,m/f,L),l.data,-1,o,f,b),b.features.length?b:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var o=this.getChildren(e);if(r++,o.length!==1)break;e=o[0].properties.cluster_id}return r}_appendLeaves(e,r,o,l,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=l?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,o,l,f):f<l?f++:e.push(h),e.length===o)break}return f}_createTree(e){for(var r=new Di(e.length/this.stride|0,this.options.nodeSize,Float32Array),o=0;o<e.length;o+=this.stride)r.add(e[o],e[o+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,o,l,f,p){for(var h of e){var m=h*this.stride,E=r[m+zt]>1,L=void 0,b=void 0,P=void 0;if(E)L=Qs(r,m,this.clusterProps),b=r[m],P=r[m+1];else{var R=this.points[r[m+Ut]];L=R.properties;var[k,W]=R.geometry.coordinates;b=mr(k),P=vr(W)}var q={type:1,geometry:[[Math.round(this.options.extent*(b*f-o)),Math.round(this.options.extent*(P*f-l))]],tags:L},G=void 0;E||this.options.generateId?G=r[m+Ut]:G=this.points[r[m+Ut]].id,G!==void 0&&(q.id=G),p.features.push(q)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:o,extent:l,reduce:f,minPoints:p}=this.options,h=o/(l*Math.pow(2,r)),m=e.data,E=[],L=this.stride,b=0;b<m.length;b+=L)if(!(m[b+Gt]<=r)){m[b+Gt]=r;var P=m[b],R=m[b+1],k=e.within(m[b],m[b+1],h),W=m[b+zt],q=W;for(var G of k){var V=G*L;m[V+Gt]>r&&(q+=m[V+zt])}if(q>W&&q>=p){var se=P*W,K=R*W,B=void 0,I=-1,F=((b/L|0)<<5)+(r+1)+this.points.length;for(var ie of k){var N=ie*L;if(!(m[N+Gt]<=r)){m[N+Gt]=r;var re=m[N+zt];se+=m[N]*re,K+=m[N+1]*re,m[N+gi]=F,f&&(B||(B=this._map(m,b,!0),I=this.clusterProps.length,this.clusterProps.push(B)),f(B,this._map(m,N)))}}m[b+gi]=F,E.push(se/q,K/q,1/0,F,-1,q),f&&E.push(I)}else{for(var J=0;J<L;J++)E.push(m[b+J]);if(q>1)for(var ae of k){var de=ae*L;if(!(m[de+Gt]<=r)){m[de+Gt]=r;for(var fe=0;fe<L;fe++)E.push(m[de+fe])}}}}return E}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,o){if(e[r+zt]>1){var l=this.clusterProps[e[r+Xs]];return o?Object.assign({},l):l}var f=this.points[e[r+Ut]].properties,p=this.options.map(f);return o&&p===f?Object.assign({},p):p}}function Fo(t,e,r){return{type:"Feature",id:t[e+Ut],properties:Qs(t,e,r),geometry:{type:"Point",coordinates:[Fl(t[e]),Kl(t[e+1])]}}}function Qs(t,e,r){var o=t[e+zt],l=o>=1e4?"".concat(Math.round(o/1e3),"k"):o>=1e3?"".concat(Math.round(o/100)/10,"k"):o,f=t[e+Xs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Ut],point_count:o,point_count_abbreviated:l})}function mr(t){return t/360+.5}function vr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Fl(t){return(t-.5)*360}function Kl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Nl(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(t);l<o.length;l++)e.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(t,o[l])&&(r[o[l]]=t[o[l]]);return r}class rt{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class wi{constructor(e){var{markers:r,position:o}=e;this.markers=r,o&&(o instanceof google.maps.LatLng?this._position=o:this._position=new google.maps.LatLng(o))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(rt.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>rt.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(rt.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class ql{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Wl(r)}}var Wl=t=>{var e=t.map(r=>new wi({position:rt.getPosition(r),markers:[r]}));return e};class Zl extends ql{constructor(e){var{maxZoom:r,radius:o=60}=e,l=Nl(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Ul(Object.assign({maxZoom:this.maxZoom,radius:o},l))}calculate(e){var r=!1,o={zoom:e.map.getZoom()};if(!Ao(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var l=this.markers.map(f=>{var p=rt.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(l)}return r||(this.state.zoom<=this.maxZoom||o.zoom<=this.maxZoom)&&(r=!Ao(this.state,o)),this.state=o,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(o=>this.transformCluster(o))}transformCluster(e){var{geometry:{coordinates:[r,o]},properties:l}=e;if(l.cluster)return new wi({markers:this.superCluster.getLeaves(l.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:o,lng:r}});var f=l.marker;return new wi({markers:[f],position:rt.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var o=r.map(f=>f.count),l=o.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:l/r.length,sum:l,min:Math.min(...o),max:Math.max(...o)}}}}class $l{render(e,r,o){var{count:l,position:f}=e,p=l>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(l,`</text>
</svg>`),m="Cluster of ".concat(l," markers"),E=Number(google.maps.Marker.MAX_ZINDEX)+l;if(rt.isAdvancedMarkerAvailable(o)){var L=new DOMParser,b=L.parseFromString(h,"image/svg+xml").documentElement;b.setAttribute("transform","translate(0 25)");var P={map:o,position:f,zIndex:E,title:m,content:b};return new google.maps.marker.AdvancedMarkerElement(P)}var R={position:f,zIndex:E,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(R)}}function Hl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ii{constructor(){Hl(Ii,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Gl=(t,e,r)=>{r.fitBounds(e.bounds)};class Yl extends Ii{constructor(e){var{map:r,markers:o=[],algorithmOptions:l={},algorithm:f=new Zl(l),renderer:p=new $l,onClusterClick:h=Gl}=e;super(),this.markers=[...o],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(o=>{this.addMarker(o,!0)}),r||this.render()}removeMarker(e,r){var o=this.markers.indexOf(e);return o===-1?!1:(rt.setMap(e,null),this.markers.splice(o,1),r||this.render(),!0)}removeMarkers(e,r){var o=!1;return e.forEach(l=>{o=this.removeMarker(l,!0)||o}),o&&!r&&this.render(),o}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:o}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(o||o==null){var l=new Set;for(var f of r)f.markers.length==1&&l.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?l.has(h.marker)||rt.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>rt.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>rt.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(o=>{o.markers.length===1?o.marker=o.markers[0]:(o.marker=this.renderer.render(o,e,r),o.markers.forEach(l=>rt.setMap(l,null)),this.onClusterClick&&o.marker.addListener("click",l=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,o),this.onClusterClick(l,o,r)})),rt.setMap(o.marker,r)})}}function Ko(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function No(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ko(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ko(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function Xl(t){var e=Na(),[r,o]=u.useState(null);return u.useEffect(()=>{if(e&&r===null){var l=new Yl(No(No({},t),{},{map:e}));o(l)}},[e]),r}function Ql(t){var{children:e,options:r}=t,o=Xl(r);return o!==null?e(o):null}u.memo(Ql);var qo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Wo={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function Jl(t){var{children:e,anchor:r,options:o,position:l,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:E,onZindexChanged:L,onLoad:b,onUnmount:P}=t,R=u.useContext(xe),[k,W]=u.useState(null),[q,G]=u.useState(null),[V,se]=u.useState(null),[K,B]=u.useState(null),[I,F]=u.useState(null),[ie,N]=u.useState(null),re=u.useRef(null);return u.useEffect(()=>{k!==null&&(k.close(),r?k.open(R,r):k.getPosition()&&k.open(R))},[R,k,r]),u.useEffect(()=>{o&&k!==null&&k.setOptions(o)},[k,o]),u.useEffect(()=>{l&&k!==null&&k.setPosition(l)},[l]),u.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),u.useEffect(()=>{k&&p&&(q!==null&&google.maps.event.removeListener(q),G(google.maps.event.addListener(k,"closeclick",p)))},[p]),u.useEffect(()=>{k&&h&&(V!==null&&google.maps.event.removeListener(V),se(google.maps.event.addListener(k,"domready",h)))},[h]),u.useEffect(()=>{k&&m&&(K!==null&&google.maps.event.removeListener(K),B(google.maps.event.addListener(k,"content_changed",m)))},[m]),u.useEffect(()=>{k&&E&&(I!==null&&google.maps.event.removeListener(I),F(google.maps.event.addListener(k,"position_changed",E)))},[E]),u.useEffect(()=>{k&&L&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(k,"zindex_changed",L)))},[L]),u.useEffect(()=>{var J=new google.maps.InfoWindow(o);return W(J),re.current=document.createElement("div"),p&&G(google.maps.event.addListener(J,"closeclick",p)),h&&se(google.maps.event.addListener(J,"domready",h)),m&&B(google.maps.event.addListener(J,"content_changed",m)),E&&F(google.maps.event.addListener(J,"position_changed",E)),L&&N(google.maps.event.addListener(J,"zindex_changed",L)),J.setContent(re.current),l&&J.setPosition(l),f&&J.setZIndex(f),r?J.open(R,r):J.getPosition()?J.open(R):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),b&&b(J),()=>{q&&google.maps.event.removeListener(q),K&&google.maps.event.removeListener(K),V&&google.maps.event.removeListener(V),I&&google.maps.event.removeListener(I),ie&&google.maps.event.removeListener(ie),P&&P(J),J.close()}},[]),re.current?wn.createPortal(u.Children.only(e),re.current):null}u.memo(Jl);class eu extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",null),z(this,"state",{infoWindow:null}),z(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),z(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=Oe({updaterMap:Wo,eventMap:qo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Wo,eventMap:qo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(je(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?wn.createPortal(u.Children.only(this.props.children),this.containerElement):null}}z(eu,"contextType",xe);function Zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Vo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},$o={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},tu={};function nu(t){var{options:e,draggable:r,editable:o,visible:l,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:E,onMouseMove:L,onMouseOut:b,onMouseOver:P,onMouseUp:R,onRightClick:k,onClick:W,onDrag:q,onLoad:G,onUnmount:V}=t,se=u.useContext(xe),[K,B]=u.useState(null),[I,F]=u.useState(null),[ie,N]=u.useState(null),[re,J]=u.useState(null),[ae,de]=u.useState(null),[fe,le]=u.useState(null),[me,Se]=u.useState(null),[he,ve]=u.useState(null),[ye,Me]=u.useState(null),[De,pe]=u.useState(null),[Be,T]=u.useState(null),[Pe,Ae]=u.useState(null);return u.useEffect(()=>{K!==null&&K.setMap(se)},[se]),u.useEffect(()=>{typeof e<"u"&&K!==null&&K.setOptions(e)},[K,e]),u.useEffect(()=>{typeof r<"u"&&K!==null&&K.setDraggable(r)},[K,r]),u.useEffect(()=>{typeof o<"u"&&K!==null&&K.setEditable(o)},[K,o]),u.useEffect(()=>{typeof l<"u"&&K!==null&&K.setVisible(l)},[K,l]),u.useEffect(()=>{typeof f<"u"&&K!==null&&K.setPath(f)},[K,f]),u.useEffect(()=>{K&&p&&(I!==null&&google.maps.event.removeListener(I),F(google.maps.event.addListener(K,"dblclick",p)))},[p]),u.useEffect(()=>{K&&h&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(K,"dragend",h)))},[h]),u.useEffect(()=>{K&&m&&(re!==null&&google.maps.event.removeListener(re),J(google.maps.event.addListener(K,"dragstart",m)))},[m]),u.useEffect(()=>{K&&E&&(ae!==null&&google.maps.event.removeListener(ae),de(google.maps.event.addListener(K,"mousedown",E)))},[E]),u.useEffect(()=>{K&&L&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(K,"mousemove",L)))},[L]),u.useEffect(()=>{K&&b&&(me!==null&&google.maps.event.removeListener(me),Se(google.maps.event.addListener(K,"mouseout",b)))},[b]),u.useEffect(()=>{K&&P&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(K,"mouseover",P)))},[P]),u.useEffect(()=>{K&&R&&(ye!==null&&google.maps.event.removeListener(ye),Me(google.maps.event.addListener(K,"mouseup",R)))},[R]),u.useEffect(()=>{K&&k&&(De!==null&&google.maps.event.removeListener(De),pe(google.maps.event.addListener(K,"rightclick",k)))},[k]),u.useEffect(()=>{K&&W&&(Be!==null&&google.maps.event.removeListener(Be),T(google.maps.event.addListener(K,"click",W)))},[W]),u.useEffect(()=>{K&&q&&(Pe!==null&&google.maps.event.removeListener(Pe),Ae(google.maps.event.addListener(K,"drag",q)))},[q]),u.useEffect(()=>{var Ce=new google.maps.Polyline(Sr(Sr({},e||tu),{},{map:se}));return f&&Ce.setPath(f),typeof l<"u"&&Ce.setVisible(l),typeof o<"u"&&Ce.setEditable(o),typeof r<"u"&&Ce.setDraggable(r),p&&F(google.maps.event.addListener(Ce,"dblclick",p)),h&&N(google.maps.event.addListener(Ce,"dragend",h)),m&&J(google.maps.event.addListener(Ce,"dragstart",m)),E&&de(google.maps.event.addListener(Ce,"mousedown",E)),L&&le(google.maps.event.addListener(Ce,"mousemove",L)),b&&Se(google.maps.event.addListener(Ce,"mouseout",b)),P&&ve(google.maps.event.addListener(Ce,"mouseover",P)),R&&Me(google.maps.event.addListener(Ce,"mouseup",R)),k&&pe(google.maps.event.addListener(Ce,"rightclick",k)),W&&T(google.maps.event.addListener(Ce,"click",W)),q&&Ae(google.maps.event.addListener(Ce,"drag",q)),B(Ce),G&&G(Ce),()=>{I!==null&&google.maps.event.removeListener(I),ie!==null&&google.maps.event.removeListener(ie),re!==null&&google.maps.event.removeListener(re),ae!==null&&google.maps.event.removeListener(ae),fe!==null&&google.maps.event.removeListener(fe),me!==null&&google.maps.event.removeListener(me),he!==null&&google.maps.event.removeListener(he),ye!==null&&google.maps.event.removeListener(ye),De!==null&&google.maps.event.removeListener(De),Be!==null&&google.maps.event.removeListener(Be),V&&V(Ce),Ce.setMap(null)}},[]),null}u.memo(nu);class ru extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{polyline:null}),z(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Sr(Sr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:$o,eventMap:Vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:$o,eventMap:Vo,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),je(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}z(ru,"contextType",xe);function Ho(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Go(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ho(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ho(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Yo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Xo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function iu(t){var{options:e,draggable:r,editable:o,visible:l,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:E,onMouseDown:L,onMouseMove:b,onMouseOut:P,onMouseOver:R,onMouseUp:k,onRightClick:W,onClick:q,onDrag:G,onLoad:V,onUnmount:se,onEdit:K}=t,B=u.useContext(xe),[I,F]=u.useState(null),[ie,N]=u.useState(null),[re,J]=u.useState(null),[ae,de]=u.useState(null),[fe,le]=u.useState(null),[me,Se]=u.useState(null),[he,ve]=u.useState(null),[ye,Me]=u.useState(null),[De,pe]=u.useState(null),[Be,T]=u.useState(null),[Pe,Ae]=u.useState(null),[Ce,ne]=u.useState(null);return u.useEffect(()=>{I!==null&&I.setMap(B)},[B]),u.useEffect(()=>{typeof e<"u"&&I!==null&&I.setOptions(e)},[I,e]),u.useEffect(()=>{typeof r<"u"&&I!==null&&I.setDraggable(r)},[I,r]),u.useEffect(()=>{typeof o<"u"&&I!==null&&I.setEditable(o)},[I,o]),u.useEffect(()=>{typeof l<"u"&&I!==null&&I.setVisible(l)},[I,l]),u.useEffect(()=>{typeof f<"u"&&I!==null&&I.setPath(f)},[I,f]),u.useEffect(()=>{typeof p<"u"&&I!==null&&I.setPaths(p)},[I,p]),u.useEffect(()=>{I&&typeof h=="function"&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(I,"dblclick",h)))},[h]),u.useEffect(()=>{I&&(google.maps.event.addListener(I.getPath(),"insert_at",()=>{K?.(I)}),google.maps.event.addListener(I.getPath(),"set_at",()=>{K?.(I)}),google.maps.event.addListener(I.getPath(),"remove_at",()=>{K?.(I)}))},[I,K]),u.useEffect(()=>{I&&typeof m=="function"&&(re!==null&&google.maps.event.removeListener(re),J(google.maps.event.addListener(I,"dragend",m)))},[m]),u.useEffect(()=>{I&&typeof E=="function"&&(ae!==null&&google.maps.event.removeListener(ae),de(google.maps.event.addListener(I,"dragstart",E)))},[E]),u.useEffect(()=>{I&&typeof L=="function"&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(I,"mousedown",L)))},[L]),u.useEffect(()=>{I&&typeof b=="function"&&(me!==null&&google.maps.event.removeListener(me),Se(google.maps.event.addListener(I,"mousemove",b)))},[b]),u.useEffect(()=>{I&&typeof P=="function"&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(I,"mouseout",P)))},[P]),u.useEffect(()=>{I&&typeof R=="function"&&(ye!==null&&google.maps.event.removeListener(ye),Me(google.maps.event.addListener(I,"mouseover",R)))},[R]),u.useEffect(()=>{I&&typeof k=="function"&&(De!==null&&google.maps.event.removeListener(De),pe(google.maps.event.addListener(I,"mouseup",k)))},[k]),u.useEffect(()=>{I&&typeof W=="function"&&(Be!==null&&google.maps.event.removeListener(Be),T(google.maps.event.addListener(I,"rightclick",W)))},[W]),u.useEffect(()=>{I&&typeof q=="function"&&(Pe!==null&&google.maps.event.removeListener(Pe),Ae(google.maps.event.addListener(I,"click",q)))},[q]),u.useEffect(()=>{I&&typeof G=="function"&&(Ce!==null&&google.maps.event.removeListener(Ce),ne(google.maps.event.addListener(I,"drag",G)))},[G]),u.useEffect(()=>{var ge=new google.maps.Polygon(Go(Go({},e),{},{map:B}));return f&&ge.setPath(f),p&&ge.setPaths(p),typeof l<"u"&&ge.setVisible(l),typeof o<"u"&&ge.setEditable(o),typeof r<"u"&&ge.setDraggable(r),h&&N(google.maps.event.addListener(ge,"dblclick",h)),m&&J(google.maps.event.addListener(ge,"dragend",m)),E&&de(google.maps.event.addListener(ge,"dragstart",E)),L&&le(google.maps.event.addListener(ge,"mousedown",L)),b&&Se(google.maps.event.addListener(ge,"mousemove",b)),P&&ve(google.maps.event.addListener(ge,"mouseout",P)),R&&Me(google.maps.event.addListener(ge,"mouseover",R)),k&&pe(google.maps.event.addListener(ge,"mouseup",k)),W&&T(google.maps.event.addListener(ge,"rightclick",W)),q&&Ae(google.maps.event.addListener(ge,"click",q)),G&&ne(google.maps.event.addListener(ge,"drag",G)),F(ge),V&&V(ge),()=>{ie!==null&&google.maps.event.removeListener(ie),re!==null&&google.maps.event.removeListener(re),ae!==null&&google.maps.event.removeListener(ae),fe!==null&&google.maps.event.removeListener(fe),me!==null&&google.maps.event.removeListener(me),he!==null&&google.maps.event.removeListener(he),ye!==null&&google.maps.event.removeListener(ye),De!==null&&google.maps.event.removeListener(De),Be!==null&&google.maps.event.removeListener(Be),Pe!==null&&google.maps.event.removeListener(Pe),se&&se(ge),ge.setMap(null)}},[]),null}u.memo(iu);class ou extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=Oe({updaterMap:Xo,eventMap:Yo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Xo,eventMap:Yo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),je(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}z(ou,"contextType",xe);function Qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Jo={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},es={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function su(t){var{options:e,bounds:r,draggable:o,editable:l,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:E,onMouseMove:L,onMouseOut:b,onMouseOver:P,onMouseUp:R,onRightClick:k,onClick:W,onDrag:q,onBoundsChanged:G,onLoad:V,onUnmount:se}=t,K=u.useContext(xe),[B,I]=u.useState(null),[F,ie]=u.useState(null),[N,re]=u.useState(null),[J,ae]=u.useState(null),[de,fe]=u.useState(null),[le,me]=u.useState(null),[Se,he]=u.useState(null),[ve,ye]=u.useState(null),[Me,De]=u.useState(null),[pe,Be]=u.useState(null),[T,Pe]=u.useState(null),[Ae,Ce]=u.useState(null),[ne,ge]=u.useState(null);return u.useEffect(()=>{B!==null&&B.setMap(K)},[K]),u.useEffect(()=>{typeof e<"u"&&B!==null&&B.setOptions(e)},[B,e]),u.useEffect(()=>{typeof o<"u"&&B!==null&&B.setDraggable(o)},[B,o]),u.useEffect(()=>{typeof l<"u"&&B!==null&&B.setEditable(l)},[B,l]),u.useEffect(()=>{typeof f<"u"&&B!==null&&B.setVisible(f)},[B,f]),u.useEffect(()=>{typeof r<"u"&&B!==null&&B.setBounds(r)},[B,r]),u.useEffect(()=>{B&&p&&(F!==null&&google.maps.event.removeListener(F),ie(google.maps.event.addListener(B,"dblclick",p)))},[p]),u.useEffect(()=>{B&&h&&(N!==null&&google.maps.event.removeListener(N),re(google.maps.event.addListener(B,"dragend",h)))},[h]),u.useEffect(()=>{B&&m&&(J!==null&&google.maps.event.removeListener(J),ae(google.maps.event.addListener(B,"dragstart",m)))},[m]),u.useEffect(()=>{B&&E&&(de!==null&&google.maps.event.removeListener(de),fe(google.maps.event.addListener(B,"mousedown",E)))},[E]),u.useEffect(()=>{B&&L&&(le!==null&&google.maps.event.removeListener(le),me(google.maps.event.addListener(B,"mousemove",L)))},[L]),u.useEffect(()=>{B&&b&&(Se!==null&&google.maps.event.removeListener(Se),he(google.maps.event.addListener(B,"mouseout",b)))},[b]),u.useEffect(()=>{B&&P&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(B,"mouseover",P)))},[P]),u.useEffect(()=>{B&&R&&(Me!==null&&google.maps.event.removeListener(Me),De(google.maps.event.addListener(B,"mouseup",R)))},[R]),u.useEffect(()=>{B&&k&&(pe!==null&&google.maps.event.removeListener(pe),Be(google.maps.event.addListener(B,"rightclick",k)))},[k]),u.useEffect(()=>{B&&W&&(T!==null&&google.maps.event.removeListener(T),Pe(google.maps.event.addListener(B,"click",W)))},[W]),u.useEffect(()=>{B&&q&&(Ae!==null&&google.maps.event.removeListener(Ae),Ce(google.maps.event.addListener(B,"drag",q)))},[q]),u.useEffect(()=>{B&&G&&(ne!==null&&google.maps.event.removeListener(ne),ge(google.maps.event.addListener(B,"bounds_changed",G)))},[G]),u.useEffect(()=>{var Ie=new google.maps.Rectangle(Mr(Mr({},e),{},{map:K}));return typeof f<"u"&&Ie.setVisible(f),typeof l<"u"&&Ie.setEditable(l),typeof o<"u"&&Ie.setDraggable(o),typeof r<"u"&&Ie.setBounds(r),p&&ie(google.maps.event.addListener(Ie,"dblclick",p)),h&&re(google.maps.event.addListener(Ie,"dragend",h)),m&&ae(google.maps.event.addListener(Ie,"dragstart",m)),E&&fe(google.maps.event.addListener(Ie,"mousedown",E)),L&&me(google.maps.event.addListener(Ie,"mousemove",L)),b&&he(google.maps.event.addListener(Ie,"mouseout",b)),P&&ye(google.maps.event.addListener(Ie,"mouseover",P)),R&&De(google.maps.event.addListener(Ie,"mouseup",R)),k&&Be(google.maps.event.addListener(Ie,"rightclick",k)),W&&Pe(google.maps.event.addListener(Ie,"click",W)),q&&Ce(google.maps.event.addListener(Ie,"drag",q)),G&&ge(google.maps.event.addListener(Ie,"bounds_changed",G)),I(Ie),V&&V(Ie),()=>{F!==null&&google.maps.event.removeListener(F),N!==null&&google.maps.event.removeListener(N),J!==null&&google.maps.event.removeListener(J),de!==null&&google.maps.event.removeListener(de),le!==null&&google.maps.event.removeListener(le),Se!==null&&google.maps.event.removeListener(Se),ve!==null&&google.maps.event.removeListener(ve),Me!==null&&google.maps.event.removeListener(Me),pe!==null&&google.maps.event.removeListener(pe),T!==null&&google.maps.event.removeListener(T),Ae!==null&&google.maps.event.removeListener(Ae),ne!==null&&google.maps.event.removeListener(ne),se&&se(Ie),Ie.setMap(null)}},[]),null}u.memo(su);class au extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{rectangle:null}),z(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Mr(Mr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:es,eventMap:Jo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:es,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),je(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}z(au,"contextType",xe);function ts(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ts(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ts(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ns={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},rs={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},lu={};function uu(t){var{options:e,center:r,radius:o,draggable:l,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:E,onMouseDown:L,onMouseMove:b,onMouseOut:P,onMouseOver:R,onMouseUp:k,onRightClick:W,onClick:q,onDrag:G,onCenterChanged:V,onRadiusChanged:se,onLoad:K,onUnmount:B}=t,I=u.useContext(xe),[F,ie]=u.useState(null),[N,re]=u.useState(null),[J,ae]=u.useState(null),[de,fe]=u.useState(null),[le,me]=u.useState(null),[Se,he]=u.useState(null),[ve,ye]=u.useState(null),[Me,De]=u.useState(null),[pe,Be]=u.useState(null),[T,Pe]=u.useState(null),[Ae,Ce]=u.useState(null),[ne,ge]=u.useState(null),[Ie,Ee]=u.useState(null),[Ye,Nt]=u.useState(null);return u.useEffect(()=>{F!==null&&F.setMap(I)},[I]),u.useEffect(()=>{typeof e<"u"&&F!==null&&F.setOptions(e)},[F,e]),u.useEffect(()=>{typeof l<"u"&&F!==null&&F.setDraggable(l)},[F,l]),u.useEffect(()=>{typeof f<"u"&&F!==null&&F.setEditable(f)},[F,f]),u.useEffect(()=>{typeof p<"u"&&F!==null&&F.setVisible(p)},[F,p]),u.useEffect(()=>{typeof o=="number"&&F!==null&&F.setRadius(o)},[F,o]),u.useEffect(()=>{typeof r<"u"&&F!==null&&F.setCenter(r)},[F,r]),u.useEffect(()=>{F&&h&&(N!==null&&google.maps.event.removeListener(N),re(google.maps.event.addListener(F,"dblclick",h)))},[h]),u.useEffect(()=>{F&&m&&(J!==null&&google.maps.event.removeListener(J),ae(google.maps.event.addListener(F,"dragend",m)))},[m]),u.useEffect(()=>{F&&E&&(de!==null&&google.maps.event.removeListener(de),fe(google.maps.event.addListener(F,"dragstart",E)))},[E]),u.useEffect(()=>{F&&L&&(le!==null&&google.maps.event.removeListener(le),me(google.maps.event.addListener(F,"mousedown",L)))},[L]),u.useEffect(()=>{F&&b&&(Se!==null&&google.maps.event.removeListener(Se),he(google.maps.event.addListener(F,"mousemove",b)))},[b]),u.useEffect(()=>{F&&P&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(F,"mouseout",P)))},[P]),u.useEffect(()=>{F&&R&&(Me!==null&&google.maps.event.removeListener(Me),De(google.maps.event.addListener(F,"mouseover",R)))},[R]),u.useEffect(()=>{F&&k&&(pe!==null&&google.maps.event.removeListener(pe),Be(google.maps.event.addListener(F,"mouseup",k)))},[k]),u.useEffect(()=>{F&&W&&(T!==null&&google.maps.event.removeListener(T),Pe(google.maps.event.addListener(F,"rightclick",W)))},[W]),u.useEffect(()=>{F&&q&&(Ae!==null&&google.maps.event.removeListener(Ae),Ce(google.maps.event.addListener(F,"click",q)))},[q]),u.useEffect(()=>{F&&G&&(ne!==null&&google.maps.event.removeListener(ne),ge(google.maps.event.addListener(F,"drag",G)))},[G]),u.useEffect(()=>{F&&V&&(Ie!==null&&google.maps.event.removeListener(Ie),Ee(google.maps.event.addListener(F,"center_changed",V)))},[q]),u.useEffect(()=>{F&&se&&(Ye!==null&&google.maps.event.removeListener(Ye),Nt(google.maps.event.addListener(F,"radius_changed",se)))},[se]),u.useEffect(()=>{var Re=new google.maps.Circle(Pr(Pr({},e||lu),{},{map:I}));return typeof o=="number"&&Re.setRadius(o),typeof r<"u"&&Re.setCenter(r),typeof o=="number"&&Re.setRadius(o),typeof p<"u"&&Re.setVisible(p),typeof f<"u"&&Re.setEditable(f),typeof l<"u"&&Re.setDraggable(l),h&&re(google.maps.event.addListener(Re,"dblclick",h)),m&&ae(google.maps.event.addListener(Re,"dragend",m)),E&&fe(google.maps.event.addListener(Re,"dragstart",E)),L&&me(google.maps.event.addListener(Re,"mousedown",L)),b&&he(google.maps.event.addListener(Re,"mousemove",b)),P&&ye(google.maps.event.addListener(Re,"mouseout",P)),R&&De(google.maps.event.addListener(Re,"mouseover",R)),k&&Be(google.maps.event.addListener(Re,"mouseup",k)),W&&Pe(google.maps.event.addListener(Re,"rightclick",W)),q&&Ce(google.maps.event.addListener(Re,"click",q)),G&&ge(google.maps.event.addListener(Re,"drag",G)),V&&Ee(google.maps.event.addListener(Re,"center_changed",V)),se&&Nt(google.maps.event.addListener(Re,"radius_changed",se)),ie(Re),K&&K(Re),()=>{N!==null&&google.maps.event.removeListener(N),J!==null&&google.maps.event.removeListener(J),de!==null&&google.maps.event.removeListener(de),le!==null&&google.maps.event.removeListener(le),Se!==null&&google.maps.event.removeListener(Se),ve!==null&&google.maps.event.removeListener(ve),Me!==null&&google.maps.event.removeListener(Me),pe!==null&&google.maps.event.removeListener(pe),T!==null&&google.maps.event.removeListener(T),Ae!==null&&google.maps.event.removeListener(Ae),Ie!==null&&google.maps.event.removeListener(Ie),Ye!==null&&google.maps.event.removeListener(Ye),B&&B(Re),Re.setMap(null)}},[]),null}u.memo(uu);class cu extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{circle:null}),z(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:rs,eventMap:ns,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:rs,eventMap:ns,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),je(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}z(cu,"contextType",xe);function is(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?is(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var os={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ss={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,o){t.loadGeoJson(e,r,o)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function fu(t){var{options:e,onClick:r,onDblClick:o,onMouseDown:l,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:E,onAddFeature:L,onRemoveFeature:b,onRemoveProperty:P,onSetGeometry:R,onSetProperty:k,onLoad:W,onUnmount:q}=t,G=u.useContext(xe),[V,se]=u.useState(null),[K,B]=u.useState(null),[I,F]=u.useState(null),[ie,N]=u.useState(null),[re,J]=u.useState(null),[ae,de]=u.useState(null),[fe,le]=u.useState(null),[me,Se]=u.useState(null),[he,ve]=u.useState(null),[ye,Me]=u.useState(null),[De,pe]=u.useState(null),[Be,T]=u.useState(null),[Pe,Ae]=u.useState(null),[Ce,ne]=u.useState(null);return u.useEffect(()=>{V!==null&&V.setMap(G)},[G]),u.useEffect(()=>{V&&o&&(K!==null&&google.maps.event.removeListener(K),B(google.maps.event.addListener(V,"dblclick",o)))},[o]),u.useEffect(()=>{V&&l&&(I!==null&&google.maps.event.removeListener(I),F(google.maps.event.addListener(V,"mousedown",l)))},[l]),u.useEffect(()=>{V&&f&&(ie!==null&&google.maps.event.removeListener(ie),N(google.maps.event.addListener(V,"mousemove",f)))},[f]),u.useEffect(()=>{V&&p&&(re!==null&&google.maps.event.removeListener(re),J(google.maps.event.addListener(V,"mouseout",p)))},[p]),u.useEffect(()=>{V&&h&&(ae!==null&&google.maps.event.removeListener(ae),de(google.maps.event.addListener(V,"mouseover",h)))},[h]),u.useEffect(()=>{V&&m&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(V,"mouseup",m)))},[m]),u.useEffect(()=>{V&&E&&(me!==null&&google.maps.event.removeListener(me),Se(google.maps.event.addListener(V,"rightclick",E)))},[E]),u.useEffect(()=>{V&&r&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(V,"click",r)))},[r]),u.useEffect(()=>{V&&L&&(ye!==null&&google.maps.event.removeListener(ye),Me(google.maps.event.addListener(V,"addfeature",L)))},[L]),u.useEffect(()=>{V&&b&&(De!==null&&google.maps.event.removeListener(De),pe(google.maps.event.addListener(V,"removefeature",b)))},[b]),u.useEffect(()=>{V&&P&&(Be!==null&&google.maps.event.removeListener(Be),T(google.maps.event.addListener(V,"removeproperty",P)))},[P]),u.useEffect(()=>{V&&R&&(Pe!==null&&google.maps.event.removeListener(Pe),Ae(google.maps.event.addListener(V,"setgeometry",R)))},[R]),u.useEffect(()=>{V&&k&&(Ce!==null&&google.maps.event.removeListener(Ce),ne(google.maps.event.addListener(V,"setproperty",k)))},[k]),u.useEffect(()=>{if(G!==null){var ge=new google.maps.Data(_r(_r({},e),{},{map:G}));o&&B(google.maps.event.addListener(ge,"dblclick",o)),l&&F(google.maps.event.addListener(ge,"mousedown",l)),f&&N(google.maps.event.addListener(ge,"mousemove",f)),p&&J(google.maps.event.addListener(ge,"mouseout",p)),h&&de(google.maps.event.addListener(ge,"mouseover",h)),m&&le(google.maps.event.addListener(ge,"mouseup",m)),E&&Se(google.maps.event.addListener(ge,"rightclick",E)),r&&ve(google.maps.event.addListener(ge,"click",r)),L&&Me(google.maps.event.addListener(ge,"addfeature",L)),b&&pe(google.maps.event.addListener(ge,"removefeature",b)),P&&T(google.maps.event.addListener(ge,"removeproperty",P)),R&&Ae(google.maps.event.addListener(ge,"setgeometry",R)),k&&ne(google.maps.event.addListener(ge,"setproperty",k)),se(ge),W&&W(ge)}return()=>{V&&(K!==null&&google.maps.event.removeListener(K),I!==null&&google.maps.event.removeListener(I),ie!==null&&google.maps.event.removeListener(ie),re!==null&&google.maps.event.removeListener(re),ae!==null&&google.maps.event.removeListener(ae),fe!==null&&google.maps.event.removeListener(fe),me!==null&&google.maps.event.removeListener(me),he!==null&&google.maps.event.removeListener(he),ye!==null&&google.maps.event.removeListener(ye),De!==null&&google.maps.event.removeListener(De),Be!==null&&google.maps.event.removeListener(Be),Pe!==null&&google.maps.event.removeListener(Pe),Ce!==null&&google.maps.event.removeListener(Ce),q&&q(V),V.setMap(null))}},[]),null}u.memo(fu);class du extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{data:null}),z(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ss,eventMap:os,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ss,eventMap:os,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),je(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}z(du,"contextType",xe);function as(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function ls(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?as(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):as(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var us={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},cs={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class pu extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{kmlLayer:null}),z(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(ls(ls({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:cs,eventMap:us,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:cs,eventMap:us,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),je(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}z(pu,"contextType",xe);function Js(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function hu(t,e){return new e(t.lat,t.lng)}function gu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function mu(t,e,r){return t instanceof e?t:r(t,e)}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r.getNorthEast()),l=t&&t.fromLatLngToDivPixel(r.getSouthWest());return o&&l?{left:"".concat(l.x+e.x,"px"),top:"".concat(o.y+e.y,"px"),width:"".concat(o.x-l.x-e.x,"px"),height:"".concat(l.y-o.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function bu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r);if(o){var{x:l,y:f}=o;return{left:"".concat(l+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function ea(t,e,r,o){return r!==void 0?yu(t,e,vu(r,google.maps.LatLngBounds,gu)):bu(t,e,mu(o,google.maps.LatLng,hu))}function wu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function fs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Lu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fs(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function Cu(t,e,r,o,l){class f extends google.maps.OverlayView{constructor(h,m,E,L){super(),this.container=h,this.pane=m,this.position=E,this.bounds=L}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=Lu({},this.container?Js(this.container,l):{x:0,y:0}),E=ea(h,m,this.bounds,this.position);for(var[L,b]of Object.entries(E))this.container.style[L]=b}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,o)}function ds(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ds(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ds(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function ps(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function hs(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Eu(t){var{position:e,bounds:r,mapPaneName:o,zIndex:l,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,E=u.useContext(xe),L=u.useMemo(()=>{var P=document.createElement("div");return P.style.position="absolute",P},[]),b=u.useMemo(()=>Cu(L,o,e,r,h),[L,o,e,r]);return u.useEffect(()=>(f?.(b),b?.setMap(E),()=>{p?.(b),b?.setMap(null)}),[E,b]),u.useEffect(()=>{L.style.zIndex="".concat(l)},[l,L]),wn.createPortal(m,L)}u.memo(Eu);class Kt extends u.PureComponent{constructor(e){super(e),z(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),z(this,"updatePane",()=>{var o=this.props.mapPaneName,l=this.overlayView.getPanes();We(!!o,"OverlayView requires props.mapPaneName but got %s",o),l?this.setState({paneEl:l[o]}):this.setState({paneEl:null})}),z(this,"onAdd",()=>{var o,l;this.updatePane(),(o=(l=this.props).onLoad)===null||o===void 0||o.call(l,this.overlayView)}),z(this,"onPositionElement",()=>{var o=this.overlayView.getProjection(),l=xu({x:0,y:0},this.containerRef.current?Js(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=ea(o,l,this.props.bounds,this.props.position);if(!wu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,E;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(E=f.height)!==null&&E!==void 0?E:0,position:"absolute"}})}}),z(this,"draw",()=>{this.onPositionElement()}),z(this,"onRemove",()=>{var o,l;this.setState(()=>({paneEl:null})),(o=(l=this.props).onUnmount)===null||o===void 0||o.call(l,this.overlayView)}),this.containerRef=u.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=ps(e.position),o=ps(this.props.position),l=hs(e.bounds),f=hs(this.props.bounds);(r!==o||l!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?wn.createPortal(ce.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:u.Children.only(this.props.children)}),e):null}}z(Kt,"FLOAT_PANE","floatPane");z(Kt,"MAP_PANE","mapPane");z(Kt,"MARKER_LAYER","markerLayer");z(Kt,"OVERLAY_LAYER","overlayLayer");z(Kt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");z(Kt,"contextType",xe);function ku(){}function gs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function ms(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gs(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var vs={onDblClick:"dblclick",onClick:"click"},ys={opacity(t,e){t.setOpacity(e)}};function Su(t){var{url:e,bounds:r,options:o,visible:l}=t,f=u.useContext(xe),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=u.useMemo(()=>new google.maps.GroundOverlay(e,p,o),[]);return u.useEffect(()=>{h!==null&&h.setMap(f)},[f]),u.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),u.useEffect(()=>{typeof l<"u"&&h!==null&&h.setOpacity(l?1:0)},[h,l]),u.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}u.memo(Su);class ta extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{groundOverlay:null}),z(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){We(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ms(ms({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ys,eventMap:vs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ys,eventMap:vs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}z(ta,"defaultProps",{onLoad:ku});z(ta,"contextType",xe);function bs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bs(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ws={},Ls={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Mu(t){var{data:e,onLoad:r,onUnmount:o,options:l}=t,f=u.useContext(xe),[p,h]=u.useState(null);return u.useEffect(()=>{google.maps.visualization||We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),u.useEffect(()=>{We(!!e,"data property is required in HeatmapLayer %s",e)},[e]),u.useEffect(()=>{p!==null&&p.setMap(f)},[f]),u.useEffect(()=>{l&&p!==null&&p.setOptions(l)},[p,l]),u.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Or(Or({},l),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(o&&o(p),p.setMap(null))}},[]),null}u.memo(Mu);class Pu extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{heatmapLayer:null}),z(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),We(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Or(Or({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=Oe({updaterMap:Ls,eventMap:ws,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ls,eventMap:ws,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),je(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}z(Pu,"contextType",xe);var Cs={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},xs={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{streetViewPanorama:null}),z(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,o=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=Oe({updaterMap:xs,eventMap:Cs,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({streetViewPanorama:o}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:xs,eventMap:Cs,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),je(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}z(_u,"contextType",xe);class Ou extends u.PureComponent{constructor(){super(...arguments),z(this,"state",{streetViewService:null}),z(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}z(Ou,"contextType",xe);var Es={onDirectionsChanged:"directions_changed"},ks={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Du extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{directionsRenderer:null}),z(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=Oe({updaterMap:ks,eventMap:Es,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ks,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),je(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}z(Du,"contextType",xe);var Ss={onPlacesChanged:"places_changed"},Ms={bounds(t,e){t.setBounds(e)}};class Iu extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",u.createRef()),z(this,"state",{searchBox:null}),z(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=Oe({updaterMap:Ms,eventMap:Ss,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ms,eventMap:Ss,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),je(this.registeredEvents))}render(){return ce.jsx("div",{ref:this.containerElement,children:u.Children.only(this.props.children)})}}z(Iu,"contextType",xe);var Ps={onPlaceChanged:"place_changed"},_s={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class na extends u.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",u.createRef()),z(this,"state",{autocomplete:null}),z(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var o=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=Oe({updaterMap:_s,eventMap:Ps,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({autocomplete:o}),this.setAutocompleteCallback)}}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=Oe({updaterMap:_s,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&je(this.registeredEvents)}render(){return ce.jsx("div",{ref:this.containerElement,className:this.props.className,children:u.Children.only(this.props.children)})}}z(na,"defaultProps",{className:""});z(na,"contextType",xe);const ju="/chill-demo/assets/cloud-CFb1wSHM.png",At=5e-4,wr=new Image;wr.src=ju;const Ru=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const o=e.createImageData(r,r),l=o.data;for(let f=0;f<l.length;f+=4){const p=Math.random()*100;l[f]=p,l[f+1]=p,l[f+2]=p,l[f+3]=5}return e.putImageData(o,0,0),e.createPattern(t,"repeat")},Tu=({map:t,zoom:e,claimedCells:r,exploredCells:o,hoveredCell:l})=>{const f=u.useRef(null),p=u.useRef(null),[h,m]=u.useState([]),[E,L]=u.useState([]),b=u.useRef(r),P=u.useRef(o),R=u.useRef(null);return u.useEffect(()=>{b.current=r},[r]),u.useEffect(()=>{P.current=o},[o]),u.useEffect(()=>{R.current=Ru();const k=new Worker(new URL("/chill-demo/assets/grid.worker-6f75YCnB.js",import.meta.url),{type:"module"});return p.current=k,k.onmessage=W=>{const{claimedCellsToDraw:q,exploredCellsToDraw:G}=W.data;m(q),L(G)},()=>{k.terminate()}},[]),u.useEffect(()=>{if(!t)return;class k extends window.google.maps.OverlayView{constructor(){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.cloudsCanvas=document.createElement("canvas"),this.cloudsCtx=this.cloudsCanvas.getContext("2d"),this.cloudsCanvas.style.position="absolute",this.cloudsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none",wr.onload=()=>this.drawClouds()}setProps(I){this.props={...this.props,...I}}setDrawableCells(I,F){this.drawableClaimed=I,this.drawableExplored=F}onAdd(){const I=this.getPanes();I.overlayLayer.appendChild(this.fogCanvas),I.overlayMouseTarget.appendChild(this.cloudsCanvas),I.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.cloudsCanvas,this.dynamicCanvas].forEach(I=>{I.parentElement&&I.parentElement.removeChild(I)})}draw(){const I=this.getProjection();if(!I)return;const F=.5,ie=this.getMap().getBounds(),N=ie.getSouthWest(),re=ie.getNorthEast(),J=I.fromLatLngToDivPixel(N),ae=I.fromLatLngToDivPixel(re);if(!J||!ae)return;const de=ae.x-J.x,fe=J.y-ae.y,le=Math.round(de*F),me=Math.round(fe*F),Se=de+2*le,he=fe+2*me;this.swPixel={x:J.x-le,y:J.y+me},this.nePixel={x:ae.x+le,y:ae.y-me},[this.fogCanvas,this.cloudsCanvas,this.dynamicCanvas].forEach(ve=>{ve.style.left=`${J.x-le}px`,ve.style.top=`${ae.y-me}px`,ve.width=Se,ve.height=he}),this.drawFog(),this.drawClouds(),this.drawDynamic()}drawFog(){const I=this.getProjection();!I||!this.swPixel||(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),R.current&&(this.fogCtx.fillStyle=R.current,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(F=>{const{south:ie,west:N}=F,re=new window.google.maps.LatLng(ie,N),J=new window.google.maps.LatLng(ie+At,N+At),ae=I.fromLatLngToDivPixel(re),de=I.fromLatLngToDivPixel(J);if(!ae||!de)return;const fe=ae.x-this.swPixel.x,le=de.y-this.nePixel.y,me=de.x-ae.x,Se=ae.y-de.y,he=fe+me/2,ve=le+Se/2,ye=me*1.5,Me=Se*1.5,De=this.fogCtx.createRadialGradient(he,ve,0,he,ve,Math.max(ye,Me));De.addColorStop(0,"rgba(0, 0, 0, 1)"),De.addColorStop(.7,"rgba(0, 0, 0, 1)"),De.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=De,this.fogCtx.beginPath(),this.fogCtx.ellipse(he,ve,ye,Me,0,0,2*Math.PI),this.fogCtx.fill()}),this.fogCtx.globalCompositeOperation="source-over")}drawClouds(){const I=this.getProjection();!I||!wr.complete||!this.swPixel||(this.cloudsCtx.clearRect(0,0,this.cloudsCanvas.width,this.cloudsCanvas.height),this.drawableClaimed.forEach(F=>{const{south:ie,west:N}=F,re=I.fromLatLngToDivPixel(new window.google.maps.LatLng(ie,N)),J=I.fromLatLngToDivPixel(new window.google.maps.LatLng(ie+At,N+At));!re||!J||this.cloudsCtx.drawImage(wr,re.x-this.swPixel.x,J.y-this.nePixel.y,J.x-re.x,re.y-J.y)}))}drawDynamic(){const I=this.getProjection();if(!I||!this.swPixel)return;const{hoveredCell:F}=this.props;if(this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height),!F)return;const[ie,N]=F.split("_").map(Number),re=ie*At,J=N*At,ae=new window.google.maps.LatLng(re,J),de=new window.google.maps.LatLng(re+At,J+At),fe=I.fromLatLngToDivPixel(ae),le=I.fromLatLngToDivPixel(de);if(!fe||!le)return;const me=fe.x-this.swPixel.x,Se=le.y-this.nePixel.y,he=le.x-fe.x,ve=fe.y-le.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(me,Se,he,ve)}}const W=new k;W.setMap(t),f.current=W;let q=null;const G=100,V=()=>{if(p.current){const B=t.getBounds();B&&p.current.postMessage({bounds:{southwest:{lat:B.getSouthWest().lat(),lng:B.getSouthWest().lng()},northeast:{lat:B.getNorthEast().lat(),lng:B.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:b.current,exploredCells:P.current})}},se=t.addListener("bounds_changed",()=>{q||(q=setTimeout(()=>{V(),q=null},G))}),K=t.addListener("idle",V);return()=>{f.current&&f.current.setMap(null),window.google.maps.event.removeListener(se),window.google.maps.event.removeListener(K),q&&clearTimeout(q)}},[t]),u.useEffect(()=>{f.current&&(f.current.setProps({zoom:e,hoveredCell:l}),f.current.drawDynamic())},[e,l]),u.useEffect(()=>{f.current&&(f.current.setDrawableCells(h,E),f.current.drawFog(),f.current.drawClouds())},[h,E]),u.useEffect(()=>{if(!t||!p.current)return;const k=t.getBounds();k&&p.current.postMessage({bounds:{southwest:{lat:k.getSouthWest().lat(),lng:k.getSouthWest().lng()},northeast:{lat:k.getNorthEast().lat(),lng:k.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:r,exploredCells:o})},[r,o,t]),null},Au="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Os=new Audio(Au),ra=()=>{Os.currentTime=0,Os.play().catch(t=>{console.error("Audio playback failed:",t)})},Ds=t=>{let e;const r=new Set,o=(E,L)=>{const b=typeof E=="function"?E(e):E;if(!Object.is(b,e)){const P=e;e=L??(typeof b!="object"||b===null)?b:Object.assign({},e,b),r.forEach(R=>R(e,P))}},l=()=>e,h={setState:o,getState:l,getInitialState:()=>m,subscribe:E=>(r.add(E),()=>r.delete(E))},m=e=t(o,l,h);return h},Bu=(t=>t?Ds(t):Ds),zu=t=>t;function Uu(t,e=zu){const r=Jt.useSyncExternalStore(t.subscribe,Jt.useCallback(()=>e(t.getState()),[t,e]),Jt.useCallback(()=>e(t.getInitialState()),[t,e]));return Jt.useDebugValue(r),r}const Is=t=>{const e=Bu(t),r=o=>Uu(e,o);return Object.assign(r,e),r},Fu=(t=>t?Is(t):Is);var ia=Symbol.for("immer-nothing"),js=Symbol.for("immer-draftable"),it=Symbol.for("immer-state");function lt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Kn=Object.getPrototypeOf;function bn(t){return!!t&&!!t[it]}function en(t){return t?oa(t)||Array.isArray(t)||!!t[js]||!!t.constructor?.[js]||Wn(t)||Ar(t):!1}var Ku=Object.prototype.constructor.toString(),Rs=new WeakMap;function oa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let o=Rs.get(r);return o===void 0&&(o=Function.toString.call(r),Rs.set(r,o)),o===Ku}function Dr(t,e,r=!0){Tr(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(l=>{e(l,t[l],t)}):t.forEach((o,l)=>e(l,o,t))}function Tr(t){const e=t[it];return e?e.type_:Array.isArray(t)?1:Wn(t)?2:Ar(t)?3:0}function Li(t,e){return Tr(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function sa(t,e,r){const o=Tr(t);o===2?t.set(e,r):o===3?t.add(r):t[e]=r}function Nu(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Wn(t){return t instanceof Map}function Ar(t){return t instanceof Set}function Xt(t){return t.copy_||t.base_}function Ci(t,e){if(Wn(t))return new Map(t);if(Ar(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=oa(t);if(e===!0||e==="class_only"&&!r){const o=Object.getOwnPropertyDescriptors(t);delete o[it];let l=Reflect.ownKeys(o);for(let f=0;f<l.length;f++){const p=l[f],h=o[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(o[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Kn(t),o)}else{const o=Kn(t);if(o!==null&&r)return{...t};const l=Object.create(o);return Object.assign(l,t)}}function ji(t,e=!1){return Br(t)||bn(t)||!en(t)||(Tr(t)>1&&Object.defineProperties(t,{set:yr,add:yr,clear:yr,delete:yr}),Object.freeze(t),e&&Object.values(t).forEach(r=>ji(r,!0))),t}function qu(){lt(2)}var yr={value:qu};function Br(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var Wu={};function tn(t){const e=Wu[t];return e||lt(0,t),e}var Nn;function aa(){return Nn}function Zu(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ts(t,e){e&&(tn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function xi(t){Ei(t),t.drafts_.forEach(Vu),t.drafts_=null}function Ei(t){t===Nn&&(Nn=t.parent_)}function As(t){return Nn=Zu(Nn,t)}function Vu(t){const e=t[it];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Bs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[it].modified_&&(xi(e),lt(4)),en(t)&&(t=Ir(e,t),e.parent_||jr(e,t)),e.patches_&&tn("Patches").generateReplacementPatches_(r[it].base_,t,e.patches_,e.inversePatches_)):t=Ir(e,r,[]),xi(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==ia?t:void 0}function Ir(t,e,r){if(Br(e))return e;const o=t.immer_.shouldUseStrictIteration(),l=e[it];if(!l)return Dr(e,(f,p)=>zs(t,l,e,f,p,r),o),e;if(l.scope_!==t)return e;if(!l.modified_)return jr(t,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const f=l.copy_;let p=f,h=!1;l.type_===3&&(p=new Set(f),f.clear(),h=!0),Dr(p,(m,E)=>zs(t,l,f,m,E,r,h),o),jr(t,f,!1),r&&t.patches_&&tn("Patches").generatePatches_(l,r,t.patches_,t.inversePatches_)}return l.copy_}function zs(t,e,r,o,l,f,p){if(l==null||typeof l!="object"&&!p)return;const h=Br(l);if(!(h&&!p)){if(bn(l)){const m=f&&e&&e.type_!==3&&!Li(e.assigned_,o)?f.concat(o):void 0,E=Ir(t,l,m);if(sa(r,o,E),bn(E))t.canAutoFreeze_=!1;else return}else p&&r.add(l);if(en(l)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[o]===l&&h)return;Ir(t,l),(!e||!e.scope_.parent_)&&typeof o!="symbol"&&(Wn(r)?r.has(o):Object.prototype.propertyIsEnumerable.call(r,o))&&jr(t,l)}}}function jr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ji(e,r)}function $u(t,e){const r=Array.isArray(t),o={type_:r?1:0,scope_:e?e.scope_:aa(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=o,f=Ri;r&&(l=[o],f=qn);const{revoke:p,proxy:h}=Proxy.revocable(l,f);return o.draft_=h,o.revoke_=p,h}var Ri={get(t,e){if(e===it)return t;const r=Xt(t);if(!Li(r,e))return Hu(t,r,e);const o=r[e];return t.finalized_||!en(o)?o:o===mi(t.base_,e)?(vi(t),t.copy_[e]=Si(o,t)):o},has(t,e){return e in Xt(t)},ownKeys(t){return Reflect.ownKeys(Xt(t))},set(t,e,r){const o=la(Xt(t),e);if(o?.set)return o.set.call(t.draft_,r),!0;if(!t.modified_){const l=mi(Xt(t),e),f=l?.[it];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Nu(r,l)&&(r!==void 0||Li(t.base_,e)))return!0;vi(t),ki(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return mi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,vi(t),ki(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xt(t),o=Reflect.getOwnPropertyDescriptor(r,e);return o&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:o.enumerable,value:r[e]}},defineProperty(){lt(11)},getPrototypeOf(t){return Kn(t.base_)},setPrototypeOf(){lt(12)}},qn={};Dr(Ri,(t,e)=>{qn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});qn.deleteProperty=function(t,e){return qn.set.call(this,t,e,void 0)};qn.set=function(t,e,r){return Ri.set.call(this,t[0],e,r,t[0])};function mi(t,e){const r=t[it];return(r?Xt(r):t)[e]}function Hu(t,e,r){const o=la(e,r);return o?"value"in o?o.value:o.get?.call(t.draft_):void 0}function la(t,e){if(!(e in t))return;let r=Kn(t);for(;r;){const o=Object.getOwnPropertyDescriptor(r,e);if(o)return o;r=Kn(r)}}function ki(t){t.modified_||(t.modified_=!0,t.parent_&&ki(t.parent_))}function vi(t){t.copy_||(t.copy_=Ci(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Gu=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,o)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...E){return p.produce(m,L=>r.call(this,L,...E))}}typeof r!="function"&&lt(6),o!==void 0&&typeof o!="function"&&lt(7);let l;if(en(e)){const f=As(this),p=Si(e,void 0);let h=!0;try{l=r(p),h=!1}finally{h?xi(f):Ei(f)}return Ts(f,o),Bs(l,f)}else if(!e||typeof e!="object"){if(l=r(e),l===void 0&&(l=e),l===ia&&(l=void 0),this.autoFreeze_&&ji(l,!0),o){const f=[],p=[];tn("Patches").generateReplacementPatches_(e,l,f,p),o(f,p)}return l}else lt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let o,l;return[this.produce(e,r,(p,h)=>{o=p,l=h}),o,l]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){en(t)||lt(8),bn(t)&&(t=Yu(t));const e=As(this),r=Si(t,void 0);return r[it].isManual_=!0,Ei(e),r}finishDraft(t,e){const r=t&&t[it];(!r||!r.isManual_)&&lt(9);const{scope_:o}=r;return Ts(o,e),Bs(void 0,o)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const l=e[r];if(l.path.length===0&&l.op==="replace"){t=l.value;break}}r>-1&&(e=e.slice(r+1));const o=tn("Patches").applyPatches_;return bn(t)?o(t,e):this.produce(t,l=>o(l,e))}};function Si(t,e){const r=Wn(t)?tn("MapSet").proxyMap_(t,e):Ar(t)?tn("MapSet").proxySet_(t,e):$u(t,e);return(e?e.scope_:aa()).drafts_.push(r),r}function Yu(t){return bn(t)||lt(10,t),ua(t)}function ua(t){if(!en(t)||Br(t))return t;const e=t[it];let r,o=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ci(t,e.scope_.immer_.useStrictShallowCopy_),o=e.scope_.immer_.shouldUseStrictIteration()}else r=Ci(t,!0);return Dr(r,(l,f)=>{sa(r,l,ua(f))},o),e&&(e.finalized_=!1),r}var Xu=new Gu,Qu=Xu.produce;const Ju=t=>(e,r,o)=>(o.setState=(l,f,...p)=>{const h=typeof l=="function"?Qu(l):l;return e(h,f,...p)},t(o.setState,r,o)),ec=Ju;var Lr={exports:{}},tc=Lr.exports,Us;function nc(){return Us||(Us=1,(function(t,e){(function(r,o){t.exports=o()})(tc,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,s=1,a=arguments.length;s<a;s++)for(var c in i=arguments[s])Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c]);return n}).apply(this,arguments)};function l(n,i,s){for(var a,c=0,d=i.length;c<d;c++)!a&&c in i||((a=a||Array.prototype.slice.call(i,0,c))[c]=i[c]);return n.concat(a||Array.prototype.slice.call(i))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ra,p=Object.keys,h=Array.isArray;function m(n,i){return typeof i!="object"||p(i).forEach(function(s){n[s]=i[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var E=Object.getPrototypeOf,L={}.hasOwnProperty;function b(n,i){return L.call(n,i)}function P(n,i){typeof i=="function"&&(i=i(E(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(i).forEach(function(s){k(n,s,i[s])})}var R=Object.defineProperty;function k(n,i,s,a){R(n,i,m(s&&b(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function W(n){return{from:function(i){return n.prototype=Object.create(i.prototype),k(n.prototype,"constructor",n),{extend:P.bind(null,n.prototype)}}}}var q=Object.getOwnPropertyDescriptor,G=[].slice;function V(n,i,s){return G.call(n,i,s)}function se(n,i){return i(n)}function K(n){if(!n)throw new Error("Assertion Failed")}function B(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function I(n,i){if(typeof i=="string"&&b(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var s=[],a=0,c=i.length;a<c;++a){var d=I(n,i[a]);s.push(d)}return s}var g=i.indexOf(".");if(g!==-1){var v=n[i.substr(0,g)];return v==null?void 0:I(v,i.substr(g+1))}}function F(n,i,s){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){K(typeof s!="string"&&"length"in s);for(var a=0,c=i.length;a<c;++a)F(n,i[a],s[a])}else{var d,g,v=i.indexOf(".");v!==-1?(d=i.substr(0,v),(g=i.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:F(v=!(v=n[d])||!b(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=s}}function ie(n){var i,s={};for(i in n)b(n,i)&&(s[i]=n[i]);return s}var N=[].concat;function re(n){return N.apply([],n)}var ct="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(re([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return f[n]}),J=new Set(ct.map(function(n){return f[n]})),ae=null;function de(n){return ae=new WeakMap,n=(function i(s){if(!s||typeof s!="object")return s;var a=ae.get(s);if(a)return a;if(h(s)){a=[],ae.set(s,a);for(var c=0,d=s.length;c<d;++c)a.push(i(s[c]))}else if(J.has(s.constructor))a=s;else{var g,v=E(s);for(g in a=v===Object.prototype?{}:Object.create(v),ae.set(s,a),s)b(s,g)&&(a[g]=i(s[g]))}return a})(n),ae=null,n}var fe={}.toString;function le(n){return fe.call(n).slice(8,-1)}var me=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Se=typeof me=="symbol"?function(n){var i;return n!=null&&(i=n[me])&&i.apply(n)}:function(){return null};function he(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var ve={};function ye(n){var i,s,a,c;if(arguments.length===1){if(h(n))return n.slice();if(this===ve&&typeof n=="string")return[n];if(c=Se(n)){for(s=[];!(a=c.next()).done;)s.push(a.value);return s}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(s=new Array(i);i--;)s[i]=n[i];return s}for(i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return s}var Me=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},St=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],st=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(St),De={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pe(n,i){this.name=n,this.message=i}function Be(n,i){return n+". Errors: "+Object.keys(i).map(function(s){return i[s].toString()}).filter(function(s,a,c){return c.indexOf(s)===a}).join(`
`)}function T(n,i,s,a){this.failures=i,this.failedKeys=a,this.successCount=s,this.message=Be(n,i)}function Pe(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(s){return i[s]}),this.failuresByPos=i,this.message=Be(n,this.failures)}W(pe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),W(T).from(pe),W(Pe).from(pe);var Ae=st.reduce(function(n,i){return n[i]=i+"Error",n},{}),Ce=pe,ne=st.reduce(function(n,i){var s=i+"Error";function a(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=De[i]||s,this.inner=null)}return W(a).from(Ce),n[i]=a,n},{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var ge=St.reduce(function(n,i){return n[i+"Error"]=ne[i],n},{}),Ie=st.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=ne[i]),n},{});function Ee(){}function Ye(n){return n}function Nt(n,i){return n==null||n===Ye?i:function(s){return i(n(s))}}function Re(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function Zn(n,i){return n===Ee?i:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=i.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Re(a,this.onsuccess):a),c&&(this.onerror=this.onerror?Re(c,this.onerror):c),d!==void 0?d:s}}function nn(n,i){return n===Ee?i:function(){n.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Re(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Re(a,this.onerror):a)}}function Vn(n,i){return n===Ee?i:function(s){var a=n.apply(this,arguments);m(s,a);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=i.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?Re(c,this.onsuccess):c),d&&(this.onerror=this.onerror?Re(d,this.onerror):d),a===void 0?s===void 0?void 0:s:m(a,s)}}function rn(n,i){return n===Ee?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function on(n,i){return n===Ee?i:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return i.apply(a,d)})}return i.apply(this,arguments)}}Ie.ModifyError=T,Ie.DexieError=pe,Ie.BulkError=Pe;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ln(n){Xe=n}var ut={},Cn=100,ct=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,E(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,E(i),n]})(),St=ct[0],st=ct[1],ct=ct[2],st=st&&st.then,ot=St&&St.constructor,sn=!!ct,ft=function(n,i){pt.push([n,i]),yt&&(queueMicrotask(cn),yt=!1)},an=!0,yt=!0,dt=[],bt=[],ln=Ye,Je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ee,pgp:!1,env:{},finalize:Ee},ue=Je,pt=[],ht=0,wt=[];function te(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=ue;if(typeof n!="function"){if(n!==ut)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Mt(this,this._value))}this._state=null,this._value=null,++i.ref,(function s(a,c){try{c(function(d){if(a._state===null){if(d===a)throw new TypeError("A promise cannot be resolved with itself.");var g=a._lib&&Lt();d&&typeof d.then=="function"?s(a,function(v,w){d instanceof te?d._then(v,w):d.then(v,w)}):(a._state=!0,a._value=d,En(a)),g&&_t()}},Mt.bind(null,a))}catch(d){Mt(a,d)}})(this,n)}var un={get:function(){var n=ue,i=Yn;function s(a,c){var d=this,g=!n.global&&(n!==ue||i!==Yn),v=g&&!Dt(),w=new te(function(C,_){Pt(d,new xn(Ai(a,n,g,v),Ai(c,n,g,v),C,_,n))});return this._consoleTask&&(w._consoleTask=this._consoleTask),w}return s.prototype=ut,s},set:function(n){k(this,"then",n&&n.prototype===ut?un:{get:function(){return n},set:un.set})}};function xn(n,i,s,a,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=s,this.reject=a,this.psd=c}function Mt(n,i){var s,a;bt.push(i),n._state===null&&(s=n._lib&&Lt(),i=ln(i),n._state=!1,n._value=i,a=n,dt.some(function(c){return c._value===a._value})||dt.push(a),En(n),s&&_t())}function En(n){var i=n._listeners;n._listeners=[];for(var s=0,a=i.length;s<a;++s)Pt(n,i[s]);var c=n._PSD;--c.ref||c.finalize(),ht===0&&(++ht,ft(function(){--ht==0&&Ct()},[]))}function Pt(n,i){if(n._state!==null){var s=n._state?i.onFulfilled:i.onRejected;if(s===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++ht,ft($n,[s,n,i])}else n._listeners.push(i)}function $n(n,i,s){try{var a,c=i._value;!i._state&&bt.length&&(bt=[]),a=Xe&&i._consoleTask?i._consoleTask.run(function(){return n(c)}):n(c),i._state||bt.indexOf(c)!==-1||(function(d){for(var g=dt.length;g;)if(dt[--g]._value===d._value)return dt.splice(g,1)})(i),s.resolve(a)}catch(d){s.reject(d)}finally{--ht==0&&Ct(),--s.psd.ref||s.psd.finalize()}}function cn(){qt(Je,function(){Lt()&&_t()})}function Lt(){var n=an;return yt=an=!1,n}function _t(){var n,i,s;do for(;0<pt.length;)for(n=pt,pt=[],s=n.length,i=0;i<s;++i){var a=n[i];a[0].apply(null,a[1])}while(0<pt.length);yt=an=!0}function Ct(){var n=dt;dt=[],n.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var i=wt.slice(0),s=i.length;s;)i[--s]()}function be(n){return new te(ut,!1,n)}function Ke(n,i){var s=ue;return function(){var a=Lt(),c=ue;try{return It(s,!0),n.apply(this,arguments)}catch(d){i&&i(d)}finally{It(c,!1),a&&_t()}}}P(te.prototype,{then:un,_then:function(n,i){Pt(this,new xn(null,null,n,i,ue))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,s=arguments[1];return typeof i=="function"?this.then(null,function(a){return(a instanceof i?s:be)(a)}):this.then(null,function(a){return(a&&a.name===i?s:be)(a)})},finally:function(n){return this.then(function(i){return te.resolve(n()).then(function(){return i})},function(i){return te.resolve(n()).then(function(){return be(i)})})},timeout:function(n,i){var s=this;return n<1/0?new te(function(a,c){var d=setTimeout(function(){return c(new ne.Timeout(i))},n);s.then(a,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(te.prototype,Symbol.toStringTag,"Dexie.Promise"),Je.env=Ti(),P(te,{all:function(){var n=ye.apply(null,arguments).map(Xn);return new te(function(i,s){n.length===0&&i([]);var a=n.length;n.forEach(function(c,d){return te.resolve(c).then(function(g){n[d]=g,--a||i(n)},s)})})},resolve:function(n){return n instanceof te?n:n&&typeof n.then=="function"?new te(function(i,s){n.then(i,s)}):new te(ut,!0,n)},reject:be,race:function(){var n=ye.apply(null,arguments).map(Xn);return new te(function(i,s){n.map(function(a){return te.resolve(a).then(i,s)})})},PSD:{get:function(){return ue},set:function(n){return ue=n}},totalEchoes:{get:function(){return Yn}},newPSD:Ot,usePSD:qt,scheduler:{get:function(){return ft},set:function(n){ft=n}},rejectionMapper:{get:function(){return ln},set:function(n){ln=n}},follow:function(n,i){return new te(function(s,a){return Ot(function(c,d){var g=ue;g.unhandleds=[],g.onunhandled=d,g.finalize=Re(function(){var v,w=this;v=function(){w.unhandleds.length===0?c():d(w.unhandleds[0])},wt.push(function C(){v(),wt.splice(wt.indexOf(C),1)}),++ht,ft(function(){--ht==0&&Ct()},[])},g.finalize),n()},i,s,a)})}}),ot&&(ot.allSettled&&k(te,"allSettled",function(){var n=ye.apply(null,arguments).map(Xn);return new te(function(i){n.length===0&&i([]);var s=n.length,a=new Array(s);n.forEach(function(c,d){return te.resolve(c).then(function(g){return a[d]={status:"fulfilled",value:g}},function(g){return a[d]={status:"rejected",reason:g}}).then(function(){return--s||i(a)})})})}),ot.any&&typeof AggregateError<"u"&&k(te,"any",function(){var n=ye.apply(null,arguments).map(Xn);return new te(function(i,s){n.length===0&&s(new AggregateError([]));var a=n.length,c=new Array(a);n.forEach(function(d,g){return te.resolve(d).then(function(v){return i(v)},function(v){c[g]=v,--a||s(new AggregateError(c))})})})}),ot.withResolvers&&(te.withResolvers=ot.withResolvers));var Ze={awaits:0,echoes:0,id:0},fa=0,Hn=[],Gn=0,Yn=0,da=0;function Ot(n,i,s,a){var c=ue,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++da,Je.env,d.env=sn?{Promise:te,PromiseProp:{value:te,configurable:!0,writable:!0},all:te.all,race:te.race,allSettled:te.allSettled,any:te.any,resolve:te.resolve,reject:te.reject}:{},i&&m(d,i),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},a=qt(d,n,s,a),d.ref===0&&d.finalize(),a}function fn(){return Ze.id||(Ze.id=++fa),++Ze.awaits,Ze.echoes+=Cn,Ze.id}function Dt(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*Cn,!0)}function Xn(n){return Ze.echoes&&n&&n.constructor===ot?(fn(),n.then(function(i){return Dt(),i},function(i){return Dt(),Ne(i)})):n}function pa(){var n=Hn[Hn.length-1];Hn.pop(),It(n,!1)}function It(n,i){var s,a=ue;(i?!Ze.echoes||Gn++&&n===ue:!Gn||--Gn&&n===ue)||queueMicrotask(i?(function(c){++Yn,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Hn.push(ue),It(c,!0)}).bind(null,n):pa),n!==ue&&(ue=n,a===Je&&(Je.env=Ti()),sn&&(s=Je.env.Promise,i=n.env,(a.global||n.global)&&(Object.defineProperty(f,"Promise",i.PromiseProp),s.all=i.all,s.race=i.race,s.resolve=i.resolve,s.reject=i.reject,i.allSettled&&(s.allSettled=i.allSettled),i.any&&(s.any=i.any))))}function Ti(){var n=f.Promise;return sn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function qt(n,i,s,a,c){var d=ue;try{return It(n,!0),i(s,a,c)}finally{It(d,!1)}}function Ai(n,i,s,a){return typeof n!="function"?n:function(){var c=ue;s&&fn(),It(i,!0);try{return n.apply(this,arguments)}finally{It(c,!1),a&&queueMicrotask(Dt)}}}function zr(n){Promise===ot&&Ze.echoes===0?Gn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+st).indexOf("[native code]")===-1&&(fn=Dt=Ee);var Ne=te.reject,Wt="￿",xt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Bi="String expected.",dn=[],Qn="__dbnames",Ur="readonly",Fr="readwrite";function Zt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var zi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Jn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=de(i))[n],i}}function Ui(){throw ne.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Te(n,i){try{var s=Fi(n),a=Fi(i);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,w=g<v?g:v,C=0;C<w;++C)if(c[C]!==d[C])return c[C]<d[C]?-1:1;return g===v?0:g<v?-1:1})(Ki(n),Ki(i));case"Array":return(function(c,d){for(var g=c.length,v=d.length,w=g<v?g:v,C=0;C<w;++C){var _=Te(c[C],d[C]);if(_!==0)return _}return g===v?0:g<v?-1:1})(n,i)}}catch{}return NaN}function Fi(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=le(n),n==="ArrayBuffer"?"binary":n)}function Ki(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function er(n,i,s){var a=n.schema.yProps;return a?(i&&0<s.numFailures&&(i=i.filter(function(c,d){return!s.failures[d]})),Promise.all(a.map(function(c){return c=c.updatesTable,i?n.db.table(c).where("k").anyOf(i).delete():n.db.table(c).clear()})).then(function(){return s})):s}var kn=(Ni.prototype.execute=function(n){var i=this["@@propmod"];if(i.add!==void 0){var s=i.add;if(h(s))return l(l([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(i.remove!==void 0){var a=i.remove;if(h(a))return h(n)?n.filter(function(c){return!a.includes(c)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=i.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?i.replacePrefix[1]+n.substring(s.length):n},Ni);function Ni(n){this["@@propmod"]=n}function qi(n,i){for(var s=p(i),a=s.length,c=!1,d=0;d<a;++d){var g=s[d],v=i[g],w=I(n,g);v instanceof kn?(F(n,g,v.execute(w)),c=!0):w!==v&&(F(n,g,v),c=!0)}return c}var Wi=(Fe.prototype._trans=function(n,i,s){var a=this._tx||ue.trans,c=this.name,d=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(C,_,y){if(!y.schema[c])throw new ne.NotFound("Table "+c+" not part of transaction");return i(y.idbtrans,y)}var v=Lt();try{var w=a&&a.db._novip===this.db._novip?a===ue.trans?a._promise(n,g,s):Ot(function(){return a._promise(n,g,s)},{trans:a,transless:ue.transless||ue}):(function C(_,y,D,x){if(_.idbdb&&(_._state.openComplete||ue.letThrough||_._vip)){var S=_._createTransaction(y,D,_._dbSchema);try{S.create(),_._state.PR1398_maxLoop=3}catch(M){return M.name===Ae.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return C(_,y,D,x)})):Ne(M)}return S._promise(y,function(M,O){return Ot(function(){return ue.trans=S,x(M,O,S)})}).then(function(M){if(y==="readwrite")try{S.idbtrans.commit()}catch{}return y==="readonly"?M:S._completion.then(function(){return M})})}if(_._state.openComplete)return Ne(new ne.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return Ne(new ne.DatabaseClosed);_.open().catch(Ee)}return _._state.dbReadyPromise.then(function(){return C(_,y,D,x)})})(this.db,n,[this.name],g);return d&&(w._consoleTask=d,w=w.catch(function(C){return console.trace(C),Ne(C)})),w}finally{v&&_t()}},Fe.prototype.get=function(n,i){var s=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?Ne(new ne.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(i)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=p(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&i.every(function(C){return 0<=v.keyPath.indexOf(C)})){for(var w=0;w<i.length;++w)if(i.indexOf(v.keyPath[w])===-1)return!1;return!0}return!1}).sort(function(v,w){return v.keyPath.length-w.keyPath.length})[0];if(s&&this.db._maxKey!==Wt){var d=s.keyPath.slice(0,i.length);return this.where(d).equals(d.map(function(w){return n[w]}))}!s&&Xe&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var a=this.schema.idxByName;function c(v,w){return Te(v,w)===0}var g=i.reduce(function(y,w){var C=y[0],_=y[1],y=a[w],D=n[w];return[C||y,C||!y?Zt(_,y&&y.multi?function(x){return x=I(x,w),h(x)&&x.some(function(S){return c(D,S)})}:function(x){return c(D,I(x,w))}):_]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(i).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var i,s=this.db,a=this.name;function c(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ui&&((function(w,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function _(){this.constructor=w}r(w,C),w.prototype=C===null?Object.create(C):(_.prototype=C.prototype,new _)})(c,i=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return a},n=c);for(var d=new Set,g=n.prototype;g;g=E(g))Object.getOwnPropertyNames(g).forEach(function(w){return d.add(w)});function v(w){if(!w)return w;var C,_=Object.create(n.prototype);for(C in w)if(!d.has(C))try{_[C]=w[C]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,g=n;return d&&c&&(g=Jn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:i!=null?[i]:null,values:[g]})}).then(function(v){return v.numFailures?te.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{F(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,i){var s=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return qi(g,i),a&&F(g,a,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[i]}}).then(function(v){return v.numFailures?te.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,i){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(i):(n=I(n,this.schema.primKey.keyPath),n===void 0?Ne(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},Fe.prototype.put=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,g=n;return d&&c&&(g=Jn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:i!=null?[i]:null})}).then(function(v){return v.numFailures?te.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{F(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(a){return er(i,[n],a)}).then(function(a){return a.numFailures?te.reject(a.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:zi}).then(function(s){return er(n,null,s)})}).then(function(i){return i.numFailures?te.reject(i.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(s){return i.core.getMany({keys:n,trans:s}).then(function(a){return a.map(function(c){return i.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(g){var C=a.schema.primKey,v=C.auto,C=C.keyPath;if(C&&c)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var w=n.length,C=C&&v?n.map(Jn(C)):n;return a.core.mutate({trans:g,type:"add",keys:c,values:C,wantResults:d}).then(function(S){var y=S.numFailures,D=S.results,x=S.lastResult,S=S.failures;if(y===0)return d?D:x;throw new Pe("".concat(a.name,".bulkAdd(): ").concat(y," of ").concat(w," operations failed"),S)})})},Fe.prototype.bulkPut=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(g){var C=a.schema.primKey,v=C.auto,C=C.keyPath;if(C&&c)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var w=n.length,C=C&&v?n.map(Jn(C)):n;return a.core.mutate({trans:g,type:"put",keys:c,values:C,wantResults:d}).then(function(S){var y=S.numFailures,D=S.results,x=S.lastResult,S=S.failures;if(y===0)return d?D:x;throw new Pe("".concat(a.name,".bulkPut(): ").concat(y," of ").concat(w," operations failed"),S)})})},Fe.prototype.bulkUpdate=function(n){var i=this,s=this.core,a=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:a,cache:"clone"}).then(function(v){var w=[],C=[];n.forEach(function(y,D){var x=y.key,S=y.changes,M=v[D];if(M){for(var O=0,j=Object.keys(S);O<j.length;O++){var A=j[O],U=S[A];if(A===i.schema.primKey.keyPath){if(Te(U,x)!==0)throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else F(M,A,U)}d.push(D),w.push(x),C.push(M)}});var _=w.length;return s.mutate({trans:g,type:"put",keys:w,values:C,updates:{keys:a,changeSpecs:c}}).then(function(y){var D=y.numFailures,x=y.failures;if(D===0)return _;for(var S=0,M=Object.keys(x);S<M.length;S++){var O,j=M[S],A=d[Number(j)];A!=null&&(O=x[j],delete x[j],x[A]=O)}throw new Pe("".concat(i.name,".bulkUpdate(): ").concat(D," of ").concat(_," operations failed"),x)})})})},Fe.prototype.bulkDelete=function(n){var i=this,s=n.length;return this._trans("readwrite",function(a){return i.core.mutate({trans:a,type:"delete",keys:n}).then(function(c){return er(i,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Pe("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function Sn(n){function i(g,v){if(v){for(var w=arguments.length,C=new Array(w-1);--w;)C[w-1]=arguments[w];return s[g].subscribe.apply(null,C),n}if(typeof g=="string")return s[g]}var s={};i.addEventType=d;for(var a=1,c=arguments.length;a<c;++a)d(arguments[a]);return i;function d(g,v,w){if(typeof g!="object"){var C;v=v||rn;var _={subscribers:[],fire:w=w||Ee,subscribe:function(y){_.subscribers.indexOf(y)===-1&&(_.subscribers.push(y),_.fire=v(_.fire,y))},unsubscribe:function(y){_.subscribers=_.subscribers.filter(function(D){return D!==y}),_.fire=_.subscribers.reduce(v,w)}};return s[g]=i[g]=_}p(C=g).forEach(function(y){var D=C[y];if(h(D))d(y,C[y][0],C[y][1]);else{if(D!=="asap")throw new ne.InvalidArgument("Invalid event config");var x=d(y,Ye,function(){for(var S=arguments.length,M=new Array(S);S--;)M[S]=arguments[S];x.subscribers.forEach(function(O){B(function(){O.apply(null,M)})})})}})}}function Mn(n,i){return W(i).from({prototype:n}),i}function pn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Kr(n,i){n.filter=Zt(n.filter,i)}function Nr(n,i,s){var a=n.replayFilter;n.replayFilter=a?function(){return Zt(a(),i())}:i,n.justLimit=s&&!a}function tr(n,i){if(n.isPrimKey)return i.primaryKey;var s=i.getIndexByKeyPath(n.index);if(!s)throw new ne.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return s}function Zi(n,i,s){var a=tr(n,i.schema);return i.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:a,range:n.range}})}function nr(n,i,s,a){var c=n.replayFilter?Zt(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,w,C){var _,y;c&&!c(w,C,function(D){return w.stop(D)},function(D){return w.fail(D)})||((y=""+(_=w.primaryKey))=="[object ArrayBuffer]"&&(y=""+new Uint8Array(_)),b(d,y)||(d[y]=!0,i(v,w,C)))};return Promise.all([n.or._iterate(g,s),Vi(Zi(n,a,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Vi(Zi(n,a,s),Zt(n.algorithm,c),i,!n.keysOnly&&n.valueMapper)}function Vi(n,i,s,a){var c=Ke(a?function(d,g,v){return s(a(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};i&&!i(d,function(v){return g=v},function(v){d.stop(v),g=Ee},function(v){d.fail(v),g=Ee})||c(d.value,d,function(v){return g=v}),g()})})}var ha=(ze.prototype._read=function(n,i){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(i)},ze.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,Ne.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},ze.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Zt(i.algorithm,n)},ze.prototype._iterate=function(n,i){return nr(this._ctx,n,i,this._ctx.table.core)},ze.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),i._ctx=s,i},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(n){var i=this._ctx;return this._read(function(s){return nr(i,n,s,i.table.core)})},ze.prototype.count=function(n){var i=this;return this._read(function(s){var a=i._ctx,c=a.table.core;if(pn(a,!0))return c.count({trans:s,query:{index:tr(a,c.schema),range:a.range}}).then(function(g){return Math.min(g,a.limit)});var d=0;return nr(a,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},ze.prototype.sortBy=function(n,i){var s=n.split(".").reverse(),a=s[0],c=s.length-1;function d(w,C){return C?d(w[s[C]],C-1):w[a]}var g=this._ctx.dir==="next"?1:-1;function v(w,C){return Te(d(w,c),d(C,c))*g}return this.toArray(function(w){return w.sort(v)}).then(i)},ze.prototype.toArray=function(n){var i=this;return this._read(function(s){var a=i._ctx;if(a.dir==="next"&&pn(a,!0)&&0<a.limit){var c=a.valueMapper,d=tr(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:d,range:a.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return nr(a,function(v){return g.push(v)},s,a.table.core).then(function(){return g})},n)},ze.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,pn(i)?Nr(i,function(){var s=n;return function(a,c){return s===0||(s===1?--s:c(function(){a.advance(s),s=0}),!1)}}):Nr(i,function(){var s=n;return function(){return--s<0}})),this},ze.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Nr(this._ctx,function(){var i=n;return function(s,a,c){return--i<=0&&a(c),0<=i}},!0),this},ze.prototype.until=function(n,i){return Kr(this._ctx,function(s,a,c){return!n(s.value)||(a(c),i)}),this},ze.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},ze.prototype.last=function(n){return this.reverse().first(n)},ze.prototype.filter=function(n){var i;return Kr(this._ctx,function(s){return n(s.value)}),(i=this._ctx).isMatch=Zt(i.isMatch,n),this},ze.prototype.and=function(n){return this.filter(n)},ze.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.key,a)})},ze.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},ze.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.primaryKey,a)})},ze.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.key)}).then(function(){return s}).then(n)},ze.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&pn(i,!0)&&0<i.limit)return this._read(function(a){var c=tr(i,i.table.core.schema);return i.table.core.query({trans:a,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(a){return a.result}).then(n);i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},ze.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},ze.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},ze.prototype.lastKey=function(n){return this.reverse().firstKey(n)},ze.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Kr(this._ctx,function(c){var a=c.primaryKey.toString(),c=b(i,a);return i[a]=!0,!c}),this},ze.prototype.modify=function(n){var i=this,s=this._ctx;return this._write(function(a){var c=typeof n=="function"?n:function(M){return qi(M,n)},d=s.table.core,C=d.schema.primaryKey,g=C.outbound,v=C.extractKey,w=200,C=i.db._options.modifyChunkSize;C&&(w=typeof C=="object"?C[d.name]||C["*"]||200:C);function _(M,A){var j=A.failures,A=A.numFailures;D+=M-A;for(var U=0,Z=p(j);U<Z.length;U++){var H=Z[U];y.push(j[H])}}var y=[],D=0,x=[],S=n===$i;return i.clone().primaryKeys().then(function(M){function O(A){var U=Math.min(w,M.length-A),Z=M.slice(A,A+U);return(S?Promise.resolve([]):d.getMany({trans:a,keys:Z,cache:"immutable"})).then(function(H){var Q=[],$=[],Y=g?[]:null,ee=S?Z:[];if(!S)for(var X=0;X<U;++X){var oe=H[X],Le={value:de(oe),primKey:M[A+X]};c.call(Le,Le.value,Le)!==!1&&(Le.value==null?ee.push(M[A+X]):g||Te(v(oe),v(Le.value))===0?($.push(Le.value),g&&Y.push(M[A+X])):(ee.push(M[A+X]),Q.push(Le.value)))}return Promise.resolve(0<Q.length&&d.mutate({trans:a,type:"add",values:Q}).then(function(ke){for(var _e in ke.failures)ee.splice(parseInt(_e),1);_(Q.length,ke)})).then(function(){return(0<$.length||j&&typeof n=="object")&&d.mutate({trans:a,type:"put",keys:Y,values:$,criteria:j,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<A}).then(function(ke){return _($.length,ke)})}).then(function(){return(0<ee.length||j&&S)&&d.mutate({trans:a,type:"delete",keys:ee,criteria:j,isAdditionalChunk:0<A}).then(function(ke){return er(s.table,ee,ke)}).then(function(ke){return _(ee.length,ke)})}).then(function(){return M.length>A+U&&O(A+w)})})}var j=pn(s)&&s.limit===1/0&&(typeof n!="function"||S)&&{index:s.index,range:s.range};return O(0).then(function(){if(0<y.length)throw new T("Error modifying one or more objects",y,D,x);return M.length})})})},ze.prototype.delete=function(){var n=this._ctx,i=n.range;return!pn(n)||n.table.schema.yProps||!n.isPrimKey&&i.type!==3?this.modify($i):this._write(function(s){var a=n.table.core.schema.primaryKey,c=i;return n.table.core.count({trans:s,query:{index:a,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(w){var v=w.failures,w=w.numFailures;if(w)throw new T("Could not delete some values",Object.keys(v).map(function(C){return v[C]}),d-w);return d-w})})})},ze);function ze(){}var $i=function(n,i){return i.value=null};function ga(n,i){return n<i?-1:n===i?0:1}function ma(n,i){return i<n?-1:n===i?0:1}function et(n,i,s){return n=n instanceof Gi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(i),n}function hn(n){return new n.Collection(n,function(){return Hi("")}).limit(0)}function rr(n,i,s,a){var c,d,g,v,w,C,_,y=s.length;if(!s.every(function(S){return typeof S=="string"}))return et(n,Bi);function D(S){c=S==="next"?function(O){return O.toUpperCase()}:function(O){return O.toLowerCase()},d=S==="next"?function(O){return O.toLowerCase()}:function(O){return O.toUpperCase()},g=S==="next"?ga:ma;var M=s.map(function(O){return{lower:d(O),upper:c(O)}}).sort(function(O,j){return g(O.lower,j.lower)});v=M.map(function(O){return O.upper}),w=M.map(function(O){return O.lower}),_=(C=S)==="next"?"":a}D("next"),n=new n.Collection(n,function(){return jt(v[0],w[y-1]+a)}),n._ondirectionchange=function(S){D(S)};var x=0;return n._addAlgorithm(function(S,M,O){var j=S.key;if(typeof j!="string")return!1;var A=d(j);if(i(A,w,x))return!0;for(var U=null,Z=x;Z<y;++Z){var H=(function(Q,$,Y,ee,X,oe){for(var Le=Math.min(Q.length,ee.length),ke=-1,_e=0;_e<Le;++_e){var tt=$[_e];if(tt!==ee[_e])return X(Q[_e],Y[_e])<0?Q.substr(0,_e)+Y[_e]+Y.substr(_e+1):X(Q[_e],ee[_e])<0?Q.substr(0,_e)+ee[_e]+Y.substr(_e+1):0<=ke?Q.substr(0,ke)+$[ke]+Y.substr(ke+1):null;X(Q[_e],tt)<0&&(ke=_e)}return Le<ee.length&&oe==="next"?Q+Y.substr(Q.length):Le<Q.length&&oe==="prev"?Q.substr(0,Y.length):ke<0?null:Q.substr(0,ke)+ee[ke]+Y.substr(ke+1)})(j,A,v[Z],w[Z],g,C);H===null&&U===null?x=Z+1:(U===null||0<g(U,H))&&(U=H)}return M(U!==null?function(){S.continue(U+_)}:O),!1}),n}function jt(n,i,s,a){return{type:2,lower:n,upper:i,lowerOpen:s,upperOpen:a}}function Hi(n){return{type:1,lower:n,upper:n}}var Gi=(Object.defineProperty(Ve.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ve.prototype.between=function(n,i,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(s||a)&&(!s||!a)?hn(this):new this.Collection(this,function(){return jt(n,i,!s,!a)})}catch{return et(this,xt)}},Ve.prototype.equals=function(n){return n==null?et(this,xt):new this.Collection(this,function(){return Hi(n)})},Ve.prototype.above=function(n){return n==null?et(this,xt):new this.Collection(this,function(){return jt(n,void 0,!0)})},Ve.prototype.aboveOrEqual=function(n){return n==null?et(this,xt):new this.Collection(this,function(){return jt(n,void 0,!1)})},Ve.prototype.below=function(n){return n==null?et(this,xt):new this.Collection(this,function(){return jt(void 0,n,!1,!0)})},Ve.prototype.belowOrEqual=function(n){return n==null?et(this,xt):new this.Collection(this,function(){return jt(void 0,n)})},Ve.prototype.startsWith=function(n){return typeof n!="string"?et(this,Bi):this.between(n,n+Wt,!0,!0)},Ve.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):rr(this,function(i,s){return i.indexOf(s[0])===0},[n],Wt)},Ve.prototype.equalsIgnoreCase=function(n){return rr(this,function(i,s){return i===s[0]},[n],"")},Ve.prototype.anyOfIgnoreCase=function(){var n=ye.apply(ve,arguments);return n.length===0?hn(this):rr(this,function(i,s){return s.indexOf(i)!==-1},n,"")},Ve.prototype.startsWithAnyOfIgnoreCase=function(){var n=ye.apply(ve,arguments);return n.length===0?hn(this):rr(this,function(i,s){return s.some(function(a){return i.indexOf(a)===0})},n,Wt)},Ve.prototype.anyOf=function(){var n=this,i=ye.apply(ve,arguments),s=this._cmp;try{i.sort(s)}catch{return et(this,xt)}if(i.length===0)return hn(this);var a=new this.Collection(this,function(){return jt(i[0],i[i.length-1])});a._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,i.sort(s)};var c=0;return a._addAlgorithm(function(d,g,v){for(var w=d.key;0<s(w,i[c]);)if(++c===i.length)return g(v),!1;return s(w,i[c])===0||(g(function(){d.continue(i[c])}),!1)}),a},Ve.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ve.prototype.noneOf=function(){var n=ye.apply(ve,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return et(this,xt)}var i=n.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},Ve.prototype.inAnyRange=function(j,i){var s=this,a=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(j.length===0)return hn(this);if(!j.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&c(A[0],A[1])<=0}))return et(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var w=!i||i.includeLowers!==!1,C=i&&i.includeUppers===!0,_,y=c;function D(A,U){return y(A[0],U[0])}try{(_=j.reduce(function(A,U){for(var Z=0,H=A.length;Z<H;++Z){var Q=A[Z];if(a(U[0],Q[1])<0&&0<a(U[1],Q[0])){Q[0]=g(Q[0],U[0]),Q[1]=v(Q[1],U[1]);break}}return Z===H&&A.push(U),A},[])).sort(D)}catch{return et(this,xt)}var x=0,S=C?function(A){return 0<c(A,_[x][1])}:function(A){return 0<=c(A,_[x][1])},M=w?function(A){return 0<d(A,_[x][0])}:function(A){return 0<=d(A,_[x][0])},O=S,j=new this.Collection(this,function(){return jt(_[0][0],_[_.length-1][1],!w,!C)});return j._ondirectionchange=function(A){y=A==="next"?(O=S,c):(O=M,d),_.sort(D)},j._addAlgorithm(function(A,U,Z){for(var H,Q=A.key;O(Q);)if(++x===_.length)return U(Z),!1;return!S(H=Q)&&!M(H)||(s._cmp(Q,_[x][1])===0||s._cmp(Q,_[x][0])===0||U(function(){y===c?A.continue(_[x][0]):A.continue(_[x][1])}),!1)}),j},Ve.prototype.startsWithAnyOf=function(){var n=ye.apply(ve,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?hn(this):this.inAnyRange(n.map(function(i){return[i,i+Wt]})):et(this,"startsWithAnyOf() only works with strings")},Ve);function Ve(){}function gt(n){return Ke(function(i){return Pn(i),n(i.target.error),!1})}function Pn(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",qr="x-storagemutated-1",Rt=Sn(null,_n),va=(mt.prototype._lock=function(){return K(!ue.global),++this._reculock,this._reculock!==1||ue.global||(ue.lockOwnerFor=this),this},mt.prototype._unlock=function(){if(K(!ue.global),--this._reculock==0)for(ue.global||(ue.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{qt(n[1],n[0])}catch{}}return this},mt.prototype._locked=function(){return this._reculock&&ue.lockOwnerFor!==this},mt.prototype.create=function(n){var i=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(K(!this.idbtrans),!n&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(a);case"MissingAPIError":throw new ne.MissingAPI(a.message,a);default:throw new ne.OpenFailed(a)}if(!this.active)throw new ne.TransactionInactive;return K(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){Pn(c),i._reject(n.error)}),n.onabort=Ke(function(c){Pn(c),i.active&&i._reject(new ne.Abort(n.error)),i.active=!1,i.on("abort").fire(c)}),n.oncomplete=Ke(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&Rt.storagemutated.fire(n.mutatedParts)}),this},mt.prototype._promise=function(n,i,s){var a=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new ne.TransactionInactive);if(this._locked())return new te(function(d,g){a._blockedFuncs.push([function(){a._promise(n,i,s).then(d,g)},ue])});if(s)return Ot(function(){var d=new te(function(g,v){a._lock();var w=i(g,v,a);w&&w.then&&w.then(g,v)});return d.finally(function(){return a._unlock()}),d._lib=!0,d});var c=new te(function(d,g){var v=i(d,g,a);v&&v.then&&v.then(d,g)});return c._lib=!0,c},mt.prototype._root=function(){return this.parent?this.parent._root():this},mt.prototype.waitFor=function(n){var i,s=this._root(),a=te.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],i=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(i.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new te(function(d,g){a.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},mt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},mt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(b(i,n))return i[n];var s=this.schema[n];if(!s)throw new ne.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),i[n]=s},mt);function mt(){}function Wr(n,i,s,a,c,d,g,v){return{name:n,keyPath:i,unique:s,multi:a,auto:c,compound:d,src:(s&&!g?"&":"")+(a?"*":"")+(c?"++":"")+Yi(i),type:v}}function Yi(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Zr(n,i,s){return{name:n,primKey:i,indexes:s,mappedClass:null,idxByName:(a=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=a(d,g),g&&(c[g[0]]=g[1]),c},{}))};var a}var On=function(n){try{return n.only([[]]),On=function(){return[[]]},[[]]}catch{return On=function(){return Wt},Wt}};function Vr(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(s){return s[i]}:function(s){return I(s,i)}:function(s){return I(s,n)};var i}function Xi(n){return[].slice.call(n)}var ya=0;function Dn(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ba(n,i,w){function a(O){if(O.type===3)return null;if(O.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var x=O.lower,S=O.upper,M=O.lowerOpen,O=O.upperOpen;return x===void 0?S===void 0?null:i.upperBound(S,!!O):S===void 0?i.lowerBound(x,!!M):i.bound(x,S,!!M,!!O)}function c(D){var x,S=D.name;return{name:S,schema:D,mutate:function(M){var O=M.trans,j=M.type,A=M.keys,U=M.values,Z=M.range;return new Promise(function(H,Q){H=Ke(H);var $=O.objectStore(S),Y=$.keyPath==null,ee=j==="put"||j==="add";if(!ee&&j!=="delete"&&j!=="deleteRange")throw new Error("Invalid operation type: "+j);var X,oe=(A||U||{length:1}).length;if(A&&U&&A.length!==U.length)throw new Error("Given keys array must have same length as given values array.");if(oe===0)return H({numFailures:0,failures:{},results:[],lastResult:void 0});function Le(Qe){++tt,Pn(Qe)}var ke=[],_e=[],tt=0;if(j==="deleteRange"){if(Z.type===4)return H({numFailures:tt,failures:_e,results:[],lastResult:void 0});Z.type===3?ke.push(X=$.clear()):ke.push(X=$.delete(a(Z)))}else{var Y=ee?Y?[U,A]:[U,null]:[A,null],we=Y[0],He=Y[1];if(ee)for(var Ge=0;Ge<oe;++Ge)ke.push(X=He&&He[Ge]!==void 0?$[j](we[Ge],He[Ge]):$[j](we[Ge])),X.onerror=Le;else for(Ge=0;Ge<oe;++Ge)ke.push(X=$[j](we[Ge])),X.onerror=Le}function gr(Qe){Qe=Qe.target.result,ke.forEach(function(Ht,ci){return Ht.error!=null&&(_e[ci]=Ht.error)}),H({numFailures:tt,failures:_e,results:j==="delete"?A:ke.map(function(Ht){return Ht.result}),lastResult:Qe})}X.onerror=function(Qe){Le(Qe),gr(Qe)},X.onsuccess=gr})},getMany:function(M){var O=M.trans,j=M.keys;return new Promise(function(A,U){A=Ke(A);for(var Z,H=O.objectStore(S),Q=j.length,$=new Array(Q),Y=0,ee=0,X=function(ke){ke=ke.target,$[ke._pos]=ke.result,++ee===Y&&A($)},oe=gt(U),Le=0;Le<Q;++Le)j[Le]!=null&&((Z=H.get(j[Le]))._pos=Le,Z.onsuccess=X,Z.onerror=oe,++Y);Y===0&&A($)})},get:function(M){var O=M.trans,j=M.key;return new Promise(function(A,U){A=Ke(A);var Z=O.objectStore(S).get(j);Z.onsuccess=function(H){return A(H.target.result)},Z.onerror=gt(U)})},query:(x=C,function(M){return new Promise(function(O,j){O=Ke(O);var A,U,Z,Y=M.trans,H=M.values,Q=M.limit,X=M.query,$=Q===1/0?void 0:Q,ee=X.index,X=X.range,Y=Y.objectStore(S),ee=ee.isPrimaryKey?Y:Y.index(ee.name),X=a(X);if(Q===0)return O({result:[]});x?(($=H?ee.getAll(X,$):ee.getAllKeys(X,$)).onsuccess=function(oe){return O({result:oe.target.result})},$.onerror=gt(j)):(A=0,U=!H&&"openKeyCursor"in ee?ee.openKeyCursor(X):ee.openCursor(X),Z=[],U.onsuccess=function(oe){var Le=U.result;return Le?(Z.push(H?Le.value:Le.primaryKey),++A===Q?O({result:Z}):void Le.continue()):O({result:Z})},U.onerror=gt(j))})}),openCursor:function(M){var O=M.trans,j=M.values,A=M.query,U=M.reverse,Z=M.unique;return new Promise(function(H,Q){H=Ke(H);var ee=A.index,$=A.range,Y=O.objectStore(S),Y=ee.isPrimaryKey?Y:Y.index(ee.name),ee=U?Z?"prevunique":"prev":Z?"nextunique":"next",X=!j&&"openKeyCursor"in Y?Y.openKeyCursor(a($),ee):Y.openCursor(a($),ee);X.onerror=gt(Q),X.onsuccess=Ke(function(oe){var Le,ke,_e,tt,we=X.result;we?(we.___id=++ya,we.done=!1,Le=we.continue.bind(we),ke=(ke=we.continuePrimaryKey)&&ke.bind(we),_e=we.advance.bind(we),tt=function(){throw new Error("Cursor not stopped")},we.trans=O,we.stop=we.continue=we.continuePrimaryKey=we.advance=function(){throw new Error("Cursor not started")},we.fail=Ke(Q),we.next=function(){var He=this,Ge=1;return this.start(function(){return Ge--?He.continue():He.stop()}).then(function(){return He})},we.start=function(He){function Ge(){if(X.result)try{He()}catch(Qe){we.fail(Qe)}else we.done=!0,we.start=function(){throw new Error("Cursor behind last entry")},we.stop()}var gr=new Promise(function(Qe,Ht){Qe=Ke(Qe),X.onerror=gt(Ht),we.fail=Ht,we.stop=function(ci){we.stop=we.continue=we.continuePrimaryKey=we.advance=tt,Qe(ci)}});return X.onsuccess=Ke(function(Qe){X.onsuccess=Ge,Ge()}),we.continue=Le,we.continuePrimaryKey=ke,we.advance=_e,Ge(),gr},H(we)):H(null)},Q)})},count:function(M){var O=M.query,j=M.trans,A=O.index,U=O.range;return new Promise(function(Z,H){var Q=j.objectStore(S),$=A.isPrimaryKey?Q:Q.index(A.name),Q=a(U),$=Q?$.count(Q):$.count();$.onsuccess=Ke(function(Y){return Z(Y.target.result)}),$.onerror=gt(H)})}}}var d,g,v,_=(g=w,v=Xi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(D){return g.objectStore(D)}).map(function(D){var x=D.keyPath,O=D.autoIncrement,S=h(x),M={},O={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:x==null,compound:S,keyPath:x,autoIncrement:O,unique:!0,extractKey:Vr(x)},indexes:Xi(D.indexNames).map(function(j){return D.index(j)}).map(function(Z){var A=Z.name,U=Z.unique,H=Z.multiEntry,Z=Z.keyPath,H={name:A,compound:h(Z),keyPath:Z,unique:U,multiEntry:H,extractKey:Vr(Z)};return M[Dn(Z)]=H}),getIndexByKeyPath:function(j){return M[Dn(j)]}};return M[":id"]=O.primaryKey,x!=null&&(M[Dn(x)]=O.primaryKey),O})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),w=_.schema,C=_.hasGetAll,_=w.tables.map(c),y={};return _.forEach(function(D){return y[D.name]=D}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(D){if(!y[D])throw new Error("Table '".concat(D,"' not found"));return y[D]},MIN_KEY:-1/0,MAX_KEY:On(i),schema:w}}function wa(n,i,s,a){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=ba(i,c,a),n.dbcore.reduce(function(d,g){return g=g.create,o(o({},d),g(d))},a))}}function ir(n,a){var s=a.db,a=wa(n._middlewares,s,n._deps,a);n.core=a.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function or(n,i,s,a){s.forEach(function(c){var d=a[c];i.forEach(function(g){var v=(function w(C,_){return q(C,_)||(C=E(C))&&w(C,_)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?k(g,c,{get:function(){return this.table(c)},set:function(w){R(this,c,{value:w,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function $r(n,i){i.forEach(function(s){for(var a in s)s[a]instanceof n.Table&&delete s[a]})}function La(n,i){return n._cfg.version-i._cfg.version}function Ca(n,i,s,a){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=Zr("$meta",Ji("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(a);var g=d._reject.bind(d),v=ue.transless||ue;Ot(function(){return ue.trans=d,ue.transless=v,i!==0?(ir(n,s),C=i,((w=d).storeNames.includes("$meta")?w.table("$meta").get("version").then(function(_){return _??C}):te.resolve(C)).then(function(_){return D=_,x=d,S=s,M=[],_=(y=n)._versions,O=y._dbSchema=ar(0,y.idbdb,S),(_=_.filter(function(j){return j._cfg.version>=D})).length!==0?(_.forEach(function(j){M.push(function(){var A=O,U=j._cfg.dbschema;lr(y,A,S),lr(y,U,S),O=y._dbSchema=U;var Z=Hr(A,U);Z.add.forEach(function(ee){Gr(S,ee[0],ee[1].primKey,ee[1].indexes)}),Z.change.forEach(function(ee){if(ee.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var X=S.objectStore(ee.name);ee.add.forEach(function(oe){return sr(X,oe)}),ee.change.forEach(function(oe){X.deleteIndex(oe.name),sr(X,oe)}),ee.del.forEach(function(oe){return X.deleteIndex(oe)})});var H=j._cfg.contentUpgrade;if(H&&j._cfg.version>D){ir(y,S),x._memoizedTables={};var Q=ie(U);Z.del.forEach(function(ee){Q[ee]=A[ee]}),$r(y,[y.Transaction.prototype]),or(y,[y.Transaction.prototype],p(Q),Q),x.schema=Q;var $,Y=Me(H);return Y&&fn(),Z=te.follow(function(){var ee;($=H(x))&&Y&&(ee=Dt.bind(null,null),$.then(ee,ee))}),$&&typeof $.then=="function"?te.resolve($):Z.then(function(){return $})}}),M.push(function(A){var U,Z,H=j._cfg.dbschema;U=H,Z=A,[].slice.call(Z.db.objectStoreNames).forEach(function(Q){return U[Q]==null&&Z.db.deleteObjectStore(Q)}),$r(y,[y.Transaction.prototype]),or(y,[y.Transaction.prototype],y._storeNames,y._dbSchema),x.schema=y._dbSchema}),M.push(function(A){y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(y.idbdb.version/10)===j._cfg.version?(y.idbdb.deleteObjectStore("$meta"),delete y._dbSchema.$meta,y._storeNames=y._storeNames.filter(function(U){return U!=="$meta"})):A.objectStore("$meta").put(j._cfg.version,"version"))})}),(function j(){return M.length?te.resolve(M.shift()(x.idbtrans)).then(j):te.resolve()})().then(function(){Qi(O,S)})):te.resolve();var y,D,x,S,M,O}).catch(g)):(p(c).forEach(function(_){Gr(s,_,c[_].primKey,c[_].indexes)}),ir(n,s),void te.follow(function(){return n.on.populate.fire(d)}).catch(g));var w,C})}function xa(n,i){Qi(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var s=ar(0,n.idbdb,i);lr(n,n._dbSchema,i);for(var a=0,c=Hr(s,n._dbSchema).change;a<c.length;a++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=i.objectStore(g.name);g.add.forEach(function(w){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(w.src)),sr(v,w)})})(c[a]);if(typeof d=="object")return d.value}}function Hr(n,i){var s,a={del:[],add:[],change:[]};for(s in n)i[s]||a.del.push(s);for(s in i){var c=n[s],d=i[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,a.change.push(g);else{var v=c.idxByName,w=d.idxByName,C=void 0;for(C in v)w[C]||g.del.push(C);for(C in w){var _=v[C],y=w[C];_?_.src!==y.src&&g.change.push(y):g.add.push(y)}(0<g.del.length||0<g.add.length||0<g.change.length)&&a.change.push(g)}}else a.add.push([s,d])}return a}function Gr(n,i,s,a){var c=n.db.createObjectStore(i,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(d){return sr(c,d)}),c}function Qi(n,i){p(n).forEach(function(s){i.db.objectStoreNames.contains(s)||(Xe&&console.debug("Dexie: Creating missing table",s),Gr(i,s,n[s].primKey,n[s].indexes))})}function sr(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function ar(n,i,s){var a={};return V(i.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Wr(Yi(C=d.keyPath),C||"",!0,!1,!!d.autoIncrement,C&&typeof C!="string",!0),v=[],w=0;w<d.indexNames.length;++w){var _=d.index(d.indexNames[w]),C=_.keyPath,_=Wr(_.name,C,!!_.unique,!!_.multiEntry,!1,C&&typeof C!="string",!1);v.push(_)}a[c]=Zr(c,g,v)}),a}function lr(n,i,s){for(var a=s.db.objectStoreNames,c=0;c<a.length;++c){var d=a[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var w=g.indexNames[v],C=g.index(w).keyPath,_=typeof C=="string"?C:"["+V(C).join("+")+"]";!i[d]||(C=i[d].idxByName[_])&&(C.name=w,delete i[d].idxByName[_],i[d].idxByName[w]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Ji(n){return n.split(",").map(function(i,s){var d=i.split(":"),a=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(i=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Wr(c,d||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),h(d),s===0,a)})}var Ea=(gn.prototype._createTableSchema=Zr,gn.prototype._parseIndexSyntax=Ji,gn.prototype._parseStoresSpec=function(n,i){var s=this;p(n).forEach(function(a){if(n[a]!==null){var c=s._parseIndexSyntax(n[a]),d=c.shift();if(!d)throw new ne.Schema("Invalid schema for table "+a+": "+n[a]);if(d.unique=!0,d.multi)throw new ne.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(a,d,c),i[a]=c}})},gn.prototype.stores=function(s){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=i._versions,a={},c={};return s.forEach(function(d){m(a,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(a,c)}),i._dbSchema=c,$r(i,[i._allTables,i,i.Transaction.prototype]),or(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],p(c),c),i._storeNames=p(c),this},gn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=on(this._cfg.contentUpgrade||Ee,n),this},gn);function gn(){}function Yr(n,i){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Et(Qn,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Xr(n){return n&&typeof n.databases=="function"}function Qr(n){return Ot(function(){return ue.letThrough=!0,n()})}function Jr(n){return!("from"in n)}var $e=function(n,i){if(!this){var s=new $e;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function In(n,i,s){var a=Te(i,s);if(!isNaN(a)){if(0<a)throw RangeError();if(Jr(n))return m(n,{from:i,to:s,d:1});var c=n.l,a=n.r;if(Te(s,n.from)<0)return c?In(c,i,s):n.l={from:i,to:s,d:1,l:null,r:null},to(n);if(0<Te(i,n.to))return a?In(a,i,s):n.r={from:i,to:s,d:1,l:null,r:null},to(n);Te(i,n.from)<0&&(n.from=i,n.l=null,n.d=a?a.d+1:1),0<Te(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&jn(n,c),a&&s&&jn(n,a)}}function jn(n,i){Jr(i)||(function s(a,w){var d=w.from,g=w.to,v=w.l,w=w.r;In(a,d,g),v&&s(a,v),w&&s(a,w)})(n,i)}function eo(n,i){var s=ur(i),a=s.next();if(a.done)return!1;for(var c=a.value,d=ur(n),g=d.next(c.from),v=g.value;!a.done&&!g.done;){if(Te(v.from,c.to)<=0&&0<=Te(v.to,c.from))return!0;Te(c.from,v.from)<0?c=(a=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function ur(n){var i=Jr(n)?null:{s:0,n};return{next:function(s){for(var a=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,a)for(;i.n.l&&Te(s,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!a||Te(s,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function to(n){var i,s,a=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<a?"r":a<-1?"l":"";c&&(i=c=="r"?"l":"r",s=o({},n),a=n[c],n.from=a.from,n.to=a.to,n[c]=a[c],s[c]=a[i],(n[i]=s).d=no(s)),n.d=no(n)}function no(s){var i=s.r,s=s.l;return(i?s?Math.max(i.d,s.d):i.d:s?s.d:0)+1}function cr(n,i){return p(i).forEach(function(s){n[s]?jn(n[s],i[s]):n[s]=(function a(c){var d,g,v={};for(d in c)b(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||J.has(g.constructor)?g:a(g));return v})(i[s])}),n}function ei(n,i){return n.all||i.all||Object.keys(n).some(function(s){return i[s]&&eo(i[s],n[s])})}P($e.prototype,((st={add:function(n){return jn(this,n),this},addKey:function(n){return In(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(s){return In(i,s,s)}),this},hasKey:function(n){var i=ur(this).next(n).value;return i&&Te(i.from,n)<=0&&0<=Te(i.to,n)}})[me]=function(){return ur(this)},st));var Vt={},ti={},ni=!1;function fr(n){cr(ti,n),ni||(ni=!0,setTimeout(function(){ni=!1,ri(ti,!(ti={}))},0))}function ri(n,i){i===void 0&&(i=!1);var s=new Set;if(n.all)for(var a=0,c=Object.values(Vt);a<c.length;a++)ro(g=c[a],n,s,i);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Vt["idb://".concat(d,"/").concat(v)])&&ro(g,n,s,i))}s.forEach(function(w){return w()})}function ro(n,i,s,a){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],w=v[0],C=[],_=0,y=v[1];_<y.length;_++){var D=y[_];ei(i,D.obsSet)?D.subscribers.forEach(function(O){return s.add(O)}):a&&C.push(D)}a&&c.push([w,C])}if(a)for(var x=0,S=c;x<S.length;x++){var M=S[x],w=M[0],C=M[1];n.queries.query[w]=C}}function ka(n){var i=n._state,s=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?Ne(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var a=i.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(i.openCanceller!==a)throw new ne.DatabaseClosed("db.open() was cancelled")}function v(){return new te(function(D,x){if(g(),!s)throw new ne.MissingAPI;var S=n.name,M=i.autoSchema||!c?s.open(S):s.open(S,c);if(!M)throw new ne.MissingAPI;M.onerror=gt(x),M.onblocked=Ke(n._fireOnBlocked),M.onupgradeneeded=Ke(function(O){var j;_=M.transaction,i.autoSchema&&!n._options.allowEmptyDB?(M.onerror=Pn,_.abort(),M.result.close(),(j=s.deleteDatabase(S)).onsuccess=j.onerror=Ke(function(){x(new ne.NoSuchDatabase("Database ".concat(S," doesnt exist")))})):(_.onerror=gt(x),O=O.oldVersion>Math.pow(2,62)?0:O.oldVersion,y=O<1,n.idbdb=M.result,d&&xa(n,_),Ca(n,O/10,_,x))},x),M.onsuccess=Ke(function(){_=null;var O,j,A,U,Z,H=n.idbdb=M.result,Q=V(H.objectStoreNames);if(0<Q.length)try{var $=H.transaction((U=Q).length===1?U[0]:U,"readonly");if(i.autoSchema)j=H,A=$,(O=n).verno=j.version/10,A=O._dbSchema=ar(0,j,A),O._storeNames=V(j.objectStoreNames,0),or(O,[O._allTables],p(A),A);else if(lr(n,n._dbSchema,$),((Z=Hr(ar(0,(Z=n).idbdb,$),Z._dbSchema)).add.length||Z.change.some(function(Y){return Y.add.length||Y.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),H.close(),c=H.version+1,d=!0,D(v());ir(n,$)}catch{}dn.push(n),H.onversionchange=Ke(function(Y){i.vcFired=!0,n.on("versionchange").fire(Y)}),H.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),y&&(Z=n._deps,$=S,H=Z.indexedDB,Z=Z.IDBKeyRange,Xr(H)||$===Qn||Yr(H,Z).put({name:$}).catch(Ee)),D()},x)}).catch(function(D){switch(D?.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return te.reject(D)})}var w,C=i.dbReadyResolve,_=null,y=!1;return te.race([a,(typeof navigator>"u"?te.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function x(){return indexedDB.databases().finally(D)}w=setInterval(x,100),x()}).finally(function(){return clearInterval(w)}):Promise.resolve()).then(v)]).then(function(){return g(),i.onReadyBeingFired=[],te.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function D(){if(0<i.onReadyBeingFired.length){var x=i.onReadyBeingFired.reduce(on,Ee);return i.onReadyBeingFired=[],te.resolve(Qr(function(){return x(n.vip)})).then(D)}})}).finally(function(){i.openCanceller===a&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(D){i.dbOpenError=D;try{_&&_.abort()}catch{}return a===i.openCanceller&&n._close(),Ne(D)}).finally(function(){i.openComplete=!0,C()}).then(function(){var D;return y&&(D={},n.tables.forEach(function(x){x.schema.indexes.forEach(function(S){S.name&&(D["idb://".concat(n.name,"/").concat(x.name,"/").concat(S.name)]=new $e(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(x.name,"/")]=D["idb://".concat(n.name,"/").concat(x.name,"/:dels")]=new $e(-1/0,[[[]]])}),Rt(_n).fire(D),ri(D,!0)),n})}function ii(n){function i(d){return n.next(d)}var s=c(i),a=c(function(d){return n.throw(d)});function c(d){return function(w){var v=d(w),w=v.value;return v.done?w:w&&typeof w.then=="function"?w.then(s,a):h(w)?Promise.all(w).then(s,a):s(w)}}return c(i)()}function dr(n,i,s){for(var a=h(n)?n.slice():[n],c=0;c<s;++c)a.push(i);return a}var Sa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema,c={},d=[];function g(y,D,x){var S=Dn(y),M=c[S]=c[S]||[],O=y==null?0:typeof y=="string"?1:y.length,j=0<D,j=o(o({},x),{name:j?"".concat(S,"(virtual-from:").concat(x.name,")"):x.name,lowLevelIndex:x,isVirtual:j,keyTail:D,keyLength:O,extractKey:Vr(y),unique:!j&&x.unique});return M.push(j),j.isPrimaryKey||d.push(j),1<O&&g(O===2?y[0]:y.slice(0,O-1),D+1,x),M.sort(function(A,U){return A.keyTail-U.keyTail}),j}i=g(a.primaryKey.keyPath,0,a.primaryKey),c[":id"]=[i];for(var v=0,w=a.indexes;v<w.length;v++){var C=w[v];g(C.keyPath,0,C)}function _(y){var D,x=y.query.index;return x.isVirtual?o(o({},y),{query:{index:x.lowLevelIndex,range:(D=y.query.range,x=x.keyTail,{type:D.type===1?2:D.type,lower:dr(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,x),lowerOpen:!0,upper:dr(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,x),upperOpen:!0})}}):y}return o(o({},s),{schema:o(o({},a),{primaryKey:i,indexes:d,getIndexByKeyPath:function(y){return(y=c[Dn(y)])&&y[0]}}),count:function(y){return s.count(_(y))},query:function(y){return s.query(_(y))},openCursor:function(y){var D=y.query.index,x=D.keyTail,S=D.isVirtual,M=D.keyLength;return S?s.openCursor(_(y)).then(function(j){return j&&O(j)}):s.openCursor(y);function O(j){return Object.create(j,{continue:{value:function(A){A!=null?j.continue(dr(A,y.reverse?n.MAX_KEY:n.MIN_KEY,x)):y.unique?j.continue(j.key.slice(0,M).concat(y.reverse?n.MIN_KEY:n.MAX_KEY,x)):j.continue()}},continuePrimaryKey:{value:function(A,U){j.continuePrimaryKey(dr(A,n.MAX_KEY,x),U)}},primaryKey:{get:function(){return j.primaryKey}},key:{get:function(){var A=j.key;return M===1?A[0]:A.slice(0,M)}},value:{get:function(){return j.value}}})}}})}})}};function oi(n,i,s,a){return s=s||{},a=a||"",p(n).forEach(function(c){var d,g,v;b(i,c)?(d=n[c],g=i[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=le(d))!==le(g)?s[a+c]=i[c]:v==="Object"?oi(d,g,s,a+c+"."):d!==g&&(s[a+c]=i[c]):d!==g&&(s[a+c]=i[c])):s[a+c]=void 0}),p(i).forEach(function(c){b(n,c)||(s[a+c]=i[c])}),s}function si(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var Ma={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema.primaryKey;return o(o({},s),{mutate:function(c){var d=ue.trans,g=d.table(i).hook,v=g.deleting,w=g.creating,C=g.updating;switch(c.type){case"add":if(w.fire===Ee)break;return d._promise("readwrite",function(){return _(c)},!0);case"put":if(w.fire===Ee&&C.fire===Ee)break;return d._promise("readwrite",function(){return _(c)},!0);case"delete":if(v.fire===Ee)break;return d._promise("readwrite",function(){return _(c)},!0);case"deleteRange":if(v.fire===Ee)break;return d._promise("readwrite",function(){return(function y(D,x,S){return s.query({trans:D,values:!1,query:{index:a,range:x},limit:S}).then(function(M){var O=M.result;return _({type:"delete",keys:O,trans:D}).then(function(j){return 0<j.numFailures?Promise.reject(j.failures[0]):O.length<S?{failures:[],numFailures:0,lastResult:void 0}:y(D,o(o({},x),{lower:O[O.length-1],lowerOpen:!0}),S)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function _(y){var D,x,S,M=ue.trans,O=y.keys||si(a,y);if(!O)throw new Error("Keys missing");return(y=y.type==="add"||y.type==="put"?o(o({},y),{keys:O}):o({},y)).type!=="delete"&&(y.values=l([],y.values)),y.keys&&(y.keys=l([],y.keys)),D=s,S=O,((x=y).type==="add"?Promise.resolve([]):D.getMany({trans:x.trans,keys:S,cache:"immutable"})).then(function(j){var A=O.map(function(U,Z){var H,Q,$,Y=j[Z],ee={onerror:null,onsuccess:null};return y.type==="delete"?v.fire.call(ee,U,Y,M):y.type==="add"||Y===void 0?(H=w.fire.call(ee,U,y.values[Z],M),U==null&&H!=null&&(y.keys[Z]=U=H,a.outbound||F(y.values[Z],a.keyPath,U))):(H=oi(Y,y.values[Z]),(Q=C.fire.call(ee,H,U,Y,M))&&($=y.values[Z],Object.keys(Q).forEach(function(X){b($,X)?$[X]=Q[X]:F($,X,Q[X])}))),ee});return s.mutate(y).then(function(U){for(var Z=U.failures,H=U.results,Q=U.numFailures,U=U.lastResult,$=0;$<O.length;++$){var Y=(H||O)[$],ee=A[$];Y==null?ee.onerror&&ee.onerror(Z[$]):ee.onsuccess&&ee.onsuccess(y.type==="put"&&j[$]?y.values[$]:Y)}return{failures:Z,results:H,numFailures:Q,lastResult:U}}).catch(function(U){return A.forEach(function(Z){return Z.onerror&&Z.onerror(U)}),Promise.reject(U)})})}}})}})}};function io(n,i,s){try{if(!i||i.keys.length<n.length)return null;for(var a=[],c=0,d=0;c<i.keys.length&&d<n.length;++c)Te(i.keys[c],n[d])===0&&(a.push(s?de(i.values[c]):i.values[c]),++d);return a.length===n.length?a:null}catch{return null}}var Pa={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var s=n.table(i);return o(o({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var c=io(a.keys,a.trans._cache,a.cache==="clone");return c?te.resolve(c):s.getMany(a).then(function(d){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?de(d):d},d})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function oo(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function so(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,s=new $e(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(a,c,d){if(ue.subscr&&c!=="readonly")throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ue.querier));return n.transaction(a,c,d)},table:function(a){var c=n.table(a),d=c.schema,g=d.primaryKey,y=d.indexes,v=g.extractKey,w=g.outbound,C=g.autoIncrement&&y.filter(function(x){return x.compound&&x.keyPath.includes(g.keyPath)}),_=o(o({},c),{mutate:function(x){function S(X){return X="idb://".concat(i,"/").concat(a,"/").concat(X),U[X]||(U[X]=new $e)}var M,O,j,A=x.trans,U=x.mutatedParts||(x.mutatedParts={}),Z=S(""),H=S(":dels"),Q=x.type,ee=x.type==="deleteRange"?[x.range]:x.type==="delete"?[x.keys]:x.values.length<50?[si(g,x).filter(function(X){return X}),x.values]:[],$=ee[0],Y=ee[1],ee=x.trans._cache;return h($)?(Z.addKeys($),(ee=Q==="delete"||$.length===Y.length?io($,ee):null)||H.addKeys($),(ee||Y)&&(M=S,O=ee,j=Y,d.indexes.forEach(function(X){var oe=M(X.name||"");function Le(_e){return _e!=null?X.extractKey(_e):null}function ke(_e){return X.multiEntry&&h(_e)?_e.forEach(function(tt){return oe.addKey(tt)}):oe.addKey(_e)}(O||j).forEach(function(_e,He){var we=O&&Le(O[He]),He=j&&Le(j[He]);Te(we,He)!==0&&(we!=null&&ke(we),He!=null&&ke(He))})}))):$?(Y={from:(Y=$.lower)!==null&&Y!==void 0?Y:n.MIN_KEY,to:(Y=$.upper)!==null&&Y!==void 0?Y:n.MAX_KEY},H.add(Y),Z.add(Y)):(Z.add(s),H.add(s),d.indexes.forEach(function(X){return S(X.name).add(s)})),c.mutate(x).then(function(X){return!$||x.type!=="add"&&x.type!=="put"||(Z.addKeys(X.results),C&&C.forEach(function(oe){for(var Le=x.values.map(function(we){return oe.extractKey(we)}),ke=oe.keyPath.findIndex(function(we){return we===g.keyPath}),_e=0,tt=X.results.length;_e<tt;++_e)Le[_e][ke]=X.results[_e];S(oe.name).addKeys(Le)})),A.mutatedParts=cr(A.mutatedParts||{},U),X})}}),y=function(S){var M=S.query,S=M.index,M=M.range;return[S,new $e((S=M.lower)!==null&&S!==void 0?S:n.MIN_KEY,(M=M.upper)!==null&&M!==void 0?M:n.MAX_KEY)]},D={get:function(x){return[g,new $e(x.key)]},getMany:function(x){return[g,new $e().addKeys(x.keys)]},count:y,query:y,openCursor:y};return p(D).forEach(function(x){_[x]=function(S){var M=ue.subscr,O=!!M,j=oo(ue,c)&&so(x,S)?S.obsSet={}:M;if(O){var A=function(Y){return Y="idb://".concat(i,"/").concat(a,"/").concat(Y),j[Y]||(j[Y]=new $e)},U=A(""),Z=A(":dels"),M=D[x](S),O=M[0],M=M[1];if((x==="query"&&O.isPrimaryKey&&!S.values?Z:A(O.name||"")).add(M),!O.isPrimaryKey){if(x!=="count"){var H=x==="query"&&w&&S.values&&c.query(o(o({},S),{values:!1}));return c[x].apply(this,arguments).then(function(Y){if(x==="query"){if(w&&S.values)return H.then(function(Le){return Le=Le.result,U.addKeys(Le),Y});var ee=S.values?Y.result.map(v):Y.result;(S.values?U:Z).addKeys(ee)}else if(x==="openCursor"){var X=Y,oe=S.values;return X&&Object.create(X,{key:{get:function(){return Z.addKey(X.primaryKey),X.key}},primaryKey:{get:function(){var Le=X.primaryKey;return Z.addKey(Le),Le}},value:{get:function(){return oe&&U.addKey(X.primaryKey),X.value}}})}return Y})}Z.add(s)}}return c[x].apply(this,arguments)}}),_}})}};function ao(n,i,s){if(s.numFailures===0)return i;if(i.type==="deleteRange")return null;var a=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return s.numFailures===a?null:(i=o({},i),h(i.keys)&&(i.keys=i.keys.filter(function(c,d){return!(d in s.failures)})),"values"in i&&h(i.values)&&(i.values=i.values.filter(function(c,d){return!(d in s.failures)})),i)}function ai(n,i){return s=n,((a=i).lower===void 0||(a.lowerOpen?0<Te(s,a.lower):0<=Te(s,a.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Te(n,i.upper)<0:Te(n,i.upper)<=0));var s,a}function lo(n,i,D,a,c,d){if(!D||D.length===0)return n;var g=i.query.index,v=g.multiEntry,w=i.query.range,C=a.schema.primaryKey.extractKey,_=g.extractKey,y=(g.lowLevelIndex||g).extractKey,D=D.reduce(function(x,S){var M=x,O=[];if(S.type==="add"||S.type==="put")for(var j=new $e,A=S.values.length-1;0<=A;--A){var U,Z=S.values[A],H=C(Z);j.hasKey(H)||(U=_(Z),(v&&h(U)?U.some(function(X){return ai(X,w)}):ai(U,w))&&(j.addKey(H),O.push(Z)))}switch(S.type){case"add":var Q=new $e().addKeys(i.values?x.map(function(oe){return C(oe)}):x),M=x.concat(i.values?O.filter(function(oe){return oe=C(oe),!Q.hasKey(oe)&&(Q.addKey(oe),!0)}):O.map(function(oe){return C(oe)}).filter(function(oe){return!Q.hasKey(oe)&&(Q.addKey(oe),!0)}));break;case"put":var $=new $e().addKeys(S.values.map(function(oe){return C(oe)}));M=x.filter(function(oe){return!$.hasKey(i.values?C(oe):oe)}).concat(i.values?O:O.map(function(oe){return C(oe)}));break;case"delete":var Y=new $e().addKeys(S.keys);M=x.filter(function(oe){return!Y.hasKey(i.values?C(oe):oe)});break;case"deleteRange":var ee=S.range;M=x.filter(function(oe){return!ai(C(oe),ee)})}return M},n);return D===n?n:(D.sort(function(x,S){return Te(y(x),y(S))||Te(C(x),C(S))}),i.limit&&i.limit<1/0&&(D.length>i.limit?D.length=i.limit:n.length===i.limit&&D.length<i.limit&&(c.dirty=!0)),d?Object.freeze(D):D)}function uo(n,i){return Te(n.lower,i.lower)===0&&Te(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function Oa(n,i){return(function(s,a,c,d){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=Te(s,a))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return a})(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=(function(s,a,c,d){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=Te(s,a))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return a})(n.upper,i.upper,n.upperOpen,i.upperOpen)}function Da(n,i,s,a){n.subscribers.add(s),a.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=i,setTimeout(function(){c.subscribers.size===0&&he(d,c)},3e3))})}var Ia={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(s,a,c){var d,g,v=n.transaction(s,a,c);return a==="readwrite"&&(g=(d=new AbortController).signal,c=function(w){return function(){if(d.abort(),a==="readwrite"){for(var C=new Set,_=0,y=s;_<y.length;_++){var D=y[_],x=Vt["idb://".concat(i,"/").concat(D)];if(x){var S=n.table(D),M=x.optimisticOps.filter(function(oe){return oe.trans===v});if(v._explicit&&w&&v.mutatedParts)for(var O=0,j=Object.values(x.queries.query);O<j.length;O++)for(var A=0,U=(Q=j[O]).slice();A<U.length;A++)ei(($=U[A]).obsSet,v.mutatedParts)&&(he(Q,$),$.subscribers.forEach(function(oe){return C.add(oe)}));else if(0<M.length){x.optimisticOps=x.optimisticOps.filter(function(oe){return oe.trans!==v});for(var Z=0,H=Object.values(x.queries.query);Z<H.length;Z++)for(var Q,$,Y,ee=0,X=(Q=H[Z]).slice();ee<X.length;ee++)($=X[ee]).res!=null&&v.mutatedParts&&(w&&!$.dirty?(Y=Object.isFrozen($.res),Y=lo($.res,$.req,M,S,$,Y),$.dirty?(he(Q,$),$.subscribers.forEach(function(oe){return C.add(oe)})):Y!==$.res&&($.res=Y,$.promise=te.resolve({result:Y}))):($.dirty&&he(Q,$),$.subscribers.forEach(function(oe){return C.add(oe)})))}}}C.forEach(function(oe){return oe()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var a=n.table(s),c=a.schema.primaryKey;return o(o({},a),{mutate:function(d){var g=ue.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return a.mutate(d);var v=Vt["idb://".concat(i,"/").concat(s)];return v?(g=a.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||si(c,d).some(function(w){return w==null}))?(v.optimisticOps.push(d),d.mutatedParts&&fr(d.mutatedParts),g.then(function(w){0<w.numFailures&&(he(v.optimisticOps,d),(w=ao(0,d,w))&&v.optimisticOps.push(w),d.mutatedParts&&fr(d.mutatedParts))}),g.catch(function(){he(v.optimisticOps,d),d.mutatedParts&&fr(d.mutatedParts)})):g.then(function(w){var C=ao(0,o(o({},d),{values:d.values.map(function(_,y){var D;return w.failures[y]?_:(_=(D=c.keyPath)!==null&&D!==void 0&&D.includes(".")?de(_):o({},_),F(_,c.keyPath,w.results[y]),_)})}),w);v.optimisticOps.push(C),queueMicrotask(function(){return d.mutatedParts&&fr(d.mutatedParts)})}),g):a.mutate(d)},query:function(d){if(!oo(ue,a)||!so("query",d))return a.query(d);var g=((C=ue.trans)===null||C===void 0?void 0:C.db._options.cache)==="immutable",y=ue,v=y.requery,w=y.signal,C=(function(S,M,O,j){var A=Vt["idb://".concat(S,"/").concat(M)];if(!A)return[];if(!(M=A.queries[O]))return[null,!1,A,null];var U=M[(j.query?j.query.index.name:null)||""];if(!U)return[null,!1,A,null];switch(O){case"query":var Z=U.find(function(H){return H.req.limit===j.limit&&H.req.values===j.values&&uo(H.req.query.range,j.query.range)});return Z?[Z,!0,A,U]:[U.find(function(H){return("limit"in H.req?H.req.limit:1/0)>=j.limit&&(!j.values||H.req.values)&&Oa(H.req.query.range,j.query.range)}),!1,A,U];case"count":return Z=U.find(function(H){return uo(H.req.query.range,j.query.range)}),[Z,!!Z,A,U]}})(i,s,"query",d),_=C[0],y=C[1],D=C[2],x=C[3];return _&&y?_.obsSet=d.obsSet:(y=a.query(d).then(function(S){var M=S.result;if(_&&(_.res=M),g){for(var O=0,j=M.length;O<j;++O)Object.freeze(M[O]);Object.freeze(M)}else S.result=de(M);return S}).catch(function(S){return x&&_&&he(x,_),Promise.reject(S)}),_={obsSet:d.obsSet,promise:y,subscribers:new Set,type:"query",req:d,dirty:!1},x?x.push(_):(x=[_],(D=D||(Vt["idb://".concat(i,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=x)),Da(_,x,v,w),_.promise.then(function(S){return{result:lo(S.result,d,D?.optimisticOps,a,_,g)}})}})}})}};function pr(n,i){return new Proxy(n,{get:function(s,a,c){return a==="db"?i:Reflect.get(s,a,c)}})}var Et=(qe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ne.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,s=i.filter(function(a){return a._cfg.version===n})[0];return s||(s=new this.Version(n),i.push(s),i.sort(La),s.stores({}),this._state.autoSchema=!1,s)},qe.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||ue.letThrough||this._vip)?n():new te(function(s,a){if(i._state.openComplete)return a(new ne.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void a(new ne.DatabaseClosed);i.open().catch(Ee)}i._state.dbReadyPromise.then(s,a)}).then(n)},qe.prototype.use=function(n){var i=n.stack,s=n.create,a=n.level,c=n.name;return c&&this.unuse({stack:i,name:c}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:s,level:a??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},qe.prototype.unuse=function(n){var i=n.stack,s=n.name,a=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return a?c.create!==a:!!s&&c.name!==s})),this},qe.prototype.open=function(){var n=this;return qt(Je,function(){return ka(n)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,i=dn.indexOf(this);if(0<=i&&dn.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new te(function(s){n.dbReadyResolve=s}),n.openCanceller=new te(function(s,a){n.cancelOpen=a}))},qe.prototype.close=function(s){var i=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;i?(s.isBeingOpened&&s.cancelOpen(new ne.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new ne.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},qe.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new te(function(c,d){function g(){i.close(n);var v=i._deps.indexedDB.deleteDatabase(i.name);v.onsuccess=Ke(function(){var w,C,_;w=i._deps,C=i.name,_=w.indexedDB,w=w.IDBKeyRange,Xr(_)||C===Qn||Yr(_,w).delete(C).catch(Ee),c()}),v.onerror=gt(d),v.onblocked=i._fireOnBlocked}if(s)throw new ne.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(g):g()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var n=(function(i,s,a){var c=arguments.length;if(c<2)throw new ne.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return a=d.pop(),[i,re(d),a]}).apply(this,arguments);return this._transaction.apply(this,n)},qe.prototype._transaction=function(n,i,s){var a=this,c=ue.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=i.map(function(C){if(C=C instanceof a.Table?C.name:C,typeof C!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return C}),n=="r"||n===Ur)d=Ur;else{if(n!="rw"&&n!=Fr)throw new ne.InvalidArgument("Invalid transaction mode: "+n);d=Fr}if(c){if(c.mode===Ur&&d===Fr){if(!v)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(C){if(c&&c.storeNames.indexOf(C)===-1){if(!v)throw new ne.SubTransaction("Table "+C+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(C){return c?c._promise(null,function(_,y){y(C)}):Ne(C)}var w=(function C(_,y,D,x,S){return te.resolve().then(function(){var M=ue.transless||ue,O=_._createTransaction(y,D,_._dbSchema,x);if(O.explicit=!0,M={trans:O,transless:M},x)O.idbtrans=x.idbtrans;else try{O.create(),O.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(U){return U.name===Ae.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return C(_,y,D,null,S)})):Ne(U)}var j,A=Me(S);return A&&fn(),M=te.follow(function(){var U;(j=S.call(O,O))&&(A?(U=Dt.bind(null,null),j.then(U,U)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=ii(j)))},M),(j&&typeof j.then=="function"?te.resolve(j).then(function(U){return O.active?U:Ne(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):M.then(function(){return j})).then(function(U){return x&&O._resolve(),O._completion.then(function(){return U})}).catch(function(U){return O._reject(U),Ne(U)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,w,"lock"):ue.trans?qt(ue.transless,function(){return a._whenReady(w)}):this._whenReady(w)},qe.prototype.table=function(n){if(!b(this._allTables,n))throw new ne.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},qe);function qe(n,i){var s=this;this._middlewares={},this.verno=0;var a=qe.dependencies;this._options=i=o({addons:qe.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},a=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,w,C={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ee,dbReadyPromise:null,cancelOpen:Ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};C.dbReadyPromise=new te(function(y){C.dbReadyResolve=y}),C.openCanceller=new te(function(y,D){C.cancelOpen=D}),this._state=C,this.name=n,this.on=Sn(this,"populate","blocked","versionchange","close",{ready:[on,Ee]}),this.once=function(y,D){var x=function(){for(var S=[],M=0;M<arguments.length;M++)S[M]=arguments[M];s.on(y).unsubscribe(x),D.apply(s,S)};return s.on(y,x)},this.on.ready.subscribe=se(this.on.ready.subscribe,function(y){return function(D,x){qe.vip(function(){var S,M=s._state;M.openComplete?(M.dbOpenError||te.resolve().then(D),x&&y(D)):M.onReadyBeingFired?(M.onReadyBeingFired.push(D),x&&y(D)):(y(D),S=s,x||y(function O(){S.on.ready.unsubscribe(D),S.on.ready.unsubscribe(O)}))})}}),this.Collection=(c=this,Mn(ha.prototype,function(j,O){this.db=c;var x=zi,S=null;if(O)try{x=O()}catch(A){S=A}var M=j._ctx,O=M.table,j=O.hook.reading.fire;this._ctx={table:O,index:M.index,isPrimKey:!M.index||O.schema.primKey.keyPath&&M.index===O.schema.primKey.name,range:x,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:S,or:M.or,valueMapper:j!==Ye?j:null}})),this.Table=(d=this,Mn(Wi.prototype,function(y,D,x){this.db=d,this._tx=x,this.name=y,this.schema=D,this.hook=d._allTables[y]?d._allTables[y].hook:Sn(null,{creating:[Zn,Ee],reading:[Nt,Ye],updating:[Vn,Ee],deleting:[nn,Ee]})})),this.Transaction=(g=this,Mn(va.prototype,function(y,D,x,S,M){var O=this;y!=="readonly"&&D.forEach(function(j){j=(j=x[j])===null||j===void 0?void 0:j.yProps,j&&(D=D.concat(j.map(function(A){return A.updatesTable})))}),this.db=g,this.mode=y,this.storeNames=D,this.schema=x,this.chromeTransactionDurability=S,this.idbtrans=null,this.on=Sn(this,"complete","error","abort"),this.parent=M||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new te(function(j,A){O._resolve=j,O._reject=A}),this._completion.then(function(){O.active=!1,O.on.complete.fire()},function(j){var A=O.active;return O.active=!1,O.on.error.fire(j),O.parent?O.parent._reject(j):A&&O.idbtrans&&O.idbtrans.abort(),Ne(j)})})),this.Version=(v=this,Mn(Ea.prototype,function(y){this.db=v,this._cfg={version:y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(w=this,Mn(Gi.prototype,function(y,D,x){if(this.db=w,this._ctx={table:y,index:D===":id"?null:D,or:x},this._cmp=this._ascending=Te,this._descending=function(S,M){return Te(M,S)},this._max=function(S,M){return 0<Te(S,M)?S:M},this._min=function(S,M){return Te(S,M)<0?S:M},this._IDBKeyRange=w._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI})),this.on("versionchange",function(y){0<y.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(y){!y.newVersion||y.newVersion<y.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(y.oldVersion/10))}),this._maxKey=On(i.IDBKeyRange),this._createTransaction=function(y,D,x,S){return new s.Transaction(y,D,x,s._options.chromeTransactionDurability,S)},this._fireOnBlocked=function(y){s.on("blocked").fire(y),dn.filter(function(D){return D.name===s.name&&D!==s&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(y)})},this.use(Pa),this.use(Ia),this.use(_a),this.use(Sa),this.use(Ma);var _=new Proxy(this,{get:function(y,D,x){if(D==="_vip")return!0;if(D==="table")return function(M){return pr(s.table(M),_)};var S=Reflect.get(y,D,x);return S instanceof Wi?pr(S,_):D==="tables"?S.map(function(M){return pr(M,_)}):D==="_createTransaction"?function(){return pr(S.apply(this,arguments),_)}:S}});this.vip=_,a.forEach(function(y){return y(s)})}var hr,st=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ja=(li.prototype.subscribe=function(n,i,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:s})},li.prototype[st]=function(){return this},li);function li(n){this._subscribe=n}try{hr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{hr={indexedDB:null,IDBKeyRange:null}}function co(n){var i,s=!1,a=new ja(function(c){var d=Me(n),g,v=!1,w={},C={},_={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),y&&Rt.storagemutated.unsubscribe(x))}};c.start&&c.start(_);var y=!1,D=function(){return zr(S)},x=function(M){cr(w,M),ei(C,w)&&D()},S=function(){var M,O,j;!v&&hr.indexedDB&&(w={},M={},g&&g.abort(),g=new AbortController,j=(function(A){var U=Lt();try{d&&fn();var Z=Ot(n,A);return Z=d?Z.finally(Dt):Z}finally{U&&_t()}})(O={subscr:M,signal:g.signal,requery:D,querier:n,trans:null}),Promise.resolve(j).then(function(A){s=!0,i=A,v||O.signal.aborted||(w={},(function(U){for(var Z in U)if(b(U,Z))return;return 1})(C=M)||y||(Rt(_n,x),y=!0),zr(function(){return!v&&c.next&&c.next(A)}))},function(A){s=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||v||zr(function(){v||c.error&&c.error(A)})}))};return setTimeout(D,0),_});return a.hasValue=function(){return s},a.getValue=function(){return i},a}var $t=Et;function ui(n){var i=Tt;try{Tt=!0,Rt.storagemutated.fire(n),ri(n,!0)}finally{Tt=i}}P($t,o(o({},Ie),{delete:function(n){return new $t(n,{addons:[]}).delete()},exists:function(n){return new $t(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=$t.dependencies,s=i.indexedDB,i=i.IDBKeyRange,(Xr(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Yr(s,i).toCollection().primaryKeys()).then(n)}catch{return Ne(new ne.MissingAPI)}var i,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return ue.trans?qt(ue.transless,n):n()},vip:Qr,async:function(n){return function(){try{var i=ii(n.apply(this,arguments));return i&&typeof i.then=="function"?i:te.resolve(i)}catch(s){return Ne(s)}}},spawn:function(n,i,s){try{var a=ii(n.apply(s,i||[]));return a&&typeof a.then=="function"?a:te.resolve(a)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return ue.trans||null}},waitFor:function(n,i){return i=te.resolve(typeof n=="function"?$t.ignoreTransaction(n):n).timeout(i||6e4),ue.trans?ue.trans.waitFor(i):i},Promise:te,debug:{get:function(){return Xe},set:function(n){Ln(n)}},derive:W,extend:m,props:P,override:se,Events:Sn,on:Rt,liveQuery:co,extendObservabilitySet:cr,getByKeyPath:I,setByKeyPath:F,delByKeyPath:function(n,i){typeof i=="string"?F(n,i,void 0):"length"in i&&[].map.call(i,function(s){F(n,s,void 0)})},shallowClone:ie,deepClone:de,getObjectDiff:oi,cmp:Te,asap:B,minKey:-1/0,addons:[],connections:dn,errnames:Ae,dependencies:hr,cache:Vt,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,s){return n+i/Math.pow(10,2*s)})})),$t.maxKey=On($t.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Rt(_n,function(n){Tt||(n=new CustomEvent(qr,{detail:n}),Tt=!0,dispatchEvent(n),Tt=!1)}),addEventListener(qr,function(n){n=n.detail,Tt||ui(n)}));var mn,Tt=!1,fo=function(){};return typeof BroadcastChannel<"u"&&((fo=function(){(mn=new BroadcastChannel(qr)).onmessage=function(n){return n.data&&ui(n.data)}})(),typeof mn.unref=="function"&&mn.unref(),Rt(_n,function(n){Tt||mn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Et.disableBfCache&&n.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),mn?.close();for(var i=0,s=dn;i<s.length;i++)s[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Et.disableBfCache&&n.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),fo(),ui({all:new $e(-1/0,[[]])}))})),te.rejectionMapper=function(n,i){return!n||n instanceof pe||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ge[n.name]?n:(i=new ge[n.name](i||n.message,n),"stack"in n&&k(i,"stack",{get:function(){return this.inner.stack}}),i)},Ln(Xe),o(Et,Object.freeze({__proto__:null,Dexie:Et,liveQuery:co,Entity:Ui,cmp:Te,PropModification:kn,replacePrefix:function(n,i){return new kn({replacePrefix:[n,i]})},add:function(n){return new kn({add:n})},remove:function(n){return new kn({remove:n})},default:Et,RangeSet:$e,mergeRanges:jn,rangesOverlap:eo}),{default:Et}),Et})})(Lr)),Lr.exports}var rc=nc();const Mi=Ta(rc),Fs=Symbol.for("Dexie"),Rr=globalThis[Fs]||(globalThis[Fs]=Mi);if(Mi.semVer!==Rr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Mi.semVer} and ${Rr.semVer}`);const{liveQuery:Mc,mergeRanges:Pc,rangesOverlap:_c,RangeSet:Oc,cmp:Dc,Entity:Ic,PropModification:jc,replacePrefix:Rc,add:Tc,remove:Ac,DexieYProvider:Bc}=Rr,kt=new Rr("ChillGameDB");kt.version(1).stores({exploredCells:"id",claimedCells:"id",gameState:"key"});kt.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const Ks=5e-4,nt=Fu(ec((t,e)=>({clouds:10,claimedCells:{},exploredCells:{},selectedCell:null,userLocation:null,isHydrated:!1,hydrate:async()=>{try{const[r,o,l]=await Promise.all([kt.exploredCells.toArray(),kt.claimedCells.toArray(),kt.gameState.get("clouds")]),f={};r.forEach(h=>{f[h.id]=!0});const p={};o.forEach(h=>{p[h.id]=h.data}),t(h=>{h.exploredCells=f,h.claimedCells=p,h.clouds=l?l.value:10,h.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(o=>{o.isHydrated=!0})}},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:o,longitude:l}=r.coords;t(f=>{f.userLocation={lat:o,lng:l};const p=Math.floor(o/Ks),h=Math.floor(l/Ks),m=e().exploredCells;let E=!1;const L=2,b=[];for(let P=-L;P<=L;P++)for(let R=-L;R<=L;R++)if(P*P+R*R<=L*L){const k=`${p+P}_${h+R}`;m[k]||(f.exploredCells[k]=!0,b.push({id:k}),E=!0)}E&&b.length>0&&kt.exploredCells.bulkAdd(b).catch(P=>console.error("Failed to bulkAdd explored cells:",P))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const o=e().selectedCell,l=e().claimedCells;!r||o&&o.key===r.key||l[r.key]?t({selectedCell:null}):t({selectedCell:r})},updateSelectedCellInfo:r=>{t(o=>{o.selectedCell&&(o.selectedCell={...o.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:o}=e();if(!r)return"no-cell";if(o<=0)return"no-clouds";const{key:l}=r,f={owner:"user",color:"#3B82F6"};return t(p=>{p.clouds-=1,p.claimedCells[l]=f,p.selectedCell=null}),kt.claimedCells.put({id:l,data:f}).catch(p=>console.error("Failed to put claimed cell:",p)),kt.gameState.put({key:"clouds",value:e().clouds}).catch(p=>console.error("Failed to put clouds state:",p)),"claimed"},register:()=>{t({clouds:10}),kt.gameState.put({key:"clouds",value:10}).catch(r=>console.error("Failed to put clouds state on register:",r))}}))),Yt={container:{position:"fixed",bottom:"32px",left:"50%",transform:"translateX(-50%)",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0,0,0,0.2)",padding:"20px 28px",display:"flex",alignItems:"center",gap:"20px",fontFamily:"system-ui, sans-serif",color:"#222",zIndex:100,minWidth:"320px",transition:"transform 0.3s ease-out, opacity 0.3s ease-out"},flag:{width:"40px",height:"auto",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},infoContainer:{display:"flex",flexDirection:"column",gap:"4px",flexGrow:1},locationText:{fontSize:"18px",fontWeight:"bold"},coordsText:{fontSize:"14px",color:"#666"},claimButton:{backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"10px",padding:"12px 24px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",transition:"background-color 0.2s, transform 0.1s"},loadingText:{fontSize:"16px",color:"#555"}},ic=({cellInfo:t})=>{const e=nt(h=>h.claimSelectedCell);if(!t)return null;const[r,o]=t.key.split("_"),l=()=>{ra(),e()},f=h=>{h.target.style.transform="scale(0.95)"},p=h=>{h.target.style.transform="scale(1)"};return ce.jsx("div",{style:Yt.container,children:t.isLoading?ce.jsx("div",{style:Yt.loadingText,children:"正在取得地點資訊..."}):ce.jsxs(ce.Fragment,{children:[t.flagUrl&&ce.jsx("img",{src:t.flagUrl,alt:"Country Flag",style:Yt.flag}),ce.jsxs("div",{style:Yt.infoContainer,children:[ce.jsxs("div",{style:Yt.locationText,children:[t.countryName,t.regionName&&`, ${t.regionName}`]}),ce.jsxs("div",{style:Yt.coordsText,children:["座標 (X: ",o,", Y: ",r,")"]})]}),ce.jsx("button",{style:Yt.claimButton,onClick:l,onMouseDown:f,onMouseUp:p,onMouseLeave:p,children:"佔領"})]})})},ca=u.memo(ic),yi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},oc=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,sc=()=>(Jt.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=oc,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),ac=({position:t})=>ce.jsxs(ce.Fragment,{children:[ce.jsx(sc,{}),ce.jsx(Kt,{position:t,mapPaneName:Kt.MARKER_LAYER,children:ce.jsxs("div",{style:yi.pulseContainer,children:[ce.jsx("div",{style:yi.pulse}),ce.jsx("div",{style:yi.dot})]})})]}),lc=u.memo(ac),Bn=(t,e,r,o=null)=>new Promise(l=>{const f=t.getCenter(),p=t.getZoom(),h=Date.now(),m=()=>{const E=Date.now(),L=Math.min((E-h)/r,1),b=L*L*(3-2*L),P={lat:f.lat()+(e.lat-f.lat())*b,lng:f.lng()+(e.lng-f.lng())*b},R=o!==null?p+(o-p)*b:p;t.moveCamera({center:P,zoom:R}),L<1?requestAnimationFrame(m):l()};m()}),Bt=5e-4,uc={width:"100%",height:"100%"},cc={position:"absolute",inset:"0px",width:"100%",height:"100%"},fc=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],dc=({center:t,onSelectCell:e,claimedCells:r,exploredCells:o,setMapRef:l,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m})=>{const[E,L]=u.useState(null),[b,P]=u.useState(15),[R,k]=u.useState(null),W=u.useRef(null),q=u.useRef(!1),G=u.useCallback(I=>{k(I),l(I)},[l]),V=u.useCallback(()=>{if(R){const I=R.getZoom(),F=R.getCenter();f(I),p({lat:F.lat(),lng:F.lng()}),P(I)}},[R,f,p]);u.useEffect(()=>{(async()=>{R&&t&&!q.current&&(q.current=!0,await Bn(R,t,2e3,15),V())})()},[R,t,V]);const se=u.useCallback(I=>{W.current||(W.current=setTimeout(()=>{if(W.current=null,b<15){E&&L(null);return}const F=`${Math.floor(I.latLng.lat()/Bt)}_${Math.floor(I.latLng.lng()/Bt)}`;F!==E&&L(F)},50))},[b,E,L]),K=u.useCallback(()=>{L(null)},[L]),B=u.useCallback(I=>{if(b<15){e(null,null);return}const F=I.latLng.lat(),ie=I.latLng.lng(),N=Math.floor(F/Bt),re=Math.floor(ie/Bt),J=`${N}_${re}`,ae=N*Bt,de=re*Bt,fe=ae+Bt/2,le=de+Bt/2;e(J,{lat:fe,lng:le})},[b,e]);return ce.jsx("div",{className:"view-container fade-in",style:cc,children:ce.jsxs(Ga,{mapContainerStyle:uc,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:fc},onLoad:G,onIdle:V,onMouseMove:se,onMouseOut:K,onClick:B,children:[ce.jsx(Tu,{map:R,zoom:b,claimedCells:r,exploredCells:o,hoveredCell:E}),h&&ce.jsx(ca,{cellInfo:h}),m&&ce.jsx(lc,{position:m})]})})},pc=Jt.memo(dc),hc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},gc={fontSize:"24px"};function mc(){const t=nt(e=>e.clouds);return ce.jsxs("div",{style:hc,children:[ce.jsx("span",{style:gc,children:"☁️"}),ce.jsx("span",{children:t})]})}const vc=Jt.memo(mc),yc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},bc={fontSize:"28px"};function wc({onClick:t}){const[e,r]=u.useState(!1),o={...yc,transform:e?"scale(1.1)":"scale(1)"};return ce.jsx("button",{onClick:t,title:"Reset View",style:o,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:ce.jsx("span",{style:bc,children:"🧭"})})}const Lc=u.memo(wc),br=new Map,Ns=.5;function Cc(t){const e=nt(r=>r.updateSelectedCellInfo);u.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,o=`${Math.floor(r.lat/Ns)}_${Math.floor(r.lng/Ns)}`;(async()=>{if(br.has(o)){e(br.get(o));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,E=m.find(W=>W.types.includes("country")),L=m.find(W=>W.types.includes("administrative_area_level_1")),b=E?E.long_name:"未知領域",P=E?E.short_name.toLowerCase():null,R=L?L.long_name:"",k=P?`https://flagcdn.com/w40/${P}.png`:null;h={countryName:b,regionName:R,flagUrl:k}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};br.set(o,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};br.set(o,p),e(p)}})()},[t,e])}const xc=u.lazy(()=>Pi(()=>import("./Leaderboard-D8CP2BIb.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),Ec=u.lazy(()=>Pi(()=>import("./RegistrationModal-3UCvtYMU.js"),__vite__mapDeps([4,1,2]))),kc=u.lazy(()=>Pi(()=>import("./InfoModal-Bvyee4_k.js"),__vite__mapDeps([5,1,2]))),vt={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50}};function zc(){const{lat:t,lng:e}=Aa(),r=Ba(),[o,l]=u.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=u.useState(!1),h=u.useRef(null),m=nt(T=>T.claimedCells),E=nt(T=>T.exploredCells),L=nt(T=>T.selectedCell),b=nt(T=>T.userLocation),P=nt(T=>T.initializeGeolocation),R=nt(T=>T.selectCell),k=nt(T=>T.claimSelectedCell),W=nt(T=>T.register),q=nt(T=>T.isHydrated),G=nt(T=>T.hydrate);Cc(L);const{isLoaded:V}=al({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});u.useEffect(()=>{P()},[P]),u.useEffect(()=>{G()},[G]),u.useEffect(()=>{o||navigator.geolocation.getCurrentPosition(T=>{l({lat:T.coords.latitude,lng:T.coords.longitude})},()=>{l({lat:25.033,lng:121.5654})})},[o]);const[se,K]=u.useState(!1),[B,I]=u.useState(!1),[F,ie]=u.useState(!1),[N,re]=u.useState(10),J=u.useCallback(T=>{h.current=T},[]),ae=u.useCallback((T,Pe)=>{ra(),R(T?{key:T,position:Pe,isLoading:!0}:null)},[R]),de=u.useCallback(()=>{k()==="no-clouds"&&K(!0)},[k]),fe=u.useCallback(()=>{W(),K(!1)},[W]),le=u.useCallback(async()=>{if(!h.current)return;const T=h.current.getCenter(),Pe=T.lat(),Ae=T.lng();p(!0),await Bn(h.current,{lat:Pe,lng:Ae},1500,2),r("/",{state:{lat:Pe,lng:Ae}})},[r]),me=u.useCallback(async()=>{if(b&&h.current){const T=h.current,Pe=T.getCenter(),Ae={lat:Pe.lat(),lng:Pe.lng()};await Bn(T,Ae,1e3,5),await Bn(T,b,1500,5),await Bn(T,b,1e3,15)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[b]),Se=u.useCallback(T=>{re(T)},[]),he=u.useCallback(T=>{r(`/map/${T.lat.toFixed(7)}/${T.lng.toFixed(7)}`,{replace:!0})},[r]),ve=u.useCallback(()=>{h.current&&h.current.setZoom(h.current.getZoom()+1)},[]),ye=u.useCallback(()=>{h.current&&h.current.setZoom(h.current.getZoom()-1)},[]),Me=u.useCallback(()=>ie(!0),[]),De=u.useCallback(()=>K(!1),[]),pe=u.useCallback(()=>I(!1),[]),Be=u.useCallback(()=>ie(!1),[]);return!V||!o||!q?ce.jsx(po,{}):ce.jsxs("div",{style:vt.app,className:f?"map-container-fade-out":"",children:[ce.jsx(pc,{center:o,onSelectCell:ae,claimedCells:m,exploredCells:E,setMapRef:J,onZoomChanged:Se,onCenterChanged:he,selectedCell:L,userLocation:b}),L&&ce.jsx(ca,{cellInfo:L,onClaim:de}),ce.jsxs("div",{style:vt.topLeftControls,children:[ce.jsx("button",{style:vt.controlButton,onClick:ve,children:"+"}),ce.jsx("button",{style:vt.controlButton,onClick:ye,children:"-"}),ce.jsx("button",{style:vt.controlButton,onClick:Me,children:"i"})]}),ce.jsx("div",{style:vt.topCenterContainer,children:ce.jsx(vc,{})}),ce.jsxs("div",{style:vt.topRightContainer,children:[ce.jsx("button",{style:vt.controlButton,onClick:()=>I(!0),children:"🏆"}),ce.jsx("button",{style:vt.controlButton,onClick:le,title:"Return to Globe",children:"🌍"})]}),ce.jsx("div",{style:vt.bottomRightContainer,children:ce.jsx(Lc,{onClick:me})}),ce.jsxs(u.Suspense,{fallback:ce.jsx(po,{}),children:[se&&ce.jsx(Ec,{onClose:De,onRegister:fe}),B&&ce.jsx(xc,{onClose:pe}),F&&ce.jsx(kc,{onClose:Be})]})]})}export{zc as default};
