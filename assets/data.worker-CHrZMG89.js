(function(){"use strict";function f(a){const s=a.trim().split(`
`);if(s.length<2)return console.warn("CSV data has less than 2 lines, returning empty."),[];const e=s[0].split(",").map(t=>t.trim().replace(/"/g,"")),r=[],o=e.indexOf("location_lat"),l=e.indexOf("location_lng"),c=e.indexOf("avatar_url"),g=e.indexOf("seq");if(o===-1||l===-1||c===-1)return console.error("CSV headers are missing required columns (location_lat, location_lng, avatar_url)"),[];for(let t=1;t<s.length;t++){const n=s[t].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(n.length===e.length){const i=parseFloat(n[o]),u=parseFloat(n[l]),h=n[c].replace(/"/g,"");!isNaN(i)&&!isNaN(u)&&r.push({seq:n[g],lat:i,lng:u,avatarUrl:h||null})}}return r}self.onmessage=function(a){const{csvPath:s}=a.data;fetch(s).then(e=>{if(!e.ok)throw new Error(`Network response was not ok: ${e.statusText}`);return e.text()}).then(e=>{const r=f(e);self.postMessage({success:!0,users:r})}).catch(e=>{console.error("Error in worker while fetching or parsing CSV:",e),self.postMessage({success:!1,error:e.message})})}})();
