const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-CWhPvCGG.js","assets/index-CPD7Oimj.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-BmSPzp3D.js","assets/InfoModal-BebEIpGE.js"])))=>i.map(i=>d[i]);
import{r as u,j as se,b as Ln,R as en,c as Ta,g as Aa,d as Ba,a as za,L as go,_ as _i}from"./index-CPD7Oimj.js";function Un(t){"@babel/helpers - typeof";return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Un(t)}function Ua(t,e){if(Un(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,e);if(Un(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=Ua(t,"string");return Un(e)=="symbol"?e:e+""}function A(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ws(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var di,mo;function Ka(){if(mo)return di;mo=1;var t=function(r,o,l,f,p,h,m,C){if(!r){var w;if(o===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var y=[l,f,p,h,m,C],S=0;w=new Error(o.replace(/%s/g,function(){return y[S++]})),w.name="Invariant Violation"}throw w.framesToPop=1,w}};return di=t,di}var Na=Ka(),qe=Ws(Na),Me=u.createContext(null);function Za(){qe(!!u.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=u.useContext(Me);return qe(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function qa(t,e,r){return Object.keys(t).reduce(function(l,f){return e(l,t[f],f)},r)}function Wa(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function $a(t,e,r,o){var l={},f=(p,h)=>{var m=r[h];m!==e[h]&&(l[h]=m,p(o,m))};return Wa(t,f),l}function Va(t,e,r){var o=qa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return o}function Ha(t){google.maps.event.removeListener(t)}function je(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Ha)}function De(t){var{updaterMap:e,eventMap:r,prevProps:o,nextProps:l,instance:f}=t,p=Va(l,f,r);return $a(e,o,l,f),p}var vo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},yo={extraMapTypes(t,e){e.forEach(function(o,l){t.mapTypes.set(String(l),o)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ga(t){var{children:e,options:r,id:o,mapContainerStyle:l,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:C,onDragEnd:w,onDragStart:y,onMouseMove:S,onMouseOut:j,onMouseOver:k,onMouseDown:W,onMouseUp:U,onRightClick:Y,onCenterChanged:$,onLoad:ue,onUnmount:F}=t,[T,z]=u.useState(null),N=u.useRef(null),[J,K]=u.useState(null),[ae,le]=u.useState(null),[re,Q]=u.useState(null),[fe,de]=u.useState(null),[be,xe]=u.useState(null),[ge,ve]=u.useState(null),[me,we]=u.useState(null),[Ie,pe]=u.useState(null),[Oe,Z]=u.useState(null),[Ae,Ue]=u.useState(null),[Ee,ie]=u.useState(null),[V,ye]=u.useState(null);return u.useEffect(()=>{r&&T!==null&&T.setOptions(r)},[T,r]),u.useEffect(()=>{T!==null&&typeof p<"u"&&T.setCenter(p)},[T,p]),u.useEffect(()=>{T&&m&&(ae!==null&&google.maps.event.removeListener(ae),le(google.maps.event.addListener(T,"dblclick",m)))},[m]),u.useEffect(()=>{T&&w&&(re!==null&&google.maps.event.removeListener(re),Q(google.maps.event.addListener(T,"dragend",w)))},[w]),u.useEffect(()=>{T&&y&&(fe!==null&&google.maps.event.removeListener(fe),de(google.maps.event.addListener(T,"dragstart",y)))},[y]),u.useEffect(()=>{T&&W&&(be!==null&&google.maps.event.removeListener(be),xe(google.maps.event.addListener(T,"mousedown",W)))},[W]),u.useEffect(()=>{T&&S&&(ge!==null&&google.maps.event.removeListener(ge),ve(google.maps.event.addListener(T,"mousemove",S)))},[S]),u.useEffect(()=>{T&&j&&(me!==null&&google.maps.event.removeListener(me),we(google.maps.event.addListener(T,"mouseout",j)))},[j]),u.useEffect(()=>{T&&k&&(Ie!==null&&google.maps.event.removeListener(Ie),pe(google.maps.event.addListener(T,"mouseover",k)))},[k]),u.useEffect(()=>{T&&U&&(Oe!==null&&google.maps.event.removeListener(Oe),Z(google.maps.event.addListener(T,"mouseup",U)))},[U]),u.useEffect(()=>{T&&Y&&(Ae!==null&&google.maps.event.removeListener(Ae),Ue(google.maps.event.addListener(T,"rightclick",Y)))},[Y]),u.useEffect(()=>{T&&h&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener(T,"click",h)))},[h]),u.useEffect(()=>{T&&C&&(V!==null&&google.maps.event.removeListener(V),ye(google.maps.event.addListener(T,"drag",C)))},[C]),u.useEffect(()=>{T&&$&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(T,"center_changed",$)))},[h]),u.useEffect(()=>{var Ce=N.current===null?null:new google.maps.Map(N.current,r);return z(Ce),Ce!==null&&ue&&ue(Ce),()=>{Ce!==null&&F&&F(Ce)}},[]),se.jsx("div",{id:o,ref:N,style:l,className:f,children:se.jsx(Me.Provider,{value:T,children:T!==null?e:null})})}u.memo(Ga);class Ya extends u.PureComponent{constructor(){super(...arguments),A(this,"state",{map:null}),A(this,"registeredEvents",[]),A(this,"mapRef",null),A(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),A(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),A(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),A(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=De({updaterMap:yo,eventMap:vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:yo,eventMap:vo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),je(this.registeredEvents))}render(){return se.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:se.jsx(Me.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bo(t,e,r,o,l,f,p){try{var h=t[f](p),m=h.value}catch(C){return void r(C)}h.done?e(m):Promise.resolve(m).then(o,l)}function $s(t){return function(){var e=this,r=arguments;return new Promise(function(o,l){var f=t.apply(e,r);function p(m){bo(f,o,l,p,h,"next",m)}function h(m){bo(f,o,l,p,h,"throw",m)}p(void 0)})}}function Vs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:o="weekly",language:l,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:C,apiUrl:w="https://maps.googleapis.com"}=t,y=[];return qe(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?y.push("key=".concat(e)):r&&y.push("client=".concat(r)),o&&y.push("v=".concat(o)),l&&y.push("language=".concat(l)),f&&y.push("region=".concat(f)),p&&p.length&&y.push("libraries=".concat(p.sort().join(","))),h&&y.push("channel=".concat(h)),m&&m.length&&y.push("map_ids=".concat(m.join(","))),C&&y.push("auth_referrer_policy=".concat(C)),y.push("loading=async"),y.push("callback=initMap"),"".concat(w,"/maps/api/js?").concat(y.join("&"))}var Nt=typeof document<"u";function Hs(t){var{url:e,id:r,nonce:o}=t;return Nt?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var C=h.getAttribute("data-state");if(h.src===e&&C!=="error"){if(C==="ready")return f(r);var w=m.initMap,y=h.onerror;m.initMap=function(){w&&w(),f(r)},h.onerror=function(j){y&&y(j),p(j)};return}else h.remove()}var S=document.createElement("script");S.type="text/javascript",S.src=e,S.id=r,S.async=!0,S.nonce=o||"",S.onerror=function(k){S.setAttribute("data-state","error"),p(k)},m.initMap=function(){S.setAttribute("data-state","ready"),f(r)},document.head.appendChild(S)}).catch(l=>{throw console.error("injectScript error: ",l),l}):Promise.reject(new Error("document is undefined"))}function wo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function Di(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(l,f){return wo(l)||Reflect.apply(e,t,[l,f]),l};var r=t.appendChild.bind(t);t.appendChild=function(l){return wo(l)||Reflect.apply(r,t,[l]),l}}}var Tn=!1;function Gs(){return se.jsx("div",{children:"Loading..."})}var Fn={id:"script-loader",version:"weekly"};class Ja extends u.PureComponent{constructor(){super(...arguments),A(this,"check",null),A(this,"state",{loaded:!1}),A(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),A(this,"isCleaningUp",$s(function*(){function e(r){if(!Tn)r();else if(Nt)var o=window.setInterval(function(){Tn||(window.clearInterval(o),r())},1)}return new Promise(e)})),A(this,"cleanup",()=>{Tn=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(o){return typeof o.src=="string"&&o.src.includes("maps.googleapis")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(o){return o.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(o){return o.innerText!==void 0&&o.innerText.length>0&&o.innerText.includes(".gm-")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)})}),A(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Di(),qe(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Vs(this.props)};Hs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),A(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Nt){if(window.google&&window.google.maps&&!Tn){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Nt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Nt){this.cleanup();var e=()=>{this.check||(delete window.google,Tn=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return se.jsxs(se.Fragment,{children:[se.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||se.jsx(Gs,{})]})}}A(Ja,"defaultProps",Fn);function Xa(t,e){if(t==null)return{};var r={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;r[o]=t[o]}return r}function Ii(t,e){if(t==null)return{};var r,o,l=Xa(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(o=0;o<f.length;o++)r=f[o],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(l[r]=t[r])}return l}var Lo;function Qa(t){var{id:e=Fn.id,version:r=Fn.version,nonce:o,googleMapsApiKey:l,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:C,channel:w,mapIds:y,authReferrerPolicy:S,apiUrl:j="https://maps.googleapis.com"}=t,k=u.useRef(!1),[W,U]=u.useState(!1),[Y,$]=u.useState(void 0);u.useEffect(function(){return k.current=!0,()=>{k.current=!1}},[]),u.useEffect(function(){Nt&&C&&Di()},[C]),u.useEffect(function(){W&&qe(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[W]);var ue=Vs({version:r,googleMapsApiKey:l,googleMapsClientId:f,language:p,region:h,libraries:m,channel:w,mapIds:y,authReferrerPolicy:S,apiUrl:j});u.useEffect(function(){if(!Nt)return;function z(){k.current&&(U(!0),Lo=ue)}if(window.google&&window.google.maps&&Lo===ue){z();return}Hs({id:e,url:ue,nonce:o}).then(z).catch(function(J){k.current&&$(J),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(l||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(J)})},[e,ue,o]);var F=u.useRef(void 0);return u.useEffect(function(){F.current&&m!==F.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),F.current=m},[m]),{isLoaded:W,loadError:Y,url:ue}}var el=["loadingElement","onLoad","onError","onUnmount","children"],tl=se.jsx(Gs,{});function nl(t){var{loadingElement:e,onLoad:r,onError:o,onUnmount:l,children:f}=t,p=Ii(t,el),{isLoaded:h,loadError:m}=Qa(p);return u.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),u.useEffect(function(){m&&typeof o=="function"&&o(m)},[m,o]),u.useEffect(function(){return()=>{l&&l()}},[l]),h?f:e||tl}u.memo(nl);function rl(t,e,r,o){function l(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(w){try{C(o.next(w))}catch(y){p(y)}}function m(w){try{C(o.throw(w))}catch(y){p(y)}}function C(w){w.done?f(w.value):l(w.value).then(h,m)}C((o=o.apply(t,[])).next())})}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ol=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,l,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(l=o;l--!==0;)if(!t(e[l],r[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[l]))return!1;for(l=o;l--!==0;){var p=f[l];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},sl=il(ol),Co="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Qt{constructor(e){var{apiKey:r,authReferrerPolicy:o,channel:l,client:f,id:p=Co,language:h,libraries:m=[],mapIds:C,nonce:w,region:y,retries:S=3,url:j="https://maps.googleapis.com/maps/api/js",version:k}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=o,this.channel=l,this.client=f,this.id=p||Co,this.language=h,this.libraries=m,this.mapIds=C,this.nonce=w,this.region=y,this.retries=S,this.url=j,this.version=k,Qt.instance){if(!sl(this.options,Qt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Qt.instance.options)));return Qt.instance}Qt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(o=>{o?r(o.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var o={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(o).forEach(f=>!o[f]&&delete o[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,C="The Google Maps JavaScript API",w="google",y="importLibrary",S="__ib__",j=document,k=window;k=k[w]||(k[w]={});var W=k.maps||(k.maps={}),U=new Set,Y=new URLSearchParams,$=()=>p||(p=new Promise((ue,F)=>rl(this,void 0,void 0,function*(){var T;yield h=j.createElement("script"),h.id=this.id,Y.set("libraries",[...U]+"");for(m in f)Y.set(m.replace(/[A-Z]/g,z=>"_"+z[0].toLowerCase()),f[m]);Y.set("callback",w+".maps."+S),h.src=this.url+"?"+Y,W[S]=ue,h.onerror=()=>p=F(Error(C+" could not load.")),h.nonce=this.nonce||((T=j.querySelector("script[nonce]"))===null||T===void 0?void 0:T.nonce)||"",j.head.append(h)})));W[y]?console.warn(C+" only loads once. Ignoring:",f):W[y]=function(ue){for(var F=arguments.length,T=new Array(F>1?F-1:0),z=1;z<F;z++)T[z-1]=arguments[z];return U.add(ue)&&$().then(()=>W[y](ue,...T))}})(o);var l=this.libraries.map(f=>this.importLibrary(f));l.length||l.push(this.importLibrary("core")),Promise.all(l).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var al=["maps"];function ll(t){var{id:e=Fn.id,version:r=Fn.version,nonce:o,googleMapsApiKey:l,language:f,region:p,libraries:h=al,preventGoogleFontsLoading:m,mapIds:C,authReferrerPolicy:w}=t,y=u.useRef(!1),[S,j]=u.useState(!1),[k,W]=u.useState(void 0);u.useEffect(function(){return y.current=!0,()=>{y.current=!1}},[]);var U=u.useMemo(()=>new Qt({id:e,apiKey:l,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:C||[],nonce:o||"",authReferrerPolicy:w||"origin"}),[e,l,r,h,f,p,C,o,w]);u.useEffect(function(){S||U.load().then(()=>{y.current&&j(!0)}).catch(ue=>{W(ue)})},[]),u.useEffect(()=>{Nt&&m&&Di()},[m]);var Y=u.useRef();return u.useEffect(()=>{Y.current&&h!==Y.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Y.current=h},[h]),{isLoaded:S,loadError:k}}function xo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function xr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xo(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Eo={},ko={options(t,e){t.setOptions(e)}};function ul(t){var{options:e,onLoad:r,onUnmount:o}=t,l=u.useContext(Me),[f,p]=u.useState(null);return u.useEffect(()=>{f!==null&&f.setMap(l)},[l]),u.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),u.useEffect(()=>{var h=new google.maps.TrafficLayer(xr(xr({},e),{},{map:l}));return p(h),r&&r(h),()=>{f!==null&&(o&&o(f),f.setMap(null))}},[]),null}u.memo(ul);class cl extends u.PureComponent{constructor(){super(...arguments),A(this,"state",{trafficLayer:null}),A(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),A(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(xr(xr({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:ko,eventMap:Eo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ko,eventMap:Eo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),je(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}A(cl,"contextType",Me);function fl(t){var{onLoad:e,onUnmount:r}=t,o=u.useContext(Me),[l,f]=u.useState(null);return u.useEffect(()=>{l!==null&&l.setMap(o)},[o]),u.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(o),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}u.memo(fl);class dl extends u.PureComponent{constructor(){super(...arguments),A(this,"state",{bicyclingLayer:null}),A(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}A(dl,"contextType",Me);function pl(t){var{onLoad:e,onUnmount:r}=t,o=u.useContext(Me),[l,f]=u.useState(null);return u.useEffect(()=>{l!==null&&l.setMap(o)},[o]),u.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(o),e&&e(p),()=>{l!==null&&(r&&r(l),l.setMap(null))}},[]),null}u.memo(pl);class hl extends u.PureComponent{constructor(){super(...arguments),A(this,"state",{transitLayer:null}),A(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}A(hl,"contextType",Me);function So(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?So(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):So(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Mo={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Po={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function gl(t){var{options:e,drawingMode:r,onCircleComplete:o,onMarkerComplete:l,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:C,onUnmount:w}=t,y=u.useContext(Me),[S,j]=u.useState(null),[k,W]=u.useState(null),[U,Y]=u.useState(null),[$,ue]=u.useState(null),[F,T]=u.useState(null),[z,N]=u.useState(null),[J,K]=u.useState(null);return u.useEffect(()=>{S!==null&&S.setMap(y)},[y]),u.useEffect(()=>{e&&S!==null&&S.setOptions(e)},[S,e]),u.useEffect(()=>{S!==null&&S.setDrawingMode(r??null)},[S,r]),u.useEffect(()=>{S&&o&&(k!==null&&google.maps.event.removeListener(k),W(google.maps.event.addListener(S,"circlecomplete",o)))},[S,o]),u.useEffect(()=>{S&&l&&(U!==null&&google.maps.event.removeListener(U),Y(google.maps.event.addListener(S,"markercomplete",l)))},[S,l]),u.useEffect(()=>{S&&f&&($!==null&&google.maps.event.removeListener($),ue(google.maps.event.addListener(S,"overlaycomplete",f)))},[S,f]),u.useEffect(()=>{S&&p&&(F!==null&&google.maps.event.removeListener(F),T(google.maps.event.addListener(S,"polygoncomplete",p)))},[S,p]),u.useEffect(()=>{S&&h&&(z!==null&&google.maps.event.removeListener(z),N(google.maps.event.addListener(S,"polylinecomplete",h)))},[S,h]),u.useEffect(()=>{S&&m&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(S,"rectanglecomplete",m)))},[S,m]),u.useEffect(()=>{qe(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var ae=new google.maps.drawing.DrawingManager(Er(Er({},e),{},{map:y}));return r&&ae.setDrawingMode(r),o&&W(google.maps.event.addListener(ae,"circlecomplete",o)),l&&Y(google.maps.event.addListener(ae,"markercomplete",l)),f&&ue(google.maps.event.addListener(ae,"overlaycomplete",f)),p&&T(google.maps.event.addListener(ae,"polygoncomplete",p)),h&&N(google.maps.event.addListener(ae,"polylinecomplete",h)),m&&K(google.maps.event.addListener(ae,"rectanglecomplete",m)),j(ae),C&&C(ae),()=>{S!==null&&(k&&google.maps.event.removeListener(k),U&&google.maps.event.removeListener(U),$&&google.maps.event.removeListener($),F&&google.maps.event.removeListener(F),z&&google.maps.event.removeListener(z),J&&google.maps.event.removeListener(J),w&&w(S),S.setMap(null))}},[]),null}u.memo(gl);class ml extends u.PureComponent{constructor(e){super(e),A(this,"registeredEvents",[]),A(this,"state",{drawingManager:null}),A(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),qe(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Er(Er({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:Po,eventMap:Mo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Po,eventMap:Mo,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),je(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}A(ml,"contextType",Me);function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var _o={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Do={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},kr={};function vl(t){var{position:e,options:r,clusterer:o,noClustererRedraw:l,children:f,draggable:p,visible:h,animation:m,clickable:C,cursor:w,icon:y,label:S,opacity:j,shape:k,title:W,zIndex:U,onClick:Y,onDblClick:$,onDrag:ue,onDragEnd:F,onDragStart:T,onMouseOut:z,onMouseOver:N,onMouseUp:J,onMouseDown:K,onRightClick:ae,onClickableChanged:le,onCursorChanged:re,onAnimationChanged:Q,onDraggableChanged:fe,onFlatChanged:de,onIconChanged:be,onPositionChanged:xe,onShapeChanged:ge,onTitleChanged:ve,onVisibleChanged:me,onZindexChanged:we,onLoad:Ie,onUnmount:pe}=t,Oe=u.useContext(Me),[Z,Ae]=u.useState(null),[Ue,Ee]=u.useState(null),[ie,V]=u.useState(null),[ye,Ce]=u.useState(null),[Je,qt]=u.useState(null),[Re,Wn]=u.useState(null),[rn,$n]=u.useState(null),[on,sn]=u.useState(null),[Xe,Cn]=u.useState(null),[dt,xn]=u.useState(null),[Mt,pt]=u.useState(null),[at,an]=u.useState(null),[ht,ln]=u.useState(null),[wt,gt]=u.useState(null),[Lt,un]=u.useState(null),[et,he]=u.useState(null),[mt,vt]=u.useState(null),[Ct,oe]=u.useState(null),[cn,En]=u.useState(null),[Pt,kn]=u.useState(null),[Ot,Vn]=u.useState(null),[fn,xt]=u.useState(null);u.useEffect(()=>{Z!==null&&Z.setMap(Oe)},[Oe]),u.useEffect(()=>{typeof r<"u"&&Z!==null&&Z.setOptions(r)},[Z,r]),u.useEffect(()=>{typeof p<"u"&&Z!==null&&Z.setDraggable(p)},[Z,p]),u.useEffect(()=>{e&&Z!==null&&Z.setPosition(e)},[Z,e]),u.useEffect(()=>{typeof h<"u"&&Z!==null&&Z.setVisible(h)},[Z,h]),u.useEffect(()=>{Z?.setAnimation(m)},[Z,m]),u.useEffect(()=>{Z&&C!==void 0&&Z.setClickable(C)},[Z,C]),u.useEffect(()=>{Z&&w!==void 0&&Z.setCursor(w)},[Z,w]),u.useEffect(()=>{Z&&y!==void 0&&Z.setIcon(y)},[Z,y]),u.useEffect(()=>{Z&&S!==void 0&&Z.setLabel(S)},[Z,S]),u.useEffect(()=>{Z&&j!==void 0&&Z.setOpacity(j)},[Z,j]),u.useEffect(()=>{Z&&k!==void 0&&Z.setShape(k)},[Z,k]),u.useEffect(()=>{Z&&W!==void 0&&Z.setTitle(W)},[Z,W]),u.useEffect(()=>{Z&&U!==void 0&&Z.setZIndex(U)},[Z,U]),u.useEffect(()=>{Z&&$&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener(Z,"dblclick",$)))},[$]),u.useEffect(()=>{Z&&F&&(ie!==null&&google.maps.event.removeListener(ie),V(google.maps.event.addListener(Z,"dragend",F)))},[F]),u.useEffect(()=>{Z&&T&&(ye!==null&&google.maps.event.removeListener(ye),Ce(google.maps.event.addListener(Z,"dragstart",T)))},[T]),u.useEffect(()=>{Z&&K&&(Je!==null&&google.maps.event.removeListener(Je),qt(google.maps.event.addListener(Z,"mousedown",K)))},[K]),u.useEffect(()=>{Z&&z&&(Re!==null&&google.maps.event.removeListener(Re),Wn(google.maps.event.addListener(Z,"mouseout",z)))},[z]),u.useEffect(()=>{Z&&N&&(rn!==null&&google.maps.event.removeListener(rn),$n(google.maps.event.addListener(Z,"mouseover",N)))},[N]),u.useEffect(()=>{Z&&J&&(on!==null&&google.maps.event.removeListener(on),sn(google.maps.event.addListener(Z,"mouseup",J)))},[J]),u.useEffect(()=>{Z&&ae&&(Xe!==null&&google.maps.event.removeListener(Xe),Cn(google.maps.event.addListener(Z,"rightclick",ae)))},[ae]),u.useEffect(()=>{Z&&Y&&(dt!==null&&google.maps.event.removeListener(dt),xn(google.maps.event.addListener(Z,"click",Y)))},[Y]),u.useEffect(()=>{Z&&ue&&(Mt!==null&&google.maps.event.removeListener(Mt),pt(google.maps.event.addListener(Z,"drag",ue)))},[ue]),u.useEffect(()=>{Z&&le&&(at!==null&&google.maps.event.removeListener(at),an(google.maps.event.addListener(Z,"clickable_changed",le)))},[le]),u.useEffect(()=>{Z&&re&&(ht!==null&&google.maps.event.removeListener(ht),ln(google.maps.event.addListener(Z,"cursor_changed",re)))},[re]),u.useEffect(()=>{Z&&Q&&(wt!==null&&google.maps.event.removeListener(wt),gt(google.maps.event.addListener(Z,"animation_changed",Q)))},[Q]),u.useEffect(()=>{Z&&fe&&(Lt!==null&&google.maps.event.removeListener(Lt),un(google.maps.event.addListener(Z,"draggable_changed",fe)))},[fe]),u.useEffect(()=>{Z&&de&&(et!==null&&google.maps.event.removeListener(et),he(google.maps.event.addListener(Z,"flat_changed",de)))},[de]),u.useEffect(()=>{Z&&be&&(mt!==null&&google.maps.event.removeListener(mt),vt(google.maps.event.addListener(Z,"icon_changed",be)))},[be]),u.useEffect(()=>{Z&&xe&&(Ct!==null&&google.maps.event.removeListener(Ct),oe(google.maps.event.addListener(Z,"position_changed",xe)))},[xe]),u.useEffect(()=>{Z&&ge&&(cn!==null&&google.maps.event.removeListener(cn),En(google.maps.event.addListener(Z,"shape_changed",ge)))},[ge]),u.useEffect(()=>{Z&&ve&&(Pt!==null&&google.maps.event.removeListener(Pt),kn(google.maps.event.addListener(Z,"title_changed",ve)))},[ve]),u.useEffect(()=>{Z&&me&&(Ot!==null&&google.maps.event.removeListener(Ot),Vn(google.maps.event.addListener(Z,"visible_changed",me)))},[me]),u.useEffect(()=>{Z&&we&&(fn!==null&&google.maps.event.removeListener(fn),xt(google.maps.event.addListener(Z,"zindex_changed",we)))},[we]),u.useEffect(()=>{var Et=bn(bn(bn({},r||kr),o?kr:{map:Oe}),{},{position:e}),Le=new google.maps.Marker(Et);return o?o.addMarker(Le,!!l):Le.setMap(Oe),e&&Le.setPosition(e),typeof h<"u"&&Le.setVisible(h),typeof p<"u"&&Le.setDraggable(p),typeof C<"u"&&Le.setClickable(C),typeof w=="string"&&Le.setCursor(w),y&&Le.setIcon(y),typeof S<"u"&&Le.setLabel(S),typeof j<"u"&&Le.setOpacity(j),k&&Le.setShape(k),typeof W=="string"&&Le.setTitle(W),typeof U=="number"&&Le.setZIndex(U),$&&Ee(google.maps.event.addListener(Le,"dblclick",$)),F&&V(google.maps.event.addListener(Le,"dragend",F)),T&&Ce(google.maps.event.addListener(Le,"dragstart",T)),K&&qt(google.maps.event.addListener(Le,"mousedown",K)),z&&Wn(google.maps.event.addListener(Le,"mouseout",z)),N&&$n(google.maps.event.addListener(Le,"mouseover",N)),J&&sn(google.maps.event.addListener(Le,"mouseup",J)),ae&&Cn(google.maps.event.addListener(Le,"rightclick",ae)),Y&&xn(google.maps.event.addListener(Le,"click",Y)),ue&&pt(google.maps.event.addListener(Le,"drag",ue)),le&&an(google.maps.event.addListener(Le,"clickable_changed",le)),re&&ln(google.maps.event.addListener(Le,"cursor_changed",re)),Q&&gt(google.maps.event.addListener(Le,"animation_changed",Q)),fe&&un(google.maps.event.addListener(Le,"draggable_changed",fe)),de&&he(google.maps.event.addListener(Le,"flat_changed",de)),be&&vt(google.maps.event.addListener(Le,"icon_changed",be)),xe&&oe(google.maps.event.addListener(Le,"position_changed",xe)),ge&&En(google.maps.event.addListener(Le,"shape_changed",ge)),ve&&kn(google.maps.event.addListener(Le,"title_changed",ve)),me&&Vn(google.maps.event.addListener(Le,"visible_changed",me)),we&&xt(google.maps.event.addListener(Le,"zindex_changed",we)),Ae(Le),Ie&&Ie(Le),()=>{Ue!==null&&google.maps.event.removeListener(Ue),ie!==null&&google.maps.event.removeListener(ie),ye!==null&&google.maps.event.removeListener(ye),Je!==null&&google.maps.event.removeListener(Je),Re!==null&&google.maps.event.removeListener(Re),rn!==null&&google.maps.event.removeListener(rn),on!==null&&google.maps.event.removeListener(on),Xe!==null&&google.maps.event.removeListener(Xe),dt!==null&&google.maps.event.removeListener(dt),at!==null&&google.maps.event.removeListener(at),ht!==null&&google.maps.event.removeListener(ht),wt!==null&&google.maps.event.removeListener(wt),Lt!==null&&google.maps.event.removeListener(Lt),et!==null&&google.maps.event.removeListener(et),mt!==null&&google.maps.event.removeListener(mt),Ct!==null&&google.maps.event.removeListener(Ct),Pt!==null&&google.maps.event.removeListener(Pt),Ot!==null&&google.maps.event.removeListener(Ot),fn!==null&&google.maps.event.removeListener(fn),pe&&pe(Le),o?o.removeMarker(Le,!!l):Le&&Le.setMap(null)}},[]);var _t=u.useMemo(()=>f?u.Children.map(f,Et=>{if(!u.isValidElement(Et))return Et;var Le=Et;return u.cloneElement(Le,{anchor:Z})}):null,[f,Z]);return se.jsx(se.Fragment,{children:_t})||null}u.memo(vl);class yl extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[])}componentDidMount(){var e=this;return $s(function*(){var r=bn(bn(bn({},e.props.options||kr),e.props.clusterer?kr:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=De({updaterMap:Do,eventMap:_o,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Do,eventMap:_o,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),je(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?u.Children.map(this.props.children,r=>{if(!u.isValidElement(r))return r;var o=r;return u.cloneElement(o,{anchor:this.marker})}):null;return e||null}}A(yl,"contextType",Me);var bl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var o=r.getMaxZoom(),l=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(l),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(l);var h=p.getZoom()||0;o!==null&&h>o&&p.setZoom(o+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,o,l,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),C=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),w=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),y=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(y!==null?"".concat(y.y,"px"):"0","; left: ").concat(y!==null?"".concat(y.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var S=document.createElement("img");S.alt=h,S.src=this.url,S.width=this.width,S.height=this.height,S.setAttribute("style","position: absolute; top: ".concat(w,"px; left: ").concat(C,"px")),this.cluster.getClusterer().enableRetinaIcons||(S.style.clip="rect(-".concat(w,"px, -").concat(C+this.width,"px, -").concat(w+this.height,", -").concat(C,")"));var j=document.createElement("div");j.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((o=this.sums)===null||o===void 0)&&o.text&&(j.innerText="".concat((l=this.sums)===null||l===void 0?void 0:l.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(j.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(S),this.div.appendChild(j),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),o=r[Math.min(r.length-1,Math.max(0,e.index-1))];o&&(this.url=o.url,this.height=o.height,this.width=o.width,o.className&&(this.className="".concat(this.clusterClassName," ").concat(o.className)),this.anchorText=o.anchorText||[0,0],this.anchorIcon=o.anchorIcon||[this.height/2,this.width/2],this.textColor=o.textColor||"black",this.textSize=o.textSize||11,this.textDecoration=o.textDecoration||"none",this.fontWeight=o.fontWeight||"bold",this.fontStyle=o.fontStyle||"normal",this.fontFamily=o.fontFamily||"Arial,sans-serif",this.backgroundPosition=o.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),wl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new bl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),o=0,l=r;o<l.length;o++){var f=l[o],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var o=e.getPosition();if(o){var l=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(l-1)+o.lat())/l,(this.center.lng()*(l-1)+o.lng())/l),this.calculateBounds()}}}else{var o=e.getPosition();o&&(this.center=o,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,C=this.markers;m<C.length;m++){var w=C[m];w.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,o=this.markerClusterer.getMaxZoom(),l=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(o!==null&&typeof l<"u"&&l>o){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function Ll(t,e){var r=t.length,o=r.toString().length,l=Math.min(o,e);return{text:r.toString(),index:l,title:""}}var Cl=2e3,xl=500,El="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",kl="png",Sl=[53,56,66,78,90],Ml="cluster",Ys=(function(){function t(e,r,o){r===void 0&&(r=[]),o===void 0&&(o={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=o.gridSize||60,this.minClusterSize=o.minimumClusterSize||2,this.maxZoom=o.maxZoom||null,this.styles=o.styles||[],this.title=o.title||"",this.zoomOnClick=!0,o.zoomOnClick!==void 0&&(this.zoomOnClick=o.zoomOnClick),this.averageCenter=!1,o.averageCenter!==void 0&&(this.averageCenter=o.averageCenter),this.ignoreHidden=!1,o.ignoreHidden!==void 0&&(this.ignoreHidden=o.ignoreHidden),this.enableRetinaIcons=!1,o.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=o.enableRetinaIcons),this.imagePath=o.imagePath||El,this.imageExtension=o.imageExtension||kl,this.imageSizes=o.imageSizes||Sl,this.calculator=o.calculator||Ll,this.batchSize=o.batchSize||Cl,this.batchSizeIE=o.batchSizeIE||xl,this.clusterClass=o.clusterClass||Ml,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var o=r[e];o.getMap()!==this.activeMap&&o.setMap(this.activeMap)}for(var l=0,f=this.clusters;l<f.length;l++){var p=f[l];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var C=m[h];google.maps.event.removeListener(C)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,o=0,l=e;o<l.length;o++){var f=l[o],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=e[o];l&&this.pushMarkerTo(l)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var o=0;o<this.markers.length;o++)if(e===this.markers[o]){r=o;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var o=this.removeMarker_(e);return!r&&o&&this.repaint(),o},t.prototype.removeMarkers=function(e,r){for(var o=!1,l=0,f=e;l<f.length;l++){var p=f[l];o=o||this.removeMarker_(p)}return!r&&o&&this.repaint(),o},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var o=0,l=e;o<l.length;o++){var f=l[o];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),o=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));o!==null&&(o.x+=this.gridSize,o.y-=this.gridSize);var l=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(l!==null&&(l.x-=this.gridSize,l.y+=this.gridSize),o!==null){var f=r.fromDivPixelToLatLng(o);f!==null&&e.extend(f)}if(l!==null){var p=r.fromDivPixelToLatLng(l);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,o=this.clusters;r<o.length;r++){var l=o[r];l.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var o=6371,l=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return o*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var o=e.getPosition();return o?r.contains(o):!1},t.prototype.addToClosestCluster=function(e){for(var r,o=4e4,l=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),C=e.getPosition();if(m&&C){var w=this.distanceBetweenPoints(m,C);w<o&&(o=w,l=r)}}l&&l.isMarkerInClusterBounds(e)?l.addMarker(e):(r=new wl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var o=this.getMap(),l=o!==null&&("getBounds"in o)?o.getBounds():null,f=o?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(l?.getSouthWest(),l?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),C=e;C<m;C++){var w=this.markers[C];w&&!w.isAdded&&this.isMarkerInBounds(w,h)&&(!this.ignoreHidden||this.ignoreHidden&&w.getVisible())&&this.addToClosestCluster(w)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var y=0,S=this.clusters;y<S.length;y++){var j=S[y];j.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(l){for(var f in l.prototype){var p=f;this.prototype[p]=l.prototype[p]}return this}).apply(e,[r])},t})();function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ut={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},ze={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Ol={};function _l(t){var{children:e,options:r,averageCenter:o,batchSizeIE:l,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:C,imageExtension:w,imagePath:y,imageSizes:S,maxZoom:j,minimumClusterSize:k,styles:W,title:U,zoomOnClick:Y,onClick:$,onClusteringBegin:ue,onClusteringEnd:F,onMouseOver:T,onMouseOut:z,onLoad:N,onUnmount:J}=t,[K,ae]=u.useState(null),le=u.useContext(Me),[re,Q]=u.useState(null),[fe,de]=u.useState(null),[be,xe]=u.useState(null),[ge,ve]=u.useState(null),[me,we]=u.useState(null);return u.useEffect(()=>{K&&z&&(ge!==null&&google.maps.event.removeListener(ge),ve(google.maps.event.addListener(K,ut.onMouseOut,z)))},[z]),u.useEffect(()=>{K&&T&&(me!==null&&google.maps.event.removeListener(me),we(google.maps.event.addListener(K,ut.onMouseOver,T)))},[T]),u.useEffect(()=>{K&&$&&(re!==null&&google.maps.event.removeListener(re),Q(google.maps.event.addListener(K,ut.onClick,$)))},[$]),u.useEffect(()=>{K&&ue&&(fe!==null&&google.maps.event.removeListener(fe),de(google.maps.event.addListener(K,ut.onClusteringBegin,ue)))},[ue]),u.useEffect(()=>{K&&F&&(be!==null&&google.maps.event.removeListener(be),de(google.maps.event.addListener(K,ut.onClusteringEnd,F)))},[F]),u.useEffect(()=>{typeof o<"u"&&K!==null&&ze.averageCenter(K,o)},[K,o]),u.useEffect(()=>{typeof l<"u"&&K!==null&&ze.batchSizeIE(K,l)},[K,l]),u.useEffect(()=>{typeof f<"u"&&K!==null&&ze.calculator(K,f)},[K,f]),u.useEffect(()=>{typeof p<"u"&&K!==null&&ze.clusterClass(K,p)},[K,p]),u.useEffect(()=>{typeof h<"u"&&K!==null&&ze.enableRetinaIcons(K,h)},[K,h]),u.useEffect(()=>{typeof m<"u"&&K!==null&&ze.gridSize(K,m)},[K,m]),u.useEffect(()=>{typeof C<"u"&&K!==null&&ze.ignoreHidden(K,C)},[K,C]),u.useEffect(()=>{typeof w<"u"&&K!==null&&ze.imageExtension(K,w)},[K,w]),u.useEffect(()=>{typeof y<"u"&&K!==null&&ze.imagePath(K,y)},[K,y]),u.useEffect(()=>{typeof S<"u"&&K!==null&&ze.imageSizes(K,S)},[K,S]),u.useEffect(()=>{typeof j<"u"&&K!==null&&ze.maxZoom(K,j)},[K,j]),u.useEffect(()=>{typeof k<"u"&&K!==null&&ze.minimumClusterSize(K,k)},[K,k]),u.useEffect(()=>{typeof W<"u"&&K!==null&&ze.styles(K,W)},[K,W]),u.useEffect(()=>{typeof U<"u"&&K!==null&&ze.title(K,U)},[K,U]),u.useEffect(()=>{typeof Y<"u"&&K!==null&&ze.zoomOnClick(K,Y)},[K,Y]),u.useEffect(()=>{if(le){var Ie=Pl({},r||Ol),pe=new Ys(le,[],Ie);return o&&ze.averageCenter(pe,o),l&&ze.batchSizeIE(pe,l),f&&ze.calculator(pe,f),p&&ze.clusterClass(pe,p),h&&ze.enableRetinaIcons(pe,h),m&&ze.gridSize(pe,m),C&&ze.ignoreHidden(pe,C),w&&ze.imageExtension(pe,w),y&&ze.imagePath(pe,y),S&&ze.imageSizes(pe,S),j&&ze.maxZoom(pe,j),k&&ze.minimumClusterSize(pe,k),W&&ze.styles(pe,W),U&&ze.title(pe,U),Y&&ze.zoomOnClick(pe,Y),z&&ve(google.maps.event.addListener(pe,ut.onMouseOut,z)),T&&we(google.maps.event.addListener(pe,ut.onMouseOver,T)),$&&Q(google.maps.event.addListener(pe,ut.onClick,$)),ue&&de(google.maps.event.addListener(pe,ut.onClusteringBegin,ue)),F&&xe(google.maps.event.addListener(pe,ut.onClusteringEnd,F)),ae(pe),N&&N(pe),()=>{ge!==null&&google.maps.event.removeListener(ge),me!==null&&google.maps.event.removeListener(me),re!==null&&google.maps.event.removeListener(re),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),J&&J(pe)}}},[]),K!==null&&e(K)||null}u.memo(_l);class Dl extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{markerClusterer:null}),A(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ys(this.context,[],this.props.options);this.registeredEvents=De({updaterMap:ze,eventMap:ut,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ze,eventMap:ut,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),je(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}A(Dl,"contextType",Me);function jo(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Js=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(w){w.returnValue=!1,w.preventDefault&&w.preventDefault(),e.enableEventPropagation||jo(w)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var o=this.getPanes();if(o!==null&&o[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var l=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-l.left-l.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,jo))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var o=0,l=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,C=this.pixelOffset.width,w=this.pixelOffset.height,y=this.div.offsetWidth,S=this.div.offsetHeight,j=this.infoBoxClearance.width,k=this.infoBoxClearance.height,W=this.getProjection(),U=W.fromLatLngToContainerPixel(this.position);U!==null&&(U.x<-C+j?o=U.x+C-j:U.x+y+C+j>h&&(o=U.x+y+C+j-h),this.alignBottom?U.y<-w+k+S?l=U.y+w-k-S:U.y+w+k>m&&(l=U.y+w+k-m):U.y<-w+k?l=U.y+w-k:U.y+S+w+k>m&&(l=U.y+S+w+k-m)),o===0&&l===0||r.panBy(o,l)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var o=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+o*100+')"',this.div.style.filter="alpha(opacity="+o*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,o=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;o&&(e.top=parseInt(o.borderTopWidth||"",10)||0,e.bottom=parseInt(o.borderBottomWidth||"",10)||0,e.left=parseInt(o.borderLeftWidth||"",10)||0,e.right=parseInt(o.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var l=this.div.currentStyle;l&&(e.top=parseInt(l.borderTopWidth||"",10)||0,e.bottom=parseInt(l.borderBottomWidth||"",10)||0,e.left=parseInt(l.borderLeftWidth||"",10)||0,e.right=parseInt(l.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var o=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var l=r.getPosition();o.setPosition(l)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){o.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var o=r[e];google.maps.event.removeListener(o)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(l){for(var f in l.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=l.prototype[f]);return this}).apply(e,[r])},t})(),Il=["position"],jl=["position"];function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ro(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var To={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Ao={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Rl={};function Tl(t){var{children:e,anchor:r,options:o,position:l,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:C,onZindexChanged:w,onLoad:y,onUnmount:S}=t,j=u.useContext(Me),[k,W]=u.useState(null),[U,Y]=u.useState(null),[$,ue]=u.useState(null),[F,T]=u.useState(null),[z,N]=u.useState(null),[J,K]=u.useState(null),ae=u.useRef(null);return u.useEffect(()=>{j&&k!==null&&(k.close(),r?k.open(j,r):k.getPosition()&&k.open(j))},[j,k,r]),u.useEffect(()=>{o&&k!==null&&k.setOptions(o)},[k,o]),u.useEffect(()=>{if(l&&k!==null){var le=l instanceof google.maps.LatLng?l:new google.maps.LatLng(l.lat,l.lng);k.setPosition(le)}},[l]),u.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),u.useEffect(()=>{k&&p&&(U!==null&&google.maps.event.removeListener(U),Y(google.maps.event.addListener(k,"closeclick",p)))},[p]),u.useEffect(()=>{k&&h&&($!==null&&google.maps.event.removeListener($),ue(google.maps.event.addListener(k,"domready",h)))},[h]),u.useEffect(()=>{k&&m&&(F!==null&&google.maps.event.removeListener(F),T(google.maps.event.addListener(k,"content_changed",m)))},[m]),u.useEffect(()=>{k&&C&&(z!==null&&google.maps.event.removeListener(z),N(google.maps.event.addListener(k,"position_changed",C)))},[C]),u.useEffect(()=>{k&&w&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(k,"zindex_changed",w)))},[w]),u.useEffect(()=>{if(j){var le=o||Rl,{position:re}=le,Q=Ii(le,Il),fe;re&&!(re instanceof google.maps.LatLng)&&(fe=new google.maps.LatLng(re.lat,re.lng));var de=new Js(Sr(Sr({},Q),fe?{position:fe}:{}));ae.current=document.createElement("div"),W(de),p&&Y(google.maps.event.addListener(de,"closeclick",p)),h&&ue(google.maps.event.addListener(de,"domready",h)),m&&T(google.maps.event.addListener(de,"content_changed",m)),C&&N(google.maps.event.addListener(de,"position_changed",C)),w&&K(google.maps.event.addListener(de,"zindex_changed",w)),de.setContent(ae.current),r?de.open(j,r):de.getPosition()?de.open(j):qe(!1,"You must provide either an anchor or a position prop for <InfoBox>."),y&&y(de)}return()=>{k!==null&&(U&&google.maps.event.removeListener(U),F&&google.maps.event.removeListener(F),$&&google.maps.event.removeListener($),z&&google.maps.event.removeListener(z),J&&google.maps.event.removeListener(J),S&&S(k),k.close())}},[]),ae.current?Ln.createPortal(u.Children.only(e),ae.current):null}u.memo(Tl);class Al extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"containerElement",null),A(this,"state",{infoBox:null}),A(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):qe(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),A(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,o=Ii(e,jl),l;r&&!(r instanceof google.maps.LatLng)&&(l=new google.maps.LatLng(r.lat,r.lng));var f=new Js(Sr(Sr({},o),l?{position:l}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=De({updaterMap:Ao,eventMap:To,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Ao,eventMap:To,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),je(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(u.Children.only(this.props.children),this.containerElement):null}}A(Al,"contextType",Me);var pi,Bo;function Bl(){return Bo||(Bo=1,pi=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,l,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(l=o;l--!==0;)if(!t(e[l],r[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[l]))return!1;for(l=o;l--!==0;){var p=f[l];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),pi}var zl=Bl(),zo=Ws(zl),Uo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],hi=1,An=8;class ji{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,o]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var l=o>>4;if(l!==hi)throw new Error("Got v".concat(l," data when expected v").concat(hi,"."));var f=Uo[o&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new ji(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,l=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=Uo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(o,"."));l&&l instanceof ArrayBuffer?(this.data=l,this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(An+p+h+m),this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(hi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=r,o}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return wi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],C=[];m.length;){var w=m.pop()||0,y=m.pop()||0,S=m.pop()||0;if(y-S<=h){for(var j=S;j<=y;j++){var k=p[2*j],W=p[2*j+1];k>=e&&k<=o&&W>=r&&W<=l&&C.push(f[j])}continue}var U=S+y>>1,Y=p[2*U],$=p[2*U+1];Y>=e&&Y<=o&&$>=r&&$<=l&&C.push(f[U]),(w===0?e<=Y:r<=$)&&(m.push(S),m.push(U-1),m.push(1-w)),(w===0?o>=Y:l>=$)&&(m.push(U+1),m.push(y),m.push(1-w))}return C}within(e,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:l,coords:f,nodeSize:p}=this,h=[0,l.length-1,0],m=[],C=o*o;h.length;){var w=h.pop()||0,y=h.pop()||0,S=h.pop()||0;if(y-S<=p){for(var j=S;j<=y;j++)Fo(f[2*j],f[2*j+1],e,r)<=C&&m.push(l[j]);continue}var k=S+y>>1,W=f[2*k],U=f[2*k+1];Fo(W,U,e,r)<=C&&m.push(l[k]),(w===0?e-o<=W:r-o<=U)&&(h.push(S),h.push(k-1),h.push(1-w)),(w===0?e+o>=W:r+o>=U)&&(h.push(k+1),h.push(y),h.push(1-w))}return m}}function wi(t,e,r,o,l,f){if(!(l-o<=r)){var p=o+l>>1;Xs(t,e,p,o,l,f),wi(t,e,r,o,p-1,1-f),wi(t,e,r,p+1,l,1-f)}}function Xs(t,e,r,o,l,f){for(;l>o;){if(l-o>600){var p=l-o+1,h=r-o+1,m=Math.log(p),C=.5*Math.exp(2*m/3),w=.5*Math.sqrt(m*C*(p-C)/p)*(h-p/2<0?-1:1),y=Math.max(o,Math.floor(r-h*C/p+w)),S=Math.min(l,Math.floor(r+(p-h)*C/p+w));Xs(t,e,r,y,S,f)}var j=e[2*r+f],k=o,W=l;for(Bn(t,e,o,r),e[2*l+f]>j&&Bn(t,e,o,l);k<W;){for(Bn(t,e,k,W),k++,W--;e[2*k+f]<j;)k++;for(;e[2*W+f]>j;)W--}e[2*o+f]===j?Bn(t,e,o,W):(W++,Bn(t,e,W,l)),W<=r&&(o=W+1),r<=W&&(l=W-1)}}function Bn(t,e,r,o){gi(t,r,o),gi(e,2*r,2*o),gi(e,2*r+1,2*o+1)}function gi(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function Fo(t,e,r,o){var l=t-r,f=e-o;return l*l+f*f}var Ul={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ko=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Jt=2,Ft=3,mi=4,Ut=5,Qs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(Ul),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:o,maxZoom:l}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[C,w]=m.geometry.coordinates,y=Ko(mr(C)),S=Ko(vr(w));p.push(y,S,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var j=this.trees[l+1]=this._createTree(p);r&&console.timeEnd(f);for(var k=l;k>=o;k--){var W=+Date.now();j=this.trees[k]=this._createTree(this._cluster(j,k)),r&&console.log("z%d: %d clusters in %dms",k,j.numItems,+Date.now()-W)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var o=((e[0]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)o=-180,f=180;else if(o>f){var h=this.getClusters([o,l,180,p],r),m=this.getClusters([-180,l,f,p],r);return h.concat(m)}var C=this.trees[this._limitZoom(r)],w=C.range(mr(o),vr(p),mr(f),vr(l)),y=C.data,S=[];for(var j of w){var k=this.stride*j;S.push(y[k+Ut]>1?No(y,k,this.clusterProps):this.points[y[k+Ft]])}return S}getChildren(e){var r=this._getOriginId(e),o=this._getOriginZoom(e),l="No cluster with the specified id.",f=this.trees[o];if(!f)throw new Error(l);var p=f.data;if(r*this.stride>=p.length)throw new Error(l);var h=this.options.radius/(this.options.extent*Math.pow(2,o-1)),m=p[r*this.stride],C=p[r*this.stride+1],w=f.within(m,C,h),y=[];for(var S of w){var j=S*this.stride;p[j+mi]===e&&y.push(p[j+Ut]>1?No(p,j,this.clusterProps):this.points[p[j+Ft]])}if(y.length===0)throw new Error(l);return y}getLeaves(e,r,o){r=r||10,o=o||0;var l=[];return this._appendLeaves(l,e,r,o,0),l}getTile(e,r,o){var l=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,C=(o-m)/f,w=(o+1+m)/f,y={features:[]};return this._addTileFeatures(l.range((r-m)/f,C,(r+1+m)/f,w),l.data,r,o,f,y),r===0&&this._addTileFeatures(l.range(1-m/f,C,1,w),l.data,f,o,f,y),r===f-1&&this._addTileFeatures(l.range(0,C,m/f,w),l.data,-1,o,f,y),y.features.length?y:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var o=this.getChildren(e);if(r++,o.length!==1)break;e=o[0].properties.cluster_id}return r}_appendLeaves(e,r,o,l,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=l?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,o,l,f):f<l?f++:e.push(h),e.length===o)break}return f}_createTree(e){for(var r=new ji(e.length/this.stride|0,this.options.nodeSize,Float32Array),o=0;o<e.length;o+=this.stride)r.add(e[o],e[o+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,o,l,f,p){for(var h of e){var m=h*this.stride,C=r[m+Ut]>1,w=void 0,y=void 0,S=void 0;if(C)w=ea(r,m,this.clusterProps),y=r[m],S=r[m+1];else{var j=this.points[r[m+Ft]];w=j.properties;var[k,W]=j.geometry.coordinates;y=mr(k),S=vr(W)}var U={type:1,geometry:[[Math.round(this.options.extent*(y*f-o)),Math.round(this.options.extent*(S*f-l))]],tags:w},Y=void 0;C||this.options.generateId?Y=r[m+Ft]:Y=this.points[r[m+Ft]].id,Y!==void 0&&(U.id=Y),p.features.push(U)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:o,extent:l,reduce:f,minPoints:p}=this.options,h=o/(l*Math.pow(2,r)),m=e.data,C=[],w=this.stride,y=0;y<m.length;y+=w)if(!(m[y+Jt]<=r)){m[y+Jt]=r;var S=m[y],j=m[y+1],k=e.within(m[y],m[y+1],h),W=m[y+Ut],U=W;for(var Y of k){var $=Y*w;m[$+Jt]>r&&(U+=m[$+Ut])}if(U>W&&U>=p){var ue=S*W,F=j*W,T=void 0,z=-1,N=((y/w|0)<<5)+(r+1)+this.points.length;for(var J of k){var K=J*w;if(!(m[K+Jt]<=r)){m[K+Jt]=r;var ae=m[K+Ut];ue+=m[K]*ae,F+=m[K+1]*ae,m[K+mi]=N,f&&(T||(T=this._map(m,y,!0),z=this.clusterProps.length,this.clusterProps.push(T)),f(T,this._map(m,K)))}}m[y+mi]=N,C.push(ue/U,F/U,1/0,N,-1,U),f&&C.push(z)}else{for(var le=0;le<w;le++)C.push(m[y+le]);if(U>1)for(var re of k){var Q=re*w;if(!(m[Q+Jt]<=r)){m[Q+Jt]=r;for(var fe=0;fe<w;fe++)C.push(m[Q+fe])}}}}return C}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,o){if(e[r+Ut]>1){var l=this.clusterProps[e[r+Qs]];return o?Object.assign({},l):l}var f=this.points[e[r+Ft]].properties,p=this.options.map(f);return o&&p===f?Object.assign({},p):p}}function No(t,e,r){return{type:"Feature",id:t[e+Ft],properties:ea(t,e,r),geometry:{type:"Point",coordinates:[Kl(t[e]),Nl(t[e+1])]}}}function ea(t,e,r){var o=t[e+Ut],l=o>=1e4?"".concat(Math.round(o/1e3),"k"):o>=1e3?"".concat(Math.round(o/100)/10,"k"):o,f=t[e+Qs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Ft],point_count:o,point_count_abbreviated:l})}function mr(t){return t/360+.5}function vr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Kl(t){return(t-.5)*360}function Nl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Zl(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(t);l<o.length;l++)e.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(t,o[l])&&(r[o[l]]=t[o[l]]);return r}class ot{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Li{constructor(e){var{markers:r,position:o}=e;this.markers=r,o&&(o instanceof google.maps.LatLng?this._position=o:this._position=new google.maps.LatLng(o))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(ot.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ot.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ot.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class ql{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Wl(r)}}var Wl=t=>{var e=t.map(r=>new Li({position:ot.getPosition(r),markers:[r]}));return e};class $l extends ql{constructor(e){var{maxZoom:r,radius:o=60}=e,l=Zl(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:o},l))}calculate(e){var r=!1,o={zoom:e.map.getZoom()};if(!zo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var l=this.markers.map(f=>{var p=ot.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(l)}return r||(this.state.zoom<=this.maxZoom||o.zoom<=this.maxZoom)&&(r=!zo(this.state,o)),this.state=o,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(o=>this.transformCluster(o))}transformCluster(e){var{geometry:{coordinates:[r,o]},properties:l}=e;if(l.cluster)return new Li({markers:this.superCluster.getLeaves(l.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:o,lng:r}});var f=l.marker;return new Li({markers:[f],position:ot.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var o=r.map(f=>f.count),l=o.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:l/r.length,sum:l,min:Math.min(...o),max:Math.max(...o)}}}}class Hl{render(e,r,o){var{count:l,position:f}=e,p=l>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(l,`</text>
</svg>`),m="Cluster of ".concat(l," markers"),C=Number(google.maps.Marker.MAX_ZINDEX)+l;if(ot.isAdvancedMarkerAvailable(o)){var w=new DOMParser,y=w.parseFromString(h,"image/svg+xml").documentElement;y.setAttribute("transform","translate(0 25)");var S={map:o,position:f,zIndex:C,title:m,content:y};return new google.maps.marker.AdvancedMarkerElement(S)}var j={position:f,zIndex:C,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(j)}}function Gl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ri{constructor(){Gl(Ri,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Yl=(t,e,r)=>{r.fitBounds(e.bounds)};class Jl extends Ri{constructor(e){var{map:r,markers:o=[],algorithmOptions:l={},algorithm:f=new $l(l),renderer:p=new Hl,onClusterClick:h=Yl}=e;super(),this.markers=[...o],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(o=>{this.addMarker(o,!0)}),r||this.render()}removeMarker(e,r){var o=this.markers.indexOf(e);return o===-1?!1:(ot.setMap(e,null),this.markers.splice(o,1),r||this.render(),!0)}removeMarkers(e,r){var o=!1;return e.forEach(l=>{o=this.removeMarker(l,!0)||o}),o&&!r&&this.render(),o}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:o}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(o||o==null){var l=new Set;for(var f of r)f.markers.length==1&&l.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?l.has(h.marker)||ot.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>ot.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ot.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(o=>{o.markers.length===1?o.marker=o.markers[0]:(o.marker=this.renderer.render(o,e,r),o.markers.forEach(l=>ot.setMap(l,null)),this.onClusterClick&&o.marker.addListener("click",l=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,o),this.onClusterClick(l,o,r)})),ot.setMap(o.marker,r)})}}function Zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function qo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zo(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function Xl(t){var e=Za(),[r,o]=u.useState(null);return u.useEffect(()=>{if(e&&r===null){var l=new Jl(qo(qo({},t),{},{map:e}));o(l)}},[e]),r}function Ql(t){var{children:e,options:r}=t,o=Xl(r);return o!==null?e(o):null}u.memo(Ql);var Wo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},$o={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function eu(t){var{children:e,anchor:r,options:o,position:l,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:C,onZindexChanged:w,onLoad:y,onUnmount:S}=t,j=u.useContext(Me),[k,W]=u.useState(null),[U,Y]=u.useState(null),[$,ue]=u.useState(null),[F,T]=u.useState(null),[z,N]=u.useState(null),[J,K]=u.useState(null),ae=u.useRef(null);return u.useEffect(()=>{k!==null&&(k.close(),r?k.open(j,r):k.getPosition()&&k.open(j))},[j,k,r]),u.useEffect(()=>{o&&k!==null&&k.setOptions(o)},[k,o]),u.useEffect(()=>{l&&k!==null&&k.setPosition(l)},[l]),u.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),u.useEffect(()=>{k&&p&&(U!==null&&google.maps.event.removeListener(U),Y(google.maps.event.addListener(k,"closeclick",p)))},[p]),u.useEffect(()=>{k&&h&&($!==null&&google.maps.event.removeListener($),ue(google.maps.event.addListener(k,"domready",h)))},[h]),u.useEffect(()=>{k&&m&&(F!==null&&google.maps.event.removeListener(F),T(google.maps.event.addListener(k,"content_changed",m)))},[m]),u.useEffect(()=>{k&&C&&(z!==null&&google.maps.event.removeListener(z),N(google.maps.event.addListener(k,"position_changed",C)))},[C]),u.useEffect(()=>{k&&w&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(k,"zindex_changed",w)))},[w]),u.useEffect(()=>{var le=new google.maps.InfoWindow(o);return W(le),ae.current=document.createElement("div"),p&&Y(google.maps.event.addListener(le,"closeclick",p)),h&&ue(google.maps.event.addListener(le,"domready",h)),m&&T(google.maps.event.addListener(le,"content_changed",m)),C&&N(google.maps.event.addListener(le,"position_changed",C)),w&&K(google.maps.event.addListener(le,"zindex_changed",w)),le.setContent(ae.current),l&&le.setPosition(l),f&&le.setZIndex(f),r?le.open(j,r):le.getPosition()?le.open(j):qe(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),y&&y(le),()=>{U&&google.maps.event.removeListener(U),F&&google.maps.event.removeListener(F),$&&google.maps.event.removeListener($),z&&google.maps.event.removeListener(z),J&&google.maps.event.removeListener(J),S&&S(le),le.close()}},[]),ae.current?Ln.createPortal(u.Children.only(e),ae.current):null}u.memo(eu);class tu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"containerElement",null),A(this,"state",{infoWindow:null}),A(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):qe(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),A(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=De({updaterMap:$o,eventMap:Wo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:$o,eventMap:Wo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(je(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(u.Children.only(this.props.children),this.containerElement):null}}A(tu,"contextType",Me);function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Ho={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Go={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},nu={};function ru(t){var{options:e,draggable:r,editable:o,visible:l,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:C,onMouseMove:w,onMouseOut:y,onMouseOver:S,onMouseUp:j,onRightClick:k,onClick:W,onDrag:U,onLoad:Y,onUnmount:$}=t,ue=u.useContext(Me),[F,T]=u.useState(null),[z,N]=u.useState(null),[J,K]=u.useState(null),[ae,le]=u.useState(null),[re,Q]=u.useState(null),[fe,de]=u.useState(null),[be,xe]=u.useState(null),[ge,ve]=u.useState(null),[me,we]=u.useState(null),[Ie,pe]=u.useState(null),[Oe,Z]=u.useState(null),[Ae,Ue]=u.useState(null);return u.useEffect(()=>{F!==null&&F.setMap(ue)},[ue]),u.useEffect(()=>{typeof e<"u"&&F!==null&&F.setOptions(e)},[F,e]),u.useEffect(()=>{typeof r<"u"&&F!==null&&F.setDraggable(r)},[F,r]),u.useEffect(()=>{typeof o<"u"&&F!==null&&F.setEditable(o)},[F,o]),u.useEffect(()=>{typeof l<"u"&&F!==null&&F.setVisible(l)},[F,l]),u.useEffect(()=>{typeof f<"u"&&F!==null&&F.setPath(f)},[F,f]),u.useEffect(()=>{F&&p&&(z!==null&&google.maps.event.removeListener(z),N(google.maps.event.addListener(F,"dblclick",p)))},[p]),u.useEffect(()=>{F&&h&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(F,"dragend",h)))},[h]),u.useEffect(()=>{F&&m&&(ae!==null&&google.maps.event.removeListener(ae),le(google.maps.event.addListener(F,"dragstart",m)))},[m]),u.useEffect(()=>{F&&C&&(re!==null&&google.maps.event.removeListener(re),Q(google.maps.event.addListener(F,"mousedown",C)))},[C]),u.useEffect(()=>{F&&w&&(fe!==null&&google.maps.event.removeListener(fe),de(google.maps.event.addListener(F,"mousemove",w)))},[w]),u.useEffect(()=>{F&&y&&(be!==null&&google.maps.event.removeListener(be),xe(google.maps.event.addListener(F,"mouseout",y)))},[y]),u.useEffect(()=>{F&&S&&(ge!==null&&google.maps.event.removeListener(ge),ve(google.maps.event.addListener(F,"mouseover",S)))},[S]),u.useEffect(()=>{F&&j&&(me!==null&&google.maps.event.removeListener(me),we(google.maps.event.addListener(F,"mouseup",j)))},[j]),u.useEffect(()=>{F&&k&&(Ie!==null&&google.maps.event.removeListener(Ie),pe(google.maps.event.addListener(F,"rightclick",k)))},[k]),u.useEffect(()=>{F&&W&&(Oe!==null&&google.maps.event.removeListener(Oe),Z(google.maps.event.addListener(F,"click",W)))},[W]),u.useEffect(()=>{F&&U&&(Ae!==null&&google.maps.event.removeListener(Ae),Ue(google.maps.event.addListener(F,"drag",U)))},[U]),u.useEffect(()=>{var Ee=new google.maps.Polyline(Mr(Mr({},e||nu),{},{map:ue}));return f&&Ee.setPath(f),typeof l<"u"&&Ee.setVisible(l),typeof o<"u"&&Ee.setEditable(o),typeof r<"u"&&Ee.setDraggable(r),p&&N(google.maps.event.addListener(Ee,"dblclick",p)),h&&K(google.maps.event.addListener(Ee,"dragend",h)),m&&le(google.maps.event.addListener(Ee,"dragstart",m)),C&&Q(google.maps.event.addListener(Ee,"mousedown",C)),w&&de(google.maps.event.addListener(Ee,"mousemove",w)),y&&xe(google.maps.event.addListener(Ee,"mouseout",y)),S&&ve(google.maps.event.addListener(Ee,"mouseover",S)),j&&we(google.maps.event.addListener(Ee,"mouseup",j)),k&&pe(google.maps.event.addListener(Ee,"rightclick",k)),W&&Z(google.maps.event.addListener(Ee,"click",W)),U&&Ue(google.maps.event.addListener(Ee,"drag",U)),T(Ee),Y&&Y(Ee),()=>{z!==null&&google.maps.event.removeListener(z),J!==null&&google.maps.event.removeListener(J),ae!==null&&google.maps.event.removeListener(ae),re!==null&&google.maps.event.removeListener(re),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),ge!==null&&google.maps.event.removeListener(ge),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Oe!==null&&google.maps.event.removeListener(Oe),$&&$(Ee),Ee.setMap(null)}},[]),null}u.memo(ru);class iu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{polyline:null}),A(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Mr(Mr({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:Go,eventMap:Ho,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Go,eventMap:Ho,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),je(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}A(iu,"contextType",Me);function Yo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Jo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Xo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Qo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function ou(t){var{options:e,draggable:r,editable:o,visible:l,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:C,onMouseDown:w,onMouseMove:y,onMouseOut:S,onMouseOver:j,onMouseUp:k,onRightClick:W,onClick:U,onDrag:Y,onLoad:$,onUnmount:ue,onEdit:F}=t,T=u.useContext(Me),[z,N]=u.useState(null),[J,K]=u.useState(null),[ae,le]=u.useState(null),[re,Q]=u.useState(null),[fe,de]=u.useState(null),[be,xe]=u.useState(null),[ge,ve]=u.useState(null),[me,we]=u.useState(null),[Ie,pe]=u.useState(null),[Oe,Z]=u.useState(null),[Ae,Ue]=u.useState(null),[Ee,ie]=u.useState(null);return u.useEffect(()=>{z!==null&&z.setMap(T)},[T]),u.useEffect(()=>{typeof e<"u"&&z!==null&&z.setOptions(e)},[z,e]),u.useEffect(()=>{typeof r<"u"&&z!==null&&z.setDraggable(r)},[z,r]),u.useEffect(()=>{typeof o<"u"&&z!==null&&z.setEditable(o)},[z,o]),u.useEffect(()=>{typeof l<"u"&&z!==null&&z.setVisible(l)},[z,l]),u.useEffect(()=>{typeof f<"u"&&z!==null&&z.setPath(f)},[z,f]),u.useEffect(()=>{typeof p<"u"&&z!==null&&z.setPaths(p)},[z,p]),u.useEffect(()=>{z&&typeof h=="function"&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener(z,"dblclick",h)))},[h]),u.useEffect(()=>{z&&(google.maps.event.addListener(z.getPath(),"insert_at",()=>{F?.(z)}),google.maps.event.addListener(z.getPath(),"set_at",()=>{F?.(z)}),google.maps.event.addListener(z.getPath(),"remove_at",()=>{F?.(z)}))},[z,F]),u.useEffect(()=>{z&&typeof m=="function"&&(ae!==null&&google.maps.event.removeListener(ae),le(google.maps.event.addListener(z,"dragend",m)))},[m]),u.useEffect(()=>{z&&typeof C=="function"&&(re!==null&&google.maps.event.removeListener(re),Q(google.maps.event.addListener(z,"dragstart",C)))},[C]),u.useEffect(()=>{z&&typeof w=="function"&&(fe!==null&&google.maps.event.removeListener(fe),de(google.maps.event.addListener(z,"mousedown",w)))},[w]),u.useEffect(()=>{z&&typeof y=="function"&&(be!==null&&google.maps.event.removeListener(be),xe(google.maps.event.addListener(z,"mousemove",y)))},[y]),u.useEffect(()=>{z&&typeof S=="function"&&(ge!==null&&google.maps.event.removeListener(ge),ve(google.maps.event.addListener(z,"mouseout",S)))},[S]),u.useEffect(()=>{z&&typeof j=="function"&&(me!==null&&google.maps.event.removeListener(me),we(google.maps.event.addListener(z,"mouseover",j)))},[j]),u.useEffect(()=>{z&&typeof k=="function"&&(Ie!==null&&google.maps.event.removeListener(Ie),pe(google.maps.event.addListener(z,"mouseup",k)))},[k]),u.useEffect(()=>{z&&typeof W=="function"&&(Oe!==null&&google.maps.event.removeListener(Oe),Z(google.maps.event.addListener(z,"rightclick",W)))},[W]),u.useEffect(()=>{z&&typeof U=="function"&&(Ae!==null&&google.maps.event.removeListener(Ae),Ue(google.maps.event.addListener(z,"click",U)))},[U]),u.useEffect(()=>{z&&typeof Y=="function"&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener(z,"drag",Y)))},[Y]),u.useEffect(()=>{var V=new google.maps.Polygon(Jo(Jo({},e),{},{map:T}));return f&&V.setPath(f),p&&V.setPaths(p),typeof l<"u"&&V.setVisible(l),typeof o<"u"&&V.setEditable(o),typeof r<"u"&&V.setDraggable(r),h&&K(google.maps.event.addListener(V,"dblclick",h)),m&&le(google.maps.event.addListener(V,"dragend",m)),C&&Q(google.maps.event.addListener(V,"dragstart",C)),w&&de(google.maps.event.addListener(V,"mousedown",w)),y&&xe(google.maps.event.addListener(V,"mousemove",y)),S&&ve(google.maps.event.addListener(V,"mouseout",S)),j&&we(google.maps.event.addListener(V,"mouseover",j)),k&&pe(google.maps.event.addListener(V,"mouseup",k)),W&&Z(google.maps.event.addListener(V,"rightclick",W)),U&&Ue(google.maps.event.addListener(V,"click",U)),Y&&ie(google.maps.event.addListener(V,"drag",Y)),N(V),$&&$(V),()=>{J!==null&&google.maps.event.removeListener(J),ae!==null&&google.maps.event.removeListener(ae),re!==null&&google.maps.event.removeListener(re),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),ge!==null&&google.maps.event.removeListener(ge),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Oe!==null&&google.maps.event.removeListener(Oe),Ae!==null&&google.maps.event.removeListener(Ae),ue&&ue(V),V.setMap(null)}},[]),null}u.memo(ou);class su extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=De({updaterMap:Qo,eventMap:Xo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Qo,eventMap:Xo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),je(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}A(su,"contextType",Me);function es(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?es(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ts={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ns={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function au(t){var{options:e,bounds:r,draggable:o,editable:l,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:C,onMouseMove:w,onMouseOut:y,onMouseOver:S,onMouseUp:j,onRightClick:k,onClick:W,onDrag:U,onBoundsChanged:Y,onLoad:$,onUnmount:ue}=t,F=u.useContext(Me),[T,z]=u.useState(null),[N,J]=u.useState(null),[K,ae]=u.useState(null),[le,re]=u.useState(null),[Q,fe]=u.useState(null),[de,be]=u.useState(null),[xe,ge]=u.useState(null),[ve,me]=u.useState(null),[we,Ie]=u.useState(null),[pe,Oe]=u.useState(null),[Z,Ae]=u.useState(null),[Ue,Ee]=u.useState(null),[ie,V]=u.useState(null);return u.useEffect(()=>{T!==null&&T.setMap(F)},[F]),u.useEffect(()=>{typeof e<"u"&&T!==null&&T.setOptions(e)},[T,e]),u.useEffect(()=>{typeof o<"u"&&T!==null&&T.setDraggable(o)},[T,o]),u.useEffect(()=>{typeof l<"u"&&T!==null&&T.setEditable(l)},[T,l]),u.useEffect(()=>{typeof f<"u"&&T!==null&&T.setVisible(f)},[T,f]),u.useEffect(()=>{typeof r<"u"&&T!==null&&T.setBounds(r)},[T,r]),u.useEffect(()=>{T&&p&&(N!==null&&google.maps.event.removeListener(N),J(google.maps.event.addListener(T,"dblclick",p)))},[p]),u.useEffect(()=>{T&&h&&(K!==null&&google.maps.event.removeListener(K),ae(google.maps.event.addListener(T,"dragend",h)))},[h]),u.useEffect(()=>{T&&m&&(le!==null&&google.maps.event.removeListener(le),re(google.maps.event.addListener(T,"dragstart",m)))},[m]),u.useEffect(()=>{T&&C&&(Q!==null&&google.maps.event.removeListener(Q),fe(google.maps.event.addListener(T,"mousedown",C)))},[C]),u.useEffect(()=>{T&&w&&(de!==null&&google.maps.event.removeListener(de),be(google.maps.event.addListener(T,"mousemove",w)))},[w]),u.useEffect(()=>{T&&y&&(xe!==null&&google.maps.event.removeListener(xe),ge(google.maps.event.addListener(T,"mouseout",y)))},[y]),u.useEffect(()=>{T&&S&&(ve!==null&&google.maps.event.removeListener(ve),me(google.maps.event.addListener(T,"mouseover",S)))},[S]),u.useEffect(()=>{T&&j&&(we!==null&&google.maps.event.removeListener(we),Ie(google.maps.event.addListener(T,"mouseup",j)))},[j]),u.useEffect(()=>{T&&k&&(pe!==null&&google.maps.event.removeListener(pe),Oe(google.maps.event.addListener(T,"rightclick",k)))},[k]),u.useEffect(()=>{T&&W&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(T,"click",W)))},[W]),u.useEffect(()=>{T&&U&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener(T,"drag",U)))},[U]),u.useEffect(()=>{T&&Y&&(ie!==null&&google.maps.event.removeListener(ie),V(google.maps.event.addListener(T,"bounds_changed",Y)))},[Y]),u.useEffect(()=>{var ye=new google.maps.Rectangle(Pr(Pr({},e),{},{map:F}));return typeof f<"u"&&ye.setVisible(f),typeof l<"u"&&ye.setEditable(l),typeof o<"u"&&ye.setDraggable(o),typeof r<"u"&&ye.setBounds(r),p&&J(google.maps.event.addListener(ye,"dblclick",p)),h&&ae(google.maps.event.addListener(ye,"dragend",h)),m&&re(google.maps.event.addListener(ye,"dragstart",m)),C&&fe(google.maps.event.addListener(ye,"mousedown",C)),w&&be(google.maps.event.addListener(ye,"mousemove",w)),y&&ge(google.maps.event.addListener(ye,"mouseout",y)),S&&me(google.maps.event.addListener(ye,"mouseover",S)),j&&Ie(google.maps.event.addListener(ye,"mouseup",j)),k&&Oe(google.maps.event.addListener(ye,"rightclick",k)),W&&Ae(google.maps.event.addListener(ye,"click",W)),U&&Ee(google.maps.event.addListener(ye,"drag",U)),Y&&V(google.maps.event.addListener(ye,"bounds_changed",Y)),z(ye),$&&$(ye),()=>{N!==null&&google.maps.event.removeListener(N),K!==null&&google.maps.event.removeListener(K),le!==null&&google.maps.event.removeListener(le),Q!==null&&google.maps.event.removeListener(Q),de!==null&&google.maps.event.removeListener(de),xe!==null&&google.maps.event.removeListener(xe),ve!==null&&google.maps.event.removeListener(ve),we!==null&&google.maps.event.removeListener(we),pe!==null&&google.maps.event.removeListener(pe),Z!==null&&google.maps.event.removeListener(Z),Ue!==null&&google.maps.event.removeListener(Ue),ie!==null&&google.maps.event.removeListener(ie),ue&&ue(ye),ye.setMap(null)}},[]),null}u.memo(au);class lu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{rectangle:null}),A(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:ns,eventMap:ts,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ns,eventMap:ts,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),je(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}A(lu,"contextType",Me);function rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var is={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},os={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},uu={};function cu(t){var{options:e,center:r,radius:o,draggable:l,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:C,onMouseDown:w,onMouseMove:y,onMouseOut:S,onMouseOver:j,onMouseUp:k,onRightClick:W,onClick:U,onDrag:Y,onCenterChanged:$,onRadiusChanged:ue,onLoad:F,onUnmount:T}=t,z=u.useContext(Me),[N,J]=u.useState(null),[K,ae]=u.useState(null),[le,re]=u.useState(null),[Q,fe]=u.useState(null),[de,be]=u.useState(null),[xe,ge]=u.useState(null),[ve,me]=u.useState(null),[we,Ie]=u.useState(null),[pe,Oe]=u.useState(null),[Z,Ae]=u.useState(null),[Ue,Ee]=u.useState(null),[ie,V]=u.useState(null),[ye,Ce]=u.useState(null),[Je,qt]=u.useState(null);return u.useEffect(()=>{N!==null&&N.setMap(z)},[z]),u.useEffect(()=>{typeof e<"u"&&N!==null&&N.setOptions(e)},[N,e]),u.useEffect(()=>{typeof l<"u"&&N!==null&&N.setDraggable(l)},[N,l]),u.useEffect(()=>{typeof f<"u"&&N!==null&&N.setEditable(f)},[N,f]),u.useEffect(()=>{typeof p<"u"&&N!==null&&N.setVisible(p)},[N,p]),u.useEffect(()=>{typeof o=="number"&&N!==null&&N.setRadius(o)},[N,o]),u.useEffect(()=>{typeof r<"u"&&N!==null&&N.setCenter(r)},[N,r]),u.useEffect(()=>{N&&h&&(K!==null&&google.maps.event.removeListener(K),ae(google.maps.event.addListener(N,"dblclick",h)))},[h]),u.useEffect(()=>{N&&m&&(le!==null&&google.maps.event.removeListener(le),re(google.maps.event.addListener(N,"dragend",m)))},[m]),u.useEffect(()=>{N&&C&&(Q!==null&&google.maps.event.removeListener(Q),fe(google.maps.event.addListener(N,"dragstart",C)))},[C]),u.useEffect(()=>{N&&w&&(de!==null&&google.maps.event.removeListener(de),be(google.maps.event.addListener(N,"mousedown",w)))},[w]),u.useEffect(()=>{N&&y&&(xe!==null&&google.maps.event.removeListener(xe),ge(google.maps.event.addListener(N,"mousemove",y)))},[y]),u.useEffect(()=>{N&&S&&(ve!==null&&google.maps.event.removeListener(ve),me(google.maps.event.addListener(N,"mouseout",S)))},[S]),u.useEffect(()=>{N&&j&&(we!==null&&google.maps.event.removeListener(we),Ie(google.maps.event.addListener(N,"mouseover",j)))},[j]),u.useEffect(()=>{N&&k&&(pe!==null&&google.maps.event.removeListener(pe),Oe(google.maps.event.addListener(N,"mouseup",k)))},[k]),u.useEffect(()=>{N&&W&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(N,"rightclick",W)))},[W]),u.useEffect(()=>{N&&U&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener(N,"click",U)))},[U]),u.useEffect(()=>{N&&Y&&(ie!==null&&google.maps.event.removeListener(ie),V(google.maps.event.addListener(N,"drag",Y)))},[Y]),u.useEffect(()=>{N&&$&&(ye!==null&&google.maps.event.removeListener(ye),Ce(google.maps.event.addListener(N,"center_changed",$)))},[U]),u.useEffect(()=>{N&&ue&&(Je!==null&&google.maps.event.removeListener(Je),qt(google.maps.event.addListener(N,"radius_changed",ue)))},[ue]),u.useEffect(()=>{var Re=new google.maps.Circle(Or(Or({},e||uu),{},{map:z}));return typeof o=="number"&&Re.setRadius(o),typeof r<"u"&&Re.setCenter(r),typeof o=="number"&&Re.setRadius(o),typeof p<"u"&&Re.setVisible(p),typeof f<"u"&&Re.setEditable(f),typeof l<"u"&&Re.setDraggable(l),h&&ae(google.maps.event.addListener(Re,"dblclick",h)),m&&re(google.maps.event.addListener(Re,"dragend",m)),C&&fe(google.maps.event.addListener(Re,"dragstart",C)),w&&be(google.maps.event.addListener(Re,"mousedown",w)),y&&ge(google.maps.event.addListener(Re,"mousemove",y)),S&&me(google.maps.event.addListener(Re,"mouseout",S)),j&&Ie(google.maps.event.addListener(Re,"mouseover",j)),k&&Oe(google.maps.event.addListener(Re,"mouseup",k)),W&&Ae(google.maps.event.addListener(Re,"rightclick",W)),U&&Ee(google.maps.event.addListener(Re,"click",U)),Y&&V(google.maps.event.addListener(Re,"drag",Y)),$&&Ce(google.maps.event.addListener(Re,"center_changed",$)),ue&&qt(google.maps.event.addListener(Re,"radius_changed",ue)),J(Re),F&&F(Re),()=>{K!==null&&google.maps.event.removeListener(K),le!==null&&google.maps.event.removeListener(le),Q!==null&&google.maps.event.removeListener(Q),de!==null&&google.maps.event.removeListener(de),xe!==null&&google.maps.event.removeListener(xe),ve!==null&&google.maps.event.removeListener(ve),we!==null&&google.maps.event.removeListener(we),pe!==null&&google.maps.event.removeListener(pe),Z!==null&&google.maps.event.removeListener(Z),Ue!==null&&google.maps.event.removeListener(Ue),ye!==null&&google.maps.event.removeListener(ye),Je!==null&&google.maps.event.removeListener(Je),T&&T(Re),Re.setMap(null)}},[]),null}u.memo(cu);class fu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{circle:null}),A(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:os,eventMap:is,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:os,eventMap:is,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),je(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}A(fu,"contextType",Me);function ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var as={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ls={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,o){t.loadGeoJson(e,r,o)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function du(t){var{options:e,onClick:r,onDblClick:o,onMouseDown:l,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:C,onAddFeature:w,onRemoveFeature:y,onRemoveProperty:S,onSetGeometry:j,onSetProperty:k,onLoad:W,onUnmount:U}=t,Y=u.useContext(Me),[$,ue]=u.useState(null),[F,T]=u.useState(null),[z,N]=u.useState(null),[J,K]=u.useState(null),[ae,le]=u.useState(null),[re,Q]=u.useState(null),[fe,de]=u.useState(null),[be,xe]=u.useState(null),[ge,ve]=u.useState(null),[me,we]=u.useState(null),[Ie,pe]=u.useState(null),[Oe,Z]=u.useState(null),[Ae,Ue]=u.useState(null),[Ee,ie]=u.useState(null);return u.useEffect(()=>{$!==null&&$.setMap(Y)},[Y]),u.useEffect(()=>{$&&o&&(F!==null&&google.maps.event.removeListener(F),T(google.maps.event.addListener($,"dblclick",o)))},[o]),u.useEffect(()=>{$&&l&&(z!==null&&google.maps.event.removeListener(z),N(google.maps.event.addListener($,"mousedown",l)))},[l]),u.useEffect(()=>{$&&f&&(J!==null&&google.maps.event.removeListener(J),K(google.maps.event.addListener($,"mousemove",f)))},[f]),u.useEffect(()=>{$&&p&&(ae!==null&&google.maps.event.removeListener(ae),le(google.maps.event.addListener($,"mouseout",p)))},[p]),u.useEffect(()=>{$&&h&&(re!==null&&google.maps.event.removeListener(re),Q(google.maps.event.addListener($,"mouseover",h)))},[h]),u.useEffect(()=>{$&&m&&(fe!==null&&google.maps.event.removeListener(fe),de(google.maps.event.addListener($,"mouseup",m)))},[m]),u.useEffect(()=>{$&&C&&(be!==null&&google.maps.event.removeListener(be),xe(google.maps.event.addListener($,"rightclick",C)))},[C]),u.useEffect(()=>{$&&r&&(ge!==null&&google.maps.event.removeListener(ge),ve(google.maps.event.addListener($,"click",r)))},[r]),u.useEffect(()=>{$&&w&&(me!==null&&google.maps.event.removeListener(me),we(google.maps.event.addListener($,"addfeature",w)))},[w]),u.useEffect(()=>{$&&y&&(Ie!==null&&google.maps.event.removeListener(Ie),pe(google.maps.event.addListener($,"removefeature",y)))},[y]),u.useEffect(()=>{$&&S&&(Oe!==null&&google.maps.event.removeListener(Oe),Z(google.maps.event.addListener($,"removeproperty",S)))},[S]),u.useEffect(()=>{$&&j&&(Ae!==null&&google.maps.event.removeListener(Ae),Ue(google.maps.event.addListener($,"setgeometry",j)))},[j]),u.useEffect(()=>{$&&k&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener($,"setproperty",k)))},[k]),u.useEffect(()=>{if(Y!==null){var V=new google.maps.Data(_r(_r({},e),{},{map:Y}));o&&T(google.maps.event.addListener(V,"dblclick",o)),l&&N(google.maps.event.addListener(V,"mousedown",l)),f&&K(google.maps.event.addListener(V,"mousemove",f)),p&&le(google.maps.event.addListener(V,"mouseout",p)),h&&Q(google.maps.event.addListener(V,"mouseover",h)),m&&de(google.maps.event.addListener(V,"mouseup",m)),C&&xe(google.maps.event.addListener(V,"rightclick",C)),r&&ve(google.maps.event.addListener(V,"click",r)),w&&we(google.maps.event.addListener(V,"addfeature",w)),y&&pe(google.maps.event.addListener(V,"removefeature",y)),S&&Z(google.maps.event.addListener(V,"removeproperty",S)),j&&Ue(google.maps.event.addListener(V,"setgeometry",j)),k&&ie(google.maps.event.addListener(V,"setproperty",k)),ue(V),W&&W(V)}return()=>{$&&(F!==null&&google.maps.event.removeListener(F),z!==null&&google.maps.event.removeListener(z),J!==null&&google.maps.event.removeListener(J),ae!==null&&google.maps.event.removeListener(ae),re!==null&&google.maps.event.removeListener(re),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),ge!==null&&google.maps.event.removeListener(ge),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Oe!==null&&google.maps.event.removeListener(Oe),Ae!==null&&google.maps.event.removeListener(Ae),Ee!==null&&google.maps.event.removeListener(Ee),U&&U($),$.setMap(null))}},[]),null}u.memo(du);class pu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{data:null}),A(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:ls,eventMap:as,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ls,eventMap:as,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),je(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}A(pu,"contextType",Me);function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function cs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var fs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},ds={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class hu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{kmlLayer:null}),A(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(cs(cs({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:ds,eventMap:fs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ds,eventMap:fs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),je(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}A(hu,"contextType",Me);function ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function gu(t,e){return new e(t.lat,t.lng)}function mu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){return t instanceof e?t:r(t,e)}function bu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r.getNorthEast()),l=t&&t.fromLatLngToDivPixel(r.getSouthWest());return o&&l?{left:"".concat(l.x+e.x,"px"),top:"".concat(o.y+e.y,"px"),width:"".concat(o.x-l.x-e.x,"px"),height:"".concat(l.y-o.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function wu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r);if(o){var{x:l,y:f}=o;return{left:"".concat(l+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function na(t,e,r,o){return r!==void 0?bu(t,e,yu(r,google.maps.LatLngBounds,mu)):wu(t,e,vu(o,google.maps.LatLng,gu))}function Lu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Cu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function xu(t,e,r,o,l){class f extends google.maps.OverlayView{constructor(h,m,C,w){super(),this.container=h,this.pane=m,this.position=C,this.bounds=w}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=Cu({},this.container?ta(this.container,l):{x:0,y:0}),C=na(h,m,this.bounds,this.position);for(var[w,y]of Object.entries(C))this.container.style[w]=y}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,o)}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Eu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function ms(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function ku(t){var{position:e,bounds:r,mapPaneName:o,zIndex:l,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,C=u.useContext(Me),w=u.useMemo(()=>{var S=document.createElement("div");return S.style.position="absolute",S},[]),y=u.useMemo(()=>xu(w,o,e,r,h),[w,o,e,r]);return u.useEffect(()=>(f?.(y),y?.setMap(C),()=>{p?.(y),y?.setMap(null)}),[C,y]),u.useEffect(()=>{w.style.zIndex="".concat(l)},[l,w]),Ln.createPortal(m,w)}u.memo(ku);class Zt extends u.PureComponent{constructor(e){super(e),A(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),A(this,"updatePane",()=>{var o=this.props.mapPaneName,l=this.overlayView.getPanes();qe(!!o,"OverlayView requires props.mapPaneName but got %s",o),l?this.setState({paneEl:l[o]}):this.setState({paneEl:null})}),A(this,"onAdd",()=>{var o,l;this.updatePane(),(o=(l=this.props).onLoad)===null||o===void 0||o.call(l,this.overlayView)}),A(this,"onPositionElement",()=>{var o=this.overlayView.getProjection(),l=Eu({x:0,y:0},this.containerRef.current?ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=na(o,l,this.props.bounds,this.props.position);if(!Lu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,C;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(C=f.height)!==null&&C!==void 0?C:0,position:"absolute"}})}}),A(this,"draw",()=>{this.onPositionElement()}),A(this,"onRemove",()=>{var o,l;this.setState(()=>({paneEl:null})),(o=(l=this.props).onUnmount)===null||o===void 0||o.call(l,this.overlayView)}),this.containerRef=u.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=gs(e.position),o=gs(this.props.position),l=ms(e.bounds),f=ms(this.props.bounds);(r!==o||l!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(se.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:u.Children.only(this.props.children)}),e):null}}A(Zt,"FLOAT_PANE","floatPane");A(Zt,"MAP_PANE","mapPane");A(Zt,"MARKER_LAYER","markerLayer");A(Zt,"OVERLAY_LAYER","overlayLayer");A(Zt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");A(Zt,"contextType",Me);function Su(){}function vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vs(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var bs={onDblClick:"dblclick",onClick:"click"},ws={opacity(t,e){t.setOpacity(e)}};function Mu(t){var{url:e,bounds:r,options:o,visible:l}=t,f=u.useContext(Me),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=u.useMemo(()=>new google.maps.GroundOverlay(e,p,o),[]);return u.useEffect(()=>{h!==null&&h.setMap(f)},[f]),u.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),u.useEffect(()=>{typeof l<"u"&&h!==null&&h.setOpacity(l?1:0)},[h,l]),u.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}u.memo(Mu);class ra extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{groundOverlay:null}),A(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){qe(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ys(ys({},this.props.options),{},{map:this.context}));this.registeredEvents=De({updaterMap:ws,eventMap:bs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ws,eventMap:bs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}A(ra,"defaultProps",{onLoad:Su});A(ra,"contextType",Me);function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,o)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(o){A(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Cs={},xs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Pu(t){var{data:e,onLoad:r,onUnmount:o,options:l}=t,f=u.useContext(Me),[p,h]=u.useState(null);return u.useEffect(()=>{google.maps.visualization||qe(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),u.useEffect(()=>{qe(!!e,"data property is required in HeatmapLayer %s",e)},[e]),u.useEffect(()=>{p!==null&&p.setMap(f)},[f]),u.useEffect(()=>{l&&p!==null&&p.setOptions(l)},[p,l]),u.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Dr(Dr({},l),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(o&&o(p),p.setMap(null))}},[]),null}u.memo(Pu);class Ou extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{heatmapLayer:null}),A(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){qe(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),qe(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Dr(Dr({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=De({updaterMap:xs,eventMap:Cs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=De({updaterMap:xs,eventMap:Cs,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),je(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}A(Ou,"contextType",Me);var Es={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},ks={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{streetViewPanorama:null}),A(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,o=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=De({updaterMap:ks,eventMap:Es,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({streetViewPanorama:o}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:ks,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),je(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}A(_u,"contextType",Me);class Du extends u.PureComponent{constructor(){super(...arguments),A(this,"state",{streetViewService:null}),A(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}A(Du,"contextType",Me);var Ss={onDirectionsChanged:"directions_changed"},Ms={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Iu extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"state",{directionsRenderer:null}),A(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=De({updaterMap:Ms,eventMap:Ss,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Ms,eventMap:Ss,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),je(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}A(Iu,"contextType",Me);var Ps={onPlacesChanged:"places_changed"},Os={bounds(t,e){t.setBounds(e)}};class ju extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"containerElement",u.createRef()),A(this,"state",{searchBox:null}),A(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(qe(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=De({updaterMap:Os,eventMap:Ps,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(je(this.registeredEvents),this.registeredEvents=De({updaterMap:Os,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),je(this.registeredEvents))}render(){return se.jsx("div",{ref:this.containerElement,children:u.Children.only(this.props.children)})}}A(ju,"contextType",Me);var _s={onPlaceChanged:"place_changed"},Ds={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ia extends u.PureComponent{constructor(){super(...arguments),A(this,"registeredEvents",[]),A(this,"containerElement",u.createRef()),A(this,"state",{autocomplete:null}),A(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;qe(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var o=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=De({updaterMap:Ds,eventMap:_s,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({autocomplete:o}),this.setAutocompleteCallback)}}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=De({updaterMap:Ds,eventMap:_s,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&je(this.registeredEvents)}render(){return se.jsx("div",{ref:this.containerElement,className:this.props.className,children:u.Children.only(this.props.children)})}}A(ia,"defaultProps",{className:""});A(ia,"contextType",Me);const Ru="/chill-demo/assets/cloud-CFb1wSHM.png",Bt=5e-4,Lr=new Image;Lr.src=Ru;const Tu=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const o=e.createImageData(r,r),l=o.data;for(let f=0;f<l.length;f+=4){const p=Math.random()*100;l[f]=p,l[f+1]=p,l[f+2]=p,l[f+3]=5}return e.putImageData(o,0,0),e.createPattern(t,"repeat")},Au=({map:t,zoom:e,claimedCells:r,exploredCells:o,hoveredCell:l,isAnimating:f,selectedCell:p})=>{const h=u.useRef(null),m=u.useRef(null),[C,w]=u.useState([]),[y,S]=u.useState([]),j=u.useRef(r),k=u.useRef(o),W=u.useRef(null);return u.useEffect(()=>{j.current=r},[r]),u.useEffect(()=>{k.current=o},[o]),u.useEffect(()=>{W.current=Tu();const U=new Worker(new URL("/chill-demo/assets/grid.worker-6f75YCnB.js",import.meta.url),{type:"module"});return m.current=U,U.onmessage=Y=>{const{claimedCellsToDraw:$,exploredCellsToDraw:ue}=Y.data;w($),S(ue)},()=>{U.terminate()}},[]),u.useEffect(()=>{if(!t)return;class U extends window.google.maps.OverlayView{constructor(){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.fogCanvas.style.transition="opacity 0.3s ease-in-out",this.cloudsCanvas=document.createElement("canvas"),this.cloudsCtx=this.cloudsCanvas.getContext("2d"),this.cloudsCanvas.style.position="absolute",this.cloudsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none",Lr.onload=()=>this.drawClouds()}setProps(J){this.props={...this.props,...J}}setDrawableCells(J,K){this.drawableClaimed=J,this.drawableExplored=K}onAdd(){const J=this.getPanes();J.overlayLayer.appendChild(this.fogCanvas),J.overlayMouseTarget.appendChild(this.cloudsCanvas),J.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.cloudsCanvas,this.dynamicCanvas].forEach(J=>{J.parentElement&&J.parentElement.removeChild(J)})}draw(){const J=this.getProjection();if(!J)return;const K=.5,ae=this.getMap().getBounds(),le=ae.getSouthWest(),re=ae.getNorthEast(),Q=J.fromLatLngToDivPixel(le),fe=J.fromLatLngToDivPixel(re);if(!Q||!fe)return;const de=fe.x-Q.x,be=Q.y-fe.y,xe=Math.round(de*K),ge=Math.round(be*K),ve=de+2*xe,me=be+2*ge;this.swPixel={x:Q.x-xe,y:Q.y+ge},this.nePixel={x:fe.x+xe,y:fe.y-ge},[this.fogCanvas,this.cloudsCanvas,this.dynamicCanvas].forEach(we=>{we.style.left=`${Q.x-xe}px`,we.style.top=`${fe.y-ge}px`,we.width=ve,we.height=me}),this.drawFog(),this.drawClouds(),this.drawDynamic()}drawFog(){const J=this.getProjection();!J||!this.swPixel||(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),W.current&&(this.fogCtx.fillStyle=W.current,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(K=>{const{south:ae,west:le}=K,re=new window.google.maps.LatLng(ae,le),Q=new window.google.maps.LatLng(ae+Bt,le+Bt),fe=J.fromLatLngToDivPixel(re),de=J.fromLatLngToDivPixel(Q);if(!fe||!de)return;const be=fe.x-this.swPixel.x,xe=de.y-this.nePixel.y,ge=de.x-fe.x,ve=fe.y-de.y,me=be+ge/2,we=xe+ve/2,Ie=ge*1.5,pe=ve*1.5,Oe=this.fogCtx.createRadialGradient(me,we,0,me,we,Math.max(Ie,pe));Oe.addColorStop(0,"rgba(0, 0, 0, 1)"),Oe.addColorStop(.7,"rgba(0, 0, 0, 1)"),Oe.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=Oe,this.fogCtx.beginPath(),this.fogCtx.ellipse(me,we,Ie,pe,0,0,2*Math.PI),this.fogCtx.fill()}),this.fogCtx.globalCompositeOperation="source-over")}drawClouds(){const J=this.getProjection();!J||!Lr.complete||!this.swPixel||(this.cloudsCtx.clearRect(0,0,this.cloudsCanvas.width,this.cloudsCanvas.height),this.drawableClaimed.forEach(K=>{const{south:ae,west:le}=K,re=J.fromLatLngToDivPixel(new window.google.maps.LatLng(ae,le)),Q=J.fromLatLngToDivPixel(new window.google.maps.LatLng(ae+Bt,le+Bt));!re||!Q||this.cloudsCtx.drawImage(Lr,re.x-this.swPixel.x,Q.y-this.nePixel.y,Q.x-re.x,re.y-Q.y)}))}drawDynamic(){const J=this.getProjection();if(!J||!this.swPixel)return;const{hoveredCell:K,selectedCell:ae}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height);const le=ae?ae.key:K;if(!le)return;const[re,Q]=le.split("_").map(Number),fe=re*Bt,de=Q*Bt,be=new window.google.maps.LatLng(fe,de),xe=new window.google.maps.LatLng(fe+Bt,de+Bt),ge=J.fromLatLngToDivPixel(be),ve=J.fromLatLngToDivPixel(xe);if(!ge||!ve)return;const me=ge.x-this.swPixel.x,we=ve.y-this.nePixel.y,Ie=ve.x-ge.x,pe=ge.y-ve.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(me,we,Ie,pe)}}const Y=new U;Y.setMap(t),h.current=Y;let $=null;const ue=100,F=()=>{if(m.current){const N=t.getBounds();N&&m.current.postMessage({bounds:{southwest:{lat:N.getSouthWest().lat(),lng:N.getSouthWest().lng()},northeast:{lat:N.getNorthEast().lat(),lng:N.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:j.current,exploredCells:k.current})}},T=t.addListener("bounds_changed",()=>{$||($=setTimeout(()=>{F(),$=null},ue))}),z=t.addListener("idle",F);return()=>{h.current&&h.current.setMap(null),window.google.maps.event.removeListener(T),window.google.maps.event.removeListener(z),$&&clearTimeout($)}},[t]),u.useEffect(()=>{h.current&&(h.current.setProps({zoom:e,hoveredCell:l,isAnimating:f,selectedCell:p}),h.current.drawDynamic(),h.current.drawFog())},[e,l,f,p]),u.useEffect(()=>{h.current&&(h.current.setDrawableCells(C,y),h.current.drawFog(),h.current.drawClouds())},[C,y]),u.useEffect(()=>{if(!t||!m.current)return;const U=t.getBounds();U&&m.current.postMessage({bounds:{southwest:{lat:U.getSouthWest().lat(),lng:U.getSouthWest().lng()},northeast:{lat:U.getNorthEast().lat(),lng:U.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:r,exploredCells:o})},[r,o,t]),null},Is=t=>{let e;const r=new Set,o=(C,w)=>{const y=typeof C=="function"?C(e):C;if(!Object.is(y,e)){const S=e;e=w??(typeof y!="object"||y===null)?y:Object.assign({},e,y),r.forEach(j=>j(e,S))}},l=()=>e,h={setState:o,getState:l,getInitialState:()=>m,subscribe:C=>(r.add(C),()=>r.delete(C))},m=e=t(o,l,h);return h},Bu=(t=>t?Is(t):Is),zu=t=>t;function Uu(t,e=zu){const r=en.useSyncExternalStore(t.subscribe,en.useCallback(()=>e(t.getState()),[t,e]),en.useCallback(()=>e(t.getInitialState()),[t,e]));return en.useDebugValue(r),r}const js=t=>{const e=Bu(t),r=o=>Uu(e,o);return Object.assign(r,e),r},Fu=(t=>t?js(t):js);var oa=Symbol.for("immer-nothing"),Rs=Symbol.for("immer-draftable"),st=Symbol.for("immer-state");function ft(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Kn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[st]}function tn(t){return t?sa(t)||Array.isArray(t)||!!t[Rs]||!!t.constructor?.[Rs]||qn(t)||Br(t):!1}var Ku=Object.prototype.constructor.toString(),Ts=new WeakMap;function sa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let o=Ts.get(r);return o===void 0&&(o=Function.toString.call(r),Ts.set(r,o)),o===Ku}function Ir(t,e,r=!0){Ar(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(l=>{e(l,t[l],t)}):t.forEach((o,l)=>e(l,o,t))}function Ar(t){const e=t[st];return e?e.type_:Array.isArray(t)?1:qn(t)?2:Br(t)?3:0}function Ci(t,e){return Ar(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function aa(t,e,r){const o=Ar(t);o===2?t.set(e,r):o===3?t.add(r):t[e]=r}function Nu(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function qn(t){return t instanceof Map}function Br(t){return t instanceof Set}function Xt(t){return t.copy_||t.base_}function xi(t,e){if(qn(t))return new Map(t);if(Br(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=sa(t);if(e===!0||e==="class_only"&&!r){const o=Object.getOwnPropertyDescriptors(t);delete o[st];let l=Reflect.ownKeys(o);for(let f=0;f<l.length;f++){const p=l[f],h=o[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(o[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Kn(t),o)}else{const o=Kn(t);if(o!==null&&r)return{...t};const l=Object.create(o);return Object.assign(l,t)}}function Ti(t,e=!1){return zr(t)||wn(t)||!tn(t)||(Ar(t)>1&&Object.defineProperties(t,{set:yr,add:yr,clear:yr,delete:yr}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ti(r,!0))),t}function Zu(){ft(2)}var yr={value:Zu};function zr(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var qu={};function nn(t){const e=qu[t];return e||ft(0,t),e}var Nn;function la(){return Nn}function Wu(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function As(t,e){e&&(nn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Ei(t){ki(t),t.drafts_.forEach($u),t.drafts_=null}function ki(t){t===Nn&&(Nn=t.parent_)}function Bs(t){return Nn=Wu(Nn,t)}function $u(t){const e=t[st];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[st].modified_&&(Ei(e),ft(4)),tn(t)&&(t=jr(e,t),e.parent_||Rr(e,t)),e.patches_&&nn("Patches").generateReplacementPatches_(r[st].base_,t,e.patches_,e.inversePatches_)):t=jr(e,r,[]),Ei(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==oa?t:void 0}function jr(t,e,r){if(zr(e))return e;const o=t.immer_.shouldUseStrictIteration(),l=e[st];if(!l)return Ir(e,(f,p)=>Us(t,l,e,f,p,r),o),e;if(l.scope_!==t)return e;if(!l.modified_)return Rr(t,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const f=l.copy_;let p=f,h=!1;l.type_===3&&(p=new Set(f),f.clear(),h=!0),Ir(p,(m,C)=>Us(t,l,f,m,C,r,h),o),Rr(t,f,!1),r&&t.patches_&&nn("Patches").generatePatches_(l,r,t.patches_,t.inversePatches_)}return l.copy_}function Us(t,e,r,o,l,f,p){if(l==null||typeof l!="object"&&!p)return;const h=zr(l);if(!(h&&!p)){if(wn(l)){const m=f&&e&&e.type_!==3&&!Ci(e.assigned_,o)?f.concat(o):void 0,C=jr(t,l,m);if(aa(r,o,C),wn(C))t.canAutoFreeze_=!1;else return}else p&&r.add(l);if(tn(l)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[o]===l&&h)return;jr(t,l),(!e||!e.scope_.parent_)&&typeof o!="symbol"&&(qn(r)?r.has(o):Object.prototype.propertyIsEnumerable.call(r,o))&&Rr(t,l)}}}function Rr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ti(e,r)}function Vu(t,e){const r=Array.isArray(t),o={type_:r?1:0,scope_:e?e.scope_:la(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=o,f=Ai;r&&(l=[o],f=Zn);const{revoke:p,proxy:h}=Proxy.revocable(l,f);return o.draft_=h,o.revoke_=p,h}var Ai={get(t,e){if(e===st)return t;const r=Xt(t);if(!Ci(r,e))return Hu(t,r,e);const o=r[e];return t.finalized_||!tn(o)?o:o===vi(t.base_,e)?(yi(t),t.copy_[e]=Mi(o,t)):o},has(t,e){return e in Xt(t)},ownKeys(t){return Reflect.ownKeys(Xt(t))},set(t,e,r){const o=ua(Xt(t),e);if(o?.set)return o.set.call(t.draft_,r),!0;if(!t.modified_){const l=vi(Xt(t),e),f=l?.[st];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Nu(r,l)&&(r!==void 0||Ci(t.base_,e)))return!0;yi(t),Si(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,yi(t),Si(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xt(t),o=Reflect.getOwnPropertyDescriptor(r,e);return o&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:o.enumerable,value:r[e]}},defineProperty(){ft(11)},getPrototypeOf(t){return Kn(t.base_)},setPrototypeOf(){ft(12)}},Zn={};Ir(Ai,(t,e)=>{Zn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Zn.deleteProperty=function(t,e){return Zn.set.call(this,t,e,void 0)};Zn.set=function(t,e,r){return Ai.set.call(this,t[0],e,r,t[0])};function vi(t,e){const r=t[st];return(r?Xt(r):t)[e]}function Hu(t,e,r){const o=ua(e,r);return o?"value"in o?o.value:o.get?.call(t.draft_):void 0}function ua(t,e){if(!(e in t))return;let r=Kn(t);for(;r;){const o=Object.getOwnPropertyDescriptor(r,e);if(o)return o;r=Kn(r)}}function Si(t){t.modified_||(t.modified_=!0,t.parent_&&Si(t.parent_))}function yi(t){t.copy_||(t.copy_=xi(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Gu=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,o)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...C){return p.produce(m,w=>r.call(this,w,...C))}}typeof r!="function"&&ft(6),o!==void 0&&typeof o!="function"&&ft(7);let l;if(tn(e)){const f=Bs(this),p=Mi(e,void 0);let h=!0;try{l=r(p),h=!1}finally{h?Ei(f):ki(f)}return As(f,o),zs(l,f)}else if(!e||typeof e!="object"){if(l=r(e),l===void 0&&(l=e),l===oa&&(l=void 0),this.autoFreeze_&&Ti(l,!0),o){const f=[],p=[];nn("Patches").generateReplacementPatches_(e,l,f,p),o(f,p)}return l}else ft(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let o,l;return[this.produce(e,r,(p,h)=>{o=p,l=h}),o,l]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){tn(t)||ft(8),wn(t)&&(t=Yu(t));const e=Bs(this),r=Mi(t,void 0);return r[st].isManual_=!0,ki(e),r}finishDraft(t,e){const r=t&&t[st];(!r||!r.isManual_)&&ft(9);const{scope_:o}=r;return As(o,e),zs(void 0,o)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const l=e[r];if(l.path.length===0&&l.op==="replace"){t=l.value;break}}r>-1&&(e=e.slice(r+1));const o=nn("Patches").applyPatches_;return wn(t)?o(t,e):this.produce(t,l=>o(l,e))}};function Mi(t,e){const r=qn(t)?nn("MapSet").proxyMap_(t,e):Br(t)?nn("MapSet").proxySet_(t,e):Vu(t,e);return(e?e.scope_:la()).drafts_.push(r),r}function Yu(t){return wn(t)||ft(10,t),ca(t)}function ca(t){if(!tn(t)||zr(t))return t;const e=t[st];let r,o=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=xi(t,e.scope_.immer_.useStrictShallowCopy_),o=e.scope_.immer_.shouldUseStrictIteration()}else r=xi(t,!0);return Ir(r,(l,f)=>{aa(r,l,ca(f))},o),e&&(e.finalized_=!1),r}var Ju=new Gu,Xu=Ju.produce;const Qu=t=>(e,r,o)=>(o.setState=(l,f,...p)=>{const h=typeof l=="function"?Xu(l):l;return e(h,f,...p)},t(o.setState,r,o)),ec=Qu;var Cr={exports:{}},tc=Cr.exports,Fs;function nc(){return Fs||(Fs=1,(function(t,e){(function(r,o){t.exports=o()})(tc,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,s=1,a=arguments.length;s<a;s++)for(var c in i=arguments[s])Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c]);return n}).apply(this,arguments)};function l(n,i,s){for(var a,c=0,d=i.length;c<d;c++)!a&&c in i||((a=a||Array.prototype.slice.call(i,0,c))[c]=i[c]);return n.concat(a||Array.prototype.slice.call(i))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ta,p=Object.keys,h=Array.isArray;function m(n,i){return typeof i!="object"||p(i).forEach(function(s){n[s]=i[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var C=Object.getPrototypeOf,w={}.hasOwnProperty;function y(n,i){return w.call(n,i)}function S(n,i){typeof i=="function"&&(i=i(C(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(i).forEach(function(s){k(n,s,i[s])})}var j=Object.defineProperty;function k(n,i,s,a){j(n,i,m(s&&y(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function W(n){return{from:function(i){return n.prototype=Object.create(i.prototype),k(n.prototype,"constructor",n),{extend:S.bind(null,n.prototype)}}}}var U=Object.getOwnPropertyDescriptor,Y=[].slice;function $(n,i,s){return Y.call(n,i,s)}function ue(n,i){return i(n)}function F(n){if(!n)throw new Error("Assertion Failed")}function T(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function z(n,i){if(typeof i=="string"&&y(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var s=[],a=0,c=i.length;a<c;++a){var d=z(n,i[a]);s.push(d)}return s}var g=i.indexOf(".");if(g!==-1){var v=n[i.substr(0,g)];return v==null?void 0:z(v,i.substr(g+1))}}function N(n,i,s){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){F(typeof s!="string"&&"length"in s);for(var a=0,c=i.length;a<c;++a)N(n,i[a],s[a])}else{var d,g,v=i.indexOf(".");v!==-1?(d=i.substr(0,v),(g=i.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:N(v=!(v=n[d])||!y(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=s}}function J(n){var i,s={};for(i in n)y(n,i)&&(s[i]=n[i]);return s}var K=[].concat;function ae(n){return K.apply([],n)}var pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ae([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return f[n]}),le=new Set(pt.map(function(n){return f[n]})),re=null;function Q(n){return re=new WeakMap,n=(function i(s){if(!s||typeof s!="object")return s;var a=re.get(s);if(a)return a;if(h(s)){a=[],re.set(s,a);for(var c=0,d=s.length;c<d;++c)a.push(i(s[c]))}else if(le.has(s.constructor))a=s;else{var g,v=C(s);for(g in a=v===Object.prototype?{}:Object.create(v),re.set(s,a),s)y(s,g)&&(a[g]=i(s[g]))}return a})(n),re=null,n}var fe={}.toString;function de(n){return fe.call(n).slice(8,-1)}var be=typeof Symbol<"u"?Symbol.iterator:"@@iterator",xe=typeof be=="symbol"?function(n){var i;return n!=null&&(i=n[be])&&i.apply(n)}:function(){return null};function ge(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var ve={};function me(n){var i,s,a,c;if(arguments.length===1){if(h(n))return n.slice();if(this===ve&&typeof n=="string")return[n];if(c=xe(n)){for(s=[];!(a=c.next()).done;)s.push(a.value);return s}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(s=new Array(i);i--;)s[i]=n[i];return s}for(i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return s}var we=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Mt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Mt),Ie={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pe(n,i){this.name=n,this.message=i}function Oe(n,i){return n+". Errors: "+Object.keys(i).map(function(s){return i[s].toString()}).filter(function(s,a,c){return c.indexOf(s)===a}).join(`
`)}function Z(n,i,s,a){this.failures=i,this.failedKeys=a,this.successCount=s,this.message=Oe(n,i)}function Ae(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(s){return i[s]}),this.failuresByPos=i,this.message=Oe(n,this.failures)}W(pe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),W(Z).from(pe),W(Ae).from(pe);var Ue=lt.reduce(function(n,i){return n[i]=i+"Error",n},{}),Ee=pe,ie=lt.reduce(function(n,i){var s=i+"Error";function a(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=Ie[i]||s,this.inner=null)}return W(a).from(Ee),n[i]=a,n},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var V=Mt.reduce(function(n,i){return n[i+"Error"]=ie[i],n},{}),ye=lt.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=ie[i]),n},{});function Ce(){}function Je(n){return n}function qt(n,i){return n==null||n===Je?i:function(s){return i(n(s))}}function Re(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function Wn(n,i){return n===Ce?i:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=i.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Re(a,this.onsuccess):a),c&&(this.onerror=this.onerror?Re(c,this.onerror):c),d!==void 0?d:s}}function rn(n,i){return n===Ce?i:function(){n.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Re(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Re(a,this.onerror):a)}}function $n(n,i){return n===Ce?i:function(s){var a=n.apply(this,arguments);m(s,a);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=i.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?Re(c,this.onsuccess):c),d&&(this.onerror=this.onerror?Re(d,this.onerror):d),a===void 0?s===void 0?void 0:s:m(a,s)}}function on(n,i){return n===Ce?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function sn(n,i){return n===Ce?i:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return i.apply(a,d)})}return i.apply(this,arguments)}}ye.ModifyError=Z,ye.DexieError=pe,ye.BulkError=Ae;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Cn(n){Xe=n}var dt={},xn=100,pt=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,C(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,C(i),n]})(),Mt=pt[0],lt=pt[1],pt=pt[2],lt=lt&&lt.then,at=Mt&&Mt.constructor,an=!!pt,ht=function(n,i){mt.push([n,i]),wt&&(queueMicrotask(fn),wt=!1)},ln=!0,wt=!0,gt=[],Lt=[],un=Je,et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ce,pgp:!1,env:{},finalize:Ce},he=et,mt=[],vt=0,Ct=[];function oe(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=he;if(typeof n!="function"){if(n!==dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Pt(this,this._value))}this._state=null,this._value=null,++i.ref,(function s(a,c){try{c(function(d){if(a._state===null){if(d===a)throw new TypeError("A promise cannot be resolved with itself.");var g=a._lib&&xt();d&&typeof d.then=="function"?s(a,function(v,L){d instanceof oe?d._then(v,L):d.then(v,L)}):(a._state=!0,a._value=d,kn(a)),g&&_t()}},Pt.bind(null,a))}catch(d){Pt(a,d)}})(this,n)}var cn={get:function(){var n=he,i=Yn;function s(a,c){var d=this,g=!n.global&&(n!==he||i!==Yn),v=g&&!It(),L=new oe(function(x,O){Ot(d,new En(zi(a,n,g,v),zi(c,n,g,v),x,O,n))});return this._consoleTask&&(L._consoleTask=this._consoleTask),L}return s.prototype=dt,s},set:function(n){k(this,"then",n&&n.prototype===dt?cn:{get:function(){return n},set:cn.set})}};function En(n,i,s,a,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=s,this.reject=a,this.psd=c}function Pt(n,i){var s,a;Lt.push(i),n._state===null&&(s=n._lib&&xt(),i=un(i),n._state=!1,n._value=i,a=n,gt.some(function(c){return c._value===a._value})||gt.push(a),kn(n),s&&_t())}function kn(n){var i=n._listeners;n._listeners=[];for(var s=0,a=i.length;s<a;++s)Ot(n,i[s]);var c=n._PSD;--c.ref||c.finalize(),vt===0&&(++vt,ht(function(){--vt==0&&Et()},[]))}function Ot(n,i){if(n._state!==null){var s=n._state?i.onFulfilled:i.onRejected;if(s===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++vt,ht(Vn,[s,n,i])}else n._listeners.push(i)}function Vn(n,i,s){try{var a,c=i._value;!i._state&&Lt.length&&(Lt=[]),a=Xe&&i._consoleTask?i._consoleTask.run(function(){return n(c)}):n(c),i._state||Lt.indexOf(c)!==-1||(function(d){for(var g=gt.length;g;)if(gt[--g]._value===d._value)return gt.splice(g,1)})(i),s.resolve(a)}catch(d){s.reject(d)}finally{--vt==0&&Et(),--s.psd.ref||s.psd.finalize()}}function fn(){Wt(et,function(){xt()&&_t()})}function xt(){var n=ln;return wt=ln=!1,n}function _t(){var n,i,s;do for(;0<mt.length;)for(n=mt,mt=[],s=n.length,i=0;i<s;++i){var a=n[i];a[0].apply(null,a[1])}while(0<mt.length);wt=ln=!0}function Et(){var n=gt;gt=[],n.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var i=Ct.slice(0),s=i.length;s;)i[--s]()}function Le(n){return new oe(dt,!1,n)}function Ke(n,i){var s=he;return function(){var a=xt(),c=he;try{return jt(s,!0),n.apply(this,arguments)}catch(d){i&&i(d)}finally{jt(c,!1),a&&_t()}}}S(oe.prototype,{then:cn,_then:function(n,i){Ot(this,new En(null,null,n,i,he))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,s=arguments[1];return typeof i=="function"?this.then(null,function(a){return(a instanceof i?s:Le)(a)}):this.then(null,function(a){return(a&&a.name===i?s:Le)(a)})},finally:function(n){return this.then(function(i){return oe.resolve(n()).then(function(){return i})},function(i){return oe.resolve(n()).then(function(){return Le(i)})})},timeout:function(n,i){var s=this;return n<1/0?new oe(function(a,c){var d=setTimeout(function(){return c(new ie.Timeout(i))},n);s.then(a,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(oe.prototype,Symbol.toStringTag,"Dexie.Promise"),et.env=Bi(),S(oe,{all:function(){var n=me.apply(null,arguments).map(Jn);return new oe(function(i,s){n.length===0&&i([]);var a=n.length;n.forEach(function(c,d){return oe.resolve(c).then(function(g){n[d]=g,--a||i(n)},s)})})},resolve:function(n){return n instanceof oe?n:n&&typeof n.then=="function"?new oe(function(i,s){n.then(i,s)}):new oe(dt,!0,n)},reject:Le,race:function(){var n=me.apply(null,arguments).map(Jn);return new oe(function(i,s){n.map(function(a){return oe.resolve(a).then(i,s)})})},PSD:{get:function(){return he},set:function(n){return he=n}},totalEchoes:{get:function(){return Yn}},newPSD:Dt,usePSD:Wt,scheduler:{get:function(){return ht},set:function(n){ht=n}},rejectionMapper:{get:function(){return un},set:function(n){un=n}},follow:function(n,i){return new oe(function(s,a){return Dt(function(c,d){var g=he;g.unhandleds=[],g.onunhandled=d,g.finalize=Re(function(){var v,L=this;v=function(){L.unhandleds.length===0?c():d(L.unhandleds[0])},Ct.push(function x(){v(),Ct.splice(Ct.indexOf(x),1)}),++vt,ht(function(){--vt==0&&Et()},[])},g.finalize),n()},i,s,a)})}}),at&&(at.allSettled&&k(oe,"allSettled",function(){var n=me.apply(null,arguments).map(Jn);return new oe(function(i){n.length===0&&i([]);var s=n.length,a=new Array(s);n.forEach(function(c,d){return oe.resolve(c).then(function(g){return a[d]={status:"fulfilled",value:g}},function(g){return a[d]={status:"rejected",reason:g}}).then(function(){return--s||i(a)})})})}),at.any&&typeof AggregateError<"u"&&k(oe,"any",function(){var n=me.apply(null,arguments).map(Jn);return new oe(function(i,s){n.length===0&&s(new AggregateError([]));var a=n.length,c=new Array(a);n.forEach(function(d,g){return oe.resolve(d).then(function(v){return i(v)},function(v){c[g]=v,--a||s(new AggregateError(c))})})})}),at.withResolvers&&(oe.withResolvers=at.withResolvers));var We={awaits:0,echoes:0,id:0},da=0,Hn=[],Gn=0,Yn=0,pa=0;function Dt(n,i,s,a){var c=he,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++pa,et.env,d.env=an?{Promise:oe,PromiseProp:{value:oe,configurable:!0,writable:!0},all:oe.all,race:oe.race,allSettled:oe.allSettled,any:oe.any,resolve:oe.resolve,reject:oe.reject}:{},i&&m(d,i),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},a=Wt(d,n,s,a),d.ref===0&&d.finalize(),a}function dn(){return We.id||(We.id=++da),++We.awaits,We.echoes+=xn,We.id}function It(){return!!We.awaits&&(--We.awaits==0&&(We.id=0),We.echoes=We.awaits*xn,!0)}function Jn(n){return We.echoes&&n&&n.constructor===at?(dn(),n.then(function(i){return It(),i},function(i){return It(),Ne(i)})):n}function ha(){var n=Hn[Hn.length-1];Hn.pop(),jt(n,!1)}function jt(n,i){var s,a=he;(i?!We.echoes||Gn++&&n===he:!Gn||--Gn&&n===he)||queueMicrotask(i?(function(c){++Yn,We.echoes&&--We.echoes!=0||(We.echoes=We.awaits=We.id=0),Hn.push(he),jt(c,!0)}).bind(null,n):ha),n!==he&&(he=n,a===et&&(et.env=Bi()),an&&(s=et.env.Promise,i=n.env,(a.global||n.global)&&(Object.defineProperty(f,"Promise",i.PromiseProp),s.all=i.all,s.race=i.race,s.resolve=i.resolve,s.reject=i.reject,i.allSettled&&(s.allSettled=i.allSettled),i.any&&(s.any=i.any))))}function Bi(){var n=f.Promise;return an?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Wt(n,i,s,a,c){var d=he;try{return jt(n,!0),i(s,a,c)}finally{jt(d,!1)}}function zi(n,i,s,a){return typeof n!="function"?n:function(){var c=he;s&&dn(),jt(i,!0);try{return n.apply(this,arguments)}finally{jt(c,!1),a&&queueMicrotask(It)}}}function Ur(n){Promise===at&&We.echoes===0?Gn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+lt).indexOf("[native code]")===-1&&(dn=It=Ce);var Ne=oe.reject,$t="￿",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ui="String expected.",pn=[],Xn="__dbnames",Fr="readonly",Kr="readwrite";function Vt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=Q(i))[n],i}}function Ki(){throw ie.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Te(n,i){try{var s=Ni(n),a=Ni(i);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,L=g<v?g:v,x=0;x<L;++x)if(c[x]!==d[x])return c[x]<d[x]?-1:1;return g===v?0:g<v?-1:1})(Zi(n),Zi(i));case"Array":return(function(c,d){for(var g=c.length,v=d.length,L=g<v?g:v,x=0;x<L;++x){var O=Te(c[x],d[x]);if(O!==0)return O}return g===v?0:g<v?-1:1})(n,i)}}catch{}return NaN}function Ni(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=de(n),n==="ArrayBuffer"?"binary":n)}function Zi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function er(n,i,s){var a=n.schema.yProps;return a?(i&&0<s.numFailures&&(i=i.filter(function(c,d){return!s.failures[d]})),Promise.all(a.map(function(c){return c=c.updatesTable,i?n.db.table(c).where("k").anyOf(i).delete():n.db.table(c).clear()})).then(function(){return s})):s}var Sn=(qi.prototype.execute=function(n){var i=this["@@propmod"];if(i.add!==void 0){var s=i.add;if(h(s))return l(l([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(i.remove!==void 0){var a=i.remove;if(h(a))return h(n)?n.filter(function(c){return!a.includes(c)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=i.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?i.replacePrefix[1]+n.substring(s.length):n},qi);function qi(n){this["@@propmod"]=n}function Wi(n,i){for(var s=p(i),a=s.length,c=!1,d=0;d<a;++d){var g=s[d],v=i[g],L=z(n,g);v instanceof Sn?(N(n,g,v.execute(L)),c=!0):L!==v&&(N(n,g,v),c=!0)}return c}var $i=(Fe.prototype._trans=function(n,i,s){var a=this._tx||he.trans,c=this.name,d=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(x,O,b){if(!b.schema[c])throw new ie.NotFound("Table "+c+" not part of transaction");return i(b.idbtrans,b)}var v=xt();try{var L=a&&a.db._novip===this.db._novip?a===he.trans?a._promise(n,g,s):Dt(function(){return a._promise(n,g,s)},{trans:a,transless:he.transless||he}):(function x(O,b,D,E){if(O.idbdb&&(O._state.openComplete||he.letThrough||O._vip)){var M=O._createTransaction(b,D,O._dbSchema);try{M.create(),O._state.PR1398_maxLoop=3}catch(P){return P.name===Ue.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,b,D,E)})):Ne(P)}return M._promise(b,function(P,_){return Dt(function(){return he.trans=M,E(P,_,M)})}).then(function(P){if(b==="readwrite")try{M.idbtrans.commit()}catch{}return b==="readonly"?P:M._completion.then(function(){return P})})}if(O._state.openComplete)return Ne(new ie.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return Ne(new ie.DatabaseClosed);O.open().catch(Ce)}return O._state.dbReadyPromise.then(function(){return x(O,b,D,E)})})(this.db,n,[this.name],g);return d&&(L._consoleTask=d,L=L.catch(function(x){return console.trace(x),Ne(x)})),L}finally{v&&_t()}},Fe.prototype.get=function(n,i){var s=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?Ne(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(i)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=p(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&i.every(function(x){return 0<=v.keyPath.indexOf(x)})){for(var L=0;L<i.length;++L)if(i.indexOf(v.keyPath[L])===-1)return!1;return!0}return!1}).sort(function(v,L){return v.keyPath.length-L.keyPath.length})[0];if(s&&this.db._maxKey!==$t){var d=s.keyPath.slice(0,i.length);return this.where(d).equals(d.map(function(L){return n[L]}))}!s&&Xe&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var a=this.schema.idxByName;function c(v,L){return Te(v,L)===0}var g=i.reduce(function(b,L){var x=b[0],O=b[1],b=a[L],D=n[L];return[x||b,x||!b?Vt(O,b&&b.multi?function(E){return E=z(E,L),h(E)&&E.some(function(M){return c(D,M)})}:function(E){return c(D,z(E,L))}):O]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(i).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var i,s=this.db,a=this.name;function c(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ki&&((function(L,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function O(){this.constructor=L}r(L,x),L.prototype=x===null?Object.create(x):(O.prototype=x.prototype,new O)})(c,i=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return a},n=c);for(var d=new Set,g=n.prototype;g;g=C(g))Object.getOwnPropertyNames(g).forEach(function(L){return d.add(L)});function v(L){if(!L)return L;var x,O=Object.create(n.prototype);for(x in L)if(!d.has(x))try{O[x]=L[x]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,g=n;return d&&c&&(g=Qn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:i!=null?[i]:null,values:[g]})}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{N(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,i){var s=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return Wi(g,i),a&&N(g,a,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[i]}}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,i){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(i):(n=z(n,this.schema.primKey.keyPath),n===void 0?Ne(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},Fe.prototype.put=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,g=n;return d&&c&&(g=Qn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:i!=null?[i]:null})}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{N(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(a){return er(i,[n],a)}).then(function(a){return a.numFailures?oe.reject(a.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:Fi}).then(function(s){return er(n,null,s)})}).then(function(i){return i.numFailures?oe.reject(i.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(s){return i.core.getMany({keys:n,trans:s}).then(function(a){return a.map(function(c){return i.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(g){var x=a.schema.primKey,v=x.auto,x=x.keyPath;if(x&&c)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var L=n.length,x=x&&v?n.map(Qn(x)):n;return a.core.mutate({trans:g,type:"add",keys:c,values:x,wantResults:d}).then(function(M){var b=M.numFailures,D=M.results,E=M.lastResult,M=M.failures;if(b===0)return d?D:E;throw new Ae("".concat(a.name,".bulkAdd(): ").concat(b," of ").concat(L," operations failed"),M)})})},Fe.prototype.bulkPut=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(g){var x=a.schema.primKey,v=x.auto,x=x.keyPath;if(x&&c)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var L=n.length,x=x&&v?n.map(Qn(x)):n;return a.core.mutate({trans:g,type:"put",keys:c,values:x,wantResults:d}).then(function(M){var b=M.numFailures,D=M.results,E=M.lastResult,M=M.failures;if(b===0)return d?D:E;throw new Ae("".concat(a.name,".bulkPut(): ").concat(b," of ").concat(L," operations failed"),M)})})},Fe.prototype.bulkUpdate=function(n){var i=this,s=this.core,a=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:a,cache:"clone"}).then(function(v){var L=[],x=[];n.forEach(function(b,D){var E=b.key,M=b.changes,P=v[D];if(P){for(var _=0,I=Object.keys(M);_<I.length;_++){var R=I[_],B=M[R];if(R===i.schema.primKey.keyPath){if(Te(B,E)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else N(P,R,B)}d.push(D),L.push(E),x.push(P)}});var O=L.length;return s.mutate({trans:g,type:"put",keys:L,values:x,updates:{keys:a,changeSpecs:c}}).then(function(b){var D=b.numFailures,E=b.failures;if(D===0)return O;for(var M=0,P=Object.keys(E);M<P.length;M++){var _,I=P[M],R=d[Number(I)];R!=null&&(_=E[I],delete E[I],E[R]=_)}throw new Ae("".concat(i.name,".bulkUpdate(): ").concat(D," of ").concat(O," operations failed"),E)})})})},Fe.prototype.bulkDelete=function(n){var i=this,s=n.length;return this._trans("readwrite",function(a){return i.core.mutate({trans:a,type:"delete",keys:n}).then(function(c){return er(i,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Ae("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function Mn(n){function i(g,v){if(v){for(var L=arguments.length,x=new Array(L-1);--L;)x[L-1]=arguments[L];return s[g].subscribe.apply(null,x),n}if(typeof g=="string")return s[g]}var s={};i.addEventType=d;for(var a=1,c=arguments.length;a<c;++a)d(arguments[a]);return i;function d(g,v,L){if(typeof g!="object"){var x;v=v||on;var O={subscribers:[],fire:L=L||Ce,subscribe:function(b){O.subscribers.indexOf(b)===-1&&(O.subscribers.push(b),O.fire=v(O.fire,b))},unsubscribe:function(b){O.subscribers=O.subscribers.filter(function(D){return D!==b}),O.fire=O.subscribers.reduce(v,L)}};return s[g]=i[g]=O}p(x=g).forEach(function(b){var D=x[b];if(h(D))d(b,x[b][0],x[b][1]);else{if(D!=="asap")throw new ie.InvalidArgument("Invalid event config");var E=d(b,Je,function(){for(var M=arguments.length,P=new Array(M);M--;)P[M]=arguments[M];E.subscribers.forEach(function(_){T(function(){_.apply(null,P)})})})}})}}function Pn(n,i){return W(i).from({prototype:n}),i}function hn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Nr(n,i){n.filter=Vt(n.filter,i)}function Zr(n,i,s){var a=n.replayFilter;n.replayFilter=a?function(){return Vt(a(),i())}:i,n.justLimit=s&&!a}function tr(n,i){if(n.isPrimKey)return i.primaryKey;var s=i.getIndexByKeyPath(n.index);if(!s)throw new ie.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return s}function Vi(n,i,s){var a=tr(n,i.schema);return i.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:a,range:n.range}})}function nr(n,i,s,a){var c=n.replayFilter?Vt(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,L,x){var O,b;c&&!c(L,x,function(D){return L.stop(D)},function(D){return L.fail(D)})||((b=""+(O=L.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(O)),y(d,b)||(d[b]=!0,i(v,L,x)))};return Promise.all([n.or._iterate(g,s),Hi(Vi(n,a,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Hi(Vi(n,a,s),Vt(n.algorithm,c),i,!n.keysOnly&&n.valueMapper)}function Hi(n,i,s,a){var c=Ke(a?function(d,g,v){return s(a(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};i&&!i(d,function(v){return g=v},function(v){d.stop(v),g=Ce},function(v){d.fail(v),g=Ce})||c(d.value,d,function(v){return g=v}),g()})})}var ga=(Be.prototype._read=function(n,i){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(i)},Be.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,Ne.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},Be.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Vt(i.algorithm,n)},Be.prototype._iterate=function(n,i){return nr(this._ctx,n,i,this._ctx.table.core)},Be.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),i._ctx=s,i},Be.prototype.raw=function(){return this._ctx.valueMapper=null,this},Be.prototype.each=function(n){var i=this._ctx;return this._read(function(s){return nr(i,n,s,i.table.core)})},Be.prototype.count=function(n){var i=this;return this._read(function(s){var a=i._ctx,c=a.table.core;if(hn(a,!0))return c.count({trans:s,query:{index:tr(a,c.schema),range:a.range}}).then(function(g){return Math.min(g,a.limit)});var d=0;return nr(a,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},Be.prototype.sortBy=function(n,i){var s=n.split(".").reverse(),a=s[0],c=s.length-1;function d(L,x){return x?d(L[s[x]],x-1):L[a]}var g=this._ctx.dir==="next"?1:-1;function v(L,x){return Te(d(L,c),d(x,c))*g}return this.toArray(function(L){return L.sort(v)}).then(i)},Be.prototype.toArray=function(n){var i=this;return this._read(function(s){var a=i._ctx;if(a.dir==="next"&&hn(a,!0)&&0<a.limit){var c=a.valueMapper,d=tr(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:d,range:a.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return nr(a,function(v){return g.push(v)},s,a.table.core).then(function(){return g})},n)},Be.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,hn(i)?Zr(i,function(){var s=n;return function(a,c){return s===0||(s===1?--s:c(function(){a.advance(s),s=0}),!1)}}):Zr(i,function(){var s=n;return function(){return--s<0}})),this},Be.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Zr(this._ctx,function(){var i=n;return function(s,a,c){return--i<=0&&a(c),0<=i}},!0),this},Be.prototype.until=function(n,i){return Nr(this._ctx,function(s,a,c){return!n(s.value)||(a(c),i)}),this},Be.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},Be.prototype.last=function(n){return this.reverse().first(n)},Be.prototype.filter=function(n){var i;return Nr(this._ctx,function(s){return n(s.value)}),(i=this._ctx).isMatch=Vt(i.isMatch,n),this},Be.prototype.and=function(n){return this.filter(n)},Be.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Be.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Be.prototype.desc=function(){return this.reverse()},Be.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.key,a)})},Be.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Be.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.primaryKey,a)})},Be.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.key)}).then(function(){return s}).then(n)},Be.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&hn(i,!0)&&0<i.limit)return this._read(function(a){var c=tr(i,i.table.core.schema);return i.table.core.query({trans:a,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(a){return a.result}).then(n);i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},Be.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Be.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},Be.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Be.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Nr(this._ctx,function(c){var a=c.primaryKey.toString(),c=y(i,a);return i[a]=!0,!c}),this},Be.prototype.modify=function(n){var i=this,s=this._ctx;return this._write(function(a){var c=typeof n=="function"?n:function(P){return Wi(P,n)},d=s.table.core,x=d.schema.primaryKey,g=x.outbound,v=x.extractKey,L=200,x=i.db._options.modifyChunkSize;x&&(L=typeof x=="object"?x[d.name]||x["*"]||200:x);function O(P,R){var I=R.failures,R=R.numFailures;D+=P-R;for(var B=0,q=p(I);B<q.length;B++){var G=q[B];b.push(I[G])}}var b=[],D=0,E=[],M=n===Gi;return i.clone().primaryKeys().then(function(P){function _(R){var B=Math.min(L,P.length-R),q=P.slice(R,R+B);return(M?Promise.resolve([]):d.getMany({trans:a,keys:q,cache:"immutable"})).then(function(G){var te=[],H=[],X=g?[]:null,ne=M?q:[];if(!M)for(var ee=0;ee<B;++ee){var ce=G[ee],Se={value:Q(ce),primKey:P[R+ee]};c.call(Se,Se.value,Se)!==!1&&(Se.value==null?ne.push(P[R+ee]):g||Te(v(ce),v(Se.value))===0?(H.push(Se.value),g&&X.push(P[R+ee])):(ne.push(P[R+ee]),te.push(Se.value)))}return Promise.resolve(0<te.length&&d.mutate({trans:a,type:"add",values:te}).then(function(Pe){for(var _e in Pe.failures)ne.splice(parseInt(_e),1);O(te.length,Pe)})).then(function(){return(0<H.length||I&&typeof n=="object")&&d.mutate({trans:a,type:"put",keys:X,values:H,criteria:I,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<R}).then(function(Pe){return O(H.length,Pe)})}).then(function(){return(0<ne.length||I&&M)&&d.mutate({trans:a,type:"delete",keys:ne,criteria:I,isAdditionalChunk:0<R}).then(function(Pe){return er(s.table,ne,Pe)}).then(function(Pe){return O(ne.length,Pe)})}).then(function(){return P.length>R+B&&_(R+L)})})}var I=hn(s)&&s.limit===1/0&&(typeof n!="function"||M)&&{index:s.index,range:s.range};return _(0).then(function(){if(0<b.length)throw new Z("Error modifying one or more objects",b,D,E);return P.length})})})},Be.prototype.delete=function(){var n=this._ctx,i=n.range;return!hn(n)||n.table.schema.yProps||!n.isPrimKey&&i.type!==3?this.modify(Gi):this._write(function(s){var a=n.table.core.schema.primaryKey,c=i;return n.table.core.count({trans:s,query:{index:a,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(L){var v=L.failures,L=L.numFailures;if(L)throw new Z("Could not delete some values",Object.keys(v).map(function(x){return v[x]}),d-L);return d-L})})})},Be);function Be(){}var Gi=function(n,i){return i.value=null};function ma(n,i){return n<i?-1:n===i?0:1}function va(n,i){return i<n?-1:n===i?0:1}function tt(n,i,s){return n=n instanceof Ji?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(i),n}function gn(n){return new n.Collection(n,function(){return Yi("")}).limit(0)}function rr(n,i,s,a){var c,d,g,v,L,x,O,b=s.length;if(!s.every(function(M){return typeof M=="string"}))return tt(n,Ui);function D(M){c=M==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},d=M==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},g=M==="next"?ma:va;var P=s.map(function(_){return{lower:d(_),upper:c(_)}}).sort(function(_,I){return g(_.lower,I.lower)});v=P.map(function(_){return _.upper}),L=P.map(function(_){return _.lower}),O=(x=M)==="next"?"":a}D("next"),n=new n.Collection(n,function(){return Rt(v[0],L[b-1]+a)}),n._ondirectionchange=function(M){D(M)};var E=0;return n._addAlgorithm(function(M,P,_){var I=M.key;if(typeof I!="string")return!1;var R=d(I);if(i(R,L,E))return!0;for(var B=null,q=E;q<b;++q){var G=(function(te,H,X,ne,ee,ce){for(var Se=Math.min(te.length,ne.length),Pe=-1,_e=0;_e<Se;++_e){var nt=H[_e];if(nt!==ne[_e])return ee(te[_e],X[_e])<0?te.substr(0,_e)+X[_e]+X.substr(_e+1):ee(te[_e],ne[_e])<0?te.substr(0,_e)+ne[_e]+X.substr(_e+1):0<=Pe?te.substr(0,Pe)+H[Pe]+X.substr(Pe+1):null;ee(te[_e],nt)<0&&(Pe=_e)}return Se<ne.length&&ce==="next"?te+X.substr(te.length):Se<te.length&&ce==="prev"?te.substr(0,X.length):Pe<0?null:te.substr(0,Pe)+ne[Pe]+X.substr(Pe+1)})(I,R,v[q],L[q],g,x);G===null&&B===null?E=q+1:(B===null||0<g(B,G))&&(B=G)}return P(B!==null?function(){M.continue(B+O)}:_),!1}),n}function Rt(n,i,s,a){return{type:2,lower:n,upper:i,lowerOpen:s,upperOpen:a}}function Yi(n){return{type:1,lower:n,upper:n}}var Ji=(Object.defineProperty($e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$e.prototype.between=function(n,i,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(s||a)&&(!s||!a)?gn(this):new this.Collection(this,function(){return Rt(n,i,!s,!a)})}catch{return tt(this,kt)}},$e.prototype.equals=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Yi(n)})},$e.prototype.above=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Rt(n,void 0,!0)})},$e.prototype.aboveOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Rt(n,void 0,!1)})},$e.prototype.below=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Rt(void 0,n,!1,!0)})},$e.prototype.belowOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Rt(void 0,n)})},$e.prototype.startsWith=function(n){return typeof n!="string"?tt(this,Ui):this.between(n,n+$t,!0,!0)},$e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):rr(this,function(i,s){return i.indexOf(s[0])===0},[n],$t)},$e.prototype.equalsIgnoreCase=function(n){return rr(this,function(i,s){return i===s[0]},[n],"")},$e.prototype.anyOfIgnoreCase=function(){var n=me.apply(ve,arguments);return n.length===0?gn(this):rr(this,function(i,s){return s.indexOf(i)!==-1},n,"")},$e.prototype.startsWithAnyOfIgnoreCase=function(){var n=me.apply(ve,arguments);return n.length===0?gn(this):rr(this,function(i,s){return s.some(function(a){return i.indexOf(a)===0})},n,$t)},$e.prototype.anyOf=function(){var n=this,i=me.apply(ve,arguments),s=this._cmp;try{i.sort(s)}catch{return tt(this,kt)}if(i.length===0)return gn(this);var a=new this.Collection(this,function(){return Rt(i[0],i[i.length-1])});a._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,i.sort(s)};var c=0;return a._addAlgorithm(function(d,g,v){for(var L=d.key;0<s(L,i[c]);)if(++c===i.length)return g(v),!1;return s(L,i[c])===0||(g(function(){d.continue(i[c])}),!1)}),a},$e.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$e.prototype.noneOf=function(){var n=me.apply(ve,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return tt(this,kt)}var i=n.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},$e.prototype.inAnyRange=function(I,i){var s=this,a=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(I.length===0)return gn(this);if(!I.every(function(R){return R[0]!==void 0&&R[1]!==void 0&&c(R[0],R[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var L=!i||i.includeLowers!==!1,x=i&&i.includeUppers===!0,O,b=c;function D(R,B){return b(R[0],B[0])}try{(O=I.reduce(function(R,B){for(var q=0,G=R.length;q<G;++q){var te=R[q];if(a(B[0],te[1])<0&&0<a(B[1],te[0])){te[0]=g(te[0],B[0]),te[1]=v(te[1],B[1]);break}}return q===G&&R.push(B),R},[])).sort(D)}catch{return tt(this,kt)}var E=0,M=x?function(R){return 0<c(R,O[E][1])}:function(R){return 0<=c(R,O[E][1])},P=L?function(R){return 0<d(R,O[E][0])}:function(R){return 0<=d(R,O[E][0])},_=M,I=new this.Collection(this,function(){return Rt(O[0][0],O[O.length-1][1],!L,!x)});return I._ondirectionchange=function(R){b=R==="next"?(_=M,c):(_=P,d),O.sort(D)},I._addAlgorithm(function(R,B,q){for(var G,te=R.key;_(te);)if(++E===O.length)return B(q),!1;return!M(G=te)&&!P(G)||(s._cmp(te,O[E][1])===0||s._cmp(te,O[E][0])===0||B(function(){b===c?R.continue(O[E][0]):R.continue(O[E][1])}),!1)}),I},$e.prototype.startsWithAnyOf=function(){var n=me.apply(ve,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?gn(this):this.inAnyRange(n.map(function(i){return[i,i+$t]})):tt(this,"startsWithAnyOf() only works with strings")},$e);function $e(){}function yt(n){return Ke(function(i){return On(i),n(i.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",qr="x-storagemutated-1",Tt=Mn(null,_n),ya=(bt.prototype._lock=function(){return F(!he.global),++this._reculock,this._reculock!==1||he.global||(he.lockOwnerFor=this),this},bt.prototype._unlock=function(){if(F(!he.global),--this._reculock==0)for(he.global||(he.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Wt(n[1],n[0])}catch{}}return this},bt.prototype._locked=function(){return this._reculock&&he.lockOwnerFor!==this},bt.prototype.create=function(n){var i=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(F(!this.idbtrans),!n&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(a);case"MissingAPIError":throw new ie.MissingAPI(a.message,a);default:throw new ie.OpenFailed(a)}if(!this.active)throw new ie.TransactionInactive;return F(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){On(c),i._reject(n.error)}),n.onabort=Ke(function(c){On(c),i.active&&i._reject(new ie.Abort(n.error)),i.active=!1,i.on("abort").fire(c)}),n.oncomplete=Ke(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&Tt.storagemutated.fire(n.mutatedParts)}),this},bt.prototype._promise=function(n,i,s){var a=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new ie.TransactionInactive);if(this._locked())return new oe(function(d,g){a._blockedFuncs.push([function(){a._promise(n,i,s).then(d,g)},he])});if(s)return Dt(function(){var d=new oe(function(g,v){a._lock();var L=i(g,v,a);L&&L.then&&L.then(g,v)});return d.finally(function(){return a._unlock()}),d._lib=!0,d});var c=new oe(function(d,g){var v=i(d,g,a);v&&v.then&&v.then(d,g)});return c._lib=!0,c},bt.prototype._root=function(){return this.parent?this.parent._root():this},bt.prototype.waitFor=function(n){var i,s=this._root(),a=oe.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],i=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(i.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new oe(function(d,g){a.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},bt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},bt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(y(i,n))return i[n];var s=this.schema[n];if(!s)throw new ie.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),i[n]=s},bt);function bt(){}function Wr(n,i,s,a,c,d,g,v){return{name:n,keyPath:i,unique:s,multi:a,auto:c,compound:d,src:(s&&!g?"&":"")+(a?"*":"")+(c?"++":"")+Xi(i),type:v}}function Xi(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function $r(n,i,s){return{name:n,primKey:i,indexes:s,mappedClass:null,idxByName:(a=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=a(d,g),g&&(c[g[0]]=g[1]),c},{}))};var a}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return $t},$t}};function Vr(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(s){return s[i]}:function(s){return z(s,i)}:function(s){return z(s,n)};var i}function Qi(n){return[].slice.call(n)}var ba=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function wa(n,i,L){function a(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=_.lower,M=_.upper,P=_.lowerOpen,_=_.upperOpen;return E===void 0?M===void 0?null:i.upperBound(M,!!_):M===void 0?i.lowerBound(E,!!P):i.bound(E,M,!!P,!!_)}function c(D){var E,M=D.name;return{name:M,schema:D,mutate:function(P){var _=P.trans,I=P.type,R=P.keys,B=P.values,q=P.range;return new Promise(function(G,te){G=Ke(G);var H=_.objectStore(M),X=H.keyPath==null,ne=I==="put"||I==="add";if(!ne&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var ee,ce=(R||B||{length:1}).length;if(R&&B&&R.length!==B.length)throw new Error("Given keys array must have same length as given values array.");if(ce===0)return G({numFailures:0,failures:{},results:[],lastResult:void 0});function Se(Qe){++nt,On(Qe)}var Pe=[],_e=[],nt=0;if(I==="deleteRange"){if(q.type===4)return G({numFailures:nt,failures:_e,results:[],lastResult:void 0});q.type===3?Pe.push(ee=H.clear()):Pe.push(ee=H.delete(a(q)))}else{var X=ne?X?[B,R]:[B,null]:[R,null],ke=X[0],Ge=X[1];if(ne)for(var Ye=0;Ye<ce;++Ye)Pe.push(ee=Ge&&Ge[Ye]!==void 0?H[I](ke[Ye],Ge[Ye]):H[I](ke[Ye])),ee.onerror=Se;else for(Ye=0;Ye<ce;++Ye)Pe.push(ee=H[I](ke[Ye])),ee.onerror=Se}function gr(Qe){Qe=Qe.target.result,Pe.forEach(function(Yt,fi){return Yt.error!=null&&(_e[fi]=Yt.error)}),G({numFailures:nt,failures:_e,results:I==="delete"?R:Pe.map(function(Yt){return Yt.result}),lastResult:Qe})}ee.onerror=function(Qe){Se(Qe),gr(Qe)},ee.onsuccess=gr})},getMany:function(P){var _=P.trans,I=P.keys;return new Promise(function(R,B){R=Ke(R);for(var q,G=_.objectStore(M),te=I.length,H=new Array(te),X=0,ne=0,ee=function(Pe){Pe=Pe.target,H[Pe._pos]=Pe.result,++ne===X&&R(H)},ce=yt(B),Se=0;Se<te;++Se)I[Se]!=null&&((q=G.get(I[Se]))._pos=Se,q.onsuccess=ee,q.onerror=ce,++X);X===0&&R(H)})},get:function(P){var _=P.trans,I=P.key;return new Promise(function(R,B){R=Ke(R);var q=_.objectStore(M).get(I);q.onsuccess=function(G){return R(G.target.result)},q.onerror=yt(B)})},query:(E=x,function(P){return new Promise(function(_,I){_=Ke(_);var R,B,q,X=P.trans,G=P.values,te=P.limit,ee=P.query,H=te===1/0?void 0:te,ne=ee.index,ee=ee.range,X=X.objectStore(M),ne=ne.isPrimaryKey?X:X.index(ne.name),ee=a(ee);if(te===0)return _({result:[]});E?((H=G?ne.getAll(ee,H):ne.getAllKeys(ee,H)).onsuccess=function(ce){return _({result:ce.target.result})},H.onerror=yt(I)):(R=0,B=!G&&"openKeyCursor"in ne?ne.openKeyCursor(ee):ne.openCursor(ee),q=[],B.onsuccess=function(ce){var Se=B.result;return Se?(q.push(G?Se.value:Se.primaryKey),++R===te?_({result:q}):void Se.continue()):_({result:q})},B.onerror=yt(I))})}),openCursor:function(P){var _=P.trans,I=P.values,R=P.query,B=P.reverse,q=P.unique;return new Promise(function(G,te){G=Ke(G);var ne=R.index,H=R.range,X=_.objectStore(M),X=ne.isPrimaryKey?X:X.index(ne.name),ne=B?q?"prevunique":"prev":q?"nextunique":"next",ee=!I&&"openKeyCursor"in X?X.openKeyCursor(a(H),ne):X.openCursor(a(H),ne);ee.onerror=yt(te),ee.onsuccess=Ke(function(ce){var Se,Pe,_e,nt,ke=ee.result;ke?(ke.___id=++ba,ke.done=!1,Se=ke.continue.bind(ke),Pe=(Pe=ke.continuePrimaryKey)&&Pe.bind(ke),_e=ke.advance.bind(ke),nt=function(){throw new Error("Cursor not stopped")},ke.trans=_,ke.stop=ke.continue=ke.continuePrimaryKey=ke.advance=function(){throw new Error("Cursor not started")},ke.fail=Ke(te),ke.next=function(){var Ge=this,Ye=1;return this.start(function(){return Ye--?Ge.continue():Ge.stop()}).then(function(){return Ge})},ke.start=function(Ge){function Ye(){if(ee.result)try{Ge()}catch(Qe){ke.fail(Qe)}else ke.done=!0,ke.start=function(){throw new Error("Cursor behind last entry")},ke.stop()}var gr=new Promise(function(Qe,Yt){Qe=Ke(Qe),ee.onerror=yt(Yt),ke.fail=Yt,ke.stop=function(fi){ke.stop=ke.continue=ke.continuePrimaryKey=ke.advance=nt,Qe(fi)}});return ee.onsuccess=Ke(function(Qe){ee.onsuccess=Ye,Ye()}),ke.continue=Se,ke.continuePrimaryKey=Pe,ke.advance=_e,Ye(),gr},G(ke)):G(null)},te)})},count:function(P){var _=P.query,I=P.trans,R=_.index,B=_.range;return new Promise(function(q,G){var te=I.objectStore(M),H=R.isPrimaryKey?te:te.index(R.name),te=a(B),H=te?H.count(te):H.count();H.onsuccess=Ke(function(X){return q(X.target.result)}),H.onerror=yt(G)})}}}var d,g,v,O=(g=L,v=Qi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(D){return g.objectStore(D)}).map(function(D){var E=D.keyPath,_=D.autoIncrement,M=h(E),P={},_={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:M,keyPath:E,autoIncrement:_,unique:!0,extractKey:Vr(E)},indexes:Qi(D.indexNames).map(function(I){return D.index(I)}).map(function(q){var R=q.name,B=q.unique,G=q.multiEntry,q=q.keyPath,G={name:R,compound:h(q),keyPath:q,unique:B,multiEntry:G,extractKey:Vr(q)};return P[In(q)]=G}),getIndexByKeyPath:function(I){return P[In(I)]}};return P[":id"]=_.primaryKey,E!=null&&(P[In(E)]=_.primaryKey),_})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),L=O.schema,x=O.hasGetAll,O=L.tables.map(c),b={};return O.forEach(function(D){return b[D.name]=D}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(D){if(!b[D])throw new Error("Table '".concat(D,"' not found"));return b[D]},MIN_KEY:-1/0,MAX_KEY:Dn(i),schema:L}}function La(n,i,s,a){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=wa(i,c,a),n.dbcore.reduce(function(d,g){return g=g.create,o(o({},d),g(d))},a))}}function ir(n,a){var s=a.db,a=La(n._middlewares,s,n._deps,a);n.core=a.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function or(n,i,s,a){s.forEach(function(c){var d=a[c];i.forEach(function(g){var v=(function L(x,O){return U(x,O)||(x=C(x))&&L(x,O)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?k(g,c,{get:function(){return this.table(c)},set:function(L){j(this,c,{value:L,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function Hr(n,i){i.forEach(function(s){for(var a in s)s[a]instanceof n.Table&&delete s[a]})}function Ca(n,i){return n._cfg.version-i._cfg.version}function xa(n,i,s,a){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=$r("$meta",to("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(a);var g=d._reject.bind(d),v=he.transless||he;Dt(function(){return he.trans=d,he.transless=v,i!==0?(ir(n,s),x=i,((L=d).storeNames.includes("$meta")?L.table("$meta").get("version").then(function(O){return O??x}):oe.resolve(x)).then(function(O){return D=O,E=d,M=s,P=[],O=(b=n)._versions,_=b._dbSchema=ar(0,b.idbdb,M),(O=O.filter(function(I){return I._cfg.version>=D})).length!==0?(O.forEach(function(I){P.push(function(){var R=_,B=I._cfg.dbschema;lr(b,R,M),lr(b,B,M),_=b._dbSchema=B;var q=Gr(R,B);q.add.forEach(function(ne){Yr(M,ne[0],ne[1].primKey,ne[1].indexes)}),q.change.forEach(function(ne){if(ne.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var ee=M.objectStore(ne.name);ne.add.forEach(function(ce){return sr(ee,ce)}),ne.change.forEach(function(ce){ee.deleteIndex(ce.name),sr(ee,ce)}),ne.del.forEach(function(ce){return ee.deleteIndex(ce)})});var G=I._cfg.contentUpgrade;if(G&&I._cfg.version>D){ir(b,M),E._memoizedTables={};var te=J(B);q.del.forEach(function(ne){te[ne]=R[ne]}),Hr(b,[b.Transaction.prototype]),or(b,[b.Transaction.prototype],p(te),te),E.schema=te;var H,X=we(G);return X&&dn(),q=oe.follow(function(){var ne;(H=G(E))&&X&&(ne=It.bind(null,null),H.then(ne,ne))}),H&&typeof H.then=="function"?oe.resolve(H):q.then(function(){return H})}}),P.push(function(R){var B,q,G=I._cfg.dbschema;B=G,q=R,[].slice.call(q.db.objectStoreNames).forEach(function(te){return B[te]==null&&q.db.deleteObjectStore(te)}),Hr(b,[b.Transaction.prototype]),or(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),E.schema=b._dbSchema}),P.push(function(R){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===I._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(B){return B!=="$meta"})):R.objectStore("$meta").put(I._cfg.version,"version"))})}),(function I(){return P.length?oe.resolve(P.shift()(E.idbtrans)).then(I):oe.resolve()})().then(function(){eo(_,M)})):oe.resolve();var b,D,E,M,P,_}).catch(g)):(p(c).forEach(function(O){Yr(s,O,c[O].primKey,c[O].indexes)}),ir(n,s),void oe.follow(function(){return n.on.populate.fire(d)}).catch(g));var L,x})}function Ea(n,i){eo(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var s=ar(0,n.idbdb,i);lr(n,n._dbSchema,i);for(var a=0,c=Gr(s,n._dbSchema).change;a<c.length;a++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=i.objectStore(g.name);g.add.forEach(function(L){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(L.src)),sr(v,L)})})(c[a]);if(typeof d=="object")return d.value}}function Gr(n,i){var s,a={del:[],add:[],change:[]};for(s in n)i[s]||a.del.push(s);for(s in i){var c=n[s],d=i[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,a.change.push(g);else{var v=c.idxByName,L=d.idxByName,x=void 0;for(x in v)L[x]||g.del.push(x);for(x in L){var O=v[x],b=L[x];O?O.src!==b.src&&g.change.push(b):g.add.push(b)}(0<g.del.length||0<g.add.length||0<g.change.length)&&a.change.push(g)}}else a.add.push([s,d])}return a}function Yr(n,i,s,a){var c=n.db.createObjectStore(i,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(d){return sr(c,d)}),c}function eo(n,i){p(n).forEach(function(s){i.db.objectStoreNames.contains(s)||(Xe&&console.debug("Dexie: Creating missing table",s),Yr(i,s,n[s].primKey,n[s].indexes))})}function sr(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function ar(n,i,s){var a={};return $(i.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Wr(Xi(x=d.keyPath),x||"",!0,!1,!!d.autoIncrement,x&&typeof x!="string",!0),v=[],L=0;L<d.indexNames.length;++L){var O=d.index(d.indexNames[L]),x=O.keyPath,O=Wr(O.name,x,!!O.unique,!!O.multiEntry,!1,x&&typeof x!="string",!1);v.push(O)}a[c]=$r(c,g,v)}),a}function lr(n,i,s){for(var a=s.db.objectStoreNames,c=0;c<a.length;++c){var d=a[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var L=g.indexNames[v],x=g.index(L).keyPath,O=typeof x=="string"?x:"["+$(x).join("+")+"]";!i[d]||(x=i[d].idxByName[O])&&(x.name=L,delete i[d].idxByName[O],i[d].idxByName[L]=x)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function to(n){return n.split(",").map(function(i,s){var d=i.split(":"),a=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(i=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Wr(c,d||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),h(d),s===0,a)})}var ka=(mn.prototype._createTableSchema=$r,mn.prototype._parseIndexSyntax=to,mn.prototype._parseStoresSpec=function(n,i){var s=this;p(n).forEach(function(a){if(n[a]!==null){var c=s._parseIndexSyntax(n[a]),d=c.shift();if(!d)throw new ie.Schema("Invalid schema for table "+a+": "+n[a]);if(d.unique=!0,d.multi)throw new ie.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(a,d,c),i[a]=c}})},mn.prototype.stores=function(s){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=i._versions,a={},c={};return s.forEach(function(d){m(a,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(a,c)}),i._dbSchema=c,Hr(i,[i._allTables,i,i.Transaction.prototype]),or(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],p(c),c),i._storeNames=p(c),this},mn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=sn(this._cfg.contentUpgrade||Ce,n),this},mn);function mn(){}function Jr(n,i){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new St(Xn,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Xr(n){return n&&typeof n.databases=="function"}function Qr(n){return Dt(function(){return he.letThrough=!0,n()})}function ei(n){return!("from"in n)}var He=function(n,i){if(!this){var s=new He;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function jn(n,i,s){var a=Te(i,s);if(!isNaN(a)){if(0<a)throw RangeError();if(ei(n))return m(n,{from:i,to:s,d:1});var c=n.l,a=n.r;if(Te(s,n.from)<0)return c?jn(c,i,s):n.l={from:i,to:s,d:1,l:null,r:null},ro(n);if(0<Te(i,n.to))return a?jn(a,i,s):n.r={from:i,to:s,d:1,l:null,r:null},ro(n);Te(i,n.from)<0&&(n.from=i,n.l=null,n.d=a?a.d+1:1),0<Te(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),a&&s&&Rn(n,a)}}function Rn(n,i){ei(i)||(function s(a,L){var d=L.from,g=L.to,v=L.l,L=L.r;jn(a,d,g),v&&s(a,v),L&&s(a,L)})(n,i)}function no(n,i){var s=ur(i),a=s.next();if(a.done)return!1;for(var c=a.value,d=ur(n),g=d.next(c.from),v=g.value;!a.done&&!g.done;){if(Te(v.from,c.to)<=0&&0<=Te(v.to,c.from))return!0;Te(c.from,v.from)<0?c=(a=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function ur(n){var i=ei(n)?null:{s:0,n};return{next:function(s){for(var a=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,a)for(;i.n.l&&Te(s,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!a||Te(s,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function ro(n){var i,s,a=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<a?"r":a<-1?"l":"";c&&(i=c=="r"?"l":"r",s=o({},n),a=n[c],n.from=a.from,n.to=a.to,n[c]=a[c],s[c]=a[i],(n[i]=s).d=io(s)),n.d=io(n)}function io(s){var i=s.r,s=s.l;return(i?s?Math.max(i.d,s.d):i.d:s?s.d:0)+1}function cr(n,i){return p(i).forEach(function(s){n[s]?Rn(n[s],i[s]):n[s]=(function a(c){var d,g,v={};for(d in c)y(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||le.has(g.constructor)?g:a(g));return v})(i[s])}),n}function ti(n,i){return n.all||i.all||Object.keys(n).some(function(s){return i[s]&&no(i[s],n[s])})}S(He.prototype,((lt={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(s){return jn(i,s,s)}),this},hasKey:function(n){var i=ur(this).next(n).value;return i&&Te(i.from,n)<=0&&0<=Te(i.to,n)}})[be]=function(){return ur(this)},lt));var Ht={},ni={},ri=!1;function fr(n){cr(ni,n),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(n,i){i===void 0&&(i=!1);var s=new Set;if(n.all)for(var a=0,c=Object.values(Ht);a<c.length;a++)oo(g=c[a],n,s,i);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Ht["idb://".concat(d,"/").concat(v)])&&oo(g,n,s,i))}s.forEach(function(L){return L()})}function oo(n,i,s,a){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],L=v[0],x=[],O=0,b=v[1];O<b.length;O++){var D=b[O];ti(i,D.obsSet)?D.subscribers.forEach(function(_){return s.add(_)}):a&&x.push(D)}a&&c.push([L,x])}if(a)for(var E=0,M=c;E<M.length;E++){var P=M[E],L=P[0],x=P[1];n.queries.query[L]=x}}function Sa(n){var i=n._state,s=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?Ne(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var a=i.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(i.openCanceller!==a)throw new ie.DatabaseClosed("db.open() was cancelled")}function v(){return new oe(function(D,E){if(g(),!s)throw new ie.MissingAPI;var M=n.name,P=i.autoSchema||!c?s.open(M):s.open(M,c);if(!P)throw new ie.MissingAPI;P.onerror=yt(E),P.onblocked=Ke(n._fireOnBlocked),P.onupgradeneeded=Ke(function(_){var I;O=P.transaction,i.autoSchema&&!n._options.allowEmptyDB?(P.onerror=On,O.abort(),P.result.close(),(I=s.deleteDatabase(M)).onsuccess=I.onerror=Ke(function(){E(new ie.NoSuchDatabase("Database ".concat(M," doesnt exist")))})):(O.onerror=yt(E),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,b=_<1,n.idbdb=P.result,d&&Ea(n,O),xa(n,_/10,O,E))},E),P.onsuccess=Ke(function(){O=null;var _,I,R,B,q,G=n.idbdb=P.result,te=$(G.objectStoreNames);if(0<te.length)try{var H=G.transaction((B=te).length===1?B[0]:B,"readonly");if(i.autoSchema)I=G,R=H,(_=n).verno=I.version/10,R=_._dbSchema=ar(0,I,R),_._storeNames=$(I.objectStoreNames,0),or(_,[_._allTables],p(R),R);else if(lr(n,n._dbSchema,H),((q=Gr(ar(0,(q=n).idbdb,H),q._dbSchema)).add.length||q.change.some(function(X){return X.add.length||X.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),G.close(),c=G.version+1,d=!0,D(v());ir(n,H)}catch{}pn.push(n),G.onversionchange=Ke(function(X){i.vcFired=!0,n.on("versionchange").fire(X)}),G.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),b&&(q=n._deps,H=M,G=q.indexedDB,q=q.IDBKeyRange,Xr(G)||H===Xn||Jr(G,q).put({name:H}).catch(Ce)),D()},E)}).catch(function(D){switch(D?.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return oe.reject(D)})}var L,x=i.dbReadyResolve,O=null,b=!1;return oe.race([a,(typeof navigator>"u"?oe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function E(){return indexedDB.databases().finally(D)}L=setInterval(E,100),E()}).finally(function(){return clearInterval(L)}):Promise.resolve()).then(v)]).then(function(){return g(),i.onReadyBeingFired=[],oe.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function D(){if(0<i.onReadyBeingFired.length){var E=i.onReadyBeingFired.reduce(sn,Ce);return i.onReadyBeingFired=[],oe.resolve(Qr(function(){return E(n.vip)})).then(D)}})}).finally(function(){i.openCanceller===a&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(D){i.dbOpenError=D;try{O&&O.abort()}catch{}return a===i.openCanceller&&n._close(),Ne(D)}).finally(function(){i.openComplete=!0,x()}).then(function(){var D;return b&&(D={},n.tables.forEach(function(E){E.schema.indexes.forEach(function(M){M.name&&(D["idb://".concat(n.name,"/").concat(E.name,"/").concat(M.name)]=new He(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(E.name,"/")]=D["idb://".concat(n.name,"/").concat(E.name,"/:dels")]=new He(-1/0,[[[]]])}),Tt(_n).fire(D),ii(D,!0)),n})}function oi(n){function i(d){return n.next(d)}var s=c(i),a=c(function(d){return n.throw(d)});function c(d){return function(L){var v=d(L),L=v.value;return v.done?L:L&&typeof L.then=="function"?L.then(s,a):h(L)?Promise.all(L).then(s,a):s(L)}}return c(i)()}function dr(n,i,s){for(var a=h(n)?n.slice():[n],c=0;c<s;++c)a.push(i);return a}var Ma={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema,c={},d=[];function g(b,D,E){var M=In(b),P=c[M]=c[M]||[],_=b==null?0:typeof b=="string"?1:b.length,I=0<D,I=o(o({},E),{name:I?"".concat(M,"(virtual-from:").concat(E.name,")"):E.name,lowLevelIndex:E,isVirtual:I,keyTail:D,keyLength:_,extractKey:Vr(b),unique:!I&&E.unique});return P.push(I),I.isPrimaryKey||d.push(I),1<_&&g(_===2?b[0]:b.slice(0,_-1),D+1,E),P.sort(function(R,B){return R.keyTail-B.keyTail}),I}i=g(a.primaryKey.keyPath,0,a.primaryKey),c[":id"]=[i];for(var v=0,L=a.indexes;v<L.length;v++){var x=L[v];g(x.keyPath,0,x)}function O(b){var D,E=b.query.index;return E.isVirtual?o(o({},b),{query:{index:E.lowLevelIndex,range:(D=b.query.range,E=E.keyTail,{type:D.type===1?2:D.type,lower:dr(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,E),lowerOpen:!0,upper:dr(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,E),upperOpen:!0})}}):b}return o(o({},s),{schema:o(o({},a),{primaryKey:i,indexes:d,getIndexByKeyPath:function(b){return(b=c[In(b)])&&b[0]}}),count:function(b){return s.count(O(b))},query:function(b){return s.query(O(b))},openCursor:function(b){var D=b.query.index,E=D.keyTail,M=D.isVirtual,P=D.keyLength;return M?s.openCursor(O(b)).then(function(I){return I&&_(I)}):s.openCursor(b);function _(I){return Object.create(I,{continue:{value:function(R){R!=null?I.continue(dr(R,b.reverse?n.MAX_KEY:n.MIN_KEY,E)):b.unique?I.continue(I.key.slice(0,P).concat(b.reverse?n.MIN_KEY:n.MAX_KEY,E)):I.continue()}},continuePrimaryKey:{value:function(R,B){I.continuePrimaryKey(dr(R,n.MAX_KEY,E),B)}},primaryKey:{get:function(){return I.primaryKey}},key:{get:function(){var R=I.key;return P===1?R[0]:R.slice(0,P)}},value:{get:function(){return I.value}}})}}})}})}};function si(n,i,s,a){return s=s||{},a=a||"",p(n).forEach(function(c){var d,g,v;y(i,c)?(d=n[c],g=i[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=de(d))!==de(g)?s[a+c]=i[c]:v==="Object"?si(d,g,s,a+c+"."):d!==g&&(s[a+c]=i[c]):d!==g&&(s[a+c]=i[c])):s[a+c]=void 0}),p(i).forEach(function(c){y(n,c)||(s[a+c]=i[c])}),s}function ai(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var Pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema.primaryKey;return o(o({},s),{mutate:function(c){var d=he.trans,g=d.table(i).hook,v=g.deleting,L=g.creating,x=g.updating;switch(c.type){case"add":if(L.fire===Ce)break;return d._promise("readwrite",function(){return O(c)},!0);case"put":if(L.fire===Ce&&x.fire===Ce)break;return d._promise("readwrite",function(){return O(c)},!0);case"delete":if(v.fire===Ce)break;return d._promise("readwrite",function(){return O(c)},!0);case"deleteRange":if(v.fire===Ce)break;return d._promise("readwrite",function(){return(function b(D,E,M){return s.query({trans:D,values:!1,query:{index:a,range:E},limit:M}).then(function(P){var _=P.result;return O({type:"delete",keys:_,trans:D}).then(function(I){return 0<I.numFailures?Promise.reject(I.failures[0]):_.length<M?{failures:[],numFailures:0,lastResult:void 0}:b(D,o(o({},E),{lower:_[_.length-1],lowerOpen:!0}),M)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function O(b){var D,E,M,P=he.trans,_=b.keys||ai(a,b);if(!_)throw new Error("Keys missing");return(b=b.type==="add"||b.type==="put"?o(o({},b),{keys:_}):o({},b)).type!=="delete"&&(b.values=l([],b.values)),b.keys&&(b.keys=l([],b.keys)),D=s,M=_,((E=b).type==="add"?Promise.resolve([]):D.getMany({trans:E.trans,keys:M,cache:"immutable"})).then(function(I){var R=_.map(function(B,q){var G,te,H,X=I[q],ne={onerror:null,onsuccess:null};return b.type==="delete"?v.fire.call(ne,B,X,P):b.type==="add"||X===void 0?(G=L.fire.call(ne,B,b.values[q],P),B==null&&G!=null&&(b.keys[q]=B=G,a.outbound||N(b.values[q],a.keyPath,B))):(G=si(X,b.values[q]),(te=x.fire.call(ne,G,B,X,P))&&(H=b.values[q],Object.keys(te).forEach(function(ee){y(H,ee)?H[ee]=te[ee]:N(H,ee,te[ee])}))),ne});return s.mutate(b).then(function(B){for(var q=B.failures,G=B.results,te=B.numFailures,B=B.lastResult,H=0;H<_.length;++H){var X=(G||_)[H],ne=R[H];X==null?ne.onerror&&ne.onerror(q[H]):ne.onsuccess&&ne.onsuccess(b.type==="put"&&I[H]?b.values[H]:X)}return{failures:q,results:G,numFailures:te,lastResult:B}}).catch(function(B){return R.forEach(function(q){return q.onerror&&q.onerror(B)}),Promise.reject(B)})})}}})}})}};function so(n,i,s){try{if(!i||i.keys.length<n.length)return null;for(var a=[],c=0,d=0;c<i.keys.length&&d<n.length;++c)Te(i.keys[c],n[d])===0&&(a.push(s?Q(i.values[c]):i.values[c]),++d);return a.length===n.length?a:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var s=n.table(i);return o(o({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var c=so(a.keys,a.trans._cache,a.cache==="clone");return c?oe.resolve(c):s.getMany(a).then(function(d){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?Q(d):d},d})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function ao(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function lo(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,s=new He(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(a,c,d){if(he.subscr&&c!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(he.querier));return n.transaction(a,c,d)},table:function(a){var c=n.table(a),d=c.schema,g=d.primaryKey,b=d.indexes,v=g.extractKey,L=g.outbound,x=g.autoIncrement&&b.filter(function(E){return E.compound&&E.keyPath.includes(g.keyPath)}),O=o(o({},c),{mutate:function(E){function M(ee){return ee="idb://".concat(i,"/").concat(a,"/").concat(ee),B[ee]||(B[ee]=new He)}var P,_,I,R=E.trans,B=E.mutatedParts||(E.mutatedParts={}),q=M(""),G=M(":dels"),te=E.type,ne=E.type==="deleteRange"?[E.range]:E.type==="delete"?[E.keys]:E.values.length<50?[ai(g,E).filter(function(ee){return ee}),E.values]:[],H=ne[0],X=ne[1],ne=E.trans._cache;return h(H)?(q.addKeys(H),(ne=te==="delete"||H.length===X.length?so(H,ne):null)||G.addKeys(H),(ne||X)&&(P=M,_=ne,I=X,d.indexes.forEach(function(ee){var ce=P(ee.name||"");function Se(_e){return _e!=null?ee.extractKey(_e):null}function Pe(_e){return ee.multiEntry&&h(_e)?_e.forEach(function(nt){return ce.addKey(nt)}):ce.addKey(_e)}(_||I).forEach(function(_e,Ge){var ke=_&&Se(_[Ge]),Ge=I&&Se(I[Ge]);Te(ke,Ge)!==0&&(ke!=null&&Pe(ke),Ge!=null&&Pe(Ge))})}))):H?(X={from:(X=H.lower)!==null&&X!==void 0?X:n.MIN_KEY,to:(X=H.upper)!==null&&X!==void 0?X:n.MAX_KEY},G.add(X),q.add(X)):(q.add(s),G.add(s),d.indexes.forEach(function(ee){return M(ee.name).add(s)})),c.mutate(E).then(function(ee){return!H||E.type!=="add"&&E.type!=="put"||(q.addKeys(ee.results),x&&x.forEach(function(ce){for(var Se=E.values.map(function(ke){return ce.extractKey(ke)}),Pe=ce.keyPath.findIndex(function(ke){return ke===g.keyPath}),_e=0,nt=ee.results.length;_e<nt;++_e)Se[_e][Pe]=ee.results[_e];M(ce.name).addKeys(Se)})),R.mutatedParts=cr(R.mutatedParts||{},B),ee})}}),b=function(M){var P=M.query,M=P.index,P=P.range;return[M,new He((M=P.lower)!==null&&M!==void 0?M:n.MIN_KEY,(P=P.upper)!==null&&P!==void 0?P:n.MAX_KEY)]},D={get:function(E){return[g,new He(E.key)]},getMany:function(E){return[g,new He().addKeys(E.keys)]},count:b,query:b,openCursor:b};return p(D).forEach(function(E){O[E]=function(M){var P=he.subscr,_=!!P,I=ao(he,c)&&lo(E,M)?M.obsSet={}:P;if(_){var R=function(X){return X="idb://".concat(i,"/").concat(a,"/").concat(X),I[X]||(I[X]=new He)},B=R(""),q=R(":dels"),P=D[E](M),_=P[0],P=P[1];if((E==="query"&&_.isPrimaryKey&&!M.values?q:R(_.name||"")).add(P),!_.isPrimaryKey){if(E!=="count"){var G=E==="query"&&L&&M.values&&c.query(o(o({},M),{values:!1}));return c[E].apply(this,arguments).then(function(X){if(E==="query"){if(L&&M.values)return G.then(function(Se){return Se=Se.result,B.addKeys(Se),X});var ne=M.values?X.result.map(v):X.result;(M.values?B:q).addKeys(ne)}else if(E==="openCursor"){var ee=X,ce=M.values;return ee&&Object.create(ee,{key:{get:function(){return q.addKey(ee.primaryKey),ee.key}},primaryKey:{get:function(){var Se=ee.primaryKey;return q.addKey(Se),Se}},value:{get:function(){return ce&&B.addKey(ee.primaryKey),ee.value}}})}return X})}q.add(s)}}return c[E].apply(this,arguments)}}),O}})}};function uo(n,i,s){if(s.numFailures===0)return i;if(i.type==="deleteRange")return null;var a=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return s.numFailures===a?null:(i=o({},i),h(i.keys)&&(i.keys=i.keys.filter(function(c,d){return!(d in s.failures)})),"values"in i&&h(i.values)&&(i.values=i.values.filter(function(c,d){return!(d in s.failures)})),i)}function li(n,i){return s=n,((a=i).lower===void 0||(a.lowerOpen?0<Te(s,a.lower):0<=Te(s,a.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Te(n,i.upper)<0:Te(n,i.upper)<=0));var s,a}function co(n,i,D,a,c,d){if(!D||D.length===0)return n;var g=i.query.index,v=g.multiEntry,L=i.query.range,x=a.schema.primaryKey.extractKey,O=g.extractKey,b=(g.lowLevelIndex||g).extractKey,D=D.reduce(function(E,M){var P=E,_=[];if(M.type==="add"||M.type==="put")for(var I=new He,R=M.values.length-1;0<=R;--R){var B,q=M.values[R],G=x(q);I.hasKey(G)||(B=O(q),(v&&h(B)?B.some(function(ee){return li(ee,L)}):li(B,L))&&(I.addKey(G),_.push(q)))}switch(M.type){case"add":var te=new He().addKeys(i.values?E.map(function(ce){return x(ce)}):E),P=E.concat(i.values?_.filter(function(ce){return ce=x(ce),!te.hasKey(ce)&&(te.addKey(ce),!0)}):_.map(function(ce){return x(ce)}).filter(function(ce){return!te.hasKey(ce)&&(te.addKey(ce),!0)}));break;case"put":var H=new He().addKeys(M.values.map(function(ce){return x(ce)}));P=E.filter(function(ce){return!H.hasKey(i.values?x(ce):ce)}).concat(i.values?_:_.map(function(ce){return x(ce)}));break;case"delete":var X=new He().addKeys(M.keys);P=E.filter(function(ce){return!X.hasKey(i.values?x(ce):ce)});break;case"deleteRange":var ne=M.range;P=E.filter(function(ce){return!li(x(ce),ne)})}return P},n);return D===n?n:(D.sort(function(E,M){return Te(b(E),b(M))||Te(x(E),x(M))}),i.limit&&i.limit<1/0&&(D.length>i.limit?D.length=i.limit:n.length===i.limit&&D.length<i.limit&&(c.dirty=!0)),d?Object.freeze(D):D)}function fo(n,i){return Te(n.lower,i.lower)===0&&Te(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function Da(n,i){return(function(s,a,c,d){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=Te(s,a))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return a})(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=(function(s,a,c,d){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=Te(s,a))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return a})(n.upper,i.upper,n.upperOpen,i.upperOpen)}function Ia(n,i,s,a){n.subscribers.add(s),a.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=i,setTimeout(function(){c.subscribers.size===0&&ge(d,c)},3e3))})}var ja={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(s,a,c){var d,g,v=n.transaction(s,a,c);return a==="readwrite"&&(g=(d=new AbortController).signal,c=function(L){return function(){if(d.abort(),a==="readwrite"){for(var x=new Set,O=0,b=s;O<b.length;O++){var D=b[O],E=Ht["idb://".concat(i,"/").concat(D)];if(E){var M=n.table(D),P=E.optimisticOps.filter(function(ce){return ce.trans===v});if(v._explicit&&L&&v.mutatedParts)for(var _=0,I=Object.values(E.queries.query);_<I.length;_++)for(var R=0,B=(te=I[_]).slice();R<B.length;R++)ti((H=B[R]).obsSet,v.mutatedParts)&&(ge(te,H),H.subscribers.forEach(function(ce){return x.add(ce)}));else if(0<P.length){E.optimisticOps=E.optimisticOps.filter(function(ce){return ce.trans!==v});for(var q=0,G=Object.values(E.queries.query);q<G.length;q++)for(var te,H,X,ne=0,ee=(te=G[q]).slice();ne<ee.length;ne++)(H=ee[ne]).res!=null&&v.mutatedParts&&(L&&!H.dirty?(X=Object.isFrozen(H.res),X=co(H.res,H.req,P,M,H,X),H.dirty?(ge(te,H),H.subscribers.forEach(function(ce){return x.add(ce)})):X!==H.res&&(H.res=X,H.promise=oe.resolve({result:X}))):(H.dirty&&ge(te,H),H.subscribers.forEach(function(ce){return x.add(ce)})))}}}x.forEach(function(ce){return ce()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var a=n.table(s),c=a.schema.primaryKey;return o(o({},a),{mutate:function(d){var g=he.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return a.mutate(d);var v=Ht["idb://".concat(i,"/").concat(s)];return v?(g=a.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ai(c,d).some(function(L){return L==null}))?(v.optimisticOps.push(d),d.mutatedParts&&fr(d.mutatedParts),g.then(function(L){0<L.numFailures&&(ge(v.optimisticOps,d),(L=uo(0,d,L))&&v.optimisticOps.push(L),d.mutatedParts&&fr(d.mutatedParts))}),g.catch(function(){ge(v.optimisticOps,d),d.mutatedParts&&fr(d.mutatedParts)})):g.then(function(L){var x=uo(0,o(o({},d),{values:d.values.map(function(O,b){var D;return L.failures[b]?O:(O=(D=c.keyPath)!==null&&D!==void 0&&D.includes(".")?Q(O):o({},O),N(O,c.keyPath,L.results[b]),O)})}),L);v.optimisticOps.push(x),queueMicrotask(function(){return d.mutatedParts&&fr(d.mutatedParts)})}),g):a.mutate(d)},query:function(d){if(!ao(he,a)||!lo("query",d))return a.query(d);var g=((x=he.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",b=he,v=b.requery,L=b.signal,x=(function(M,P,_,I){var R=Ht["idb://".concat(M,"/").concat(P)];if(!R)return[];if(!(P=R.queries[_]))return[null,!1,R,null];var B=P[(I.query?I.query.index.name:null)||""];if(!B)return[null,!1,R,null];switch(_){case"query":var q=B.find(function(G){return G.req.limit===I.limit&&G.req.values===I.values&&fo(G.req.query.range,I.query.range)});return q?[q,!0,R,B]:[B.find(function(G){return("limit"in G.req?G.req.limit:1/0)>=I.limit&&(!I.values||G.req.values)&&Da(G.req.query.range,I.query.range)}),!1,R,B];case"count":return q=B.find(function(G){return fo(G.req.query.range,I.query.range)}),[q,!!q,R,B]}})(i,s,"query",d),O=x[0],b=x[1],D=x[2],E=x[3];return O&&b?O.obsSet=d.obsSet:(b=a.query(d).then(function(M){var P=M.result;if(O&&(O.res=P),g){for(var _=0,I=P.length;_<I;++_)Object.freeze(P[_]);Object.freeze(P)}else M.result=Q(P);return M}).catch(function(M){return E&&O&&ge(E,O),Promise.reject(M)}),O={obsSet:d.obsSet,promise:b,subscribers:new Set,type:"query",req:d,dirty:!1},E?E.push(O):(E=[O],(D=D||(Ht["idb://".concat(i,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=E)),Ia(O,E,v,L),O.promise.then(function(M){return{result:co(M.result,d,D?.optimisticOps,a,O,g)}})}})}})}};function pr(n,i){return new Proxy(n,{get:function(s,a,c){return a==="db"?i:Reflect.get(s,a,c)}})}var St=(Ze.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ie.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,s=i.filter(function(a){return a._cfg.version===n})[0];return s||(s=new this.Version(n),i.push(s),i.sort(Ca),s.stores({}),this._state.autoSchema=!1,s)},Ze.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||he.letThrough||this._vip)?n():new oe(function(s,a){if(i._state.openComplete)return a(new ie.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void a(new ie.DatabaseClosed);i.open().catch(Ce)}i._state.dbReadyPromise.then(s,a)}).then(n)},Ze.prototype.use=function(n){var i=n.stack,s=n.create,a=n.level,c=n.name;return c&&this.unuse({stack:i,name:c}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:s,level:a??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},Ze.prototype.unuse=function(n){var i=n.stack,s=n.name,a=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return a?c.create!==a:!!s&&c.name!==s})),this},Ze.prototype.open=function(){var n=this;return Wt(et,function(){return Sa(n)})},Ze.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,i=pn.indexOf(this);if(0<=i&&pn.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new oe(function(s){n.dbReadyResolve=s}),n.openCanceller=new oe(function(s,a){n.cancelOpen=a}))},Ze.prototype.close=function(s){var i=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;i?(s.isBeingOpened&&s.cancelOpen(new ie.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new ie.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},Ze.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new oe(function(c,d){function g(){i.close(n);var v=i._deps.indexedDB.deleteDatabase(i.name);v.onsuccess=Ke(function(){var L,x,O;L=i._deps,x=i.name,O=L.indexedDB,L=L.IDBKeyRange,Xr(O)||x===Xn||Jr(O,L).delete(x).catch(Ce),c()}),v.onerror=yt(d),v.onblocked=i._fireOnBlocked}if(s)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(g):g()})},Ze.prototype.backendDB=function(){return this.idbdb},Ze.prototype.isOpen=function(){return this.idbdb!==null},Ze.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Ze.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ze.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ze.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),Ze.prototype.transaction=function(){var n=(function(i,s,a){var c=arguments.length;if(c<2)throw new ie.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return a=d.pop(),[i,ae(d),a]}).apply(this,arguments);return this._transaction.apply(this,n)},Ze.prototype._transaction=function(n,i,s){var a=this,c=he.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=i.map(function(x){if(x=x instanceof a.Table?x.name:x,typeof x!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return x}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Kr)throw new ie.InvalidArgument("Invalid transaction mode: "+n);d=Kr}if(c){if(c.mode===Fr&&d===Kr){if(!v)throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(x){if(c&&c.storeNames.indexOf(x)===-1){if(!v)throw new ie.SubTransaction("Table "+x+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(x){return c?c._promise(null,function(O,b){b(x)}):Ne(x)}var L=(function x(O,b,D,E,M){return oe.resolve().then(function(){var P=he.transless||he,_=O._createTransaction(b,D,O._dbSchema,E);if(_.explicit=!0,P={trans:_,transless:P},E)_.idbtrans=E.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(B){return B.name===Ue.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,b,D,null,M)})):Ne(B)}var I,R=we(M);return R&&dn(),P=oe.follow(function(){var B;(I=M.call(_,_))&&(R?(B=It.bind(null,null),I.then(B,B)):typeof I.next=="function"&&typeof I.throw=="function"&&(I=oi(I)))},P),(I&&typeof I.then=="function"?oe.resolve(I).then(function(B){return _.active?B:Ne(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):P.then(function(){return I})).then(function(B){return E&&_._resolve(),_._completion.then(function(){return B})}).catch(function(B){return _._reject(B),Ne(B)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,L,"lock"):he.trans?Wt(he.transless,function(){return a._whenReady(L)}):this._whenReady(L)},Ze.prototype.table=function(n){if(!y(this._allTables,n))throw new ie.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},Ze);function Ze(n,i){var s=this;this._middlewares={},this.verno=0;var a=Ze.dependencies;this._options=i=o({addons:Ze.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},a=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,L,x={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ce,dbReadyPromise:null,cancelOpen:Ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};x.dbReadyPromise=new oe(function(b){x.dbReadyResolve=b}),x.openCanceller=new oe(function(b,D){x.cancelOpen=D}),this._state=x,this.name=n,this.on=Mn(this,"populate","blocked","versionchange","close",{ready:[sn,Ce]}),this.once=function(b,D){var E=function(){for(var M=[],P=0;P<arguments.length;P++)M[P]=arguments[P];s.on(b).unsubscribe(E),D.apply(s,M)};return s.on(b,E)},this.on.ready.subscribe=ue(this.on.ready.subscribe,function(b){return function(D,E){Ze.vip(function(){var M,P=s._state;P.openComplete?(P.dbOpenError||oe.resolve().then(D),E&&b(D)):P.onReadyBeingFired?(P.onReadyBeingFired.push(D),E&&b(D)):(b(D),M=s,E||b(function _(){M.on.ready.unsubscribe(D),M.on.ready.unsubscribe(_)}))})}}),this.Collection=(c=this,Pn(ga.prototype,function(I,_){this.db=c;var E=Fi,M=null;if(_)try{E=_()}catch(R){M=R}var P=I._ctx,_=P.table,I=_.hook.reading.fire;this._ctx={table:_,index:P.index,isPrimKey:!P.index||_.schema.primKey.keyPath&&P.index===_.schema.primKey.name,range:E,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:M,or:P.or,valueMapper:I!==Je?I:null}})),this.Table=(d=this,Pn($i.prototype,function(b,D,E){this.db=d,this._tx=E,this.name=b,this.schema=D,this.hook=d._allTables[b]?d._allTables[b].hook:Mn(null,{creating:[Wn,Ce],reading:[qt,Je],updating:[$n,Ce],deleting:[rn,Ce]})})),this.Transaction=(g=this,Pn(ya.prototype,function(b,D,E,M,P){var _=this;b!=="readonly"&&D.forEach(function(I){I=(I=E[I])===null||I===void 0?void 0:I.yProps,I&&(D=D.concat(I.map(function(R){return R.updatesTable})))}),this.db=g,this.mode=b,this.storeNames=D,this.schema=E,this.chromeTransactionDurability=M,this.idbtrans=null,this.on=Mn(this,"complete","error","abort"),this.parent=P||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new oe(function(I,R){_._resolve=I,_._reject=R}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(I){var R=_.active;return _.active=!1,_.on.error.fire(I),_.parent?_.parent._reject(I):R&&_.idbtrans&&_.idbtrans.abort(),Ne(I)})})),this.Version=(v=this,Pn(ka.prototype,function(b){this.db=v,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(L=this,Pn(Ji.prototype,function(b,D,E){if(this.db=L,this._ctx={table:b,index:D===":id"?null:D,or:E},this._cmp=this._ascending=Te,this._descending=function(M,P){return Te(P,M)},this._max=function(M,P){return 0<Te(M,P)?M:P},this._min=function(M,P){return Te(M,P)<0?M:P},this._IDBKeyRange=L._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=Dn(i.IDBKeyRange),this._createTransaction=function(b,D,E,M){return new s.Transaction(b,D,E,s._options.chromeTransactionDurability,M)},this._fireOnBlocked=function(b){s.on("blocked").fire(b),pn.filter(function(D){return D.name===s.name&&D!==s&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(b)})},this.use(Oa),this.use(ja),this.use(_a),this.use(Ma),this.use(Pa);var O=new Proxy(this,{get:function(b,D,E){if(D==="_vip")return!0;if(D==="table")return function(P){return pr(s.table(P),O)};var M=Reflect.get(b,D,E);return M instanceof $i?pr(M,O):D==="tables"?M.map(function(P){return pr(P,O)}):D==="_createTransaction"?function(){return pr(M.apply(this,arguments),O)}:M}});this.vip=O,a.forEach(function(b){return b(s)})}var hr,lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ra=(ui.prototype.subscribe=function(n,i,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:s})},ui.prototype[lt]=function(){return this},ui);function ui(n){this._subscribe=n}try{hr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{hr={indexedDB:null,IDBKeyRange:null}}function po(n){var i,s=!1,a=new Ra(function(c){var d=we(n),g,v=!1,L={},x={},O={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),b&&Tt.storagemutated.unsubscribe(E))}};c.start&&c.start(O);var b=!1,D=function(){return Ur(M)},E=function(P){cr(L,P),ti(x,L)&&D()},M=function(){var P,_,I;!v&&hr.indexedDB&&(L={},P={},g&&g.abort(),g=new AbortController,I=(function(R){var B=xt();try{d&&dn();var q=Dt(n,R);return q=d?q.finally(It):q}finally{B&&_t()}})(_={subscr:P,signal:g.signal,requery:D,querier:n,trans:null}),Promise.resolve(I).then(function(R){s=!0,i=R,v||_.signal.aborted||(L={},(function(B){for(var q in B)if(y(B,q))return;return 1})(x=P)||b||(Tt(_n,E),b=!0),Ur(function(){return!v&&c.next&&c.next(R)}))},function(R){s=!1,["DatabaseClosedError","AbortError"].includes(R?.name)||v||Ur(function(){v||c.error&&c.error(R)})}))};return setTimeout(D,0),O});return a.hasValue=function(){return s},a.getValue=function(){return i},a}var Gt=St;function ci(n){var i=At;try{At=!0,Tt.storagemutated.fire(n),ii(n,!0)}finally{At=i}}S(Gt,o(o({},ye),{delete:function(n){return new Gt(n,{addons:[]}).delete()},exists:function(n){return new Gt(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=Gt.dependencies,s=i.indexedDB,i=i.IDBKeyRange,(Xr(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(c){return c.name}).filter(function(c){return c!==Xn})}):Jr(s,i).toCollection().primaryKeys()).then(n)}catch{return Ne(new ie.MissingAPI)}var i,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return he.trans?Wt(he.transless,n):n()},vip:Qr,async:function(n){return function(){try{var i=oi(n.apply(this,arguments));return i&&typeof i.then=="function"?i:oe.resolve(i)}catch(s){return Ne(s)}}},spawn:function(n,i,s){try{var a=oi(n.apply(s,i||[]));return a&&typeof a.then=="function"?a:oe.resolve(a)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return he.trans||null}},waitFor:function(n,i){return i=oe.resolve(typeof n=="function"?Gt.ignoreTransaction(n):n).timeout(i||6e4),he.trans?he.trans.waitFor(i):i},Promise:oe,debug:{get:function(){return Xe},set:function(n){Cn(n)}},derive:W,extend:m,props:S,override:ue,Events:Mn,on:Tt,liveQuery:po,extendObservabilitySet:cr,getByKeyPath:z,setByKeyPath:N,delByKeyPath:function(n,i){typeof i=="string"?N(n,i,void 0):"length"in i&&[].map.call(i,function(s){N(n,s,void 0)})},shallowClone:J,deepClone:Q,getObjectDiff:si,cmp:Te,asap:T,minKey:-1/0,addons:[],connections:pn,errnames:Ue,dependencies:hr,cache:Ht,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,s){return n+i/Math.pow(10,2*s)})})),Gt.maxKey=Dn(Gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Tt(_n,function(n){At||(n=new CustomEvent(qr,{detail:n}),At=!0,dispatchEvent(n),At=!1)}),addEventListener(qr,function(n){n=n.detail,At||ci(n)}));var vn,At=!1,ho=function(){};return typeof BroadcastChannel<"u"&&((ho=function(){(vn=new BroadcastChannel(qr)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof vn.unref=="function"&&vn.unref(),Tt(_n,function(n){At||vn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!St.disableBfCache&&n.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),vn?.close();for(var i=0,s=pn;i<s.length;i++)s[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!St.disableBfCache&&n.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),ho(),ci({all:new He(-1/0,[[]])}))})),oe.rejectionMapper=function(n,i){return!n||n instanceof pe||n instanceof TypeError||n instanceof SyntaxError||!n.name||!V[n.name]?n:(i=new V[n.name](i||n.message,n),"stack"in n&&k(i,"stack",{get:function(){return this.inner.stack}}),i)},Cn(Xe),o(St,Object.freeze({__proto__:null,Dexie:St,liveQuery:po,Entity:Ki,cmp:Te,PropModification:Sn,replacePrefix:function(n,i){return new Sn({replacePrefix:[n,i]})},add:function(n){return new Sn({add:n})},remove:function(n){return new Sn({remove:n})},default:St,RangeSet:He,mergeRanges:Rn,rangesOverlap:no}),{default:St}),St})})(Cr)),Cr.exports}var rc=nc();const Pi=Aa(rc),Ks=Symbol.for("Dexie"),Tr=globalThis[Ks]||(globalThis[Ks]=Pi);if(Pi.semVer!==Tr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Pi.semVer} and ${Tr.semVer}`);const{liveQuery:_c,mergeRanges:Dc,rangesOverlap:Ic,RangeSet:jc,cmp:Rc,Entity:Tc,PropModification:Ac,replacePrefix:Bc,add:zc,remove:Uc,DexieYProvider:Fc}=Tr,it=new Tr("ChillGameDB");it.version(1).stores({exploredCells:"id",claimedCells:"id",gameState:"key"});it.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const Ns=5e-4,Ve=Fu(ec((t,e)=>({clouds:10,claimedCells:{},exploredCells:{},selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,o,l,f]=await Promise.all([it.exploredCells.toArray(),it.claimedCells.toArray(),it.gameState.get("clouds"),it.gameState.get("lastCloudIncrease")]),p={};r.forEach(m=>{p[m.id]=!0});const h={};o.forEach(m=>{h[m.id]=m.data}),t(m=>{m.exploredCells=p,m.claimedCells=h,m.clouds=l?l.value:10,m.lastCloudIncrease=f?f.value:Date.now(),m.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(o=>{o.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(o=>{o.clouds<10&&(o.clouds+=1,o.lastCloudIncrease=r)}),it.gameState.put({key:"clouds",value:e().clouds}).catch(o=>console.error("Failed to put clouds state:",o)),it.gameState.put({key:"lastCloudIncrease",value:r}).catch(o=>console.error("Failed to put lastCloudIncrease state:",o))},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:o,longitude:l}=r.coords;t(f=>{f.userLocation={lat:o,lng:l};const p=Math.floor(o/Ns),h=Math.floor(l/Ns),m=e().exploredCells;let C=!1;const w=2,y=[];for(let S=-w;S<=w;S++)for(let j=-w;j<=w;j++)if(S*S+j*j<=w*w){const k=`${p+S}_${h+j}`;m[k]||(f.exploredCells[k]=!0,y.push({id:k}),C=!0)}C&&y.length>0&&it.exploredCells.bulkAdd(y).catch(S=>console.error("Failed to bulkAdd explored cells:",S))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const o=e().selectedCell,l=e().claimedCells;!r||o&&o.key===r.key||l[r.key]?t({selectedCell:null}):t({selectedCell:r})},updateSelectedCellInfo:r=>{t(o=>{o.selectedCell&&(o.selectedCell={...o.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:o,exploredCells:l}=e();if(!r)return"no-cell";if(o<=0)return"no-clouds";const{key:f}=r,p={owner:"user",color:"#3B82F6"},[h,m]=f.split("_").map(Number),C=[],w=1;for(let y=-w;y<=w;y++)for(let S=-w;S<=w;S++){const j=`${h+y}_${m+S}`;l[j]||C.push({id:j})}return t(y=>{y.clouds-=1,y.claimedCells[f]=p,C.forEach(S=>{y.exploredCells[S.id]=!0}),y.selectedCell=null}),it.claimedCells.put({id:f,data:p}).catch(y=>console.error("Failed to put claimed cell:",y)),it.gameState.put({key:"clouds",value:e().clouds}).catch(y=>console.error("Failed to put clouds state:",y)),C.length>0&&it.exploredCells.bulkAdd(C).catch(y=>console.error("Failed to bulkAdd explored cells:",y)),"claimed"},register:()=>{t({clouds:10}),it.gameState.put({key:"clouds",value:10}).catch(r=>console.error("Failed to put clouds state on register:",r))}}))),ic="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Zs=new Audio(ic),Oi=()=>{Zs.currentTime=0,Zs.play().catch(t=>{console.error("Audio playback failed:",t)})},rt={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},oc=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:o})=>{const{countryName:l,regionName:f,flagUrl:p,isLoading:h}=t;Ve(w=>w.clouds);const m=w=>{w.stopPropagation(),Oi(),e()},C=w=>{w.stopPropagation(),Oi(),r()};return se.jsxs("div",{style:rt.container,onClick:w=>w.stopPropagation(),children:[se.jsx("button",{style:rt.closeButton,onClick:C,children:"×"}),se.jsx("div",{style:rt.header,children:h?se.jsx("div",{style:rt.loader}):se.jsxs(se.Fragment,{children:[p&&se.jsx("img",{src:p,alt:"Flag",style:rt.flag}),se.jsxs("div",{style:rt.location,children:[se.jsx("span",{style:rt.country,children:l}),se.jsx("span",{style:rt.region,children:f}),se.jsxs("span",{style:rt.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),se.jsxs("div",{style:rt.body,children:[se.jsx("p",{style:rt.text,children:"Do you want to claim this area?"}),se.jsxs("button",{style:rt.claimButton,onClick:m,disabled:o,children:[se.jsx("span",{style:rt.cloudIcon,children:"☁️"}),"Claim"]})]})]})},fa=u.memo(oc),bi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},sc=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,ac=()=>(en.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=sc,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),lc=({position:t})=>se.jsxs(se.Fragment,{children:[se.jsx(ac,{}),se.jsx(Zt,{position:t,mapPaneName:Zt.MARKER_LAYER,children:se.jsxs("div",{style:bi.pulseContainer,children:[se.jsx("div",{style:bi.pulse}),se.jsx("div",{style:bi.dot})]})})]}),uc=u.memo(lc),Kt=(t,e,r,o=null,l=null)=>new Promise(f=>{l&&l(!0);const p=t.getCenter(),h=t.getZoom(),m=Date.now(),C=()=>{const w=Date.now(),y=Math.min((w-m)/r,1),S=y*y*(3-2*y),j={lat:p.lat()+(e.lat-p.lat())*S,lng:p.lng()+(e.lng-p.lng())*S},k=o!==null?h+(o-h)*S:h;t.moveCamera({center:j,zoom:k}),y<1?requestAnimationFrame(C):(l&&l(!1),f())};C()}),zt=5e-4,cc={width:"100%",height:"100%"},fc={position:"absolute",inset:"0px",width:"100%",height:"100%"},dc=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],pc=({center:t,onSelectCell:e,claimedCells:r,exploredCells:o,setMapRef:l,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m,onZoomOutLimit:C})=>{const[w,y]=u.useState(null),[S,j]=u.useState(15),[k,W]=u.useState(null),U=u.useRef(null),Y=u.useRef(!1),$=u.useRef(null),ue=150,[F,T]=u.useState(!1),z=u.useCallback(re=>{W(re),l(re)},[l]),N=u.useCallback(()=>{if(!Y.current||!k)return;const re=k.getZoom(),Q=k.getCenter();re<=5&&C(),f(re),p({lat:Q.lat(),lng:Q.lng()}),j(re)},[k,f,p,C]);u.useEffect(()=>{(async()=>{k&&t&&!Y.current&&(Y.current=!0,await Kt(k,t,2e3,15,T),N())})()},[k,t,N,T]);const J=u.useCallback(re=>{U.current||(U.current=setTimeout(()=>{if(U.current=null,S<15){w&&y(null);return}const Q=`${Math.floor(re.latLng.lat()/zt)}_${Math.floor(re.latLng.lng()/zt)}`;Q!==w&&y(Q)},50))},[S,w,y]),K=u.useCallback(()=>{y(null)},[y]),ae=u.useCallback(re=>{if(S<15){e(null,null);return}const Q=re.latLng.lat(),fe=re.latLng.lng(),de=Math.floor(Q/zt),be=Math.floor(fe/zt),xe=`${de}_${be}`,ge=de*zt,ve=be*zt,me=ge+zt/2,we=ve+zt/2;e(xe,{lat:me,lng:we})},[S,e]),le=u.useCallback(async re=>{re.preventDefault(),!$.current&&($.current=setTimeout(async()=>{if($.current=null,!k)return;const Q=k.getZoom(),fe=re.deltaY<0?Q+1:Q-1,de=Math.max(5,Math.min(20,fe));de!==Q&&await Kt(k,k.getCenter().toJSON(),300,de,T)},ue))},[k,T]);return se.jsx("div",{className:"view-container fade-in",style:fc,onWheel:le,children:se.jsxs(Ya,{mapContainerStyle:cc,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:dc,minZoom:5,maxZoom:20,scrollwheel:!1},onLoad:z,onIdle:N,onMouseMove:J,onMouseOut:K,onClick:ae,children:[se.jsx(Au,{map:k,zoom:S,claimedCells:r,exploredCells:o,hoveredCell:w,isAnimating:F,selectedCell:h}),h&&se.jsx(fa,{cellInfo:h}),m&&se.jsx(uc,{position:m})]})})},hc=en.memo(pc),gc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},mc={fontSize:"24px"};function vc(){const t=Ve(e=>e.clouds);return se.jsxs("div",{style:gc,children:[se.jsx("span",{style:mc,children:"☁️"}),se.jsx("span",{children:t})]})}const yc=en.memo(vc),bc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},wc={fontSize:"28px"};function Lc({onClick:t}){const[e,r]=u.useState(!1),o={...bc,transform:e?"scale(1.1)":"scale(1)"};return se.jsx("button",{onClick:t,title:"Reset View",style:o,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:se.jsx("span",{style:wc,children:"🧭"})})}const Cc=u.memo(Lc),br={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},xc=()=>{const t=Ve(f=>f.clouds),e=Ve(f=>f.lastCloudIncrease),r=Ve(f=>f.increaseCloud),[o,l]=u.useState(0);return u.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const m=6e4-(Date.now()-e);m<=0?(r(),l(60)):l(Math.ceil(m/1e3))},1e3):(clearInterval(f),l(0)),()=>clearInterval(f)},[t,e,r]),se.jsxs("div",{style:br.container,children:[se.jsx("span",{style:br.icon,children:"☁️"}),t<10?se.jsxs("span",{style:br.timer,children:[o,"s"]}):se.jsx("span",{style:br.timer,children:"⏰"})]})},Ec=u.memo(xc),wr=new Map,qs=.5;function kc(t){const e=Ve(r=>r.updateSelectedCellInfo);u.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,o=`${Math.floor(r.lat/qs)}_${Math.floor(r.lng/qs)}`;(async()=>{if(wr.has(o)){e(wr.get(o));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,C=m.find(W=>W.types.includes("country")),w=m.find(W=>W.types.includes("administrative_area_level_1")),y=C?C.long_name:"未知領域",S=C?C.short_name.toLowerCase():null,j=w?w.long_name:"",k=S?`https://flagcdn.com/w40/${S}.png`:null;h={countryName:y,regionName:j,flagUrl:k}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};wr.set(o,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};wr.set(o,p),e(p)}})()},[t,e])}const Sc=u.lazy(()=>_i(()=>import("./Leaderboard-CWhPvCGG.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),Mc=u.lazy(()=>_i(()=>import("./RegistrationModal-BmSPzp3D.js"),__vite__mapDeps([4,1,2]))),Pc=u.lazy(()=>_i(()=>import("./InfoModal-BebEIpGE.js"),__vite__mapDeps([5,1,2]))),ct={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"4px",left:"8px",zIndex:50}};function Kc(){const{lat:t,lng:e}=Ba(),r=za(),[o,l]=u.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=u.useState(!1),h=u.useRef(null),m=Ve(V=>V.claimedCells),C=Ve(V=>V.exploredCells),w=Ve(V=>V.selectedCell),y=Ve(V=>V.userLocation),S=Ve(V=>V.clouds),j=Ve(V=>V.initializeGeolocation),k=Ve(V=>V.selectCell),W=Ve(V=>V.claimSelectedCell),U=Ve(V=>V.register),Y=Ve(V=>V.isHydrated),$=Ve(V=>V.hydrate);kc(w);const{isLoaded:ue}=ll({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});u.useEffect(()=>{j()},[j]),u.useEffect(()=>{$()},[$]),u.useEffect(()=>{o||navigator.geolocation.getCurrentPosition(V=>{l({lat:V.coords.latitude,lng:V.coords.longitude})},()=>{l({lat:25.033,lng:121.5654})})},[o]);const[F,T]=u.useState(!1),[z,N]=u.useState(!1),[J,K]=u.useState(!1),[ae,le]=u.useState(10),[re,Q]=u.useState(!1),fe=u.useCallback(V=>{h.current=V},[]),de=u.useCallback((V,ye)=>{Oi(),k(V?{key:V,position:ye,isLoading:!0}:null)},[k]),be=u.useCallback(()=>{W()==="no-clouds"&&T(!0)},[W]),xe=u.useCallback(()=>{k(null)},[k]),ge=u.useCallback(()=>{U(),T(!1)},[U]),ve=u.useCallback(async()=>{if(!h.current)return;const V=h.current.getCenter(),ye=V.lat(),Ce=V.lng();p(!0),await Kt(h.current,{lat:ye,lng:Ce},1500,2,Q),r("/",{state:{lat:ye,lng:Ce}})},[r,Q]),me=u.useCallback(()=>{window.confirm("您已縮放到最小級別，要返回地球儀嗎？")?ve():h.current&&h.current.setZoom(h.current.getZoom()+1)},[ve]),we=u.useCallback(async()=>{if(y&&h.current){const V=h.current,ye=V.getCenter(),Ce={lat:ye.lat(),lng:ye.lng()};await Kt(V,Ce,1e3,5,Q),await Kt(V,y,1500,5,Q),await Kt(V,y,1e3,15,Q)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[y,Q]),Ie=u.useCallback(V=>{le(V)},[]),pe=u.useCallback(V=>{r(`/map/${V.lat.toFixed(7)}/${V.lng.toFixed(7)}`,{replace:!0})},[r]),Oe=u.useCallback(async()=>{if(h.current){const V=h.current.getZoom(),ye=Math.min(20,V+1);ye!==V&&await Kt(h.current,h.current.getCenter().toJSON(),300,ye,Q)}},[Q]),Z=u.useCallback(async()=>{if(h.current){const V=h.current.getZoom(),ye=Math.max(5,V-1);ye!==V&&await Kt(h.current,h.current.getCenter().toJSON(),300,ye,Q)}},[Q]),Ae=u.useCallback(()=>K(!0),[]),Ue=u.useCallback(()=>T(!1),[]),Ee=u.useCallback(()=>N(!1),[]),ie=u.useCallback(()=>K(!1),[]);return!ue||!o||!Y?se.jsx(go,{}):se.jsxs("div",{style:ct.app,className:f?"map-container-fade-out":"",children:[se.jsx(hc,{center:o,onSelectCell:de,claimedCells:m,exploredCells:C,setMapRef:fe,onZoomChanged:Ie,onCenterChanged:pe,selectedCell:w,userLocation:y,onZoomOutLimit:me,isAnimating:re}),w&&se.jsx(fa,{cellInfo:w,onClaim:be,onClose:xe,isClaimDisabled:S<=0&&F}),se.jsxs("div",{style:ct.topLeftControls,children:[se.jsx("button",{style:ct.controlButton,onClick:Oe,children:"+"}),se.jsx("button",{style:ct.controlButton,onClick:Z,children:"-"}),se.jsx("button",{style:ct.controlButton,onClick:Ae,children:"i"})]}),se.jsx("div",{style:ct.topCenterContainer,children:se.jsx(yc,{})}),se.jsxs("div",{style:ct.topRightContainer,children:[se.jsx("button",{style:ct.controlButton,onClick:()=>N(!0),children:"🏆"}),se.jsx("button",{style:ct.controlButton,onClick:ve,title:"Return to Globe",children:"🌍"})]}),se.jsx("div",{style:ct.bottomLeftContainer,children:se.jsx(Ec,{})}),se.jsx("div",{style:ct.bottomRightContainer,children:se.jsx(Cc,{onClick:we})}),se.jsxs(u.Suspense,{fallback:se.jsx(go,{}),children:[F&&se.jsx(Mc,{onClose:Ue,onRegister:ge}),z&&se.jsx(Sc,{onClose:Ee}),J&&se.jsx(Pc,{onClose:ie})]})]})}export{Kc as default};
