const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-CRJlvsFl.js","assets/index-CmoM7vgG.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-D-RonHKU.js","assets/InfoModal-Mhe9DrnX.js"])))=>i.map(i=>d[i]);
import{r as l,j as ue,b as Ln,R as en,c as Ra,g as Ta,d as Aa,a as Ba,L as ho,_ as Oi}from"./index-CmoM7vgG.js";function Fn(t){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(t)}function za(t,e){if(Fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,e);if(Fn(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=za(t,"string");return Fn(e)=="symbol"?e:e+""}function z(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ws(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fi,go;function Ua(){if(go)return fi;go=1;var t=function(r,o,u,f,p,h,g,L){if(!r){var w;if(o===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var y=[u,f,p,h,g,L],S=0;w=new Error(o.replace(/%s/g,function(){return y[S++]})),w.name="Invariant Violation"}throw w.framesToPop=1,w}};return fi=t,fi}var Ka=Ua(),Ze=Ws(Ka),Pe=l.createContext(null);function Na(){Ze(!!l.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=l.useContext(Pe);return Ze(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function qa(t,e,r){return Object.keys(t).reduce(function(u,f){return e(u,t[f],f)},r)}function Wa(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function Za(t,e,r,o){var u={},f=(p,h)=>{var g=r[h];g!==e[h]&&(u[h]=g,p(o,g))};return Wa(t,f),u}function $a(t,e,r){var o=qa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return o}function Va(t){google.maps.event.removeListener(t)}function je(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Va)}function Ie(t){var{updaterMap:e,eventMap:r,prevProps:o,nextProps:u,instance:f}=t,p=$a(u,f,r);return Za(e,o,u,f),p}var mo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},vo={extraMapTypes(t,e){e.forEach(function(o,u){t.mapTypes.set(String(u),o)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ha(t){var{children:e,options:r,id:o,mapContainerStyle:u,mapContainerClassName:f,center:p,onClick:h,onDblClick:g,onDrag:L,onDragEnd:w,onDragStart:y,onMouseMove:S,onMouseOut:j,onMouseOver:P,onMouseDown:K,onMouseUp:Z,onRightClick:Y,onCenterChanged:F,onLoad:ae,onUnmount:B}=t,[T,A]=l.useState(null),$=l.useRef(null),[se,N]=l.useState(null),[V,re]=l.useState(null),[ge,Q]=l.useState(null),[ce,le]=l.useState(null),[de,Le]=l.useState(null),[ve,ye]=l.useState(null),[pe,we]=l.useState(null),[xe,fe]=l.useState(null),[ke,q]=l.useState(null),[Re,Ue]=l.useState(null),[Ee,ie]=l.useState(null),[be,_e]=l.useState(null);return l.useEffect(()=>{r&&T!==null&&T.setOptions(r)},[T,r]),l.useEffect(()=>{T!==null&&typeof p<"u"&&T.setCenter(p)},[T,p]),l.useEffect(()=>{T&&g&&(V!==null&&google.maps.event.removeListener(V),re(google.maps.event.addListener(T,"dblclick",g)))},[g]),l.useEffect(()=>{T&&w&&(ge!==null&&google.maps.event.removeListener(ge),Q(google.maps.event.addListener(T,"dragend",w)))},[w]),l.useEffect(()=>{T&&y&&(ce!==null&&google.maps.event.removeListener(ce),le(google.maps.event.addListener(T,"dragstart",y)))},[y]),l.useEffect(()=>{T&&K&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(T,"mousedown",K)))},[K]),l.useEffect(()=>{T&&S&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(T,"mousemove",S)))},[S]),l.useEffect(()=>{T&&j&&(pe!==null&&google.maps.event.removeListener(pe),we(google.maps.event.addListener(T,"mouseout",j)))},[j]),l.useEffect(()=>{T&&P&&(xe!==null&&google.maps.event.removeListener(xe),fe(google.maps.event.addListener(T,"mouseover",P)))},[P]),l.useEffect(()=>{T&&Z&&(ke!==null&&google.maps.event.removeListener(ke),q(google.maps.event.addListener(T,"mouseup",Z)))},[Z]),l.useEffect(()=>{T&&Y&&(Re!==null&&google.maps.event.removeListener(Re),Ue(google.maps.event.addListener(T,"rightclick",Y)))},[Y]),l.useEffect(()=>{T&&h&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener(T,"click",h)))},[h]),l.useEffect(()=>{T&&L&&(be!==null&&google.maps.event.removeListener(be),_e(google.maps.event.addListener(T,"drag",L)))},[L]),l.useEffect(()=>{T&&F&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(T,"center_changed",F)))},[h]),l.useEffect(()=>{var H=$.current===null?null:new google.maps.Map($.current,r);return A(H),H!==null&&ae&&ae(H),()=>{H!==null&&B&&B(H)}},[]),ue.jsx("div",{id:o,ref:$,style:u,className:f,children:ue.jsx(Pe.Provider,{value:T,children:T!==null?e:null})})}l.memo(Ha);class Ga extends l.PureComponent{constructor(){super(...arguments),z(this,"state",{map:null}),z(this,"registeredEvents",[]),z(this,"mapRef",null),z(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),z(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),z(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),z(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=Ie({updaterMap:vo,eventMap:mo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:vo,eventMap:mo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),je(this.registeredEvents))}render(){return ue.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:ue.jsx(Pe.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function yo(t,e,r,o,u,f,p){try{var h=t[f](p),g=h.value}catch(L){return void r(L)}h.done?e(g):Promise.resolve(g).then(o,u)}function Zs(t){return function(){var e=this,r=arguments;return new Promise(function(o,u){var f=t.apply(e,r);function p(g){yo(f,o,u,p,h,"next",g)}function h(g){yo(f,o,u,p,h,"throw",g)}p(void 0)})}}function $s(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:o="weekly",language:u,region:f,libraries:p,channel:h,mapIds:g,authReferrerPolicy:L,apiUrl:w="https://maps.googleapis.com"}=t,y=[];return Ze(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?y.push("key=".concat(e)):r&&y.push("client=".concat(r)),o&&y.push("v=".concat(o)),u&&y.push("language=".concat(u)),f&&y.push("region=".concat(f)),p&&p.length&&y.push("libraries=".concat(p.sort().join(","))),h&&y.push("channel=".concat(h)),g&&g.length&&y.push("map_ids=".concat(g.join(","))),L&&y.push("auth_referrer_policy=".concat(L)),y.push("loading=async"),y.push("callback=initMap"),"".concat(w,"/maps/api/js?").concat(y.join("&"))}var qt=typeof document<"u";function Vs(t){var{url:e,id:r,nonce:o}=t;return qt?new Promise(function(f,p){var h=document.getElementById(r),g=window;if(h){var L=h.getAttribute("data-state");if(h.src===e&&L!=="error"){if(L==="ready")return f(r);var w=g.initMap,y=h.onerror;g.initMap=function(){w&&w(),f(r)},h.onerror=function(j){y&&y(j),p(j)};return}else h.remove()}var S=document.createElement("script");S.type="text/javascript",S.src=e,S.id=r,S.async=!0,S.nonce=o||"",S.onerror=function(P){S.setAttribute("data-state","error"),p(P)},g.initMap=function(){S.setAttribute("data-state","ready"),f(r)},document.head.appendChild(S)}).catch(u=>{throw console.error("injectScript error: ",u),u}):Promise.reject(new Error("document is undefined"))}function bo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function _i(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(u,f){return bo(u)||Reflect.apply(e,t,[u,f]),u};var r=t.appendChild.bind(t);t.appendChild=function(u){return bo(u)||Reflect.apply(r,t,[u]),u}}}var Tn=!1;function Hs(){return ue.jsx("div",{children:"Loading..."})}var Un={id:"script-loader",version:"weekly"};class Ya extends l.PureComponent{constructor(){super(...arguments),z(this,"check",null),z(this,"state",{loaded:!1}),z(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),z(this,"isCleaningUp",Zs(function*(){function e(r){if(!Tn)r();else if(qt)var o=window.setInterval(function(){Tn||(window.clearInterval(o),r())},1)}return new Promise(e)})),z(this,"cleanup",()=>{Tn=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(o){return typeof o.src=="string"&&o.src.includes("maps.googleapis")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(o){return o.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(o){return o.innerText!==void 0&&o.innerText.length>0&&o.innerText.includes(".gm-")}).forEach(function(o){o.parentNode&&o.parentNode.removeChild(o)})}),z(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&_i(),Ze(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:$s(this.props)};Vs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),z(this,"getRef",e=>{this.check=e})}componentDidMount(){if(qt){if(window.google&&window.google.maps&&!Tn){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),qt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(qt){this.cleanup();var e=()=>{this.check||(delete window.google,Tn=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||ue.jsx(Hs,{})]})}}z(Ya,"defaultProps",Un);function Ja(t,e){if(t==null)return{};var r={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;r[o]=t[o]}return r}function Di(t,e){if(t==null)return{};var r,o,u=Ja(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(o=0;o<f.length;o++)r=f[o],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(u[r]=t[r])}return u}var wo;function Xa(t){var{id:e=Un.id,version:r=Un.version,nonce:o,googleMapsApiKey:u,googleMapsClientId:f,language:p,region:h,libraries:g,preventGoogleFontsLoading:L,channel:w,mapIds:y,authReferrerPolicy:S,apiUrl:j="https://maps.googleapis.com"}=t,P=l.useRef(!1),[K,Z]=l.useState(!1),[Y,F]=l.useState(void 0);l.useEffect(function(){return P.current=!0,()=>{P.current=!1}},[]),l.useEffect(function(){qt&&L&&_i()},[L]),l.useEffect(function(){K&&Ze(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[K]);var ae=$s({version:r,googleMapsApiKey:u,googleMapsClientId:f,language:p,region:h,libraries:g,channel:w,mapIds:y,authReferrerPolicy:S,apiUrl:j});l.useEffect(function(){if(!qt)return;function A(){P.current&&(Z(!0),wo=ae)}if(window.google&&window.google.maps&&wo===ae){A();return}Vs({id:e,url:ae,nonce:o}).then(A).catch(function(se){P.current&&F(se),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(u||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(se)})},[e,ae,o]);var B=l.useRef(void 0);return l.useEffect(function(){B.current&&g!==B.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),B.current=g},[g]),{isLoaded:K,loadError:Y,url:ae}}var Qa=["loadingElement","onLoad","onError","onUnmount","children"],el=ue.jsx(Hs,{});function tl(t){var{loadingElement:e,onLoad:r,onError:o,onUnmount:u,children:f}=t,p=Di(t,Qa),{isLoaded:h,loadError:g}=Xa(p);return l.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),l.useEffect(function(){g&&typeof o=="function"&&o(g)},[g,o]),l.useEffect(function(){return()=>{u&&u()}},[u]),h?f:e||el}l.memo(tl);function nl(t,e,r,o){function u(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(w){try{L(o.next(w))}catch(y){p(y)}}function g(w){try{L(o.throw(w))}catch(y){p(y)}}function L(w){w.done?f(w.value):u(w.value).then(h,g)}L((o=o.apply(t,[])).next())})}function rl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var il=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,u,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(u=o;u--!==0;)if(!t(e[u],r[u]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(u=o;u--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[u]))return!1;for(u=o;u--!==0;){var p=f[u];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},ol=rl(il),Lo="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Qt{constructor(e){var{apiKey:r,authReferrerPolicy:o,channel:u,client:f,id:p=Lo,language:h,libraries:g=[],mapIds:L,nonce:w,region:y,retries:S=3,url:j="https://maps.googleapis.com/maps/api/js",version:P}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=o,this.channel=u,this.client=f,this.id=p||Lo,this.language=h,this.libraries=g,this.mapIds=L,this.nonce=w,this.region=y,this.retries=S,this.url=j,this.version=P,Qt.instance){if(!ol(this.options,Qt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Qt.instance.options)));return Qt.instance}Qt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(o=>{o?r(o.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var o={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(o).forEach(f=>!o[f]&&delete o[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,g,L="The Google Maps JavaScript API",w="google",y="importLibrary",S="__ib__",j=document,P=window;P=P[w]||(P[w]={});var K=P.maps||(P.maps={}),Z=new Set,Y=new URLSearchParams,F=()=>p||(p=new Promise((ae,B)=>nl(this,void 0,void 0,function*(){var T;yield h=j.createElement("script"),h.id=this.id,Y.set("libraries",[...Z]+"");for(g in f)Y.set(g.replace(/[A-Z]/g,A=>"_"+A[0].toLowerCase()),f[g]);Y.set("callback",w+".maps."+S),h.src=this.url+"?"+Y,K[S]=ae,h.onerror=()=>p=B(Error(L+" could not load.")),h.nonce=this.nonce||((T=j.querySelector("script[nonce]"))===null||T===void 0?void 0:T.nonce)||"",j.head.append(h)})));K[y]?console.warn(L+" only loads once. Ignoring:",f):K[y]=function(ae){for(var B=arguments.length,T=new Array(B>1?B-1:0),A=1;A<B;A++)T[A-1]=arguments[A];return Z.add(ae)&&F().then(()=>K[y](ae,...T))}})(o);var u=this.libraries.map(f=>this.importLibrary(f));u.length||u.push(this.importLibrary("core")),Promise.all(u).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var sl=["maps"];function al(t){var{id:e=Un.id,version:r=Un.version,nonce:o,googleMapsApiKey:u,language:f,region:p,libraries:h=sl,preventGoogleFontsLoading:g,mapIds:L,authReferrerPolicy:w}=t,y=l.useRef(!1),[S,j]=l.useState(!1),[P,K]=l.useState(void 0);l.useEffect(function(){return y.current=!0,()=>{y.current=!1}},[]);var Z=l.useMemo(()=>new Qt({id:e,apiKey:u,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:L||[],nonce:o||"",authReferrerPolicy:w||"origin"}),[e,u,r,h,f,p,L,o,w]);l.useEffect(function(){S||Z.load().then(()=>{y.current&&j(!0)}).catch(ae=>{K(ae)})},[]),l.useEffect(()=>{qt&&g&&_i()},[g]);var Y=l.useRef();return l.useEffect(()=>{Y.current&&h!==Y.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Y.current=h},[h]),{isLoaded:S,loadError:P}}function Co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Co(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var xo={},Eo={options(t,e){t.setOptions(e)}};function ll(t){var{options:e,onLoad:r,onUnmount:o}=t,u=l.useContext(Pe),[f,p]=l.useState(null);return l.useEffect(()=>{f!==null&&f.setMap(u)},[u]),l.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),l.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:u}));return p(h),r&&r(h),()=>{f!==null&&(o&&o(f),f.setMap(null))}},[]),null}l.memo(ll);class ul extends l.PureComponent{constructor(){super(...arguments),z(this,"state",{trafficLayer:null}),z(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),z(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:Eo,eventMap:xo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Eo,eventMap:xo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),je(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}z(ul,"contextType",Pe);function cl(t){var{onLoad:e,onUnmount:r}=t,o=l.useContext(Pe),[u,f]=l.useState(null);return l.useEffect(()=>{u!==null&&u.setMap(o)},[o]),l.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(o),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}l.memo(cl);class fl extends l.PureComponent{constructor(){super(...arguments),z(this,"state",{bicyclingLayer:null}),z(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}z(fl,"contextType",Pe);function dl(t){var{onLoad:e,onUnmount:r}=t,o=l.useContext(Pe),[u,f]=l.useState(null);return l.useEffect(()=>{u!==null&&u.setMap(o)},[o]),l.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(o),e&&e(p),()=>{u!==null&&(r&&r(u),u.setMap(null))}},[]),null}l.memo(dl);class pl extends l.PureComponent{constructor(){super(...arguments),z(this,"state",{transitLayer:null}),z(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}z(pl,"contextType",Pe);function So(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function xr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?So(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):So(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ko={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Mo={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function hl(t){var{options:e,drawingMode:r,onCircleComplete:o,onMarkerComplete:u,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:g,onLoad:L,onUnmount:w}=t,y=l.useContext(Pe),[S,j]=l.useState(null),[P,K]=l.useState(null),[Z,Y]=l.useState(null),[F,ae]=l.useState(null),[B,T]=l.useState(null),[A,$]=l.useState(null),[se,N]=l.useState(null);return l.useEffect(()=>{S!==null&&S.setMap(y)},[y]),l.useEffect(()=>{e&&S!==null&&S.setOptions(e)},[S,e]),l.useEffect(()=>{S!==null&&S.setDrawingMode(r??null)},[S,r]),l.useEffect(()=>{S&&o&&(P!==null&&google.maps.event.removeListener(P),K(google.maps.event.addListener(S,"circlecomplete",o)))},[S,o]),l.useEffect(()=>{S&&u&&(Z!==null&&google.maps.event.removeListener(Z),Y(google.maps.event.addListener(S,"markercomplete",u)))},[S,u]),l.useEffect(()=>{S&&f&&(F!==null&&google.maps.event.removeListener(F),ae(google.maps.event.addListener(S,"overlaycomplete",f)))},[S,f]),l.useEffect(()=>{S&&p&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(S,"polygoncomplete",p)))},[S,p]),l.useEffect(()=>{S&&h&&(A!==null&&google.maps.event.removeListener(A),$(google.maps.event.addListener(S,"polylinecomplete",h)))},[S,h]),l.useEffect(()=>{S&&g&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(S,"rectanglecomplete",g)))},[S,g]),l.useEffect(()=>{Ze(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var V=new google.maps.drawing.DrawingManager(xr(xr({},e),{},{map:y}));return r&&V.setDrawingMode(r),o&&K(google.maps.event.addListener(V,"circlecomplete",o)),u&&Y(google.maps.event.addListener(V,"markercomplete",u)),f&&ae(google.maps.event.addListener(V,"overlaycomplete",f)),p&&T(google.maps.event.addListener(V,"polygoncomplete",p)),h&&$(google.maps.event.addListener(V,"polylinecomplete",h)),g&&N(google.maps.event.addListener(V,"rectanglecomplete",g)),j(V),L&&L(V),()=>{S!==null&&(P&&google.maps.event.removeListener(P),Z&&google.maps.event.removeListener(Z),F&&google.maps.event.removeListener(F),B&&google.maps.event.removeListener(B),A&&google.maps.event.removeListener(A),se&&google.maps.event.removeListener(se),w&&w(S),S.setMap(null))}},[]),null}l.memo(hl);class gl extends l.PureComponent{constructor(e){super(e),z(this,"registeredEvents",[]),z(this,"state",{drawingManager:null}),z(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),Ze(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(xr(xr({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:Mo,eventMap:ko,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Mo,eventMap:ko,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),je(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}z(gl,"contextType",Pe);function Po(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Po(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Po(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Oo={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},_o={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Er={};function ml(t){var{position:e,options:r,clusterer:o,noClustererRedraw:u,children:f,draggable:p,visible:h,animation:g,clickable:L,cursor:w,icon:y,label:S,opacity:j,shape:P,title:K,zIndex:Z,onClick:Y,onDblClick:F,onDrag:ae,onDragEnd:B,onDragStart:T,onMouseOut:A,onMouseOver:$,onMouseUp:se,onMouseDown:N,onRightClick:V,onClickableChanged:re,onCursorChanged:ge,onAnimationChanged:Q,onDraggableChanged:ce,onFlatChanged:le,onIconChanged:de,onPositionChanged:Le,onShapeChanged:ve,onTitleChanged:ye,onVisibleChanged:pe,onZindexChanged:we,onLoad:xe,onUnmount:fe}=t,ke=l.useContext(Pe),[q,Re]=l.useState(null),[Ue,Ee]=l.useState(null),[ie,be]=l.useState(null),[_e,H]=l.useState(null),[Be,et]=l.useState(null),[Te,Zn]=l.useState(null),[rn,$n]=l.useState(null),[on,sn]=l.useState(null),[Xe,Cn]=l.useState(null),[pt,xn]=l.useState(null),[Pt,ht]=l.useState(null),[lt,an]=l.useState(null),[gt,ln]=l.useState(null),[Lt,mt]=l.useState(null),[Ct,un]=l.useState(null),[tt,me]=l.useState(null),[vt,yt]=l.useState(null),[xt,oe]=l.useState(null),[cn,En]=l.useState(null),[Ot,Sn]=l.useState(null),[_t,Vn]=l.useState(null),[fn,Et]=l.useState(null);l.useEffect(()=>{q!==null&&q.setMap(ke)},[ke]),l.useEffect(()=>{typeof r<"u"&&q!==null&&q.setOptions(r)},[q,r]),l.useEffect(()=>{typeof p<"u"&&q!==null&&q.setDraggable(p)},[q,p]),l.useEffect(()=>{e&&q!==null&&q.setPosition(e)},[q,e]),l.useEffect(()=>{typeof h<"u"&&q!==null&&q.setVisible(h)},[q,h]),l.useEffect(()=>{q?.setAnimation(g)},[q,g]),l.useEffect(()=>{q&&L!==void 0&&q.setClickable(L)},[q,L]),l.useEffect(()=>{q&&w!==void 0&&q.setCursor(w)},[q,w]),l.useEffect(()=>{q&&y!==void 0&&q.setIcon(y)},[q,y]),l.useEffect(()=>{q&&S!==void 0&&q.setLabel(S)},[q,S]),l.useEffect(()=>{q&&j!==void 0&&q.setOpacity(j)},[q,j]),l.useEffect(()=>{q&&P!==void 0&&q.setShape(P)},[q,P]),l.useEffect(()=>{q&&K!==void 0&&q.setTitle(K)},[q,K]),l.useEffect(()=>{q&&Z!==void 0&&q.setZIndex(Z)},[q,Z]),l.useEffect(()=>{q&&F&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener(q,"dblclick",F)))},[F]),l.useEffect(()=>{q&&B&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener(q,"dragend",B)))},[B]),l.useEffect(()=>{q&&T&&(_e!==null&&google.maps.event.removeListener(_e),H(google.maps.event.addListener(q,"dragstart",T)))},[T]),l.useEffect(()=>{q&&N&&(Be!==null&&google.maps.event.removeListener(Be),et(google.maps.event.addListener(q,"mousedown",N)))},[N]),l.useEffect(()=>{q&&A&&(Te!==null&&google.maps.event.removeListener(Te),Zn(google.maps.event.addListener(q,"mouseout",A)))},[A]),l.useEffect(()=>{q&&$&&(rn!==null&&google.maps.event.removeListener(rn),$n(google.maps.event.addListener(q,"mouseover",$)))},[$]),l.useEffect(()=>{q&&se&&(on!==null&&google.maps.event.removeListener(on),sn(google.maps.event.addListener(q,"mouseup",se)))},[se]),l.useEffect(()=>{q&&V&&(Xe!==null&&google.maps.event.removeListener(Xe),Cn(google.maps.event.addListener(q,"rightclick",V)))},[V]),l.useEffect(()=>{q&&Y&&(pt!==null&&google.maps.event.removeListener(pt),xn(google.maps.event.addListener(q,"click",Y)))},[Y]),l.useEffect(()=>{q&&ae&&(Pt!==null&&google.maps.event.removeListener(Pt),ht(google.maps.event.addListener(q,"drag",ae)))},[ae]),l.useEffect(()=>{q&&re&&(lt!==null&&google.maps.event.removeListener(lt),an(google.maps.event.addListener(q,"clickable_changed",re)))},[re]),l.useEffect(()=>{q&&ge&&(gt!==null&&google.maps.event.removeListener(gt),ln(google.maps.event.addListener(q,"cursor_changed",ge)))},[ge]),l.useEffect(()=>{q&&Q&&(Lt!==null&&google.maps.event.removeListener(Lt),mt(google.maps.event.addListener(q,"animation_changed",Q)))},[Q]),l.useEffect(()=>{q&&ce&&(Ct!==null&&google.maps.event.removeListener(Ct),un(google.maps.event.addListener(q,"draggable_changed",ce)))},[ce]),l.useEffect(()=>{q&&le&&(tt!==null&&google.maps.event.removeListener(tt),me(google.maps.event.addListener(q,"flat_changed",le)))},[le]),l.useEffect(()=>{q&&de&&(vt!==null&&google.maps.event.removeListener(vt),yt(google.maps.event.addListener(q,"icon_changed",de)))},[de]),l.useEffect(()=>{q&&Le&&(xt!==null&&google.maps.event.removeListener(xt),oe(google.maps.event.addListener(q,"position_changed",Le)))},[Le]),l.useEffect(()=>{q&&ve&&(cn!==null&&google.maps.event.removeListener(cn),En(google.maps.event.addListener(q,"shape_changed",ve)))},[ve]),l.useEffect(()=>{q&&ye&&(Ot!==null&&google.maps.event.removeListener(Ot),Sn(google.maps.event.addListener(q,"title_changed",ye)))},[ye]),l.useEffect(()=>{q&&pe&&(_t!==null&&google.maps.event.removeListener(_t),Vn(google.maps.event.addListener(q,"visible_changed",pe)))},[pe]),l.useEffect(()=>{q&&we&&(fn!==null&&google.maps.event.removeListener(fn),Et(google.maps.event.addListener(q,"zindex_changed",we)))},[we]),l.useEffect(()=>{var St=bn(bn(bn({},r||Er),o?Er:{map:ke}),{},{position:e}),Ce=new google.maps.Marker(St);return o?o.addMarker(Ce,!!u):Ce.setMap(ke),e&&Ce.setPosition(e),typeof h<"u"&&Ce.setVisible(h),typeof p<"u"&&Ce.setDraggable(p),typeof L<"u"&&Ce.setClickable(L),typeof w=="string"&&Ce.setCursor(w),y&&Ce.setIcon(y),typeof S<"u"&&Ce.setLabel(S),typeof j<"u"&&Ce.setOpacity(j),P&&Ce.setShape(P),typeof K=="string"&&Ce.setTitle(K),typeof Z=="number"&&Ce.setZIndex(Z),F&&Ee(google.maps.event.addListener(Ce,"dblclick",F)),B&&be(google.maps.event.addListener(Ce,"dragend",B)),T&&H(google.maps.event.addListener(Ce,"dragstart",T)),N&&et(google.maps.event.addListener(Ce,"mousedown",N)),A&&Zn(google.maps.event.addListener(Ce,"mouseout",A)),$&&$n(google.maps.event.addListener(Ce,"mouseover",$)),se&&sn(google.maps.event.addListener(Ce,"mouseup",se)),V&&Cn(google.maps.event.addListener(Ce,"rightclick",V)),Y&&xn(google.maps.event.addListener(Ce,"click",Y)),ae&&ht(google.maps.event.addListener(Ce,"drag",ae)),re&&an(google.maps.event.addListener(Ce,"clickable_changed",re)),ge&&ln(google.maps.event.addListener(Ce,"cursor_changed",ge)),Q&&mt(google.maps.event.addListener(Ce,"animation_changed",Q)),ce&&un(google.maps.event.addListener(Ce,"draggable_changed",ce)),le&&me(google.maps.event.addListener(Ce,"flat_changed",le)),de&&yt(google.maps.event.addListener(Ce,"icon_changed",de)),Le&&oe(google.maps.event.addListener(Ce,"position_changed",Le)),ve&&En(google.maps.event.addListener(Ce,"shape_changed",ve)),ye&&Sn(google.maps.event.addListener(Ce,"title_changed",ye)),pe&&Vn(google.maps.event.addListener(Ce,"visible_changed",pe)),we&&Et(google.maps.event.addListener(Ce,"zindex_changed",we)),Re(Ce),xe&&xe(Ce),()=>{Ue!==null&&google.maps.event.removeListener(Ue),ie!==null&&google.maps.event.removeListener(ie),_e!==null&&google.maps.event.removeListener(_e),Be!==null&&google.maps.event.removeListener(Be),Te!==null&&google.maps.event.removeListener(Te),rn!==null&&google.maps.event.removeListener(rn),on!==null&&google.maps.event.removeListener(on),Xe!==null&&google.maps.event.removeListener(Xe),pt!==null&&google.maps.event.removeListener(pt),lt!==null&&google.maps.event.removeListener(lt),gt!==null&&google.maps.event.removeListener(gt),Lt!==null&&google.maps.event.removeListener(Lt),Ct!==null&&google.maps.event.removeListener(Ct),tt!==null&&google.maps.event.removeListener(tt),vt!==null&&google.maps.event.removeListener(vt),xt!==null&&google.maps.event.removeListener(xt),Ot!==null&&google.maps.event.removeListener(Ot),_t!==null&&google.maps.event.removeListener(_t),fn!==null&&google.maps.event.removeListener(fn),fe&&fe(Ce),o?o.removeMarker(Ce,!!u):Ce&&Ce.setMap(null)}},[]);var Dt=l.useMemo(()=>f?l.Children.map(f,St=>{if(!l.isValidElement(St))return St;var Ce=St;return l.cloneElement(Ce,{anchor:q})}):null,[f,q]);return ue.jsx(ue.Fragment,{children:Dt})||null}l.memo(ml);class vl extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[])}componentDidMount(){var e=this;return Zs(function*(){var r=bn(bn(bn({},e.props.options||Er),e.props.clusterer?Er:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=Ie({updaterMap:_o,eventMap:Oo,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:_o,eventMap:Oo,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),je(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?l.Children.map(this.props.children,r=>{if(!l.isValidElement(r))return r;var o=r;return l.cloneElement(o,{anchor:this.marker})}):null;return e||null}}z(vl,"contextType",Pe);var yl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var o=r.getMaxZoom(),u=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(u),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(u);var h=p.getZoom()||0;o!==null&&h>o&&p.setZoom(o+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,o,u,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,g=this.backgroundPosition.split(" "),L=parseInt(((e=g[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),w=parseInt(((r=g[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),y=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(y!==null?"".concat(y.y,"px"):"0","; left: ").concat(y!==null?"".concat(y.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var S=document.createElement("img");S.alt=h,S.src=this.url,S.width=this.width,S.height=this.height,S.setAttribute("style","position: absolute; top: ".concat(w,"px; left: ").concat(L,"px")),this.cluster.getClusterer().enableRetinaIcons||(S.style.clip="rect(-".concat(w,"px, -").concat(L+this.width,"px, -").concat(w+this.height,", -").concat(L,")"));var j=document.createElement("div");j.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((o=this.sums)===null||o===void 0)&&o.text&&(j.innerText="".concat((u=this.sums)===null||u===void 0?void 0:u.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(j.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(S),this.div.appendChild(j),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),o=r[Math.min(r.length-1,Math.max(0,e.index-1))];o&&(this.url=o.url,this.height=o.height,this.width=o.width,o.className&&(this.className="".concat(this.clusterClassName," ").concat(o.className)),this.anchorText=o.anchorText||[0,0],this.anchorIcon=o.anchorIcon||[this.height/2,this.width/2],this.textColor=o.textColor||"black",this.textSize=o.textSize||11,this.textDecoration=o.textDecoration||"none",this.fontWeight=o.fontWeight||"bold",this.fontStyle=o.fontStyle||"normal",this.fontFamily=o.fontFamily||"Arial,sans-serif",this.backgroundPosition=o.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),bl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new yl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),o=0,u=r;o<u.length;o++){var f=u[o],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var o=e.getPosition();if(o){var u=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(u-1)+o.lat())/u,(this.center.lng()*(u-1)+o.lng())/u),this.calculateBounds()}}}else{var o=e.getPosition();o&&(this.center=o,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var g=0,L=this.markers;g<L.length;g++){var w=L[g];w.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,o=this.markerClusterer.getMaxZoom(),u=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(o!==null&&typeof u<"u"&&u>o){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function wl(t,e){var r=t.length,o=r.toString().length,u=Math.min(o,e);return{text:r.toString(),index:u,title:""}}var Ll=2e3,Cl=500,xl="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",El="png",Sl=[53,56,66,78,90],kl="cluster",Gs=(function(){function t(e,r,o){r===void 0&&(r=[]),o===void 0&&(o={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=o.gridSize||60,this.minClusterSize=o.minimumClusterSize||2,this.maxZoom=o.maxZoom||null,this.styles=o.styles||[],this.title=o.title||"",this.zoomOnClick=!0,o.zoomOnClick!==void 0&&(this.zoomOnClick=o.zoomOnClick),this.averageCenter=!1,o.averageCenter!==void 0&&(this.averageCenter=o.averageCenter),this.ignoreHidden=!1,o.ignoreHidden!==void 0&&(this.ignoreHidden=o.ignoreHidden),this.enableRetinaIcons=!1,o.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=o.enableRetinaIcons),this.imagePath=o.imagePath||xl,this.imageExtension=o.imageExtension||El,this.imageSizes=o.imageSizes||Sl,this.calculator=o.calculator||wl,this.batchSize=o.batchSize||Ll,this.batchSizeIE=o.batchSizeIE||Cl,this.clusterClass=o.clusterClass||kl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var o=r[e];o.getMap()!==this.activeMap&&o.setMap(this.activeMap)}for(var u=0,f=this.clusters;u<f.length;u++){var p=f[u];p.remove()}this.clusters=[];for(var h=0,g=this.listeners;h<g.length;h++){var L=g[h];google.maps.event.removeListener(L)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,o=0,u=e;o<u.length;o++){var f=u[o],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];u&&this.pushMarkerTo(u)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var o=0;o<this.markers.length;o++)if(e===this.markers[o]){r=o;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var o=this.removeMarker_(e);return!r&&o&&this.repaint(),o},t.prototype.removeMarkers=function(e,r){for(var o=!1,u=0,f=e;u<f.length;u++){var p=f[u];o=o||this.removeMarker_(p)}return!r&&o&&this.repaint(),o},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var o=0,u=e;o<u.length;o++){var f=u[o];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),o=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));o!==null&&(o.x+=this.gridSize,o.y-=this.gridSize);var u=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(u!==null&&(u.x-=this.gridSize,u.y+=this.gridSize),o!==null){var f=r.fromDivPixelToLatLng(o);f!==null&&e.extend(f)}if(u!==null){var p=r.fromDivPixelToLatLng(u);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,o=this.clusters;r<o.length;r++){var u=o[r];u.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var o=6371,u=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(u/2)*Math.sin(u/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return o*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var o=e.getPosition();return o?r.contains(o):!1},t.prototype.addToClosestCluster=function(e){for(var r,o=4e4,u=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var g=r.getCenter(),L=e.getPosition();if(g&&L){var w=this.distanceBetweenPoints(g,L);w<o&&(o=w,u=r)}}u&&u.isMarkerInClusterBounds(e)?u.addMarker(e):(r=new bl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var o=this.getMap(),u=o!==null&&("getBounds"in o)?o.getBounds():null,f=o?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(u?.getSouthWest(),u?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),g=Math.min(e+this.batchSize,this.markers.length),L=e;L<g;L++){var w=this.markers[L];w&&!w.isAdded&&this.isMarkerInBounds(w,h)&&(!this.ignoreHidden||this.ignoreHidden&&w.getVisible())&&this.addToClosestCluster(w)}if(g<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(g)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var y=0,S=this.clusters;y<S.length;y++){var j=S[y];j.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(u){for(var f in u.prototype){var p=f;this.prototype[p]=u.prototype[p]}return this}).apply(e,[r])},t})();function Do(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Ml(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Do(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Do(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ct={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Fe={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Pl={};function Ol(t){var{children:e,options:r,averageCenter:o,batchSizeIE:u,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:g,ignoreHidden:L,imageExtension:w,imagePath:y,imageSizes:S,maxZoom:j,minimumClusterSize:P,styles:K,title:Z,zoomOnClick:Y,onClick:F,onClusteringBegin:ae,onClusteringEnd:B,onMouseOver:T,onMouseOut:A,onLoad:$,onUnmount:se}=t,[N,V]=l.useState(null),re=l.useContext(Pe),[ge,Q]=l.useState(null),[ce,le]=l.useState(null),[de,Le]=l.useState(null),[ve,ye]=l.useState(null),[pe,we]=l.useState(null);return l.useEffect(()=>{N&&A&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(N,ct.onMouseOut,A)))},[A]),l.useEffect(()=>{N&&T&&(pe!==null&&google.maps.event.removeListener(pe),we(google.maps.event.addListener(N,ct.onMouseOver,T)))},[T]),l.useEffect(()=>{N&&F&&(ge!==null&&google.maps.event.removeListener(ge),Q(google.maps.event.addListener(N,ct.onClick,F)))},[F]),l.useEffect(()=>{N&&ae&&(ce!==null&&google.maps.event.removeListener(ce),le(google.maps.event.addListener(N,ct.onClusteringBegin,ae)))},[ae]),l.useEffect(()=>{N&&B&&(de!==null&&google.maps.event.removeListener(de),le(google.maps.event.addListener(N,ct.onClusteringEnd,B)))},[B]),l.useEffect(()=>{typeof o<"u"&&N!==null&&Fe.averageCenter(N,o)},[N,o]),l.useEffect(()=>{typeof u<"u"&&N!==null&&Fe.batchSizeIE(N,u)},[N,u]),l.useEffect(()=>{typeof f<"u"&&N!==null&&Fe.calculator(N,f)},[N,f]),l.useEffect(()=>{typeof p<"u"&&N!==null&&Fe.clusterClass(N,p)},[N,p]),l.useEffect(()=>{typeof h<"u"&&N!==null&&Fe.enableRetinaIcons(N,h)},[N,h]),l.useEffect(()=>{typeof g<"u"&&N!==null&&Fe.gridSize(N,g)},[N,g]),l.useEffect(()=>{typeof L<"u"&&N!==null&&Fe.ignoreHidden(N,L)},[N,L]),l.useEffect(()=>{typeof w<"u"&&N!==null&&Fe.imageExtension(N,w)},[N,w]),l.useEffect(()=>{typeof y<"u"&&N!==null&&Fe.imagePath(N,y)},[N,y]),l.useEffect(()=>{typeof S<"u"&&N!==null&&Fe.imageSizes(N,S)},[N,S]),l.useEffect(()=>{typeof j<"u"&&N!==null&&Fe.maxZoom(N,j)},[N,j]),l.useEffect(()=>{typeof P<"u"&&N!==null&&Fe.minimumClusterSize(N,P)},[N,P]),l.useEffect(()=>{typeof K<"u"&&N!==null&&Fe.styles(N,K)},[N,K]),l.useEffect(()=>{typeof Z<"u"&&N!==null&&Fe.title(N,Z)},[N,Z]),l.useEffect(()=>{typeof Y<"u"&&N!==null&&Fe.zoomOnClick(N,Y)},[N,Y]),l.useEffect(()=>{if(re){var xe=Ml({},r||Pl),fe=new Gs(re,[],xe);return o&&Fe.averageCenter(fe,o),u&&Fe.batchSizeIE(fe,u),f&&Fe.calculator(fe,f),p&&Fe.clusterClass(fe,p),h&&Fe.enableRetinaIcons(fe,h),g&&Fe.gridSize(fe,g),L&&Fe.ignoreHidden(fe,L),w&&Fe.imageExtension(fe,w),y&&Fe.imagePath(fe,y),S&&Fe.imageSizes(fe,S),j&&Fe.maxZoom(fe,j),P&&Fe.minimumClusterSize(fe,P),K&&Fe.styles(fe,K),Z&&Fe.title(fe,Z),Y&&Fe.zoomOnClick(fe,Y),A&&ye(google.maps.event.addListener(fe,ct.onMouseOut,A)),T&&we(google.maps.event.addListener(fe,ct.onMouseOver,T)),F&&Q(google.maps.event.addListener(fe,ct.onClick,F)),ae&&le(google.maps.event.addListener(fe,ct.onClusteringBegin,ae)),B&&Le(google.maps.event.addListener(fe,ct.onClusteringEnd,B)),V(fe),$&&$(fe),()=>{ve!==null&&google.maps.event.removeListener(ve),pe!==null&&google.maps.event.removeListener(pe),ge!==null&&google.maps.event.removeListener(ge),ce!==null&&google.maps.event.removeListener(ce),de!==null&&google.maps.event.removeListener(de),se&&se(fe)}}},[]),N!==null&&e(N)||null}l.memo(Ol);class _l extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{markerClusterer:null}),z(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Gs(this.context,[],this.props.options);this.registeredEvents=Ie({updaterMap:Fe,eventMap:ct,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Fe,eventMap:ct,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),je(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}z(_l,"contextType",Pe);function Io(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Ys=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(w){w.returnValue=!1,w.preventDefault&&w.preventDefault(),e.enableEventPropagation||Io(w)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var o=this.getPanes();if(o!==null&&o[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var u=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-u.left-u.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var g=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,g,Io))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var o=0,u=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,g=p.offsetHeight,L=this.pixelOffset.width,w=this.pixelOffset.height,y=this.div.offsetWidth,S=this.div.offsetHeight,j=this.infoBoxClearance.width,P=this.infoBoxClearance.height,K=this.getProjection(),Z=K.fromLatLngToContainerPixel(this.position);Z!==null&&(Z.x<-L+j?o=Z.x+L-j:Z.x+y+L+j>h&&(o=Z.x+y+L+j-h),this.alignBottom?Z.y<-w+P+S?u=Z.y+w-P-S:Z.y+w+P>g&&(u=Z.y+w+P-g):Z.y<-w+P?u=Z.y+w-P:Z.y+S+w+P>g&&(u=Z.y+S+w+P-g)),o===0&&u===0||r.panBy(o,u)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var o=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+o*100+')"',this.div.style.filter="alpha(opacity="+o*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,o=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;o&&(e.top=parseInt(o.borderTopWidth||"",10)||0,e.bottom=parseInt(o.borderBottomWidth||"",10)||0,e.left=parseInt(o.borderLeftWidth||"",10)||0,e.right=parseInt(o.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var u=this.div.currentStyle;u&&(e.top=parseInt(u.borderTopWidth||"",10)||0,e.bottom=parseInt(u.borderBottomWidth||"",10)||0,e.left=parseInt(u.borderLeftWidth||"",10)||0,e.right=parseInt(u.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var o=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var u=r.getPosition();o.setPosition(u)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){o.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var o=r[e];google.maps.event.removeListener(o)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(u){for(var f in u.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=u.prototype[f]);return this}).apply(e,[r])},t})(),Dl=["position"],Il=["position"];function jo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Ro={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},To={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},jl={};function Rl(t){var{children:e,anchor:r,options:o,position:u,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:g,onPositionChanged:L,onZindexChanged:w,onLoad:y,onUnmount:S}=t,j=l.useContext(Pe),[P,K]=l.useState(null),[Z,Y]=l.useState(null),[F,ae]=l.useState(null),[B,T]=l.useState(null),[A,$]=l.useState(null),[se,N]=l.useState(null),V=l.useRef(null);return l.useEffect(()=>{j&&P!==null&&(P.close(),r?P.open(j,r):P.getPosition()&&P.open(j))},[j,P,r]),l.useEffect(()=>{o&&P!==null&&P.setOptions(o)},[P,o]),l.useEffect(()=>{if(u&&P!==null){var re=u instanceof google.maps.LatLng?u:new google.maps.LatLng(u.lat,u.lng);P.setPosition(re)}},[u]),l.useEffect(()=>{typeof f=="number"&&P!==null&&P.setZIndex(f)},[f]),l.useEffect(()=>{P&&p&&(Z!==null&&google.maps.event.removeListener(Z),Y(google.maps.event.addListener(P,"closeclick",p)))},[p]),l.useEffect(()=>{P&&h&&(F!==null&&google.maps.event.removeListener(F),ae(google.maps.event.addListener(P,"domready",h)))},[h]),l.useEffect(()=>{P&&g&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(P,"content_changed",g)))},[g]),l.useEffect(()=>{P&&L&&(A!==null&&google.maps.event.removeListener(A),$(google.maps.event.addListener(P,"position_changed",L)))},[L]),l.useEffect(()=>{P&&w&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(P,"zindex_changed",w)))},[w]),l.useEffect(()=>{if(j){var re=o||jl,{position:ge}=re,Q=Di(re,Dl),ce;ge&&!(ge instanceof google.maps.LatLng)&&(ce=new google.maps.LatLng(ge.lat,ge.lng));var le=new Ys(Sr(Sr({},Q),ce?{position:ce}:{}));V.current=document.createElement("div"),K(le),p&&Y(google.maps.event.addListener(le,"closeclick",p)),h&&ae(google.maps.event.addListener(le,"domready",h)),g&&T(google.maps.event.addListener(le,"content_changed",g)),L&&$(google.maps.event.addListener(le,"position_changed",L)),w&&N(google.maps.event.addListener(le,"zindex_changed",w)),le.setContent(V.current),r?le.open(j,r):le.getPosition()?le.open(j):Ze(!1,"You must provide either an anchor or a position prop for <InfoBox>."),y&&y(le)}return()=>{P!==null&&(Z&&google.maps.event.removeListener(Z),B&&google.maps.event.removeListener(B),F&&google.maps.event.removeListener(F),A&&google.maps.event.removeListener(A),se&&google.maps.event.removeListener(se),S&&S(P),P.close())}},[]),V.current?Ln.createPortal(l.Children.only(e),V.current):null}l.memo(Rl);class Tl extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",null),z(this,"state",{infoBox:null}),z(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):Ze(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),z(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,o=Di(e,Il),u;r&&!(r instanceof google.maps.LatLng)&&(u=new google.maps.LatLng(r.lat,r.lng));var f=new Ys(Sr(Sr({},o),u?{position:u}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=Ie({updaterMap:To,eventMap:Ro,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:To,eventMap:Ro,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),je(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}z(Tl,"contextType",Pe);var di,Ao;function Al(){return Ao||(Ao=1,di=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,u,f;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(u=o;u--!==0;)if(!t(e[u],r[u]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),o=f.length,o!==Object.keys(r).length)return!1;for(u=o;u--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[u]))return!1;for(u=o;u--!==0;){var p=f[u];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),di}var Bl=Al(),Bo=Ws(Bl),zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],pi=1,An=8;class Ii{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,o]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var u=o>>4;if(u!==pi)throw new Error("Got v".concat(u," data when expected v").concat(pi,"."));var f=zo[o&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new Ii(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,u=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=zo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,g=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(o,"."));u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+g,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(An+p+h+g),this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+g,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(pi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=r,o}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return bi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,g=[0,f.length-1,0],L=[];g.length;){var w=g.pop()||0,y=g.pop()||0,S=g.pop()||0;if(y-S<=h){for(var j=S;j<=y;j++){var P=p[2*j],K=p[2*j+1];P>=e&&P<=o&&K>=r&&K<=u&&L.push(f[j])}continue}var Z=S+y>>1,Y=p[2*Z],F=p[2*Z+1];Y>=e&&Y<=o&&F>=r&&F<=u&&L.push(f[Z]),(w===0?e<=Y:r<=F)&&(g.push(S),g.push(Z-1),g.push(1-w)),(w===0?o>=Y:u>=F)&&(g.push(Z+1),g.push(y),g.push(1-w))}return L}within(e,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:u,coords:f,nodeSize:p}=this,h=[0,u.length-1,0],g=[],L=o*o;h.length;){var w=h.pop()||0,y=h.pop()||0,S=h.pop()||0;if(y-S<=p){for(var j=S;j<=y;j++)Fo(f[2*j],f[2*j+1],e,r)<=L&&g.push(u[j]);continue}var P=S+y>>1,K=f[2*P],Z=f[2*P+1];Fo(K,Z,e,r)<=L&&g.push(u[P]),(w===0?e-o<=K:r-o<=Z)&&(h.push(S),h.push(P-1),h.push(1-w)),(w===0?e+o>=K:r+o>=Z)&&(h.push(P+1),h.push(y),h.push(1-w))}return g}}function bi(t,e,r,o,u,f){if(!(u-o<=r)){var p=o+u>>1;Js(t,e,p,o,u,f),bi(t,e,r,o,p-1,1-f),bi(t,e,r,p+1,u,1-f)}}function Js(t,e,r,o,u,f){for(;u>o;){if(u-o>600){var p=u-o+1,h=r-o+1,g=Math.log(p),L=.5*Math.exp(2*g/3),w=.5*Math.sqrt(g*L*(p-L)/p)*(h-p/2<0?-1:1),y=Math.max(o,Math.floor(r-h*L/p+w)),S=Math.min(u,Math.floor(r+(p-h)*L/p+w));Js(t,e,r,y,S,f)}var j=e[2*r+f],P=o,K=u;for(Bn(t,e,o,r),e[2*u+f]>j&&Bn(t,e,o,u);P<K;){for(Bn(t,e,P,K),P++,K--;e[2*P+f]<j;)P++;for(;e[2*K+f]>j;)K--}e[2*o+f]===j?Bn(t,e,o,K):(K++,Bn(t,e,K,u)),K<=r&&(o=K+1),r<=K&&(u=K-1)}}function Bn(t,e,r,o){hi(t,r,o),hi(e,2*r,2*o),hi(e,2*r+1,2*o+1)}function hi(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function Fo(t,e,r,o){var u=t-r,f=e-o;return u*u+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Uo=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Jt=2,Kt=3,gi=4,Ut=5,Xs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:o,maxZoom:u}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var g=e[h];if(g.geometry){var[L,w]=g.geometry.coordinates,y=Uo(mr(L)),S=Uo(vr(w));p.push(y,S,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var j=this.trees[u+1]=this._createTree(p);r&&console.timeEnd(f);for(var P=u;P>=o;P--){var K=+Date.now();j=this.trees[P]=this._createTree(this._cluster(j,P)),r&&console.log("z%d: %d clusters in %dms",P,j.numItems,+Date.now()-K)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var o=((e[0]+180)%360+360)%360-180,u=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)o=-180,f=180;else if(o>f){var h=this.getClusters([o,u,180,p],r),g=this.getClusters([-180,u,f,p],r);return h.concat(g)}var L=this.trees[this._limitZoom(r)],w=L.range(mr(o),vr(p),mr(f),vr(u)),y=L.data,S=[];for(var j of w){var P=this.stride*j;S.push(y[P+Ut]>1?Ko(y,P,this.clusterProps):this.points[y[P+Kt]])}return S}getChildren(e){var r=this._getOriginId(e),o=this._getOriginZoom(e),u="No cluster with the specified id.",f=this.trees[o];if(!f)throw new Error(u);var p=f.data;if(r*this.stride>=p.length)throw new Error(u);var h=this.options.radius/(this.options.extent*Math.pow(2,o-1)),g=p[r*this.stride],L=p[r*this.stride+1],w=f.within(g,L,h),y=[];for(var S of w){var j=S*this.stride;p[j+gi]===e&&y.push(p[j+Ut]>1?Ko(p,j,this.clusterProps):this.points[p[j+Kt]])}if(y.length===0)throw new Error(u);return y}getLeaves(e,r,o){r=r||10,o=o||0;var u=[];return this._appendLeaves(u,e,r,o,0),u}getTile(e,r,o){var u=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,g=h/p,L=(o-g)/f,w=(o+1+g)/f,y={features:[]};return this._addTileFeatures(u.range((r-g)/f,L,(r+1+g)/f,w),u.data,r,o,f,y),r===0&&this._addTileFeatures(u.range(1-g/f,L,1,w),u.data,f,o,f,y),r===f-1&&this._addTileFeatures(u.range(0,L,g/f,w),u.data,-1,o,f,y),y.features.length?y:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var o=this.getChildren(e);if(r++,o.length!==1)break;e=o[0].properties.cluster_id}return r}_appendLeaves(e,r,o,u,f){var p=this.getChildren(r);for(var h of p){var g=h.properties;if(g&&g.cluster?f+g.point_count<=u?f+=g.point_count:f=this._appendLeaves(e,g.cluster_id,o,u,f):f<u?f++:e.push(h),e.length===o)break}return f}_createTree(e){for(var r=new Ii(e.length/this.stride|0,this.options.nodeSize,Float32Array),o=0;o<e.length;o+=this.stride)r.add(e[o],e[o+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,o,u,f,p){for(var h of e){var g=h*this.stride,L=r[g+Ut]>1,w=void 0,y=void 0,S=void 0;if(L)w=Qs(r,g,this.clusterProps),y=r[g],S=r[g+1];else{var j=this.points[r[g+Kt]];w=j.properties;var[P,K]=j.geometry.coordinates;y=mr(P),S=vr(K)}var Z={type:1,geometry:[[Math.round(this.options.extent*(y*f-o)),Math.round(this.options.extent*(S*f-u))]],tags:w},Y=void 0;L||this.options.generateId?Y=r[g+Kt]:Y=this.points[r[g+Kt]].id,Y!==void 0&&(Z.id=Y),p.features.push(Z)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:o,extent:u,reduce:f,minPoints:p}=this.options,h=o/(u*Math.pow(2,r)),g=e.data,L=[],w=this.stride,y=0;y<g.length;y+=w)if(!(g[y+Jt]<=r)){g[y+Jt]=r;var S=g[y],j=g[y+1],P=e.within(g[y],g[y+1],h),K=g[y+Ut],Z=K;for(var Y of P){var F=Y*w;g[F+Jt]>r&&(Z+=g[F+Ut])}if(Z>K&&Z>=p){var ae=S*K,B=j*K,T=void 0,A=-1,$=((y/w|0)<<5)+(r+1)+this.points.length;for(var se of P){var N=se*w;if(!(g[N+Jt]<=r)){g[N+Jt]=r;var V=g[N+Ut];ae+=g[N]*V,B+=g[N+1]*V,g[N+gi]=$,f&&(T||(T=this._map(g,y,!0),A=this.clusterProps.length,this.clusterProps.push(T)),f(T,this._map(g,N)))}}g[y+gi]=$,L.push(ae/Z,B/Z,1/0,$,-1,Z),f&&L.push(A)}else{for(var re=0;re<w;re++)L.push(g[y+re]);if(Z>1)for(var ge of P){var Q=ge*w;if(!(g[Q+Jt]<=r)){g[Q+Jt]=r;for(var ce=0;ce<w;ce++)L.push(g[Q+ce])}}}}return L}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,o){if(e[r+Ut]>1){var u=this.clusterProps[e[r+Xs]];return o?Object.assign({},u):u}var f=this.points[e[r+Kt]].properties,p=this.options.map(f);return o&&p===f?Object.assign({},p):p}}function Ko(t,e,r){return{type:"Feature",id:t[e+Kt],properties:Qs(t,e,r),geometry:{type:"Point",coordinates:[Ul(t[e]),Kl(t[e+1])]}}}function Qs(t,e,r){var o=t[e+Ut],u=o>=1e4?"".concat(Math.round(o/1e3),"k"):o>=1e3?"".concat(Math.round(o/100)/10,"k"):o,f=t[e+Xs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Kt],point_count:o,point_count_abbreviated:u})}function mr(t){return t/360+.5}function vr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Ul(t){return(t-.5)*360}function Kl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Nl(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(t);u<o.length;u++)e.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(t,o[u])&&(r[o[u]]=t[o[u]]);return r}class st{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class wi{constructor(e){var{markers:r,position:o}=e;this.markers=r,o&&(o instanceof google.maps.LatLng?this._position=o:this._position=new google.maps.LatLng(o))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(st.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>st.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(st.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class ql{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Wl(r)}}var Wl=t=>{var e=t.map(r=>new wi({position:st.getPosition(r),markers:[r]}));return e};class Zl extends ql{constructor(e){var{maxZoom:r,radius:o=60}=e,u=Nl(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:o},u))}calculate(e){var r=!1,o={zoom:e.map.getZoom()};if(!Bo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var u=this.markers.map(f=>{var p=st.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(u)}return r||(this.state.zoom<=this.maxZoom||o.zoom<=this.maxZoom)&&(r=!Bo(this.state,o)),this.state=o,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(o=>this.transformCluster(o))}transformCluster(e){var{geometry:{coordinates:[r,o]},properties:u}=e;if(u.cluster)return new wi({markers:this.superCluster.getLeaves(u.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:o,lng:r}});var f=u.marker;return new wi({markers:[f],position:st.getPosition(f)})}}class $l{constructor(e,r){this.markers={sum:e.length};var o=r.map(f=>f.count),u=o.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:u/r.length,sum:u,min:Math.min(...o),max:Math.max(...o)}}}}class Vl{render(e,r,o){var{count:u,position:f}=e,p=u>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(u,`</text>
</svg>`),g="Cluster of ".concat(u," markers"),L=Number(google.maps.Marker.MAX_ZINDEX)+u;if(st.isAdvancedMarkerAvailable(o)){var w=new DOMParser,y=w.parseFromString(h,"image/svg+xml").documentElement;y.setAttribute("transform","translate(0 25)");var S={map:o,position:f,zIndex:L,title:g,content:y};return new google.maps.marker.AdvancedMarkerElement(S)}var j={position:f,zIndex:L,title:g,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(j)}}function Hl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class ji{constructor(){Hl(ji,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Gl=(t,e,r)=>{r.fitBounds(e.bounds)};class Yl extends ji{constructor(e){var{map:r,markers:o=[],algorithmOptions:u={},algorithm:f=new Zl(u),renderer:p=new Vl,onClusterClick:h=Gl}=e;super(),this.markers=[...o],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(o=>{this.addMarker(o,!0)}),r||this.render()}removeMarker(e,r){var o=this.markers.indexOf(e);return o===-1?!1:(st.setMap(e,null),this.markers.splice(o,1),r||this.render(),!0)}removeMarkers(e,r){var o=!1;return e.forEach(u=>{o=this.removeMarker(u,!0)||o}),o&&!r&&this.render(),o}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:o}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(o||o==null){var u=new Set;for(var f of r)f.markers.length==1&&u.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?u.has(h.marker)||st.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(g=>st.setMap(g,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>st.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new $l(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(o=>{o.markers.length===1?o.marker=o.markers[0]:(o.marker=this.renderer.render(o,e,r),o.markers.forEach(u=>st.setMap(u,null)),this.onClusterClick&&o.marker.addListener("click",u=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,o),this.onClusterClick(u,o,r)})),st.setMap(o.marker,r)})}}function No(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function qo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?No(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):No(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function Jl(t){var e=Na(),[r,o]=l.useState(null);return l.useEffect(()=>{if(e&&r===null){var u=new Yl(qo(qo({},t),{},{map:e}));o(u)}},[e]),r}function Xl(t){var{children:e,options:r}=t,o=Jl(r);return o!==null?e(o):null}l.memo(Xl);var Wo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Zo={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function Ql(t){var{children:e,anchor:r,options:o,position:u,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:g,onPositionChanged:L,onZindexChanged:w,onLoad:y,onUnmount:S}=t,j=l.useContext(Pe),[P,K]=l.useState(null),[Z,Y]=l.useState(null),[F,ae]=l.useState(null),[B,T]=l.useState(null),[A,$]=l.useState(null),[se,N]=l.useState(null),V=l.useRef(null);return l.useEffect(()=>{P!==null&&(P.close(),r?P.open(j,r):P.getPosition()&&P.open(j))},[j,P,r]),l.useEffect(()=>{o&&P!==null&&P.setOptions(o)},[P,o]),l.useEffect(()=>{u&&P!==null&&P.setPosition(u)},[u]),l.useEffect(()=>{typeof f=="number"&&P!==null&&P.setZIndex(f)},[f]),l.useEffect(()=>{P&&p&&(Z!==null&&google.maps.event.removeListener(Z),Y(google.maps.event.addListener(P,"closeclick",p)))},[p]),l.useEffect(()=>{P&&h&&(F!==null&&google.maps.event.removeListener(F),ae(google.maps.event.addListener(P,"domready",h)))},[h]),l.useEffect(()=>{P&&g&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(P,"content_changed",g)))},[g]),l.useEffect(()=>{P&&L&&(A!==null&&google.maps.event.removeListener(A),$(google.maps.event.addListener(P,"position_changed",L)))},[L]),l.useEffect(()=>{P&&w&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(P,"zindex_changed",w)))},[w]),l.useEffect(()=>{var re=new google.maps.InfoWindow(o);return K(re),V.current=document.createElement("div"),p&&Y(google.maps.event.addListener(re,"closeclick",p)),h&&ae(google.maps.event.addListener(re,"domready",h)),g&&T(google.maps.event.addListener(re,"content_changed",g)),L&&$(google.maps.event.addListener(re,"position_changed",L)),w&&N(google.maps.event.addListener(re,"zindex_changed",w)),re.setContent(V.current),u&&re.setPosition(u),f&&re.setZIndex(f),r?re.open(j,r):re.getPosition()?re.open(j):Ze(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),y&&y(re),()=>{Z&&google.maps.event.removeListener(Z),B&&google.maps.event.removeListener(B),F&&google.maps.event.removeListener(F),A&&google.maps.event.removeListener(A),se&&google.maps.event.removeListener(se),S&&S(re),re.close()}},[]),V.current?Ln.createPortal(l.Children.only(e),V.current):null}l.memo(Ql);class eu extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",null),z(this,"state",{infoWindow:null}),z(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):Ze(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),z(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=Ie({updaterMap:Zo,eventMap:Wo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Zo,eventMap:Wo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(je(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}z(eu,"contextType",Pe);function $o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$o(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$o(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Vo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Ho={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},tu={};function nu(t){var{options:e,draggable:r,editable:o,visible:u,path:f,onDblClick:p,onDragEnd:h,onDragStart:g,onMouseDown:L,onMouseMove:w,onMouseOut:y,onMouseOver:S,onMouseUp:j,onRightClick:P,onClick:K,onDrag:Z,onLoad:Y,onUnmount:F}=t,ae=l.useContext(Pe),[B,T]=l.useState(null),[A,$]=l.useState(null),[se,N]=l.useState(null),[V,re]=l.useState(null),[ge,Q]=l.useState(null),[ce,le]=l.useState(null),[de,Le]=l.useState(null),[ve,ye]=l.useState(null),[pe,we]=l.useState(null),[xe,fe]=l.useState(null),[ke,q]=l.useState(null),[Re,Ue]=l.useState(null);return l.useEffect(()=>{B!==null&&B.setMap(ae)},[ae]),l.useEffect(()=>{typeof e<"u"&&B!==null&&B.setOptions(e)},[B,e]),l.useEffect(()=>{typeof r<"u"&&B!==null&&B.setDraggable(r)},[B,r]),l.useEffect(()=>{typeof o<"u"&&B!==null&&B.setEditable(o)},[B,o]),l.useEffect(()=>{typeof u<"u"&&B!==null&&B.setVisible(u)},[B,u]),l.useEffect(()=>{typeof f<"u"&&B!==null&&B.setPath(f)},[B,f]),l.useEffect(()=>{B&&p&&(A!==null&&google.maps.event.removeListener(A),$(google.maps.event.addListener(B,"dblclick",p)))},[p]),l.useEffect(()=>{B&&h&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(B,"dragend",h)))},[h]),l.useEffect(()=>{B&&g&&(V!==null&&google.maps.event.removeListener(V),re(google.maps.event.addListener(B,"dragstart",g)))},[g]),l.useEffect(()=>{B&&L&&(ge!==null&&google.maps.event.removeListener(ge),Q(google.maps.event.addListener(B,"mousedown",L)))},[L]),l.useEffect(()=>{B&&w&&(ce!==null&&google.maps.event.removeListener(ce),le(google.maps.event.addListener(B,"mousemove",w)))},[w]),l.useEffect(()=>{B&&y&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(B,"mouseout",y)))},[y]),l.useEffect(()=>{B&&S&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(B,"mouseover",S)))},[S]),l.useEffect(()=>{B&&j&&(pe!==null&&google.maps.event.removeListener(pe),we(google.maps.event.addListener(B,"mouseup",j)))},[j]),l.useEffect(()=>{B&&P&&(xe!==null&&google.maps.event.removeListener(xe),fe(google.maps.event.addListener(B,"rightclick",P)))},[P]),l.useEffect(()=>{B&&K&&(ke!==null&&google.maps.event.removeListener(ke),q(google.maps.event.addListener(B,"click",K)))},[K]),l.useEffect(()=>{B&&Z&&(Re!==null&&google.maps.event.removeListener(Re),Ue(google.maps.event.addListener(B,"drag",Z)))},[Z]),l.useEffect(()=>{var Ee=new google.maps.Polyline(kr(kr({},e||tu),{},{map:ae}));return f&&Ee.setPath(f),typeof u<"u"&&Ee.setVisible(u),typeof o<"u"&&Ee.setEditable(o),typeof r<"u"&&Ee.setDraggable(r),p&&$(google.maps.event.addListener(Ee,"dblclick",p)),h&&N(google.maps.event.addListener(Ee,"dragend",h)),g&&re(google.maps.event.addListener(Ee,"dragstart",g)),L&&Q(google.maps.event.addListener(Ee,"mousedown",L)),w&&le(google.maps.event.addListener(Ee,"mousemove",w)),y&&Le(google.maps.event.addListener(Ee,"mouseout",y)),S&&ye(google.maps.event.addListener(Ee,"mouseover",S)),j&&we(google.maps.event.addListener(Ee,"mouseup",j)),P&&fe(google.maps.event.addListener(Ee,"rightclick",P)),K&&q(google.maps.event.addListener(Ee,"click",K)),Z&&Ue(google.maps.event.addListener(Ee,"drag",Z)),T(Ee),Y&&Y(Ee),()=>{A!==null&&google.maps.event.removeListener(A),se!==null&&google.maps.event.removeListener(se),V!==null&&google.maps.event.removeListener(V),ge!==null&&google.maps.event.removeListener(ge),ce!==null&&google.maps.event.removeListener(ce),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),pe!==null&&google.maps.event.removeListener(pe),xe!==null&&google.maps.event.removeListener(xe),ke!==null&&google.maps.event.removeListener(ke),F&&F(Ee),Ee.setMap(null)}},[]),null}l.memo(nu);class ru extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{polyline:null}),z(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(kr(kr({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:Ho,eventMap:Vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Ho,eventMap:Vo,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),je(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}z(ru,"contextType",Pe);function Go(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Yo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Go(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Go(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Jo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Xo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function iu(t){var{options:e,draggable:r,editable:o,visible:u,path:f,paths:p,onDblClick:h,onDragEnd:g,onDragStart:L,onMouseDown:w,onMouseMove:y,onMouseOut:S,onMouseOver:j,onMouseUp:P,onRightClick:K,onClick:Z,onDrag:Y,onLoad:F,onUnmount:ae,onEdit:B}=t,T=l.useContext(Pe),[A,$]=l.useState(null),[se,N]=l.useState(null),[V,re]=l.useState(null),[ge,Q]=l.useState(null),[ce,le]=l.useState(null),[de,Le]=l.useState(null),[ve,ye]=l.useState(null),[pe,we]=l.useState(null),[xe,fe]=l.useState(null),[ke,q]=l.useState(null),[Re,Ue]=l.useState(null),[Ee,ie]=l.useState(null);return l.useEffect(()=>{A!==null&&A.setMap(T)},[T]),l.useEffect(()=>{typeof e<"u"&&A!==null&&A.setOptions(e)},[A,e]),l.useEffect(()=>{typeof r<"u"&&A!==null&&A.setDraggable(r)},[A,r]),l.useEffect(()=>{typeof o<"u"&&A!==null&&A.setEditable(o)},[A,o]),l.useEffect(()=>{typeof u<"u"&&A!==null&&A.setVisible(u)},[A,u]),l.useEffect(()=>{typeof f<"u"&&A!==null&&A.setPath(f)},[A,f]),l.useEffect(()=>{typeof p<"u"&&A!==null&&A.setPaths(p)},[A,p]),l.useEffect(()=>{A&&typeof h=="function"&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(A,"dblclick",h)))},[h]),l.useEffect(()=>{A&&(google.maps.event.addListener(A.getPath(),"insert_at",()=>{B?.(A)}),google.maps.event.addListener(A.getPath(),"set_at",()=>{B?.(A)}),google.maps.event.addListener(A.getPath(),"remove_at",()=>{B?.(A)}))},[A,B]),l.useEffect(()=>{A&&typeof g=="function"&&(V!==null&&google.maps.event.removeListener(V),re(google.maps.event.addListener(A,"dragend",g)))},[g]),l.useEffect(()=>{A&&typeof L=="function"&&(ge!==null&&google.maps.event.removeListener(ge),Q(google.maps.event.addListener(A,"dragstart",L)))},[L]),l.useEffect(()=>{A&&typeof w=="function"&&(ce!==null&&google.maps.event.removeListener(ce),le(google.maps.event.addListener(A,"mousedown",w)))},[w]),l.useEffect(()=>{A&&typeof y=="function"&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(A,"mousemove",y)))},[y]),l.useEffect(()=>{A&&typeof S=="function"&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(A,"mouseout",S)))},[S]),l.useEffect(()=>{A&&typeof j=="function"&&(pe!==null&&google.maps.event.removeListener(pe),we(google.maps.event.addListener(A,"mouseover",j)))},[j]),l.useEffect(()=>{A&&typeof P=="function"&&(xe!==null&&google.maps.event.removeListener(xe),fe(google.maps.event.addListener(A,"mouseup",P)))},[P]),l.useEffect(()=>{A&&typeof K=="function"&&(ke!==null&&google.maps.event.removeListener(ke),q(google.maps.event.addListener(A,"rightclick",K)))},[K]),l.useEffect(()=>{A&&typeof Z=="function"&&(Re!==null&&google.maps.event.removeListener(Re),Ue(google.maps.event.addListener(A,"click",Z)))},[Z]),l.useEffect(()=>{A&&typeof Y=="function"&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener(A,"drag",Y)))},[Y]),l.useEffect(()=>{var be=new google.maps.Polygon(Yo(Yo({},e),{},{map:T}));return f&&be.setPath(f),p&&be.setPaths(p),typeof u<"u"&&be.setVisible(u),typeof o<"u"&&be.setEditable(o),typeof r<"u"&&be.setDraggable(r),h&&N(google.maps.event.addListener(be,"dblclick",h)),g&&re(google.maps.event.addListener(be,"dragend",g)),L&&Q(google.maps.event.addListener(be,"dragstart",L)),w&&le(google.maps.event.addListener(be,"mousedown",w)),y&&Le(google.maps.event.addListener(be,"mousemove",y)),S&&ye(google.maps.event.addListener(be,"mouseout",S)),j&&we(google.maps.event.addListener(be,"mouseover",j)),P&&fe(google.maps.event.addListener(be,"mouseup",P)),K&&q(google.maps.event.addListener(be,"rightclick",K)),Z&&Ue(google.maps.event.addListener(be,"click",Z)),Y&&ie(google.maps.event.addListener(be,"drag",Y)),$(be),F&&F(be),()=>{se!==null&&google.maps.event.removeListener(se),V!==null&&google.maps.event.removeListener(V),ge!==null&&google.maps.event.removeListener(ge),ce!==null&&google.maps.event.removeListener(ce),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),pe!==null&&google.maps.event.removeListener(pe),xe!==null&&google.maps.event.removeListener(xe),ke!==null&&google.maps.event.removeListener(ke),Re!==null&&google.maps.event.removeListener(Re),ae&&ae(be),be.setMap(null)}},[]),null}l.memo(iu);class ou extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=Ie({updaterMap:Xo,eventMap:Jo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Xo,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),je(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}z(ou,"contextType",Pe);function Qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qo(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qo(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var es={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ts={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function su(t){var{options:e,bounds:r,draggable:o,editable:u,visible:f,onDblClick:p,onDragEnd:h,onDragStart:g,onMouseDown:L,onMouseMove:w,onMouseOut:y,onMouseOver:S,onMouseUp:j,onRightClick:P,onClick:K,onDrag:Z,onBoundsChanged:Y,onLoad:F,onUnmount:ae}=t,B=l.useContext(Pe),[T,A]=l.useState(null),[$,se]=l.useState(null),[N,V]=l.useState(null),[re,ge]=l.useState(null),[Q,ce]=l.useState(null),[le,de]=l.useState(null),[Le,ve]=l.useState(null),[ye,pe]=l.useState(null),[we,xe]=l.useState(null),[fe,ke]=l.useState(null),[q,Re]=l.useState(null),[Ue,Ee]=l.useState(null),[ie,be]=l.useState(null);return l.useEffect(()=>{T!==null&&T.setMap(B)},[B]),l.useEffect(()=>{typeof e<"u"&&T!==null&&T.setOptions(e)},[T,e]),l.useEffect(()=>{typeof o<"u"&&T!==null&&T.setDraggable(o)},[T,o]),l.useEffect(()=>{typeof u<"u"&&T!==null&&T.setEditable(u)},[T,u]),l.useEffect(()=>{typeof f<"u"&&T!==null&&T.setVisible(f)},[T,f]),l.useEffect(()=>{typeof r<"u"&&T!==null&&T.setBounds(r)},[T,r]),l.useEffect(()=>{T&&p&&($!==null&&google.maps.event.removeListener($),se(google.maps.event.addListener(T,"dblclick",p)))},[p]),l.useEffect(()=>{T&&h&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(T,"dragend",h)))},[h]),l.useEffect(()=>{T&&g&&(re!==null&&google.maps.event.removeListener(re),ge(google.maps.event.addListener(T,"dragstart",g)))},[g]),l.useEffect(()=>{T&&L&&(Q!==null&&google.maps.event.removeListener(Q),ce(google.maps.event.addListener(T,"mousedown",L)))},[L]),l.useEffect(()=>{T&&w&&(le!==null&&google.maps.event.removeListener(le),de(google.maps.event.addListener(T,"mousemove",w)))},[w]),l.useEffect(()=>{T&&y&&(Le!==null&&google.maps.event.removeListener(Le),ve(google.maps.event.addListener(T,"mouseout",y)))},[y]),l.useEffect(()=>{T&&S&&(ye!==null&&google.maps.event.removeListener(ye),pe(google.maps.event.addListener(T,"mouseover",S)))},[S]),l.useEffect(()=>{T&&j&&(we!==null&&google.maps.event.removeListener(we),xe(google.maps.event.addListener(T,"mouseup",j)))},[j]),l.useEffect(()=>{T&&P&&(fe!==null&&google.maps.event.removeListener(fe),ke(google.maps.event.addListener(T,"rightclick",P)))},[P]),l.useEffect(()=>{T&&K&&(q!==null&&google.maps.event.removeListener(q),Re(google.maps.event.addListener(T,"click",K)))},[K]),l.useEffect(()=>{T&&Z&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener(T,"drag",Z)))},[Z]),l.useEffect(()=>{T&&Y&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener(T,"bounds_changed",Y)))},[Y]),l.useEffect(()=>{var _e=new google.maps.Rectangle(Mr(Mr({},e),{},{map:B}));return typeof f<"u"&&_e.setVisible(f),typeof u<"u"&&_e.setEditable(u),typeof o<"u"&&_e.setDraggable(o),typeof r<"u"&&_e.setBounds(r),p&&se(google.maps.event.addListener(_e,"dblclick",p)),h&&V(google.maps.event.addListener(_e,"dragend",h)),g&&ge(google.maps.event.addListener(_e,"dragstart",g)),L&&ce(google.maps.event.addListener(_e,"mousedown",L)),w&&de(google.maps.event.addListener(_e,"mousemove",w)),y&&ve(google.maps.event.addListener(_e,"mouseout",y)),S&&pe(google.maps.event.addListener(_e,"mouseover",S)),j&&xe(google.maps.event.addListener(_e,"mouseup",j)),P&&ke(google.maps.event.addListener(_e,"rightclick",P)),K&&Re(google.maps.event.addListener(_e,"click",K)),Z&&Ee(google.maps.event.addListener(_e,"drag",Z)),Y&&be(google.maps.event.addListener(_e,"bounds_changed",Y)),A(_e),F&&F(_e),()=>{$!==null&&google.maps.event.removeListener($),N!==null&&google.maps.event.removeListener(N),re!==null&&google.maps.event.removeListener(re),Q!==null&&google.maps.event.removeListener(Q),le!==null&&google.maps.event.removeListener(le),Le!==null&&google.maps.event.removeListener(Le),ye!==null&&google.maps.event.removeListener(ye),we!==null&&google.maps.event.removeListener(we),fe!==null&&google.maps.event.removeListener(fe),q!==null&&google.maps.event.removeListener(q),Ue!==null&&google.maps.event.removeListener(Ue),ie!==null&&google.maps.event.removeListener(ie),ae&&ae(_e),_e.setMap(null)}},[]),null}l.memo(su);class au extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{rectangle:null}),z(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Mr(Mr({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:ts,eventMap:es,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:ts,eventMap:es,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),je(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}z(au,"contextType",Pe);function ns(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ns(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ns(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var rs={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},is={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},lu={};function uu(t){var{options:e,center:r,radius:o,draggable:u,editable:f,visible:p,onDblClick:h,onDragEnd:g,onDragStart:L,onMouseDown:w,onMouseMove:y,onMouseOut:S,onMouseOver:j,onMouseUp:P,onRightClick:K,onClick:Z,onDrag:Y,onCenterChanged:F,onRadiusChanged:ae,onLoad:B,onUnmount:T}=t,A=l.useContext(Pe),[$,se]=l.useState(null),[N,V]=l.useState(null),[re,ge]=l.useState(null),[Q,ce]=l.useState(null),[le,de]=l.useState(null),[Le,ve]=l.useState(null),[ye,pe]=l.useState(null),[we,xe]=l.useState(null),[fe,ke]=l.useState(null),[q,Re]=l.useState(null),[Ue,Ee]=l.useState(null),[ie,be]=l.useState(null),[_e,H]=l.useState(null),[Be,et]=l.useState(null);return l.useEffect(()=>{$!==null&&$.setMap(A)},[A]),l.useEffect(()=>{typeof e<"u"&&$!==null&&$.setOptions(e)},[$,e]),l.useEffect(()=>{typeof u<"u"&&$!==null&&$.setDraggable(u)},[$,u]),l.useEffect(()=>{typeof f<"u"&&$!==null&&$.setEditable(f)},[$,f]),l.useEffect(()=>{typeof p<"u"&&$!==null&&$.setVisible(p)},[$,p]),l.useEffect(()=>{typeof o=="number"&&$!==null&&$.setRadius(o)},[$,o]),l.useEffect(()=>{typeof r<"u"&&$!==null&&$.setCenter(r)},[$,r]),l.useEffect(()=>{$&&h&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener($,"dblclick",h)))},[h]),l.useEffect(()=>{$&&g&&(re!==null&&google.maps.event.removeListener(re),ge(google.maps.event.addListener($,"dragend",g)))},[g]),l.useEffect(()=>{$&&L&&(Q!==null&&google.maps.event.removeListener(Q),ce(google.maps.event.addListener($,"dragstart",L)))},[L]),l.useEffect(()=>{$&&w&&(le!==null&&google.maps.event.removeListener(le),de(google.maps.event.addListener($,"mousedown",w)))},[w]),l.useEffect(()=>{$&&y&&(Le!==null&&google.maps.event.removeListener(Le),ve(google.maps.event.addListener($,"mousemove",y)))},[y]),l.useEffect(()=>{$&&S&&(ye!==null&&google.maps.event.removeListener(ye),pe(google.maps.event.addListener($,"mouseout",S)))},[S]),l.useEffect(()=>{$&&j&&(we!==null&&google.maps.event.removeListener(we),xe(google.maps.event.addListener($,"mouseover",j)))},[j]),l.useEffect(()=>{$&&P&&(fe!==null&&google.maps.event.removeListener(fe),ke(google.maps.event.addListener($,"mouseup",P)))},[P]),l.useEffect(()=>{$&&K&&(q!==null&&google.maps.event.removeListener(q),Re(google.maps.event.addListener($,"rightclick",K)))},[K]),l.useEffect(()=>{$&&Z&&(Ue!==null&&google.maps.event.removeListener(Ue),Ee(google.maps.event.addListener($,"click",Z)))},[Z]),l.useEffect(()=>{$&&Y&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener($,"drag",Y)))},[Y]),l.useEffect(()=>{$&&F&&(_e!==null&&google.maps.event.removeListener(_e),H(google.maps.event.addListener($,"center_changed",F)))},[Z]),l.useEffect(()=>{$&&ae&&(Be!==null&&google.maps.event.removeListener(Be),et(google.maps.event.addListener($,"radius_changed",ae)))},[ae]),l.useEffect(()=>{var Te=new google.maps.Circle(Pr(Pr({},e||lu),{},{map:A}));return typeof o=="number"&&Te.setRadius(o),typeof r<"u"&&Te.setCenter(r),typeof o=="number"&&Te.setRadius(o),typeof p<"u"&&Te.setVisible(p),typeof f<"u"&&Te.setEditable(f),typeof u<"u"&&Te.setDraggable(u),h&&V(google.maps.event.addListener(Te,"dblclick",h)),g&&ge(google.maps.event.addListener(Te,"dragend",g)),L&&ce(google.maps.event.addListener(Te,"dragstart",L)),w&&de(google.maps.event.addListener(Te,"mousedown",w)),y&&ve(google.maps.event.addListener(Te,"mousemove",y)),S&&pe(google.maps.event.addListener(Te,"mouseout",S)),j&&xe(google.maps.event.addListener(Te,"mouseover",j)),P&&ke(google.maps.event.addListener(Te,"mouseup",P)),K&&Re(google.maps.event.addListener(Te,"rightclick",K)),Z&&Ee(google.maps.event.addListener(Te,"click",Z)),Y&&be(google.maps.event.addListener(Te,"drag",Y)),F&&H(google.maps.event.addListener(Te,"center_changed",F)),ae&&et(google.maps.event.addListener(Te,"radius_changed",ae)),se(Te),B&&B(Te),()=>{N!==null&&google.maps.event.removeListener(N),re!==null&&google.maps.event.removeListener(re),Q!==null&&google.maps.event.removeListener(Q),le!==null&&google.maps.event.removeListener(le),Le!==null&&google.maps.event.removeListener(Le),ye!==null&&google.maps.event.removeListener(ye),we!==null&&google.maps.event.removeListener(we),fe!==null&&google.maps.event.removeListener(fe),q!==null&&google.maps.event.removeListener(q),Ue!==null&&google.maps.event.removeListener(Ue),_e!==null&&google.maps.event.removeListener(_e),Be!==null&&google.maps.event.removeListener(Be),T&&T(Te),Te.setMap(null)}},[]),null}l.memo(uu);class cu extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{circle:null}),z(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:is,eventMap:rs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:is,eventMap:rs,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),je(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}z(cu,"contextType",Pe);function os(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?os(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):os(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ss={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},as={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,o){t.loadGeoJson(e,r,o)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function fu(t){var{options:e,onClick:r,onDblClick:o,onMouseDown:u,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:g,onRightClick:L,onAddFeature:w,onRemoveFeature:y,onRemoveProperty:S,onSetGeometry:j,onSetProperty:P,onLoad:K,onUnmount:Z}=t,Y=l.useContext(Pe),[F,ae]=l.useState(null),[B,T]=l.useState(null),[A,$]=l.useState(null),[se,N]=l.useState(null),[V,re]=l.useState(null),[ge,Q]=l.useState(null),[ce,le]=l.useState(null),[de,Le]=l.useState(null),[ve,ye]=l.useState(null),[pe,we]=l.useState(null),[xe,fe]=l.useState(null),[ke,q]=l.useState(null),[Re,Ue]=l.useState(null),[Ee,ie]=l.useState(null);return l.useEffect(()=>{F!==null&&F.setMap(Y)},[Y]),l.useEffect(()=>{F&&o&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(F,"dblclick",o)))},[o]),l.useEffect(()=>{F&&u&&(A!==null&&google.maps.event.removeListener(A),$(google.maps.event.addListener(F,"mousedown",u)))},[u]),l.useEffect(()=>{F&&f&&(se!==null&&google.maps.event.removeListener(se),N(google.maps.event.addListener(F,"mousemove",f)))},[f]),l.useEffect(()=>{F&&p&&(V!==null&&google.maps.event.removeListener(V),re(google.maps.event.addListener(F,"mouseout",p)))},[p]),l.useEffect(()=>{F&&h&&(ge!==null&&google.maps.event.removeListener(ge),Q(google.maps.event.addListener(F,"mouseover",h)))},[h]),l.useEffect(()=>{F&&g&&(ce!==null&&google.maps.event.removeListener(ce),le(google.maps.event.addListener(F,"mouseup",g)))},[g]),l.useEffect(()=>{F&&L&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(F,"rightclick",L)))},[L]),l.useEffect(()=>{F&&r&&(ve!==null&&google.maps.event.removeListener(ve),ye(google.maps.event.addListener(F,"click",r)))},[r]),l.useEffect(()=>{F&&w&&(pe!==null&&google.maps.event.removeListener(pe),we(google.maps.event.addListener(F,"addfeature",w)))},[w]),l.useEffect(()=>{F&&y&&(xe!==null&&google.maps.event.removeListener(xe),fe(google.maps.event.addListener(F,"removefeature",y)))},[y]),l.useEffect(()=>{F&&S&&(ke!==null&&google.maps.event.removeListener(ke),q(google.maps.event.addListener(F,"removeproperty",S)))},[S]),l.useEffect(()=>{F&&j&&(Re!==null&&google.maps.event.removeListener(Re),Ue(google.maps.event.addListener(F,"setgeometry",j)))},[j]),l.useEffect(()=>{F&&P&&(Ee!==null&&google.maps.event.removeListener(Ee),ie(google.maps.event.addListener(F,"setproperty",P)))},[P]),l.useEffect(()=>{if(Y!==null){var be=new google.maps.Data(Or(Or({},e),{},{map:Y}));o&&T(google.maps.event.addListener(be,"dblclick",o)),u&&$(google.maps.event.addListener(be,"mousedown",u)),f&&N(google.maps.event.addListener(be,"mousemove",f)),p&&re(google.maps.event.addListener(be,"mouseout",p)),h&&Q(google.maps.event.addListener(be,"mouseover",h)),g&&le(google.maps.event.addListener(be,"mouseup",g)),L&&Le(google.maps.event.addListener(be,"rightclick",L)),r&&ye(google.maps.event.addListener(be,"click",r)),w&&we(google.maps.event.addListener(be,"addfeature",w)),y&&fe(google.maps.event.addListener(be,"removefeature",y)),S&&q(google.maps.event.addListener(be,"removeproperty",S)),j&&Ue(google.maps.event.addListener(be,"setgeometry",j)),P&&ie(google.maps.event.addListener(be,"setproperty",P)),ae(be),K&&K(be)}return()=>{F&&(B!==null&&google.maps.event.removeListener(B),A!==null&&google.maps.event.removeListener(A),se!==null&&google.maps.event.removeListener(se),V!==null&&google.maps.event.removeListener(V),ge!==null&&google.maps.event.removeListener(ge),ce!==null&&google.maps.event.removeListener(ce),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),pe!==null&&google.maps.event.removeListener(pe),xe!==null&&google.maps.event.removeListener(xe),ke!==null&&google.maps.event.removeListener(ke),Re!==null&&google.maps.event.removeListener(Re),Ee!==null&&google.maps.event.removeListener(Ee),Z&&Z(F),F.setMap(null))}},[]),null}l.memo(fu);class du extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{data:null}),z(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:as,eventMap:ss,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:as,eventMap:ss,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),je(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}z(du,"contextType",Pe);function ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function us(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ls(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ls(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var cs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},fs={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class pu extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{kmlLayer:null}),z(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(us(us({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:fs,eventMap:cs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:fs,eventMap:cs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),je(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}z(pu,"contextType",Pe);function ea(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function hu(t,e){return new e(t.lat,t.lng)}function gu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function mu(t,e,r){return t instanceof e?t:r(t,e)}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r.getNorthEast()),u=t&&t.fromLatLngToDivPixel(r.getSouthWest());return o&&u?{left:"".concat(u.x+e.x,"px"),top:"".concat(o.y+e.y,"px"),width:"".concat(o.x-u.x-e.x,"px"),height:"".concat(u.y-o.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function bu(t,e,r){var o=t&&t.fromLatLngToDivPixel(r);if(o){var{x:u,y:f}=o;return{left:"".concat(u+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function ta(t,e,r,o){return r!==void 0?yu(t,e,vu(r,google.maps.LatLngBounds,gu)):bu(t,e,mu(o,google.maps.LatLng,hu))}function wu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ds(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function Lu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ds(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ds(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function Cu(t,e,r,o,u){class f extends google.maps.OverlayView{constructor(h,g,L,w){super(),this.container=h,this.pane=g,this.position=L,this.bounds=w}onAdd(){var h,g=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];g?.appendChild(this.container)}draw(){var h=this.getProjection(),g=Lu({},this.container?ea(this.container,u):{x:0,y:0}),L=ta(h,g,this.bounds,this.position);for(var[w,y]of Object.entries(L))this.container.style[w]=y}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,o)}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function hs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Eu(t){var{position:e,bounds:r,mapPaneName:o,zIndex:u,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:g}=t,L=l.useContext(Pe),w=l.useMemo(()=>{var S=document.createElement("div");return S.style.position="absolute",S},[]),y=l.useMemo(()=>Cu(w,o,e,r,h),[w,o,e,r]);return l.useEffect(()=>(f?.(y),y?.setMap(L),()=>{p?.(y),y?.setMap(null)}),[L,y]),l.useEffect(()=>{w.style.zIndex="".concat(u)},[u,w]),Ln.createPortal(g,w)}l.memo(Eu);class Wt extends l.PureComponent{constructor(e){super(e),z(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),z(this,"updatePane",()=>{var o=this.props.mapPaneName,u=this.overlayView.getPanes();Ze(!!o,"OverlayView requires props.mapPaneName but got %s",o),u?this.setState({paneEl:u[o]}):this.setState({paneEl:null})}),z(this,"onAdd",()=>{var o,u;this.updatePane(),(o=(u=this.props).onLoad)===null||o===void 0||o.call(u,this.overlayView)}),z(this,"onPositionElement",()=>{var o=this.overlayView.getProjection(),u=xu({x:0,y:0},this.containerRef.current?ea(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=ta(o,u,this.props.bounds,this.props.position);if(!wu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,g,L;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(g=f.width)!==null&&g!==void 0?g:0,height:(L=f.height)!==null&&L!==void 0?L:0,position:"absolute"}})}}),z(this,"draw",()=>{this.onPositionElement()}),z(this,"onRemove",()=>{var o,u;this.setState(()=>({paneEl:null})),(o=(u=this.props).onUnmount)===null||o===void 0||o.call(u,this.overlayView)}),this.containerRef=l.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=hs(e.position),o=hs(this.props.position),u=gs(e.bounds),f=gs(this.props.bounds);(r!==o||u!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(ue.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:l.Children.only(this.props.children)}),e):null}}z(Wt,"FLOAT_PANE","floatPane");z(Wt,"MAP_PANE","mapPane");z(Wt,"MARKER_LAYER","markerLayer");z(Wt,"OVERLAY_LAYER","overlayLayer");z(Wt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");z(Wt,"contextType",Pe);function Su(){}function ms(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function vs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ms(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ms(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var ys={onDblClick:"dblclick",onClick:"click"},bs={opacity(t,e){t.setOpacity(e)}};function ku(t){var{url:e,bounds:r,options:o,visible:u}=t,f=l.useContext(Pe),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=l.useMemo(()=>new google.maps.GroundOverlay(e,p,o),[]);return l.useEffect(()=>{h!==null&&h.setMap(f)},[f]),l.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),l.useEffect(()=>{typeof u<"u"&&h!==null&&h.setOpacity(u?1:0)},[h,u]),l.useEffect(()=>{var g=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",g),h.setMap(f))},[h,r]),null}l.memo(ku);class na extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{groundOverlay:null}),z(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){Ze(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,vs(vs({},this.props.options),{},{map:this.context}));this.registeredEvents=Ie({updaterMap:bs,eventMap:ys,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:bs,eventMap:ys,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}z(na,"defaultProps",{onLoad:Su});z(na,"contextType",Pe);function ws(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,o)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ws(Object(r),!0).forEach(function(o){z(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ws(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var Ls={},Cs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Mu(t){var{data:e,onLoad:r,onUnmount:o,options:u}=t,f=l.useContext(Pe),[p,h]=l.useState(null);return l.useEffect(()=>{google.maps.visualization||Ze(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),l.useEffect(()=>{Ze(!!e,"data property is required in HeatmapLayer %s",e)},[e]),l.useEffect(()=>{p!==null&&p.setMap(f)},[f]),l.useEffect(()=>{u&&p!==null&&p.setOptions(u)},[p,u]),l.useEffect(()=>{var g=new google.maps.visualization.HeatmapLayer(_r(_r({},u),{},{data:e,map:f}));return h(g),r&&r(g),()=>{p!==null&&(o&&o(p),p.setMap(null))}},[]),null}l.memo(Mu);class Pu extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{heatmapLayer:null}),z(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){Ze(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),Ze(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(_r(_r({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=Ie({updaterMap:Cs,eventMap:Ls,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Cs,eventMap:Ls,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),je(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}z(Pu,"contextType",Pe);var xs={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Es={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class Ou extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{streetViewPanorama:null}),z(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,o=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=Ie({updaterMap:Es,eventMap:xs,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({streetViewPanorama:o}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Es,eventMap:xs,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),je(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}z(Ou,"contextType",Pe);class _u extends l.PureComponent{constructor(){super(...arguments),z(this,"state",{streetViewService:null}),z(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}z(_u,"contextType",Pe);var Ss={onDirectionsChanged:"directions_changed"},ks={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Du extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"state",{directionsRenderer:null}),z(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=Ie({updaterMap:ks,eventMap:Ss,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:ks,eventMap:Ss,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),je(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}z(Du,"contextType",Pe);var Ms={onPlacesChanged:"places_changed"},Ps={bounds(t,e){t.setBounds(e)}};class Iu extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",l.createRef()),z(this,"state",{searchBox:null}),z(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(Ze(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=Ie({updaterMap:Ps,eventMap:Ms,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:Ps,eventMap:Ms,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),je(this.registeredEvents))}render(){return ue.jsx("div",{ref:this.containerElement,children:l.Children.only(this.props.children)})}}z(Iu,"contextType",Pe);var Os={onPlaceChanged:"place_changed"},_s={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ra extends l.PureComponent{constructor(){super(...arguments),z(this,"registeredEvents",[]),z(this,"containerElement",l.createRef()),z(this,"state",{autocomplete:null}),z(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;Ze(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var o=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=Ie({updaterMap:_s,eventMap:Os,prevProps:{},nextProps:this.props,instance:o}),this.setState(()=>({autocomplete:o}),this.setAutocompleteCallback)}}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=Ie({updaterMap:_s,eventMap:Os,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&je(this.registeredEvents)}render(){return ue.jsx("div",{ref:this.containerElement,className:this.props.className,children:l.Children.only(this.props.children)})}}z(ra,"defaultProps",{className:""});z(ra,"contextType",Pe);const zt=5e-4,ju=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const o=e.createImageData(r,r),u=o.data;for(let f=0;f<u.length;f+=4){const p=Math.random()*100;u[f]=p,u[f+1]=p,u[f+2]=p,u[f+3]=5}return e.putImageData(o,0,0),e.createPattern(t,"repeat")},Ru=({map:t,zoom:e,claimedCells:r,exploredCells:o,hoveredCell:u,isAnimating:f,selectedCell:p,effects:h})=>{const g=l.useRef(null),L=l.useRef(null),[w,y]=l.useState([]),[S,j]=l.useState([]),P=l.useRef(r),K=l.useRef(o),Z=l.useRef(null),Y=l.useRef();return l.useEffect(()=>{P.current=r},[r]),l.useEffect(()=>{K.current=o},[o]),l.useEffect(()=>{Z.current=ju();const F=new Worker(new URL("/chill-demo/assets/grid.worker-6f75YCnB.js",import.meta.url),{type:"module"});return L.current=F,F.onmessage=ae=>{const{claimedCellsToDraw:B,exploredCellsToDraw:T}=ae.data;y(B),j(T)},()=>{F.terminate(),Y.current&&cancelAnimationFrame(Y.current)}},[]),l.useEffect(()=>{const F=g.current;if(!F)return;const ae=new Map,B=()=>{const T=F.getProjection();if(!T||!F.swPixel){Y.current=requestAnimationFrame(B);return}F.effectsCtx.clearRect(0,0,F.effectsCanvas.width,F.effectsCanvas.height),F.drawFog();let A=!1;const $=Date.now();h.forEach(se=>{const N=$-se.startTime;if(N<se.particleDuration){A=!0;const V=N/se.particleDuration;F.drawParticleEffect(se,V,T)}if(N<se.revealDuration){A=!0;const V=N/se.revealDuration;F.drawRevealEffect(se,V,T)}N>=se.revealDuration&&!ae.has(se.id)&&(se.onComplete&&se.onComplete(),ae.set(se.id,!0))}),A?Y.current=requestAnimationFrame(B):F.drawFog()};return Y.current=requestAnimationFrame(B),()=>{Y.current&&cancelAnimationFrame(Y.current),F&&(F.clearEffects(),F.drawFog())}},[h]),l.useEffect(()=>{if(!t)return;class F extends window.google.maps.OverlayView{constructor(){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.effectsCanvas=document.createElement("canvas"),this.effectsCtx=this.effectsCanvas.getContext("2d"),this.effectsCanvas.style.position="absolute",this.effectsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none"}setProps(V){this.props={...this.props,...V}}setDrawableCells(V,re){this.drawableClaimed=V,this.drawableExplored=re}onAdd(){const V=this.getPanes();V.overlayLayer.appendChild(this.fogCanvas),V.overlayMouseTarget.appendChild(this.effectsCanvas),V.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(V=>{V.parentElement&&V.parentElement.removeChild(V)})}draw(){const V=this.getProjection();if(!V)return;const re=.5,ge=this.getMap().getBounds(),Q=ge.getSouthWest(),ce=ge.getNorthEast(),le=V.fromLatLngToDivPixel(Q),de=V.fromLatLngToDivPixel(ce);if(!le||!de)return;const Le=de.x-le.x,ve=le.y-de.y,ye=Math.round(Le*re),pe=Math.round(ve*re),we=Le+2*ye,xe=ve+2*pe;this.swPixel={x:le.x-ye,y:le.y+pe},this.nePixel={x:de.x+ye,y:de.y-pe},[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(fe=>{fe.style.left=`${le.x-ye}px`,fe.style.top=`${de.y-pe}px`,fe.width=we,fe.height=xe}),this.drawFog(),this.drawDynamic()}drawFog(){this.swPixel&&(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),Z.current&&(this.fogCtx.fillStyle=Z.current,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(V=>{this.drawStaticReveal(V)}),this.fogCtx.globalCompositeOperation="source-over")}drawStaticReveal(V){const re=this.getProjection();if(!re||!this.swPixel)return;const{south:ge,west:Q}=V,ce=new window.google.maps.LatLng(ge,Q),le=new window.google.maps.LatLng(ge+zt,Q+zt),de=re.fromLatLngToDivPixel(ce),Le=re.fromLatLngToDivPixel(le);if(!de||!Le)return;const ve=de.x-this.swPixel.x,ye=Le.y-this.nePixel.y,pe=Le.x-de.x,we=de.y-Le.y,xe=ve+pe/2,fe=ye+we/2,ke=pe*2.5,q=we*2.5,Re=this.fogCtx.createRadialGradient(xe,fe,0,xe,fe,Math.max(ke,q));Re.addColorStop(0,"rgba(0, 0, 0, 1)"),Re.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=Re,this.fogCtx.beginPath(),this.fogCtx.ellipse(xe,fe,ke,q,0,0,2*Math.PI),this.fogCtx.fill()}drawRevealEffect(V,re,ge){const Q=new window.google.maps.LatLng(V.position.lat,V.position.lng),ce=ge.fromLatLngToDivPixel(Q);if(!ce||!this.swPixel)return;const le=ce.x-this.swPixel.x,de=ce.y-this.nePixel.y,Le=new window.google.maps.LatLng(V.position.lat,V.position.lng),ve=new window.google.maps.LatLng(V.position.lat+zt,V.position.lng+zt),ye=ge.fromLatLngToDivPixel(Le),pe=ge.fromLatLngToDivPixel(ve);if(!ye||!pe)return;const fe=(pe.x-ye.x)*2.5*re,ke=this.fogCtx.createRadialGradient(le,de,0,le,de,fe);ke.addColorStop(0,"rgba(0, 0, 0, 1)"),ke.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.globalCompositeOperation="destination-out",this.fogCtx.fillStyle=ke,this.fogCtx.beginPath(),this.fogCtx.arc(le,de,fe,0,2*Math.PI),this.fogCtx.fill(),this.fogCtx.globalCompositeOperation="source-over"}drawParticleEffect(V,re,ge){const Q=new window.google.maps.LatLng(V.position.lat,V.position.lng),ce=ge.fromLatLngToDivPixel(Q);if(!ce||!this.swPixel)return;const le=ce.x-this.swPixel.x,de=ce.y-this.nePixel.y,ve=80*(.1+1.4*re),ye=.6*(1-re),pe=this.effectsCtx.createRadialGradient(le,de,0,le,de,ve);pe.addColorStop(0,`rgba(255, 255, 255, ${ye*.5})`),pe.addColorStop(.5,`rgba(255, 255, 255, ${ye*.5})`),pe.addColorStop(1,"rgba(255, 255, 255, 0)"),this.effectsCtx.fillStyle=pe,this.effectsCtx.filter="blur(20px)",this.effectsCtx.beginPath(),this.effectsCtx.arc(le,de,ve,0,2*Math.PI),this.effectsCtx.fill(),this.effectsCtx.filter="none"}clearEffects(){this.effectsCtx&&this.effectsCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)}drawDynamic(){const V=this.getProjection();if(!V||!this.swPixel)return;const{hoveredCell:re,selectedCell:ge}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height);const Q=ge?ge.key:re;if(!Q)return;const[ce,le]=Q.split("_").map(Number),de=ce*zt,Le=le*zt,ve=new window.google.maps.LatLng(de,Le),ye=new window.google.maps.LatLng(de+zt,Le+zt),pe=V.fromLatLngToDivPixel(ve),we=V.fromLatLngToDivPixel(ye);if(!pe||!we)return;const xe=pe.x-this.swPixel.x,fe=we.y-this.nePixel.y,ke=we.x-pe.x,q=pe.y-we.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(xe,fe,ke,q)}}const ae=new F;ae.setMap(t),g.current=ae;let B=null;const T=100,A=()=>{if(L.current){const N=t.getBounds();N&&L.current.postMessage({bounds:{southwest:{lat:N.getSouthWest().lat(),lng:N.getSouthWest().lng()},northeast:{lat:N.getNorthEast().lat(),lng:N.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:P.current,exploredCells:K.current})}},$=t.addListener("bounds_changed",()=>{B||(B=setTimeout(()=>{A(),B=null},T))}),se=t.addListener("idle",A);return()=>{g.current&&g.current.setMap(null),window.google.maps.event.removeListener($),window.google.maps.event.removeListener(se),B&&clearTimeout(B)}},[t]),l.useEffect(()=>{g.current&&(g.current.setProps({zoom:e,hoveredCell:u,isAnimating:f,selectedCell:p}),g.current.drawDynamic())},[e,u,f,p]),l.useEffect(()=>{g.current&&(g.current.setDrawableCells(w,S),g.current.drawFog())},[w,S]),l.useEffect(()=>{if(!t||!L.current)return;const F=t.getBounds();F&&L.current.postMessage({bounds:{southwest:{lat:F.getSouthWest().lat(),lng:F.getSouthWest().lng()},northeast:{lat:F.getNorthEast().lat(),lng:F.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:r,exploredCells:o})},[r,o,t]),null},Ds=t=>{let e;const r=new Set,o=(L,w)=>{const y=typeof L=="function"?L(e):L;if(!Object.is(y,e)){const S=e;e=w??(typeof y!="object"||y===null)?y:Object.assign({},e,y),r.forEach(j=>j(e,S))}},u=()=>e,h={setState:o,getState:u,getInitialState:()=>g,subscribe:L=>(r.add(L),()=>r.delete(L))},g=e=t(o,u,h);return h},Tu=(t=>t?Ds(t):Ds),Au=t=>t;function Bu(t,e=Au){const r=en.useSyncExternalStore(t.subscribe,en.useCallback(()=>e(t.getState()),[t,e]),en.useCallback(()=>e(t.getInitialState()),[t,e]));return en.useDebugValue(r),r}const Is=t=>{const e=Tu(t),r=o=>Bu(e,o);return Object.assign(r,e),r},zu=(t=>t?Is(t):Is);var ia=Symbol.for("immer-nothing"),js=Symbol.for("immer-draftable"),at=Symbol.for("immer-state");function dt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Kn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[at]}function tn(t){return t?oa(t)||Array.isArray(t)||!!t[js]||!!t.constructor?.[js]||Wn(t)||Ar(t):!1}var Fu=Object.prototype.constructor.toString(),Rs=new WeakMap;function oa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let o=Rs.get(r);return o===void 0&&(o=Function.toString.call(r),Rs.set(r,o)),o===Fu}function Dr(t,e,r=!0){Tr(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(u=>{e(u,t[u],t)}):t.forEach((o,u)=>e(u,o,t))}function Tr(t){const e=t[at];return e?e.type_:Array.isArray(t)?1:Wn(t)?2:Ar(t)?3:0}function Li(t,e){return Tr(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function sa(t,e,r){const o=Tr(t);o===2?t.set(e,r):o===3?t.add(r):t[e]=r}function Uu(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Wn(t){return t instanceof Map}function Ar(t){return t instanceof Set}function Xt(t){return t.copy_||t.base_}function Ci(t,e){if(Wn(t))return new Map(t);if(Ar(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=oa(t);if(e===!0||e==="class_only"&&!r){const o=Object.getOwnPropertyDescriptors(t);delete o[at];let u=Reflect.ownKeys(o);for(let f=0;f<u.length;f++){const p=u[f],h=o[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(o[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Kn(t),o)}else{const o=Kn(t);if(o!==null&&r)return{...t};const u=Object.create(o);return Object.assign(u,t)}}function Ri(t,e=!1){return Br(t)||wn(t)||!tn(t)||(Tr(t)>1&&Object.defineProperties(t,{set:yr,add:yr,clear:yr,delete:yr}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ri(r,!0))),t}function Ku(){dt(2)}var yr={value:Ku};function Br(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var Nu={};function nn(t){const e=Nu[t];return e||dt(0,t),e}var Nn;function aa(){return Nn}function qu(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ts(t,e){e&&(nn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function xi(t){Ei(t),t.drafts_.forEach(Wu),t.drafts_=null}function Ei(t){t===Nn&&(Nn=t.parent_)}function As(t){return Nn=qu(Nn,t)}function Wu(t){const e=t[at];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Bs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[at].modified_&&(xi(e),dt(4)),tn(t)&&(t=Ir(e,t),e.parent_||jr(e,t)),e.patches_&&nn("Patches").generateReplacementPatches_(r[at].base_,t,e.patches_,e.inversePatches_)):t=Ir(e,r,[]),xi(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==ia?t:void 0}function Ir(t,e,r){if(Br(e))return e;const o=t.immer_.shouldUseStrictIteration(),u=e[at];if(!u)return Dr(e,(f,p)=>zs(t,u,e,f,p,r),o),e;if(u.scope_!==t)return e;if(!u.modified_)return jr(t,u.base_,!0),u.base_;if(!u.finalized_){u.finalized_=!0,u.scope_.unfinalizedDrafts_--;const f=u.copy_;let p=f,h=!1;u.type_===3&&(p=new Set(f),f.clear(),h=!0),Dr(p,(g,L)=>zs(t,u,f,g,L,r,h),o),jr(t,f,!1),r&&t.patches_&&nn("Patches").generatePatches_(u,r,t.patches_,t.inversePatches_)}return u.copy_}function zs(t,e,r,o,u,f,p){if(u==null||typeof u!="object"&&!p)return;const h=Br(u);if(!(h&&!p)){if(wn(u)){const g=f&&e&&e.type_!==3&&!Li(e.assigned_,o)?f.concat(o):void 0,L=Ir(t,u,g);if(sa(r,o,L),wn(L))t.canAutoFreeze_=!1;else return}else p&&r.add(u);if(tn(u)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[o]===u&&h)return;Ir(t,u),(!e||!e.scope_.parent_)&&typeof o!="symbol"&&(Wn(r)?r.has(o):Object.prototype.propertyIsEnumerable.call(r,o))&&jr(t,u)}}}function jr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ri(e,r)}function Zu(t,e){const r=Array.isArray(t),o={type_:r?1:0,scope_:e?e.scope_:aa(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let u=o,f=Ti;r&&(u=[o],f=qn);const{revoke:p,proxy:h}=Proxy.revocable(u,f);return o.draft_=h,o.revoke_=p,h}var Ti={get(t,e){if(e===at)return t;const r=Xt(t);if(!Li(r,e))return $u(t,r,e);const o=r[e];return t.finalized_||!tn(o)?o:o===mi(t.base_,e)?(vi(t),t.copy_[e]=ki(o,t)):o},has(t,e){return e in Xt(t)},ownKeys(t){return Reflect.ownKeys(Xt(t))},set(t,e,r){const o=la(Xt(t),e);if(o?.set)return o.set.call(t.draft_,r),!0;if(!t.modified_){const u=mi(Xt(t),e),f=u?.[at];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Uu(r,u)&&(r!==void 0||Li(t.base_,e)))return!0;vi(t),Si(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return mi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,vi(t),Si(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xt(t),o=Reflect.getOwnPropertyDescriptor(r,e);return o&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:o.enumerable,value:r[e]}},defineProperty(){dt(11)},getPrototypeOf(t){return Kn(t.base_)},setPrototypeOf(){dt(12)}},qn={};Dr(Ti,(t,e)=>{qn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});qn.deleteProperty=function(t,e){return qn.set.call(this,t,e,void 0)};qn.set=function(t,e,r){return Ti.set.call(this,t[0],e,r,t[0])};function mi(t,e){const r=t[at];return(r?Xt(r):t)[e]}function $u(t,e,r){const o=la(e,r);return o?"value"in o?o.value:o.get?.call(t.draft_):void 0}function la(t,e){if(!(e in t))return;let r=Kn(t);for(;r;){const o=Object.getOwnPropertyDescriptor(r,e);if(o)return o;r=Kn(r)}}function Si(t){t.modified_||(t.modified_=!0,t.parent_&&Si(t.parent_))}function vi(t){t.copy_||(t.copy_=Ci(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Vu=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,o)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(g=f,...L){return p.produce(g,w=>r.call(this,w,...L))}}typeof r!="function"&&dt(6),o!==void 0&&typeof o!="function"&&dt(7);let u;if(tn(e)){const f=As(this),p=ki(e,void 0);let h=!0;try{u=r(p),h=!1}finally{h?xi(f):Ei(f)}return Ts(f,o),Bs(u,f)}else if(!e||typeof e!="object"){if(u=r(e),u===void 0&&(u=e),u===ia&&(u=void 0),this.autoFreeze_&&Ri(u,!0),o){const f=[],p=[];nn("Patches").generateReplacementPatches_(e,u,f,p),o(f,p)}return u}else dt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,g=>e(g,...h));let o,u;return[this.produce(e,r,(p,h)=>{o=p,u=h}),o,u]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){tn(t)||dt(8),wn(t)&&(t=Hu(t));const e=As(this),r=ki(t,void 0);return r[at].isManual_=!0,Ei(e),r}finishDraft(t,e){const r=t&&t[at];(!r||!r.isManual_)&&dt(9);const{scope_:o}=r;return Ts(o,e),Bs(void 0,o)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const u=e[r];if(u.path.length===0&&u.op==="replace"){t=u.value;break}}r>-1&&(e=e.slice(r+1));const o=nn("Patches").applyPatches_;return wn(t)?o(t,e):this.produce(t,u=>o(u,e))}};function ki(t,e){const r=Wn(t)?nn("MapSet").proxyMap_(t,e):Ar(t)?nn("MapSet").proxySet_(t,e):Zu(t,e);return(e?e.scope_:aa()).drafts_.push(r),r}function Hu(t){return wn(t)||dt(10,t),ua(t)}function ua(t){if(!tn(t)||Br(t))return t;const e=t[at];let r,o=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ci(t,e.scope_.immer_.useStrictShallowCopy_),o=e.scope_.immer_.shouldUseStrictIteration()}else r=Ci(t,!0);return Dr(r,(u,f)=>{sa(r,u,ua(f))},o),e&&(e.finalized_=!1),r}var Gu=new Vu,Yu=Gu.produce;const Ju=t=>(e,r,o)=>(o.setState=(u,f,...p)=>{const h=typeof u=="function"?Yu(u):u;return e(h,f,...p)},t(o.setState,r,o)),Xu=Ju;var Lr={exports:{}},Qu=Lr.exports,Fs;function ec(){return Fs||(Fs=1,(function(t,e){(function(r,o){t.exports=o()})(Qu,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,s=1,a=arguments.length;s<a;s++)for(var c in i=arguments[s])Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c]);return n}).apply(this,arguments)};function u(n,i,s){for(var a,c=0,d=i.length;c<d;c++)!a&&c in i||((a=a||Array.prototype.slice.call(i,0,c))[c]=i[c]);return n.concat(a||Array.prototype.slice.call(i))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ra,p=Object.keys,h=Array.isArray;function g(n,i){return typeof i!="object"||p(i).forEach(function(s){n[s]=i[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var L=Object.getPrototypeOf,w={}.hasOwnProperty;function y(n,i){return w.call(n,i)}function S(n,i){typeof i=="function"&&(i=i(L(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(i).forEach(function(s){P(n,s,i[s])})}var j=Object.defineProperty;function P(n,i,s,a){j(n,i,g(s&&y(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function K(n){return{from:function(i){return n.prototype=Object.create(i.prototype),P(n.prototype,"constructor",n),{extend:S.bind(null,n.prototype)}}}}var Z=Object.getOwnPropertyDescriptor,Y=[].slice;function F(n,i,s){return Y.call(n,i,s)}function ae(n,i){return i(n)}function B(n){if(!n)throw new Error("Assertion Failed")}function T(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function A(n,i){if(typeof i=="string"&&y(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var s=[],a=0,c=i.length;a<c;++a){var d=A(n,i[a]);s.push(d)}return s}var m=i.indexOf(".");if(m!==-1){var v=n[i.substr(0,m)];return v==null?void 0:A(v,i.substr(m+1))}}function $(n,i,s){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){B(typeof s!="string"&&"length"in s);for(var a=0,c=i.length;a<c;++a)$(n,i[a],s[a])}else{var d,m,v=i.indexOf(".");v!==-1?(d=i.substr(0,v),(m=i.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:$(v=!(v=n[d])||!y(n,d)?n[d]={}:v,m,s)):s===void 0?h(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=s}}function se(n){var i,s={};for(i in n)y(n,i)&&(s[i]=n[i]);return s}var N=[].concat;function V(n){return N.apply([],n)}var ht="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(V([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return f[n]}),re=new Set(ht.map(function(n){return f[n]})),ge=null;function Q(n){return ge=new WeakMap,n=(function i(s){if(!s||typeof s!="object")return s;var a=ge.get(s);if(a)return a;if(h(s)){a=[],ge.set(s,a);for(var c=0,d=s.length;c<d;++c)a.push(i(s[c]))}else if(re.has(s.constructor))a=s;else{var m,v=L(s);for(m in a=v===Object.prototype?{}:Object.create(v),ge.set(s,a),s)y(s,m)&&(a[m]=i(s[m]))}return a})(n),ge=null,n}var ce={}.toString;function le(n){return ce.call(n).slice(8,-1)}var de=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Le=typeof de=="symbol"?function(n){var i;return n!=null&&(i=n[de])&&i.apply(n)}:function(){return null};function ve(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var ye={};function pe(n){var i,s,a,c;if(arguments.length===1){if(h(n))return n.slice();if(this===ye&&typeof n=="string")return[n];if(c=Le(n)){for(s=[];!(a=c.next()).done;)s.push(a.value);return s}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(s=new Array(i);i--;)s[i]=n[i];return s}for(i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return s}var we=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Pt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ut=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Pt),xe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function fe(n,i){this.name=n,this.message=i}function ke(n,i){return n+". Errors: "+Object.keys(i).map(function(s){return i[s].toString()}).filter(function(s,a,c){return c.indexOf(s)===a}).join(`
`)}function q(n,i,s,a){this.failures=i,this.failedKeys=a,this.successCount=s,this.message=ke(n,i)}function Re(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(s){return i[s]}),this.failuresByPos=i,this.message=ke(n,this.failures)}K(fe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),K(q).from(fe),K(Re).from(fe);var Ue=ut.reduce(function(n,i){return n[i]=i+"Error",n},{}),Ee=fe,ie=ut.reduce(function(n,i){var s=i+"Error";function a(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=xe[i]||s,this.inner=null)}return K(a).from(Ee),n[i]=a,n},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var be=Pt.reduce(function(n,i){return n[i+"Error"]=ie[i],n},{}),_e=ut.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=ie[i]),n},{});function H(){}function Be(n){return n}function et(n,i){return n==null||n===Be?i:function(s){return i(n(s))}}function Te(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function Zn(n,i){return n===H?i:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=i.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Te(a,this.onsuccess):a),c&&(this.onerror=this.onerror?Te(c,this.onerror):c),d!==void 0?d:s}}function rn(n,i){return n===H?i:function(){n.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Te(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Te(a,this.onerror):a)}}function $n(n,i){return n===H?i:function(s){var a=n.apply(this,arguments);g(s,a);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=i.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?Te(c,this.onsuccess):c),d&&(this.onerror=this.onerror?Te(d,this.onerror):d),a===void 0?s===void 0?void 0:s:g(a,s)}}function on(n,i){return n===H?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function sn(n,i){return n===H?i:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return i.apply(a,d)})}return i.apply(this,arguments)}}_e.ModifyError=q,_e.DexieError=fe,_e.BulkError=Re;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Cn(n){Xe=n}var pt={},xn=100,ht=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,L(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,L(i),n]})(),Pt=ht[0],ut=ht[1],ht=ht[2],ut=ut&&ut.then,lt=Pt&&Pt.constructor,an=!!ht,gt=function(n,i){vt.push([n,i]),Lt&&(queueMicrotask(fn),Lt=!1)},ln=!0,Lt=!0,mt=[],Ct=[],un=Be,tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:H,pgp:!1,env:{},finalize:H},me=tt,vt=[],yt=0,xt=[];function oe(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=me;if(typeof n!="function"){if(n!==pt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ot(this,this._value))}this._state=null,this._value=null,++i.ref,(function s(a,c){try{c(function(d){if(a._state===null){if(d===a)throw new TypeError("A promise cannot be resolved with itself.");var m=a._lib&&Et();d&&typeof d.then=="function"?s(a,function(v,C){d instanceof oe?d._then(v,C):d.then(v,C)}):(a._state=!0,a._value=d,Sn(a)),m&&Dt()}},Ot.bind(null,a))}catch(d){Ot(a,d)}})(this,n)}var cn={get:function(){var n=me,i=Yn;function s(a,c){var d=this,m=!n.global&&(n!==me||i!==Yn),v=m&&!jt(),C=new oe(function(x,O){_t(d,new En(Bi(a,n,m,v),Bi(c,n,m,v),x,O,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return s.prototype=pt,s},set:function(n){P(this,"then",n&&n.prototype===pt?cn:{get:function(){return n},set:cn.set})}};function En(n,i,s,a,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=s,this.reject=a,this.psd=c}function Ot(n,i){var s,a;Ct.push(i),n._state===null&&(s=n._lib&&Et(),i=un(i),n._state=!1,n._value=i,a=n,mt.some(function(c){return c._value===a._value})||mt.push(a),Sn(n),s&&Dt())}function Sn(n){var i=n._listeners;n._listeners=[];for(var s=0,a=i.length;s<a;++s)_t(n,i[s]);var c=n._PSD;--c.ref||c.finalize(),yt===0&&(++yt,gt(function(){--yt==0&&St()},[]))}function _t(n,i){if(n._state!==null){var s=n._state?i.onFulfilled:i.onRejected;if(s===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++yt,gt(Vn,[s,n,i])}else n._listeners.push(i)}function Vn(n,i,s){try{var a,c=i._value;!i._state&&Ct.length&&(Ct=[]),a=Xe&&i._consoleTask?i._consoleTask.run(function(){return n(c)}):n(c),i._state||Ct.indexOf(c)!==-1||(function(d){for(var m=mt.length;m;)if(mt[--m]._value===d._value)return mt.splice(m,1)})(i),s.resolve(a)}catch(d){s.reject(d)}finally{--yt==0&&St(),--s.psd.ref||s.psd.finalize()}}function fn(){Zt(tt,function(){Et()&&Dt()})}function Et(){var n=ln;return Lt=ln=!1,n}function Dt(){var n,i,s;do for(;0<vt.length;)for(n=vt,vt=[],s=n.length,i=0;i<s;++i){var a=n[i];a[0].apply(null,a[1])}while(0<vt.length);Lt=ln=!0}function St(){var n=mt;mt=[],n.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var i=xt.slice(0),s=i.length;s;)i[--s]()}function Ce(n){return new oe(pt,!1,n)}function Ne(n,i){var s=me;return function(){var a=Et(),c=me;try{return Rt(s,!0),n.apply(this,arguments)}catch(d){i&&i(d)}finally{Rt(c,!1),a&&Dt()}}}S(oe.prototype,{then:cn,_then:function(n,i){_t(this,new En(null,null,n,i,me))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,s=arguments[1];return typeof i=="function"?this.then(null,function(a){return(a instanceof i?s:Ce)(a)}):this.then(null,function(a){return(a&&a.name===i?s:Ce)(a)})},finally:function(n){return this.then(function(i){return oe.resolve(n()).then(function(){return i})},function(i){return oe.resolve(n()).then(function(){return Ce(i)})})},timeout:function(n,i){var s=this;return n<1/0?new oe(function(a,c){var d=setTimeout(function(){return c(new ie.Timeout(i))},n);s.then(a,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&P(oe.prototype,Symbol.toStringTag,"Dexie.Promise"),tt.env=Ai(),S(oe,{all:function(){var n=pe.apply(null,arguments).map(Jn);return new oe(function(i,s){n.length===0&&i([]);var a=n.length;n.forEach(function(c,d){return oe.resolve(c).then(function(m){n[d]=m,--a||i(n)},s)})})},resolve:function(n){return n instanceof oe?n:n&&typeof n.then=="function"?new oe(function(i,s){n.then(i,s)}):new oe(pt,!0,n)},reject:Ce,race:function(){var n=pe.apply(null,arguments).map(Jn);return new oe(function(i,s){n.map(function(a){return oe.resolve(a).then(i,s)})})},PSD:{get:function(){return me},set:function(n){return me=n}},totalEchoes:{get:function(){return Yn}},newPSD:It,usePSD:Zt,scheduler:{get:function(){return gt},set:function(n){gt=n}},rejectionMapper:{get:function(){return un},set:function(n){un=n}},follow:function(n,i){return new oe(function(s,a){return It(function(c,d){var m=me;m.unhandleds=[],m.onunhandled=d,m.finalize=Te(function(){var v,C=this;v=function(){C.unhandleds.length===0?c():d(C.unhandleds[0])},xt.push(function x(){v(),xt.splice(xt.indexOf(x),1)}),++yt,gt(function(){--yt==0&&St()},[])},m.finalize),n()},i,s,a)})}}),lt&&(lt.allSettled&&P(oe,"allSettled",function(){var n=pe.apply(null,arguments).map(Jn);return new oe(function(i){n.length===0&&i([]);var s=n.length,a=new Array(s);n.forEach(function(c,d){return oe.resolve(c).then(function(m){return a[d]={status:"fulfilled",value:m}},function(m){return a[d]={status:"rejected",reason:m}}).then(function(){return--s||i(a)})})})}),lt.any&&typeof AggregateError<"u"&&P(oe,"any",function(){var n=pe.apply(null,arguments).map(Jn);return new oe(function(i,s){n.length===0&&s(new AggregateError([]));var a=n.length,c=new Array(a);n.forEach(function(d,m){return oe.resolve(d).then(function(v){return i(v)},function(v){c[m]=v,--a||s(new AggregateError(c))})})})}),lt.withResolvers&&(oe.withResolvers=lt.withResolvers));var $e={awaits:0,echoes:0,id:0},fa=0,Hn=[],Gn=0,Yn=0,da=0;function It(n,i,s,a){var c=me,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++da,tt.env,d.env=an?{Promise:oe,PromiseProp:{value:oe,configurable:!0,writable:!0},all:oe.all,race:oe.race,allSettled:oe.allSettled,any:oe.any,resolve:oe.resolve,reject:oe.reject}:{},i&&g(d,i),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},a=Zt(d,n,s,a),d.ref===0&&d.finalize(),a}function dn(){return $e.id||($e.id=++fa),++$e.awaits,$e.echoes+=xn,$e.id}function jt(){return!!$e.awaits&&(--$e.awaits==0&&($e.id=0),$e.echoes=$e.awaits*xn,!0)}function Jn(n){return $e.echoes&&n&&n.constructor===lt?(dn(),n.then(function(i){return jt(),i},function(i){return jt(),qe(i)})):n}function pa(){var n=Hn[Hn.length-1];Hn.pop(),Rt(n,!1)}function Rt(n,i){var s,a=me;(i?!$e.echoes||Gn++&&n===me:!Gn||--Gn&&n===me)||queueMicrotask(i?(function(c){++Yn,$e.echoes&&--$e.echoes!=0||($e.echoes=$e.awaits=$e.id=0),Hn.push(me),Rt(c,!0)}).bind(null,n):pa),n!==me&&(me=n,a===tt&&(tt.env=Ai()),an&&(s=tt.env.Promise,i=n.env,(a.global||n.global)&&(Object.defineProperty(f,"Promise",i.PromiseProp),s.all=i.all,s.race=i.race,s.resolve=i.resolve,s.reject=i.reject,i.allSettled&&(s.allSettled=i.allSettled),i.any&&(s.any=i.any))))}function Ai(){var n=f.Promise;return an?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Zt(n,i,s,a,c){var d=me;try{return Rt(n,!0),i(s,a,c)}finally{Rt(d,!1)}}function Bi(n,i,s,a){return typeof n!="function"?n:function(){var c=me;s&&dn(),Rt(i,!0);try{return n.apply(this,arguments)}finally{Rt(c,!1),a&&queueMicrotask(jt)}}}function zr(n){Promise===lt&&$e.echoes===0?Gn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ut).indexOf("[native code]")===-1&&(dn=jt=H);var qe=oe.reject,$t="￿",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",pn=[],Xn="__dbnames",Fr="readonly",Ur="readwrite";function Vt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=Q(i))[n],i}}function Ui(){throw ie.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ae(n,i){try{var s=Ki(n),a=Ki(i);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return(function(c,d){for(var m=c.length,v=d.length,C=m<v?m:v,x=0;x<C;++x)if(c[x]!==d[x])return c[x]<d[x]?-1:1;return m===v?0:m<v?-1:1})(Ni(n),Ni(i));case"Array":return(function(c,d){for(var m=c.length,v=d.length,C=m<v?m:v,x=0;x<C;++x){var O=Ae(c[x],d[x]);if(O!==0)return O}return m===v?0:m<v?-1:1})(n,i)}}catch{}return NaN}function Ki(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=le(n),n==="ArrayBuffer"?"binary":n)}function Ni(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function er(n,i,s){var a=n.schema.yProps;return a?(i&&0<s.numFailures&&(i=i.filter(function(c,d){return!s.failures[d]})),Promise.all(a.map(function(c){return c=c.updatesTable,i?n.db.table(c).where("k").anyOf(i).delete():n.db.table(c).clear()})).then(function(){return s})):s}var kn=(qi.prototype.execute=function(n){var i=this["@@propmod"];if(i.add!==void 0){var s=i.add;if(h(s))return u(u([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(i.remove!==void 0){var a=i.remove;if(h(a))return h(n)?n.filter(function(c){return!a.includes(c)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=i.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?i.replacePrefix[1]+n.substring(s.length):n},qi);function qi(n){this["@@propmod"]=n}function Wi(n,i){for(var s=p(i),a=s.length,c=!1,d=0;d<a;++d){var m=s[d],v=i[m],C=A(n,m);v instanceof kn?($(n,m,v.execute(C)),c=!0):C!==v&&($(n,m,v),c=!0)}return c}var Zi=(Ke.prototype._trans=function(n,i,s){var a=this._tx||me.trans,c=this.name,d=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function m(x,O,b){if(!b.schema[c])throw new ie.NotFound("Table "+c+" not part of transaction");return i(b.idbtrans,b)}var v=Et();try{var C=a&&a.db._novip===this.db._novip?a===me.trans?a._promise(n,m,s):It(function(){return a._promise(n,m,s)},{trans:a,transless:me.transless||me}):(function x(O,b,D,E){if(O.idbdb&&(O._state.openComplete||me.letThrough||O._vip)){var k=O._createTransaction(b,D,O._dbSchema);try{k.create(),O._state.PR1398_maxLoop=3}catch(M){return M.name===Ue.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,b,D,E)})):qe(M)}return k._promise(b,function(M,_){return It(function(){return me.trans=k,E(M,_,k)})}).then(function(M){if(b==="readwrite")try{k.idbtrans.commit()}catch{}return b==="readonly"?M:k._completion.then(function(){return M})})}if(O._state.openComplete)return qe(new ie.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return qe(new ie.DatabaseClosed);O.open().catch(H)}return O._state.dbReadyPromise.then(function(){return x(O,b,D,E)})})(this.db,n,[this.name],m);return d&&(C._consoleTask=d,C=C.catch(function(x){return console.trace(x),qe(x)})),C}finally{v&&Dt()}},Ke.prototype.get=function(n,i){var s=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?qe(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(i)},Ke.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=p(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&i.every(function(x){return 0<=v.keyPath.indexOf(x)})){for(var C=0;C<i.length;++C)if(i.indexOf(v.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(v,C){return v.keyPath.length-C.keyPath.length})[0];if(s&&this.db._maxKey!==$t){var d=s.keyPath.slice(0,i.length);return this.where(d).equals(d.map(function(C){return n[C]}))}!s&&Xe&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var a=this.schema.idxByName;function c(v,C){return Ae(v,C)===0}var m=i.reduce(function(b,C){var x=b[0],O=b[1],b=a[C],D=n[C];return[x||b,x||!b?Vt(O,b&&b.multi?function(E){return E=A(E,C),h(E)&&E.some(function(k){return c(D,k)})}:function(E){return c(D,A(E,C))}):O]},[null,null]),d=m[0],m=m[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(m):s?this.filter(m):this.where(i).equals("")},Ke.prototype.filter=function(n){return this.toCollection().and(n)},Ke.prototype.count=function(n){return this.toCollection().count(n)},Ke.prototype.offset=function(n){return this.toCollection().offset(n)},Ke.prototype.limit=function(n){return this.toCollection().limit(n)},Ke.prototype.each=function(n){return this.toCollection().each(n)},Ke.prototype.toArray=function(n){return this.toCollection().toArray(n)},Ke.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ke.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Ke.prototype.reverse=function(){return this.toCollection().reverse()},Ke.prototype.mapToClass=function(n){var i,s=this.db,a=this.name;function c(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ui&&((function(C,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function O(){this.constructor=C}r(C,x),C.prototype=x===null?Object.create(x):(O.prototype=x.prototype,new O)})(c,i=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return a},n=c);for(var d=new Set,m=n.prototype;m;m=L(m))Object.getOwnPropertyNames(m).forEach(function(C){return d.add(C)});function v(C){if(!C)return C;var x,O=Object.create(n.prototype);for(x in C)if(!d.has(x))try{O[x]=C[x]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Ke.prototype.defineClass=function(){return this.mapToClass(function(n){g(this,n)})},Ke.prototype.add=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,m=n;return d&&c&&(m=Qn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:i!=null?[i]:null,values:[m]})}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{$(n,d,v)}catch{}return v})},Ke.prototype.upsert=function(n,i){var s=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var m=d??{};return Wi(m,i),a&&$(m,a,n),s.core.mutate({trans:c,type:"put",values:[m],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[i]}}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):!!d})})})},Ke.prototype.update=function(n,i){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(i):(n=A(n,this.schema.primKey.keyPath),n===void 0?qe(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},Ke.prototype.put=function(n,i){var s=this,a=this.schema.primKey,c=a.auto,d=a.keyPath,m=n;return d&&c&&(m=Qn(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[m],keys:i!=null?[i]:null})}).then(function(v){return v.numFailures?oe.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{$(n,d,v)}catch{}return v})},Ke.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(a){return er(i,[n],a)}).then(function(a){return a.numFailures?oe.reject(a.failures[0]):void 0})})},Ke.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:Fi}).then(function(s){return er(n,null,s)})}).then(function(i){return i.numFailures?oe.reject(i.failures[0]):void 0})},Ke.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(s){return i.core.getMany({keys:n,trans:s}).then(function(a){return a.map(function(c){return i.hook.reading.fire(c)})})})},Ke.prototype.bulkAdd=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(m){var x=a.schema.primKey,v=x.auto,x=x.keyPath;if(x&&c)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,x=x&&v?n.map(Qn(x)):n;return a.core.mutate({trans:m,type:"add",keys:c,values:x,wantResults:d}).then(function(k){var b=k.numFailures,D=k.results,E=k.lastResult,k=k.failures;if(b===0)return d?D:E;throw new Re("".concat(a.name,".bulkAdd(): ").concat(b," of ").concat(C," operations failed"),k)})})},Ke.prototype.bulkPut=function(n,i,s){var a=this,c=Array.isArray(i)?i:void 0,d=(s=s||(c?void 0:i))?s.allKeys:void 0;return this._trans("readwrite",function(m){var x=a.schema.primKey,v=x.auto,x=x.keyPath;if(x&&c)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,x=x&&v?n.map(Qn(x)):n;return a.core.mutate({trans:m,type:"put",keys:c,values:x,wantResults:d}).then(function(k){var b=k.numFailures,D=k.results,E=k.lastResult,k=k.failures;if(b===0)return d?D:E;throw new Re("".concat(a.name,".bulkPut(): ").concat(b," of ").concat(C," operations failed"),k)})})},Ke.prototype.bulkUpdate=function(n){var i=this,s=this.core,a=n.map(function(m){return m.key}),c=n.map(function(m){return m.changes}),d=[];return this._trans("readwrite",function(m){return s.getMany({trans:m,keys:a,cache:"clone"}).then(function(v){var C=[],x=[];n.forEach(function(b,D){var E=b.key,k=b.changes,M=v[D];if(M){for(var _=0,I=Object.keys(k);_<I.length;_++){var R=I[_],U=k[R];if(R===i.schema.primKey.keyPath){if(Ae(U,E)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else $(M,R,U)}d.push(D),C.push(E),x.push(M)}});var O=C.length;return s.mutate({trans:m,type:"put",keys:C,values:x,updates:{keys:a,changeSpecs:c}}).then(function(b){var D=b.numFailures,E=b.failures;if(D===0)return O;for(var k=0,M=Object.keys(E);k<M.length;k++){var _,I=M[k],R=d[Number(I)];R!=null&&(_=E[I],delete E[I],E[R]=_)}throw new Re("".concat(i.name,".bulkUpdate(): ").concat(D," of ").concat(O," operations failed"),E)})})})},Ke.prototype.bulkDelete=function(n){var i=this,s=n.length;return this._trans("readwrite",function(a){return i.core.mutate({trans:a,type:"delete",keys:n}).then(function(c){return er(i,n,c)})}).then(function(m){var c=m.numFailures,d=m.lastResult,m=m.failures;if(c===0)return d;throw new Re("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),m)})},Ke);function Ke(){}function Mn(n){function i(m,v){if(v){for(var C=arguments.length,x=new Array(C-1);--C;)x[C-1]=arguments[C];return s[m].subscribe.apply(null,x),n}if(typeof m=="string")return s[m]}var s={};i.addEventType=d;for(var a=1,c=arguments.length;a<c;++a)d(arguments[a]);return i;function d(m,v,C){if(typeof m!="object"){var x;v=v||on;var O={subscribers:[],fire:C=C||H,subscribe:function(b){O.subscribers.indexOf(b)===-1&&(O.subscribers.push(b),O.fire=v(O.fire,b))},unsubscribe:function(b){O.subscribers=O.subscribers.filter(function(D){return D!==b}),O.fire=O.subscribers.reduce(v,C)}};return s[m]=i[m]=O}p(x=m).forEach(function(b){var D=x[b];if(h(D))d(b,x[b][0],x[b][1]);else{if(D!=="asap")throw new ie.InvalidArgument("Invalid event config");var E=d(b,Be,function(){for(var k=arguments.length,M=new Array(k);k--;)M[k]=arguments[k];E.subscribers.forEach(function(_){T(function(){_.apply(null,M)})})})}})}}function Pn(n,i){return K(i).from({prototype:n}),i}function hn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Kr(n,i){n.filter=Vt(n.filter,i)}function Nr(n,i,s){var a=n.replayFilter;n.replayFilter=a?function(){return Vt(a(),i())}:i,n.justLimit=s&&!a}function tr(n,i){if(n.isPrimKey)return i.primaryKey;var s=i.getIndexByKeyPath(n.index);if(!s)throw new ie.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return s}function $i(n,i,s){var a=tr(n,i.schema);return i.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:a,range:n.range}})}function nr(n,i,s,a){var c=n.replayFilter?Vt(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},m=function(v,C,x){var O,b;c&&!c(C,x,function(D){return C.stop(D)},function(D){return C.fail(D)})||((b=""+(O=C.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(O)),y(d,b)||(d[b]=!0,i(v,C,x)))};return Promise.all([n.or._iterate(m,s),Vi($i(n,a,s),n.algorithm,m,!n.keysOnly&&n.valueMapper)])}return Vi($i(n,a,s),Vt(n.algorithm,c),i,!n.keysOnly&&n.valueMapper)}function Vi(n,i,s,a){var c=Ne(a?function(d,m,v){return s(a(d),m,v)}:s);return n.then(function(d){if(d)return d.start(function(){var m=function(){return d.continue()};i&&!i(d,function(v){return m=v},function(v){d.stop(v),m=H},function(v){d.fail(v),m=H})||c(d.value,d,function(v){return m=v}),m()})})}var ha=(ze.prototype._read=function(n,i){var s=this._ctx;return s.error?s.table._trans(null,qe.bind(null,s.error)):s.table._trans("readonly",n).then(i)},ze.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,qe.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},ze.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Vt(i.algorithm,n)},ze.prototype._iterate=function(n,i){return nr(this._ctx,n,i,this._ctx.table.core)},ze.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&g(s,n),i._ctx=s,i},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(n){var i=this._ctx;return this._read(function(s){return nr(i,n,s,i.table.core)})},ze.prototype.count=function(n){var i=this;return this._read(function(s){var a=i._ctx,c=a.table.core;if(hn(a,!0))return c.count({trans:s,query:{index:tr(a,c.schema),range:a.range}}).then(function(m){return Math.min(m,a.limit)});var d=0;return nr(a,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},ze.prototype.sortBy=function(n,i){var s=n.split(".").reverse(),a=s[0],c=s.length-1;function d(C,x){return x?d(C[s[x]],x-1):C[a]}var m=this._ctx.dir==="next"?1:-1;function v(C,x){return Ae(d(C,c),d(x,c))*m}return this.toArray(function(C){return C.sort(v)}).then(i)},ze.prototype.toArray=function(n){var i=this;return this._read(function(s){var a=i._ctx;if(a.dir==="next"&&hn(a,!0)&&0<a.limit){var c=a.valueMapper,d=tr(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:d,range:a.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var m=[];return nr(a,function(v){return m.push(v)},s,a.table.core).then(function(){return m})},n)},ze.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,hn(i)?Nr(i,function(){var s=n;return function(a,c){return s===0||(s===1?--s:c(function(){a.advance(s),s=0}),!1)}}):Nr(i,function(){var s=n;return function(){return--s<0}})),this},ze.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Nr(this._ctx,function(){var i=n;return function(s,a,c){return--i<=0&&a(c),0<=i}},!0),this},ze.prototype.until=function(n,i){return Kr(this._ctx,function(s,a,c){return!n(s.value)||(a(c),i)}),this},ze.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},ze.prototype.last=function(n){return this.reverse().first(n)},ze.prototype.filter=function(n){var i;return Kr(this._ctx,function(s){return n(s.value)}),(i=this._ctx).isMatch=Vt(i.isMatch,n),this},ze.prototype.and=function(n){return this.filter(n)},ze.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.key,a)})},ze.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},ze.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(s,a){n(a.primaryKey,a)})},ze.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.key)}).then(function(){return s}).then(n)},ze.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&hn(i,!0)&&0<i.limit)return this._read(function(a){var c=tr(i,i.table.core.schema);return i.table.core.query({trans:a,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(a){return a.result}).then(n);i.keysOnly=!i.isMatch;var s=[];return this.each(function(a,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},ze.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},ze.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},ze.prototype.lastKey=function(n){return this.reverse().firstKey(n)},ze.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Kr(this._ctx,function(c){var a=c.primaryKey.toString(),c=y(i,a);return i[a]=!0,!c}),this},ze.prototype.modify=function(n){var i=this,s=this._ctx;return this._write(function(a){var c=typeof n=="function"?n:function(M){return Wi(M,n)},d=s.table.core,x=d.schema.primaryKey,m=x.outbound,v=x.extractKey,C=200,x=i.db._options.modifyChunkSize;x&&(C=typeof x=="object"?x[d.name]||x["*"]||200:x);function O(M,R){var I=R.failures,R=R.numFailures;D+=M-R;for(var U=0,W=p(I);U<W.length;U++){var J=W[U];b.push(I[J])}}var b=[],D=0,E=[],k=n===Hi;return i.clone().primaryKeys().then(function(M){function _(R){var U=Math.min(C,M.length-R),W=M.slice(R,R+U);return(k?Promise.resolve([]):d.getMany({trans:a,keys:W,cache:"immutable"})).then(function(J){var te=[],G=[],X=m?[]:null,ne=k?W:[];if(!k)for(var ee=0;ee<U;++ee){var he=J[ee],Me={value:Q(he),primKey:M[R+ee]};c.call(Me,Me.value,Me)!==!1&&(Me.value==null?ne.push(M[R+ee]):m||Ae(v(he),v(Me.value))===0?(G.push(Me.value),m&&X.push(M[R+ee])):(ne.push(M[R+ee]),te.push(Me.value)))}return Promise.resolve(0<te.length&&d.mutate({trans:a,type:"add",values:te}).then(function(Oe){for(var De in Oe.failures)ne.splice(parseInt(De),1);O(te.length,Oe)})).then(function(){return(0<G.length||I&&typeof n=="object")&&d.mutate({trans:a,type:"put",keys:X,values:G,criteria:I,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<R}).then(function(Oe){return O(G.length,Oe)})}).then(function(){return(0<ne.length||I&&k)&&d.mutate({trans:a,type:"delete",keys:ne,criteria:I,isAdditionalChunk:0<R}).then(function(Oe){return er(s.table,ne,Oe)}).then(function(Oe){return O(ne.length,Oe)})}).then(function(){return M.length>R+U&&_(R+C)})})}var I=hn(s)&&s.limit===1/0&&(typeof n!="function"||k)&&{index:s.index,range:s.range};return _(0).then(function(){if(0<b.length)throw new q("Error modifying one or more objects",b,D,E);return M.length})})})},ze.prototype.delete=function(){var n=this._ctx,i=n.range;return!hn(n)||n.table.schema.yProps||!n.isPrimKey&&i.type!==3?this.modify(Hi):this._write(function(s){var a=n.table.core.schema.primaryKey,c=i;return n.table.core.count({trans:s,query:{index:a,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(C){var v=C.failures,C=C.numFailures;if(C)throw new q("Could not delete some values",Object.keys(v).map(function(x){return v[x]}),d-C);return d-C})})})},ze);function ze(){}var Hi=function(n,i){return i.value=null};function ga(n,i){return n<i?-1:n===i?0:1}function ma(n,i){return i<n?-1:n===i?0:1}function nt(n,i,s){return n=n instanceof Yi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(i),n}function gn(n){return new n.Collection(n,function(){return Gi("")}).limit(0)}function rr(n,i,s,a){var c,d,m,v,C,x,O,b=s.length;if(!s.every(function(k){return typeof k=="string"}))return nt(n,zi);function D(k){c=k==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},d=k==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},m=k==="next"?ga:ma;var M=s.map(function(_){return{lower:d(_),upper:c(_)}}).sort(function(_,I){return m(_.lower,I.lower)});v=M.map(function(_){return _.upper}),C=M.map(function(_){return _.lower}),O=(x=k)==="next"?"":a}D("next"),n=new n.Collection(n,function(){return Tt(v[0],C[b-1]+a)}),n._ondirectionchange=function(k){D(k)};var E=0;return n._addAlgorithm(function(k,M,_){var I=k.key;if(typeof I!="string")return!1;var R=d(I);if(i(R,C,E))return!0;for(var U=null,W=E;W<b;++W){var J=(function(te,G,X,ne,ee,he){for(var Me=Math.min(te.length,ne.length),Oe=-1,De=0;De<Me;++De){var rt=G[De];if(rt!==ne[De])return ee(te[De],X[De])<0?te.substr(0,De)+X[De]+X.substr(De+1):ee(te[De],ne[De])<0?te.substr(0,De)+ne[De]+X.substr(De+1):0<=Oe?te.substr(0,Oe)+G[Oe]+X.substr(Oe+1):null;ee(te[De],rt)<0&&(Oe=De)}return Me<ne.length&&he==="next"?te+X.substr(te.length):Me<te.length&&he==="prev"?te.substr(0,X.length):Oe<0?null:te.substr(0,Oe)+ne[Oe]+X.substr(Oe+1)})(I,R,v[W],C[W],m,x);J===null&&U===null?E=W+1:(U===null||0<m(U,J))&&(U=J)}return M(U!==null?function(){k.continue(U+O)}:_),!1}),n}function Tt(n,i,s,a){return{type:2,lower:n,upper:i,lowerOpen:s,upperOpen:a}}function Gi(n){return{type:1,lower:n,upper:n}}var Yi=(Object.defineProperty(Ve.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ve.prototype.between=function(n,i,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(s||a)&&(!s||!a)?gn(this):new this.Collection(this,function(){return Tt(n,i,!s,!a)})}catch{return nt(this,kt)}},Ve.prototype.equals=function(n){return n==null?nt(this,kt):new this.Collection(this,function(){return Gi(n)})},Ve.prototype.above=function(n){return n==null?nt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!0)})},Ve.prototype.aboveOrEqual=function(n){return n==null?nt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!1)})},Ve.prototype.below=function(n){return n==null?nt(this,kt):new this.Collection(this,function(){return Tt(void 0,n,!1,!0)})},Ve.prototype.belowOrEqual=function(n){return n==null?nt(this,kt):new this.Collection(this,function(){return Tt(void 0,n)})},Ve.prototype.startsWith=function(n){return typeof n!="string"?nt(this,zi):this.between(n,n+$t,!0,!0)},Ve.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):rr(this,function(i,s){return i.indexOf(s[0])===0},[n],$t)},Ve.prototype.equalsIgnoreCase=function(n){return rr(this,function(i,s){return i===s[0]},[n],"")},Ve.prototype.anyOfIgnoreCase=function(){var n=pe.apply(ye,arguments);return n.length===0?gn(this):rr(this,function(i,s){return s.indexOf(i)!==-1},n,"")},Ve.prototype.startsWithAnyOfIgnoreCase=function(){var n=pe.apply(ye,arguments);return n.length===0?gn(this):rr(this,function(i,s){return s.some(function(a){return i.indexOf(a)===0})},n,$t)},Ve.prototype.anyOf=function(){var n=this,i=pe.apply(ye,arguments),s=this._cmp;try{i.sort(s)}catch{return nt(this,kt)}if(i.length===0)return gn(this);var a=new this.Collection(this,function(){return Tt(i[0],i[i.length-1])});a._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,i.sort(s)};var c=0;return a._addAlgorithm(function(d,m,v){for(var C=d.key;0<s(C,i[c]);)if(++c===i.length)return m(v),!1;return s(C,i[c])===0||(m(function(){d.continue(i[c])}),!1)}),a},Ve.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ve.prototype.noneOf=function(){var n=pe.apply(ye,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return nt(this,kt)}var i=n.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},Ve.prototype.inAnyRange=function(I,i){var s=this,a=this._cmp,c=this._ascending,d=this._descending,m=this._min,v=this._max;if(I.length===0)return gn(this);if(!I.every(function(R){return R[0]!==void 0&&R[1]!==void 0&&c(R[0],R[1])<=0}))return nt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var C=!i||i.includeLowers!==!1,x=i&&i.includeUppers===!0,O,b=c;function D(R,U){return b(R[0],U[0])}try{(O=I.reduce(function(R,U){for(var W=0,J=R.length;W<J;++W){var te=R[W];if(a(U[0],te[1])<0&&0<a(U[1],te[0])){te[0]=m(te[0],U[0]),te[1]=v(te[1],U[1]);break}}return W===J&&R.push(U),R},[])).sort(D)}catch{return nt(this,kt)}var E=0,k=x?function(R){return 0<c(R,O[E][1])}:function(R){return 0<=c(R,O[E][1])},M=C?function(R){return 0<d(R,O[E][0])}:function(R){return 0<=d(R,O[E][0])},_=k,I=new this.Collection(this,function(){return Tt(O[0][0],O[O.length-1][1],!C,!x)});return I._ondirectionchange=function(R){b=R==="next"?(_=k,c):(_=M,d),O.sort(D)},I._addAlgorithm(function(R,U,W){for(var J,te=R.key;_(te);)if(++E===O.length)return U(W),!1;return!k(J=te)&&!M(J)||(s._cmp(te,O[E][1])===0||s._cmp(te,O[E][0])===0||U(function(){b===c?R.continue(O[E][0]):R.continue(O[E][1])}),!1)}),I},Ve.prototype.startsWithAnyOf=function(){var n=pe.apply(ye,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?gn(this):this.inAnyRange(n.map(function(i){return[i,i+$t]})):nt(this,"startsWithAnyOf() only works with strings")},Ve);function Ve(){}function bt(n){return Ne(function(i){return On(i),n(i.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",qr="x-storagemutated-1",At=Mn(null,_n),va=(wt.prototype._lock=function(){return B(!me.global),++this._reculock,this._reculock!==1||me.global||(me.lockOwnerFor=this),this},wt.prototype._unlock=function(){if(B(!me.global),--this._reculock==0)for(me.global||(me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Zt(n[1],n[0])}catch{}}return this},wt.prototype._locked=function(){return this._reculock&&me.lockOwnerFor!==this},wt.prototype.create=function(n){var i=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(B(!this.idbtrans),!n&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(a);case"MissingAPIError":throw new ie.MissingAPI(a.message,a);default:throw new ie.OpenFailed(a)}if(!this.active)throw new ie.TransactionInactive;return B(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ne(function(c){On(c),i._reject(n.error)}),n.onabort=Ne(function(c){On(c),i.active&&i._reject(new ie.Abort(n.error)),i.active=!1,i.on("abort").fire(c)}),n.oncomplete=Ne(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&At.storagemutated.fire(n.mutatedParts)}),this},wt.prototype._promise=function(n,i,s){var a=this;if(n==="readwrite"&&this.mode!=="readwrite")return qe(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return qe(new ie.TransactionInactive);if(this._locked())return new oe(function(d,m){a._blockedFuncs.push([function(){a._promise(n,i,s).then(d,m)},me])});if(s)return It(function(){var d=new oe(function(m,v){a._lock();var C=i(m,v,a);C&&C.then&&C.then(m,v)});return d.finally(function(){return a._unlock()}),d._lib=!0,d});var c=new oe(function(d,m){var v=i(d,m,a);v&&v.then&&v.then(d,m)});return c._lib=!0,c},wt.prototype._root=function(){return this.parent?this.parent._root():this},wt.prototype.waitFor=function(n){var i,s=this._root(),a=oe.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],i=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(i.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new oe(function(d,m){a.then(function(v){return s._waitingQueue.push(Ne(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ne(m.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},wt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},wt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(y(i,n))return i[n];var s=this.schema[n];if(!s)throw new ie.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),i[n]=s},wt);function wt(){}function Wr(n,i,s,a,c,d,m,v){return{name:n,keyPath:i,unique:s,multi:a,auto:c,compound:d,src:(s&&!m?"&":"")+(a?"*":"")+(c?"++":"")+Ji(i),type:v}}function Ji(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Zr(n,i,s){return{name:n,primKey:i,indexes:s,mappedClass:null,idxByName:(a=function(c){return[c.name,c]},s.reduce(function(c,d,m){return m=a(d,m),m&&(c[m[0]]=m[1]),c},{}))};var a}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return $t},$t}};function $r(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(s){return s[i]}:function(s){return A(s,i)}:function(s){return A(s,n)};var i}function Xi(n){return[].slice.call(n)}var ya=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ba(n,i,C){function a(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=_.lower,k=_.upper,M=_.lowerOpen,_=_.upperOpen;return E===void 0?k===void 0?null:i.upperBound(k,!!_):k===void 0?i.lowerBound(E,!!M):i.bound(E,k,!!M,!!_)}function c(D){var E,k=D.name;return{name:k,schema:D,mutate:function(M){var _=M.trans,I=M.type,R=M.keys,U=M.values,W=M.range;return new Promise(function(J,te){J=Ne(J);var G=_.objectStore(k),X=G.keyPath==null,ne=I==="put"||I==="add";if(!ne&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var ee,he=(R||U||{length:1}).length;if(R&&U&&R.length!==U.length)throw new Error("Given keys array must have same length as given values array.");if(he===0)return J({numFailures:0,failures:{},results:[],lastResult:void 0});function Me(Qe){++rt,On(Qe)}var Oe=[],De=[],rt=0;if(I==="deleteRange"){if(W.type===4)return J({numFailures:rt,failures:De,results:[],lastResult:void 0});W.type===3?Oe.push(ee=G.clear()):Oe.push(ee=G.delete(a(W)))}else{var X=ne?X?[U,R]:[U,null]:[R,null],Se=X[0],Ye=X[1];if(ne)for(var Je=0;Je<he;++Je)Oe.push(ee=Ye&&Ye[Je]!==void 0?G[I](Se[Je],Ye[Je]):G[I](Se[Je])),ee.onerror=Me;else for(Je=0;Je<he;++Je)Oe.push(ee=G[I](Se[Je])),ee.onerror=Me}function gr(Qe){Qe=Qe.target.result,Oe.forEach(function(Yt,ci){return Yt.error!=null&&(De[ci]=Yt.error)}),J({numFailures:rt,failures:De,results:I==="delete"?R:Oe.map(function(Yt){return Yt.result}),lastResult:Qe})}ee.onerror=function(Qe){Me(Qe),gr(Qe)},ee.onsuccess=gr})},getMany:function(M){var _=M.trans,I=M.keys;return new Promise(function(R,U){R=Ne(R);for(var W,J=_.objectStore(k),te=I.length,G=new Array(te),X=0,ne=0,ee=function(Oe){Oe=Oe.target,G[Oe._pos]=Oe.result,++ne===X&&R(G)},he=bt(U),Me=0;Me<te;++Me)I[Me]!=null&&((W=J.get(I[Me]))._pos=Me,W.onsuccess=ee,W.onerror=he,++X);X===0&&R(G)})},get:function(M){var _=M.trans,I=M.key;return new Promise(function(R,U){R=Ne(R);var W=_.objectStore(k).get(I);W.onsuccess=function(J){return R(J.target.result)},W.onerror=bt(U)})},query:(E=x,function(M){return new Promise(function(_,I){_=Ne(_);var R,U,W,X=M.trans,J=M.values,te=M.limit,ee=M.query,G=te===1/0?void 0:te,ne=ee.index,ee=ee.range,X=X.objectStore(k),ne=ne.isPrimaryKey?X:X.index(ne.name),ee=a(ee);if(te===0)return _({result:[]});E?((G=J?ne.getAll(ee,G):ne.getAllKeys(ee,G)).onsuccess=function(he){return _({result:he.target.result})},G.onerror=bt(I)):(R=0,U=!J&&"openKeyCursor"in ne?ne.openKeyCursor(ee):ne.openCursor(ee),W=[],U.onsuccess=function(he){var Me=U.result;return Me?(W.push(J?Me.value:Me.primaryKey),++R===te?_({result:W}):void Me.continue()):_({result:W})},U.onerror=bt(I))})}),openCursor:function(M){var _=M.trans,I=M.values,R=M.query,U=M.reverse,W=M.unique;return new Promise(function(J,te){J=Ne(J);var ne=R.index,G=R.range,X=_.objectStore(k),X=ne.isPrimaryKey?X:X.index(ne.name),ne=U?W?"prevunique":"prev":W?"nextunique":"next",ee=!I&&"openKeyCursor"in X?X.openKeyCursor(a(G),ne):X.openCursor(a(G),ne);ee.onerror=bt(te),ee.onsuccess=Ne(function(he){var Me,Oe,De,rt,Se=ee.result;Se?(Se.___id=++ya,Se.done=!1,Me=Se.continue.bind(Se),Oe=(Oe=Se.continuePrimaryKey)&&Oe.bind(Se),De=Se.advance.bind(Se),rt=function(){throw new Error("Cursor not stopped")},Se.trans=_,Se.stop=Se.continue=Se.continuePrimaryKey=Se.advance=function(){throw new Error("Cursor not started")},Se.fail=Ne(te),Se.next=function(){var Ye=this,Je=1;return this.start(function(){return Je--?Ye.continue():Ye.stop()}).then(function(){return Ye})},Se.start=function(Ye){function Je(){if(ee.result)try{Ye()}catch(Qe){Se.fail(Qe)}else Se.done=!0,Se.start=function(){throw new Error("Cursor behind last entry")},Se.stop()}var gr=new Promise(function(Qe,Yt){Qe=Ne(Qe),ee.onerror=bt(Yt),Se.fail=Yt,Se.stop=function(ci){Se.stop=Se.continue=Se.continuePrimaryKey=Se.advance=rt,Qe(ci)}});return ee.onsuccess=Ne(function(Qe){ee.onsuccess=Je,Je()}),Se.continue=Me,Se.continuePrimaryKey=Oe,Se.advance=De,Je(),gr},J(Se)):J(null)},te)})},count:function(M){var _=M.query,I=M.trans,R=_.index,U=_.range;return new Promise(function(W,J){var te=I.objectStore(k),G=R.isPrimaryKey?te:te.index(R.name),te=a(U),G=te?G.count(te):G.count();G.onsuccess=Ne(function(X){return W(X.target.result)}),G.onerror=bt(J)})}}}var d,m,v,O=(m=C,v=Xi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(D){return m.objectStore(D)}).map(function(D){var E=D.keyPath,_=D.autoIncrement,k=h(E),M={},_={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:k,keyPath:E,autoIncrement:_,unique:!0,extractKey:$r(E)},indexes:Xi(D.indexNames).map(function(I){return D.index(I)}).map(function(W){var R=W.name,U=W.unique,J=W.multiEntry,W=W.keyPath,J={name:R,compound:h(W),keyPath:W,unique:U,multiEntry:J,extractKey:$r(W)};return M[In(W)]=J}),getIndexByKeyPath:function(I){return M[In(I)]}};return M[":id"]=_.primaryKey,E!=null&&(M[In(E)]=_.primaryKey),_})},hasGetAll:0<v.length&&"getAll"in m.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),C=O.schema,x=O.hasGetAll,O=C.tables.map(c),b={};return O.forEach(function(D){return b[D.name]=D}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(D){if(!b[D])throw new Error("Table '".concat(D,"' not found"));return b[D]},MIN_KEY:-1/0,MAX_KEY:Dn(i),schema:C}}function wa(n,i,s,a){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=ba(i,c,a),n.dbcore.reduce(function(d,m){return m=m.create,o(o({},d),m(d))},a))}}function ir(n,a){var s=a.db,a=wa(n._middlewares,s,n._deps,a);n.core=a.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(m){return m.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function or(n,i,s,a){s.forEach(function(c){var d=a[c];i.forEach(function(m){var v=(function C(x,O){return Z(x,O)||(x=L(x))&&C(x,O)})(m,c);(!v||"value"in v&&v.value===void 0)&&(m===n.Transaction.prototype||m instanceof n.Transaction?P(m,c,{get:function(){return this.table(c)},set:function(C){j(this,c,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):m[c]=new n.Table(c,d))})})}function Vr(n,i){i.forEach(function(s){for(var a in s)s[a]instanceof n.Table&&delete s[a]})}function La(n,i){return n._cfg.version-i._cfg.version}function Ca(n,i,s,a){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=Zr("$meta",eo("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(a);var m=d._reject.bind(d),v=me.transless||me;It(function(){return me.trans=d,me.transless=v,i!==0?(ir(n,s),x=i,((C=d).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(O){return O??x}):oe.resolve(x)).then(function(O){return D=O,E=d,k=s,M=[],O=(b=n)._versions,_=b._dbSchema=ar(0,b.idbdb,k),(O=O.filter(function(I){return I._cfg.version>=D})).length!==0?(O.forEach(function(I){M.push(function(){var R=_,U=I._cfg.dbschema;lr(b,R,k),lr(b,U,k),_=b._dbSchema=U;var W=Hr(R,U);W.add.forEach(function(ne){Gr(k,ne[0],ne[1].primKey,ne[1].indexes)}),W.change.forEach(function(ne){if(ne.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var ee=k.objectStore(ne.name);ne.add.forEach(function(he){return sr(ee,he)}),ne.change.forEach(function(he){ee.deleteIndex(he.name),sr(ee,he)}),ne.del.forEach(function(he){return ee.deleteIndex(he)})});var J=I._cfg.contentUpgrade;if(J&&I._cfg.version>D){ir(b,k),E._memoizedTables={};var te=se(U);W.del.forEach(function(ne){te[ne]=R[ne]}),Vr(b,[b.Transaction.prototype]),or(b,[b.Transaction.prototype],p(te),te),E.schema=te;var G,X=we(J);return X&&dn(),W=oe.follow(function(){var ne;(G=J(E))&&X&&(ne=jt.bind(null,null),G.then(ne,ne))}),G&&typeof G.then=="function"?oe.resolve(G):W.then(function(){return G})}}),M.push(function(R){var U,W,J=I._cfg.dbschema;U=J,W=R,[].slice.call(W.db.objectStoreNames).forEach(function(te){return U[te]==null&&W.db.deleteObjectStore(te)}),Vr(b,[b.Transaction.prototype]),or(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),E.schema=b._dbSchema}),M.push(function(R){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===I._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(U){return U!=="$meta"})):R.objectStore("$meta").put(I._cfg.version,"version"))})}),(function I(){return M.length?oe.resolve(M.shift()(E.idbtrans)).then(I):oe.resolve()})().then(function(){Qi(_,k)})):oe.resolve();var b,D,E,k,M,_}).catch(m)):(p(c).forEach(function(O){Gr(s,O,c[O].primKey,c[O].indexes)}),ir(n,s),void oe.follow(function(){return n.on.populate.fire(d)}).catch(m));var C,x})}function xa(n,i){Qi(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var s=ar(0,n.idbdb,i);lr(n,n._dbSchema,i);for(var a=0,c=Hr(s,n._dbSchema).change;a<c.length;a++){var d=(function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=i.objectStore(m.name);m.add.forEach(function(C){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(C.src)),sr(v,C)})})(c[a]);if(typeof d=="object")return d.value}}function Hr(n,i){var s,a={del:[],add:[],change:[]};for(s in n)i[s]||a.del.push(s);for(s in i){var c=n[s],d=i[s];if(c){var m={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)m.recreate=!0,a.change.push(m);else{var v=c.idxByName,C=d.idxByName,x=void 0;for(x in v)C[x]||m.del.push(x);for(x in C){var O=v[x],b=C[x];O?O.src!==b.src&&m.change.push(b):m.add.push(b)}(0<m.del.length||0<m.add.length||0<m.change.length)&&a.change.push(m)}}else a.add.push([s,d])}return a}function Gr(n,i,s,a){var c=n.db.createObjectStore(i,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(d){return sr(c,d)}),c}function Qi(n,i){p(n).forEach(function(s){i.db.objectStoreNames.contains(s)||(Xe&&console.debug("Dexie: Creating missing table",s),Gr(i,s,n[s].primKey,n[s].indexes))})}function sr(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function ar(n,i,s){var a={};return F(i.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),m=Wr(Ji(x=d.keyPath),x||"",!0,!1,!!d.autoIncrement,x&&typeof x!="string",!0),v=[],C=0;C<d.indexNames.length;++C){var O=d.index(d.indexNames[C]),x=O.keyPath,O=Wr(O.name,x,!!O.unique,!!O.multiEntry,!1,x&&typeof x!="string",!1);v.push(O)}a[c]=Zr(c,m,v)}),a}function lr(n,i,s){for(var a=s.db.objectStoreNames,c=0;c<a.length;++c){var d=a[c],m=s.objectStore(d);n._hasGetAll="getAll"in m;for(var v=0;v<m.indexNames.length;++v){var C=m.indexNames[v],x=m.index(C).keyPath,O=typeof x=="string"?x:"["+F(x).join("+")+"]";!i[d]||(x=i[d].idxByName[O])&&(x.name=C,delete i[d].idxByName[O],i[d].idxByName[C]=x)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function eo(n){return n.split(",").map(function(i,s){var d=i.split(":"),a=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(i=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Wr(c,d||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),h(d),s===0,a)})}var Ea=(mn.prototype._createTableSchema=Zr,mn.prototype._parseIndexSyntax=eo,mn.prototype._parseStoresSpec=function(n,i){var s=this;p(n).forEach(function(a){if(n[a]!==null){var c=s._parseIndexSyntax(n[a]),d=c.shift();if(!d)throw new ie.Schema("Invalid schema for table "+a+": "+n[a]);if(d.unique=!0,d.multi)throw new ie.Schema("Primary key cannot be multiEntry*");c.forEach(function(m){if(m.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!m.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(a,d,c),i[a]=c}})},mn.prototype.stores=function(s){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,s):s;var s=i._versions,a={},c={};return s.forEach(function(d){g(a,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(a,c)}),i._dbSchema=c,Vr(i,[i._allTables,i,i.Transaction.prototype]),or(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],p(c),c),i._storeNames=p(c),this},mn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=sn(this._cfg.contentUpgrade||H,n),this},mn);function mn(){}function Yr(n,i){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Mt(Xn,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Jr(n){return n&&typeof n.databases=="function"}function Xr(n){return It(function(){return me.letThrough=!0,n()})}function Qr(n){return!("from"in n)}var Ge=function(n,i){if(!this){var s=new Ge;return n&&"d"in n&&g(s,n),s}g(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function jn(n,i,s){var a=Ae(i,s);if(!isNaN(a)){if(0<a)throw RangeError();if(Qr(n))return g(n,{from:i,to:s,d:1});var c=n.l,a=n.r;if(Ae(s,n.from)<0)return c?jn(c,i,s):n.l={from:i,to:s,d:1,l:null,r:null},no(n);if(0<Ae(i,n.to))return a?jn(a,i,s):n.r={from:i,to:s,d:1,l:null,r:null},no(n);Ae(i,n.from)<0&&(n.from=i,n.l=null,n.d=a?a.d+1:1),0<Ae(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),a&&s&&Rn(n,a)}}function Rn(n,i){Qr(i)||(function s(a,C){var d=C.from,m=C.to,v=C.l,C=C.r;jn(a,d,m),v&&s(a,v),C&&s(a,C)})(n,i)}function to(n,i){var s=ur(i),a=s.next();if(a.done)return!1;for(var c=a.value,d=ur(n),m=d.next(c.from),v=m.value;!a.done&&!m.done;){if(Ae(v.from,c.to)<=0&&0<=Ae(v.to,c.from))return!0;Ae(c.from,v.from)<0?c=(a=s.next(v.from)).value:v=(m=d.next(c.from)).value}return!1}function ur(n){var i=Qr(n)?null:{s:0,n};return{next:function(s){for(var a=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,a)for(;i.n.l&&Ae(s,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!a||Ae(s,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function no(n){var i,s,a=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<a?"r":a<-1?"l":"";c&&(i=c=="r"?"l":"r",s=o({},n),a=n[c],n.from=a.from,n.to=a.to,n[c]=a[c],s[c]=a[i],(n[i]=s).d=ro(s)),n.d=ro(n)}function ro(s){var i=s.r,s=s.l;return(i?s?Math.max(i.d,s.d):i.d:s?s.d:0)+1}function cr(n,i){return p(i).forEach(function(s){n[s]?Rn(n[s],i[s]):n[s]=(function a(c){var d,m,v={};for(d in c)y(c,d)&&(m=c[d],v[d]=!m||typeof m!="object"||re.has(m.constructor)?m:a(m));return v})(i[s])}),n}function ei(n,i){return n.all||i.all||Object.keys(n).some(function(s){return i[s]&&to(i[s],n[s])})}S(Ge.prototype,((ut={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(s){return jn(i,s,s)}),this},hasKey:function(n){var i=ur(this).next(n).value;return i&&Ae(i.from,n)<=0&&0<=Ae(i.to,n)}})[de]=function(){return ur(this)},ut));var Ht={},ti={},ni=!1;function fr(n){cr(ti,n),ni||(ni=!0,setTimeout(function(){ni=!1,ri(ti,!(ti={}))},0))}function ri(n,i){i===void 0&&(i=!1);var s=new Set;if(n.all)for(var a=0,c=Object.values(Ht);a<c.length;a++)io(m=c[a],n,s,i);else for(var d in n){var m,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(m=Ht["idb://".concat(d,"/").concat(v)])&&io(m,n,s,i))}s.forEach(function(C){return C()})}function io(n,i,s,a){for(var c=[],d=0,m=Object.entries(n.queries.query);d<m.length;d++){for(var v=m[d],C=v[0],x=[],O=0,b=v[1];O<b.length;O++){var D=b[O];ei(i,D.obsSet)?D.subscribers.forEach(function(_){return s.add(_)}):a&&x.push(D)}a&&c.push([C,x])}if(a)for(var E=0,k=c;E<k.length;E++){var M=k[E],C=M[0],x=M[1];n.queries.query[C]=x}}function Sa(n){var i=n._state,s=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?qe(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var a=i.openCanceller,c=Math.round(10*n.verno),d=!1;function m(){if(i.openCanceller!==a)throw new ie.DatabaseClosed("db.open() was cancelled")}function v(){return new oe(function(D,E){if(m(),!s)throw new ie.MissingAPI;var k=n.name,M=i.autoSchema||!c?s.open(k):s.open(k,c);if(!M)throw new ie.MissingAPI;M.onerror=bt(E),M.onblocked=Ne(n._fireOnBlocked),M.onupgradeneeded=Ne(function(_){var I;O=M.transaction,i.autoSchema&&!n._options.allowEmptyDB?(M.onerror=On,O.abort(),M.result.close(),(I=s.deleteDatabase(k)).onsuccess=I.onerror=Ne(function(){E(new ie.NoSuchDatabase("Database ".concat(k," doesnt exist")))})):(O.onerror=bt(E),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,b=_<1,n.idbdb=M.result,d&&xa(n,O),Ca(n,_/10,O,E))},E),M.onsuccess=Ne(function(){O=null;var _,I,R,U,W,J=n.idbdb=M.result,te=F(J.objectStoreNames);if(0<te.length)try{var G=J.transaction((U=te).length===1?U[0]:U,"readonly");if(i.autoSchema)I=J,R=G,(_=n).verno=I.version/10,R=_._dbSchema=ar(0,I,R),_._storeNames=F(I.objectStoreNames,0),or(_,[_._allTables],p(R),R);else if(lr(n,n._dbSchema,G),((W=Hr(ar(0,(W=n).idbdb,G),W._dbSchema)).add.length||W.change.some(function(X){return X.add.length||X.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),J.close(),c=J.version+1,d=!0,D(v());ir(n,G)}catch{}pn.push(n),J.onversionchange=Ne(function(X){i.vcFired=!0,n.on("versionchange").fire(X)}),J.onclose=Ne(function(){n.close({disableAutoOpen:!1})}),b&&(W=n._deps,G=k,J=W.indexedDB,W=W.IDBKeyRange,Jr(J)||G===Xn||Yr(J,W).put({name:G}).catch(H)),D()},E)}).catch(function(D){switch(D?.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return oe.reject(D)})}var C,x=i.dbReadyResolve,O=null,b=!1;return oe.race([a,(typeof navigator>"u"?oe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function E(){return indexedDB.databases().finally(D)}C=setInterval(E,100),E()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(v)]).then(function(){return m(),i.onReadyBeingFired=[],oe.resolve(Xr(function(){return n.on.ready.fire(n.vip)})).then(function D(){if(0<i.onReadyBeingFired.length){var E=i.onReadyBeingFired.reduce(sn,H);return i.onReadyBeingFired=[],oe.resolve(Xr(function(){return E(n.vip)})).then(D)}})}).finally(function(){i.openCanceller===a&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(D){i.dbOpenError=D;try{O&&O.abort()}catch{}return a===i.openCanceller&&n._close(),qe(D)}).finally(function(){i.openComplete=!0,x()}).then(function(){var D;return b&&(D={},n.tables.forEach(function(E){E.schema.indexes.forEach(function(k){k.name&&(D["idb://".concat(n.name,"/").concat(E.name,"/").concat(k.name)]=new Ge(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(E.name,"/")]=D["idb://".concat(n.name,"/").concat(E.name,"/:dels")]=new Ge(-1/0,[[[]]])}),At(_n).fire(D),ri(D,!0)),n})}function ii(n){function i(d){return n.next(d)}var s=c(i),a=c(function(d){return n.throw(d)});function c(d){return function(C){var v=d(C),C=v.value;return v.done?C:C&&typeof C.then=="function"?C.then(s,a):h(C)?Promise.all(C).then(s,a):s(C)}}return c(i)()}function dr(n,i,s){for(var a=h(n)?n.slice():[n],c=0;c<s;++c)a.push(i);return a}var ka={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema,c={},d=[];function m(b,D,E){var k=In(b),M=c[k]=c[k]||[],_=b==null?0:typeof b=="string"?1:b.length,I=0<D,I=o(o({},E),{name:I?"".concat(k,"(virtual-from:").concat(E.name,")"):E.name,lowLevelIndex:E,isVirtual:I,keyTail:D,keyLength:_,extractKey:$r(b),unique:!I&&E.unique});return M.push(I),I.isPrimaryKey||d.push(I),1<_&&m(_===2?b[0]:b.slice(0,_-1),D+1,E),M.sort(function(R,U){return R.keyTail-U.keyTail}),I}i=m(a.primaryKey.keyPath,0,a.primaryKey),c[":id"]=[i];for(var v=0,C=a.indexes;v<C.length;v++){var x=C[v];m(x.keyPath,0,x)}function O(b){var D,E=b.query.index;return E.isVirtual?o(o({},b),{query:{index:E.lowLevelIndex,range:(D=b.query.range,E=E.keyTail,{type:D.type===1?2:D.type,lower:dr(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,E),lowerOpen:!0,upper:dr(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,E),upperOpen:!0})}}):b}return o(o({},s),{schema:o(o({},a),{primaryKey:i,indexes:d,getIndexByKeyPath:function(b){return(b=c[In(b)])&&b[0]}}),count:function(b){return s.count(O(b))},query:function(b){return s.query(O(b))},openCursor:function(b){var D=b.query.index,E=D.keyTail,k=D.isVirtual,M=D.keyLength;return k?s.openCursor(O(b)).then(function(I){return I&&_(I)}):s.openCursor(b);function _(I){return Object.create(I,{continue:{value:function(R){R!=null?I.continue(dr(R,b.reverse?n.MAX_KEY:n.MIN_KEY,E)):b.unique?I.continue(I.key.slice(0,M).concat(b.reverse?n.MIN_KEY:n.MAX_KEY,E)):I.continue()}},continuePrimaryKey:{value:function(R,U){I.continuePrimaryKey(dr(R,n.MAX_KEY,E),U)}},primaryKey:{get:function(){return I.primaryKey}},key:{get:function(){var R=I.key;return M===1?R[0]:R.slice(0,M)}},value:{get:function(){return I.value}}})}}})}})}};function oi(n,i,s,a){return s=s||{},a=a||"",p(n).forEach(function(c){var d,m,v;y(i,c)?(d=n[c],m=i[c],typeof d=="object"&&typeof m=="object"&&d&&m?(v=le(d))!==le(m)?s[a+c]=i[c]:v==="Object"?oi(d,m,s,a+c+"."):d!==m&&(s[a+c]=i[c]):d!==m&&(s[a+c]=i[c])):s[a+c]=void 0}),p(i).forEach(function(c){y(n,c)||(s[a+c]=i[c])}),s}function si(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var Ma={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var s=n.table(i),a=s.schema.primaryKey;return o(o({},s),{mutate:function(c){var d=me.trans,m=d.table(i).hook,v=m.deleting,C=m.creating,x=m.updating;switch(c.type){case"add":if(C.fire===H)break;return d._promise("readwrite",function(){return O(c)},!0);case"put":if(C.fire===H&&x.fire===H)break;return d._promise("readwrite",function(){return O(c)},!0);case"delete":if(v.fire===H)break;return d._promise("readwrite",function(){return O(c)},!0);case"deleteRange":if(v.fire===H)break;return d._promise("readwrite",function(){return(function b(D,E,k){return s.query({trans:D,values:!1,query:{index:a,range:E},limit:k}).then(function(M){var _=M.result;return O({type:"delete",keys:_,trans:D}).then(function(I){return 0<I.numFailures?Promise.reject(I.failures[0]):_.length<k?{failures:[],numFailures:0,lastResult:void 0}:b(D,o(o({},E),{lower:_[_.length-1],lowerOpen:!0}),k)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function O(b){var D,E,k,M=me.trans,_=b.keys||si(a,b);if(!_)throw new Error("Keys missing");return(b=b.type==="add"||b.type==="put"?o(o({},b),{keys:_}):o({},b)).type!=="delete"&&(b.values=u([],b.values)),b.keys&&(b.keys=u([],b.keys)),D=s,k=_,((E=b).type==="add"?Promise.resolve([]):D.getMany({trans:E.trans,keys:k,cache:"immutable"})).then(function(I){var R=_.map(function(U,W){var J,te,G,X=I[W],ne={onerror:null,onsuccess:null};return b.type==="delete"?v.fire.call(ne,U,X,M):b.type==="add"||X===void 0?(J=C.fire.call(ne,U,b.values[W],M),U==null&&J!=null&&(b.keys[W]=U=J,a.outbound||$(b.values[W],a.keyPath,U))):(J=oi(X,b.values[W]),(te=x.fire.call(ne,J,U,X,M))&&(G=b.values[W],Object.keys(te).forEach(function(ee){y(G,ee)?G[ee]=te[ee]:$(G,ee,te[ee])}))),ne});return s.mutate(b).then(function(U){for(var W=U.failures,J=U.results,te=U.numFailures,U=U.lastResult,G=0;G<_.length;++G){var X=(J||_)[G],ne=R[G];X==null?ne.onerror&&ne.onerror(W[G]):ne.onsuccess&&ne.onsuccess(b.type==="put"&&I[G]?b.values[G]:X)}return{failures:W,results:J,numFailures:te,lastResult:U}}).catch(function(U){return R.forEach(function(W){return W.onerror&&W.onerror(U)}),Promise.reject(U)})})}}})}})}};function oo(n,i,s){try{if(!i||i.keys.length<n.length)return null;for(var a=[],c=0,d=0;c<i.keys.length&&d<n.length;++c)Ae(i.keys[c],n[d])===0&&(a.push(s?Q(i.values[c]):i.values[c]),++d);return a.length===n.length?a:null}catch{return null}}var Pa={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var s=n.table(i);return o(o({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var c=oo(a.keys,a.trans._cache,a.cache==="clone");return c?oe.resolve(c):s.getMany(a).then(function(d){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?Q(d):d},d})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function so(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function ao(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Oa={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,s=new Ge(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(a,c,d){if(me.subscr&&c!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(me.querier));return n.transaction(a,c,d)},table:function(a){var c=n.table(a),d=c.schema,m=d.primaryKey,b=d.indexes,v=m.extractKey,C=m.outbound,x=m.autoIncrement&&b.filter(function(E){return E.compound&&E.keyPath.includes(m.keyPath)}),O=o(o({},c),{mutate:function(E){function k(ee){return ee="idb://".concat(i,"/").concat(a,"/").concat(ee),U[ee]||(U[ee]=new Ge)}var M,_,I,R=E.trans,U=E.mutatedParts||(E.mutatedParts={}),W=k(""),J=k(":dels"),te=E.type,ne=E.type==="deleteRange"?[E.range]:E.type==="delete"?[E.keys]:E.values.length<50?[si(m,E).filter(function(ee){return ee}),E.values]:[],G=ne[0],X=ne[1],ne=E.trans._cache;return h(G)?(W.addKeys(G),(ne=te==="delete"||G.length===X.length?oo(G,ne):null)||J.addKeys(G),(ne||X)&&(M=k,_=ne,I=X,d.indexes.forEach(function(ee){var he=M(ee.name||"");function Me(De){return De!=null?ee.extractKey(De):null}function Oe(De){return ee.multiEntry&&h(De)?De.forEach(function(rt){return he.addKey(rt)}):he.addKey(De)}(_||I).forEach(function(De,Ye){var Se=_&&Me(_[Ye]),Ye=I&&Me(I[Ye]);Ae(Se,Ye)!==0&&(Se!=null&&Oe(Se),Ye!=null&&Oe(Ye))})}))):G?(X={from:(X=G.lower)!==null&&X!==void 0?X:n.MIN_KEY,to:(X=G.upper)!==null&&X!==void 0?X:n.MAX_KEY},J.add(X),W.add(X)):(W.add(s),J.add(s),d.indexes.forEach(function(ee){return k(ee.name).add(s)})),c.mutate(E).then(function(ee){return!G||E.type!=="add"&&E.type!=="put"||(W.addKeys(ee.results),x&&x.forEach(function(he){for(var Me=E.values.map(function(Se){return he.extractKey(Se)}),Oe=he.keyPath.findIndex(function(Se){return Se===m.keyPath}),De=0,rt=ee.results.length;De<rt;++De)Me[De][Oe]=ee.results[De];k(he.name).addKeys(Me)})),R.mutatedParts=cr(R.mutatedParts||{},U),ee})}}),b=function(k){var M=k.query,k=M.index,M=M.range;return[k,new Ge((k=M.lower)!==null&&k!==void 0?k:n.MIN_KEY,(M=M.upper)!==null&&M!==void 0?M:n.MAX_KEY)]},D={get:function(E){return[m,new Ge(E.key)]},getMany:function(E){return[m,new Ge().addKeys(E.keys)]},count:b,query:b,openCursor:b};return p(D).forEach(function(E){O[E]=function(k){var M=me.subscr,_=!!M,I=so(me,c)&&ao(E,k)?k.obsSet={}:M;if(_){var R=function(X){return X="idb://".concat(i,"/").concat(a,"/").concat(X),I[X]||(I[X]=new Ge)},U=R(""),W=R(":dels"),M=D[E](k),_=M[0],M=M[1];if((E==="query"&&_.isPrimaryKey&&!k.values?W:R(_.name||"")).add(M),!_.isPrimaryKey){if(E!=="count"){var J=E==="query"&&C&&k.values&&c.query(o(o({},k),{values:!1}));return c[E].apply(this,arguments).then(function(X){if(E==="query"){if(C&&k.values)return J.then(function(Me){return Me=Me.result,U.addKeys(Me),X});var ne=k.values?X.result.map(v):X.result;(k.values?U:W).addKeys(ne)}else if(E==="openCursor"){var ee=X,he=k.values;return ee&&Object.create(ee,{key:{get:function(){return W.addKey(ee.primaryKey),ee.key}},primaryKey:{get:function(){var Me=ee.primaryKey;return W.addKey(Me),Me}},value:{get:function(){return he&&U.addKey(ee.primaryKey),ee.value}}})}return X})}W.add(s)}}return c[E].apply(this,arguments)}}),O}})}};function lo(n,i,s){if(s.numFailures===0)return i;if(i.type==="deleteRange")return null;var a=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return s.numFailures===a?null:(i=o({},i),h(i.keys)&&(i.keys=i.keys.filter(function(c,d){return!(d in s.failures)})),"values"in i&&h(i.values)&&(i.values=i.values.filter(function(c,d){return!(d in s.failures)})),i)}function ai(n,i){return s=n,((a=i).lower===void 0||(a.lowerOpen?0<Ae(s,a.lower):0<=Ae(s,a.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Ae(n,i.upper)<0:Ae(n,i.upper)<=0));var s,a}function uo(n,i,D,a,c,d){if(!D||D.length===0)return n;var m=i.query.index,v=m.multiEntry,C=i.query.range,x=a.schema.primaryKey.extractKey,O=m.extractKey,b=(m.lowLevelIndex||m).extractKey,D=D.reduce(function(E,k){var M=E,_=[];if(k.type==="add"||k.type==="put")for(var I=new Ge,R=k.values.length-1;0<=R;--R){var U,W=k.values[R],J=x(W);I.hasKey(J)||(U=O(W),(v&&h(U)?U.some(function(ee){return ai(ee,C)}):ai(U,C))&&(I.addKey(J),_.push(W)))}switch(k.type){case"add":var te=new Ge().addKeys(i.values?E.map(function(he){return x(he)}):E),M=E.concat(i.values?_.filter(function(he){return he=x(he),!te.hasKey(he)&&(te.addKey(he),!0)}):_.map(function(he){return x(he)}).filter(function(he){return!te.hasKey(he)&&(te.addKey(he),!0)}));break;case"put":var G=new Ge().addKeys(k.values.map(function(he){return x(he)}));M=E.filter(function(he){return!G.hasKey(i.values?x(he):he)}).concat(i.values?_:_.map(function(he){return x(he)}));break;case"delete":var X=new Ge().addKeys(k.keys);M=E.filter(function(he){return!X.hasKey(i.values?x(he):he)});break;case"deleteRange":var ne=k.range;M=E.filter(function(he){return!ai(x(he),ne)})}return M},n);return D===n?n:(D.sort(function(E,k){return Ae(b(E),b(k))||Ae(x(E),x(k))}),i.limit&&i.limit<1/0&&(D.length>i.limit?D.length=i.limit:n.length===i.limit&&D.length<i.limit&&(c.dirty=!0)),d?Object.freeze(D):D)}function co(n,i){return Ae(n.lower,i.lower)===0&&Ae(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function _a(n,i){return(function(s,a,c,d){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=Ae(s,a))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return a})(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=(function(s,a,c,d){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=Ae(s,a))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return a})(n.upper,i.upper,n.upperOpen,i.upperOpen)}function Da(n,i,s,a){n.subscribers.add(s),a.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=i,setTimeout(function(){c.subscribers.size===0&&ve(d,c)},3e3))})}var Ia={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(s,a,c){var d,m,v=n.transaction(s,a,c);return a==="readwrite"&&(m=(d=new AbortController).signal,c=function(C){return function(){if(d.abort(),a==="readwrite"){for(var x=new Set,O=0,b=s;O<b.length;O++){var D=b[O],E=Ht["idb://".concat(i,"/").concat(D)];if(E){var k=n.table(D),M=E.optimisticOps.filter(function(he){return he.trans===v});if(v._explicit&&C&&v.mutatedParts)for(var _=0,I=Object.values(E.queries.query);_<I.length;_++)for(var R=0,U=(te=I[_]).slice();R<U.length;R++)ei((G=U[R]).obsSet,v.mutatedParts)&&(ve(te,G),G.subscribers.forEach(function(he){return x.add(he)}));else if(0<M.length){E.optimisticOps=E.optimisticOps.filter(function(he){return he.trans!==v});for(var W=0,J=Object.values(E.queries.query);W<J.length;W++)for(var te,G,X,ne=0,ee=(te=J[W]).slice();ne<ee.length;ne++)(G=ee[ne]).res!=null&&v.mutatedParts&&(C&&!G.dirty?(X=Object.isFrozen(G.res),X=uo(G.res,G.req,M,k,G,X),G.dirty?(ve(te,G),G.subscribers.forEach(function(he){return x.add(he)})):X!==G.res&&(G.res=X,G.promise=oe.resolve({result:X}))):(G.dirty&&ve(te,G),G.subscribers.forEach(function(he){return x.add(he)})))}}}x.forEach(function(he){return he()})}}},v.addEventListener("abort",c(!1),{signal:m}),v.addEventListener("error",c(!1),{signal:m}),v.addEventListener("complete",c(!0),{signal:m})),v},table:function(s){var a=n.table(s),c=a.schema.primaryKey;return o(o({},a),{mutate:function(d){var m=me.trans;if(c.outbound||m.db._options.cache==="disabled"||m.explicit||m.idbtrans.mode!=="readwrite")return a.mutate(d);var v=Ht["idb://".concat(i,"/").concat(s)];return v?(m=a.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||si(c,d).some(function(C){return C==null}))?(v.optimisticOps.push(d),d.mutatedParts&&fr(d.mutatedParts),m.then(function(C){0<C.numFailures&&(ve(v.optimisticOps,d),(C=lo(0,d,C))&&v.optimisticOps.push(C),d.mutatedParts&&fr(d.mutatedParts))}),m.catch(function(){ve(v.optimisticOps,d),d.mutatedParts&&fr(d.mutatedParts)})):m.then(function(C){var x=lo(0,o(o({},d),{values:d.values.map(function(O,b){var D;return C.failures[b]?O:(O=(D=c.keyPath)!==null&&D!==void 0&&D.includes(".")?Q(O):o({},O),$(O,c.keyPath,C.results[b]),O)})}),C);v.optimisticOps.push(x),queueMicrotask(function(){return d.mutatedParts&&fr(d.mutatedParts)})}),m):a.mutate(d)},query:function(d){if(!so(me,a)||!ao("query",d))return a.query(d);var m=((x=me.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",b=me,v=b.requery,C=b.signal,x=(function(k,M,_,I){var R=Ht["idb://".concat(k,"/").concat(M)];if(!R)return[];if(!(M=R.queries[_]))return[null,!1,R,null];var U=M[(I.query?I.query.index.name:null)||""];if(!U)return[null,!1,R,null];switch(_){case"query":var W=U.find(function(J){return J.req.limit===I.limit&&J.req.values===I.values&&co(J.req.query.range,I.query.range)});return W?[W,!0,R,U]:[U.find(function(J){return("limit"in J.req?J.req.limit:1/0)>=I.limit&&(!I.values||J.req.values)&&_a(J.req.query.range,I.query.range)}),!1,R,U];case"count":return W=U.find(function(J){return co(J.req.query.range,I.query.range)}),[W,!!W,R,U]}})(i,s,"query",d),O=x[0],b=x[1],D=x[2],E=x[3];return O&&b?O.obsSet=d.obsSet:(b=a.query(d).then(function(k){var M=k.result;if(O&&(O.res=M),m){for(var _=0,I=M.length;_<I;++_)Object.freeze(M[_]);Object.freeze(M)}else k.result=Q(M);return k}).catch(function(k){return E&&O&&ve(E,O),Promise.reject(k)}),O={obsSet:d.obsSet,promise:b,subscribers:new Set,type:"query",req:d,dirty:!1},E?E.push(O):(E=[O],(D=D||(Ht["idb://".concat(i,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=E)),Da(O,E,v,C),O.promise.then(function(k){return{result:uo(k.result,d,D?.optimisticOps,a,O,m)}})}})}})}};function pr(n,i){return new Proxy(n,{get:function(s,a,c){return a==="db"?i:Reflect.get(s,a,c)}})}var Mt=(We.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ie.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,s=i.filter(function(a){return a._cfg.version===n})[0];return s||(s=new this.Version(n),i.push(s),i.sort(La),s.stores({}),this._state.autoSchema=!1,s)},We.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||me.letThrough||this._vip)?n():new oe(function(s,a){if(i._state.openComplete)return a(new ie.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void a(new ie.DatabaseClosed);i.open().catch(H)}i._state.dbReadyPromise.then(s,a)}).then(n)},We.prototype.use=function(n){var i=n.stack,s=n.create,a=n.level,c=n.name;return c&&this.unuse({stack:i,name:c}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:s,level:a??10,name:c}),n.sort(function(d,m){return d.level-m.level}),this},We.prototype.unuse=function(n){var i=n.stack,s=n.name,a=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return a?c.create!==a:!!s&&c.name!==s})),this},We.prototype.open=function(){var n=this;return Zt(tt,function(){return Sa(n)})},We.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,i=pn.indexOf(this);if(0<=i&&pn.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new oe(function(s){n.dbReadyResolve=s}),n.openCanceller=new oe(function(s,a){n.cancelOpen=a}))},We.prototype.close=function(s){var i=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;i?(s.isBeingOpened&&s.cancelOpen(new ie.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new ie.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},We.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new oe(function(c,d){function m(){i.close(n);var v=i._deps.indexedDB.deleteDatabase(i.name);v.onsuccess=Ne(function(){var C,x,O;C=i._deps,x=i.name,O=C.indexedDB,C=C.IDBKeyRange,Jr(O)||x===Xn||Yr(O,C).delete(x).catch(H),c()}),v.onerror=bt(d),v.onblocked=i._fireOnBlocked}if(s)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(m):m()})},We.prototype.backendDB=function(){return this.idbdb},We.prototype.isOpen=function(){return this.idbdb!==null},We.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},We.prototype.hasFailed=function(){return this._state.dbOpenError!==null},We.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(We.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),We.prototype.transaction=function(){var n=(function(i,s,a){var c=arguments.length;if(c<2)throw new ie.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return a=d.pop(),[i,V(d),a]}).apply(this,arguments);return this._transaction.apply(this,n)},We.prototype._transaction=function(n,i,s){var a=this,c=me.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,m,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(m=i.map(function(x){if(x=x instanceof a.Table?x.name:x,typeof x!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return x}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Ur)throw new ie.InvalidArgument("Invalid transaction mode: "+n);d=Ur}if(c){if(c.mode===Fr&&d===Ur){if(!v)throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&m.forEach(function(x){if(c&&c.storeNames.indexOf(x)===-1){if(!v)throw new ie.SubTransaction("Table "+x+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(x){return c?c._promise(null,function(O,b){b(x)}):qe(x)}var C=(function x(O,b,D,E,k){return oe.resolve().then(function(){var M=me.transless||me,_=O._createTransaction(b,D,O._dbSchema,E);if(_.explicit=!0,M={trans:_,transless:M},E)_.idbtrans=E.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(U){return U.name===Ue.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,b,D,null,k)})):qe(U)}var I,R=we(k);return R&&dn(),M=oe.follow(function(){var U;(I=k.call(_,_))&&(R?(U=jt.bind(null,null),I.then(U,U)):typeof I.next=="function"&&typeof I.throw=="function"&&(I=ii(I)))},M),(I&&typeof I.then=="function"?oe.resolve(I).then(function(U){return _.active?U:qe(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):M.then(function(){return I})).then(function(U){return E&&_._resolve(),_._completion.then(function(){return U})}).catch(function(U){return _._reject(U),qe(U)})})}).bind(null,this,d,m,c,s);return c?c._promise(d,C,"lock"):me.trans?Zt(me.transless,function(){return a._whenReady(C)}):this._whenReady(C)},We.prototype.table=function(n){if(!y(this._allTables,n))throw new ie.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},We);function We(n,i){var s=this;this._middlewares={},this.verno=0;var a=We.dependencies;this._options=i=o({addons:We.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},a=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,m,v,C,x={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:H,dbReadyPromise:null,cancelOpen:H,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};x.dbReadyPromise=new oe(function(b){x.dbReadyResolve=b}),x.openCanceller=new oe(function(b,D){x.cancelOpen=D}),this._state=x,this.name=n,this.on=Mn(this,"populate","blocked","versionchange","close",{ready:[sn,H]}),this.once=function(b,D){var E=function(){for(var k=[],M=0;M<arguments.length;M++)k[M]=arguments[M];s.on(b).unsubscribe(E),D.apply(s,k)};return s.on(b,E)},this.on.ready.subscribe=ae(this.on.ready.subscribe,function(b){return function(D,E){We.vip(function(){var k,M=s._state;M.openComplete?(M.dbOpenError||oe.resolve().then(D),E&&b(D)):M.onReadyBeingFired?(M.onReadyBeingFired.push(D),E&&b(D)):(b(D),k=s,E||b(function _(){k.on.ready.unsubscribe(D),k.on.ready.unsubscribe(_)}))})}}),this.Collection=(c=this,Pn(ha.prototype,function(I,_){this.db=c;var E=Fi,k=null;if(_)try{E=_()}catch(R){k=R}var M=I._ctx,_=M.table,I=_.hook.reading.fire;this._ctx={table:_,index:M.index,isPrimKey:!M.index||_.schema.primKey.keyPath&&M.index===_.schema.primKey.name,range:E,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:k,or:M.or,valueMapper:I!==Be?I:null}})),this.Table=(d=this,Pn(Zi.prototype,function(b,D,E){this.db=d,this._tx=E,this.name=b,this.schema=D,this.hook=d._allTables[b]?d._allTables[b].hook:Mn(null,{creating:[Zn,H],reading:[et,Be],updating:[$n,H],deleting:[rn,H]})})),this.Transaction=(m=this,Pn(va.prototype,function(b,D,E,k,M){var _=this;b!=="readonly"&&D.forEach(function(I){I=(I=E[I])===null||I===void 0?void 0:I.yProps,I&&(D=D.concat(I.map(function(R){return R.updatesTable})))}),this.db=m,this.mode=b,this.storeNames=D,this.schema=E,this.chromeTransactionDurability=k,this.idbtrans=null,this.on=Mn(this,"complete","error","abort"),this.parent=M||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new oe(function(I,R){_._resolve=I,_._reject=R}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(I){var R=_.active;return _.active=!1,_.on.error.fire(I),_.parent?_.parent._reject(I):R&&_.idbtrans&&_.idbtrans.abort(),qe(I)})})),this.Version=(v=this,Pn(Ea.prototype,function(b){this.db=v,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(C=this,Pn(Yi.prototype,function(b,D,E){if(this.db=C,this._ctx={table:b,index:D===":id"?null:D,or:E},this._cmp=this._ascending=Ae,this._descending=function(k,M){return Ae(M,k)},this._max=function(k,M){return 0<Ae(k,M)?k:M},this._min=function(k,M){return Ae(k,M)<0?k:M},this._IDBKeyRange=C._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=Dn(i.IDBKeyRange),this._createTransaction=function(b,D,E,k){return new s.Transaction(b,D,E,s._options.chromeTransactionDurability,k)},this._fireOnBlocked=function(b){s.on("blocked").fire(b),pn.filter(function(D){return D.name===s.name&&D!==s&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(b)})},this.use(Pa),this.use(Ia),this.use(Oa),this.use(ka),this.use(Ma);var O=new Proxy(this,{get:function(b,D,E){if(D==="_vip")return!0;if(D==="table")return function(M){return pr(s.table(M),O)};var k=Reflect.get(b,D,E);return k instanceof Zi?pr(k,O):D==="tables"?k.map(function(M){return pr(M,O)}):D==="_createTransaction"?function(){return pr(k.apply(this,arguments),O)}:k}});this.vip=O,a.forEach(function(b){return b(s)})}var hr,ut=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ja=(li.prototype.subscribe=function(n,i,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:s})},li.prototype[ut]=function(){return this},li);function li(n){this._subscribe=n}try{hr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{hr={indexedDB:null,IDBKeyRange:null}}function fo(n){var i,s=!1,a=new ja(function(c){var d=we(n),m,v=!1,C={},x={},O={get closed(){return v},unsubscribe:function(){v||(v=!0,m&&m.abort(),b&&At.storagemutated.unsubscribe(E))}};c.start&&c.start(O);var b=!1,D=function(){return zr(k)},E=function(M){cr(C,M),ei(x,C)&&D()},k=function(){var M,_,I;!v&&hr.indexedDB&&(C={},M={},m&&m.abort(),m=new AbortController,I=(function(R){var U=Et();try{d&&dn();var W=It(n,R);return W=d?W.finally(jt):W}finally{U&&Dt()}})(_={subscr:M,signal:m.signal,requery:D,querier:n,trans:null}),Promise.resolve(I).then(function(R){s=!0,i=R,v||_.signal.aborted||(C={},(function(U){for(var W in U)if(y(U,W))return;return 1})(x=M)||b||(At(_n,E),b=!0),zr(function(){return!v&&c.next&&c.next(R)}))},function(R){s=!1,["DatabaseClosedError","AbortError"].includes(R?.name)||v||zr(function(){v||c.error&&c.error(R)})}))};return setTimeout(D,0),O});return a.hasValue=function(){return s},a.getValue=function(){return i},a}var Gt=Mt;function ui(n){var i=Bt;try{Bt=!0,At.storagemutated.fire(n),ri(n,!0)}finally{Bt=i}}S(Gt,o(o({},_e),{delete:function(n){return new Gt(n,{addons:[]}).delete()},exists:function(n){return new Gt(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=Gt.dependencies,s=i.indexedDB,i=i.IDBKeyRange,(Jr(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(c){return c.name}).filter(function(c){return c!==Xn})}):Yr(s,i).toCollection().primaryKeys()).then(n)}catch{return qe(new ie.MissingAPI)}var i,s},defineClass:function(){return function(n){g(this,n)}},ignoreTransaction:function(n){return me.trans?Zt(me.transless,n):n()},vip:Xr,async:function(n){return function(){try{var i=ii(n.apply(this,arguments));return i&&typeof i.then=="function"?i:oe.resolve(i)}catch(s){return qe(s)}}},spawn:function(n,i,s){try{var a=ii(n.apply(s,i||[]));return a&&typeof a.then=="function"?a:oe.resolve(a)}catch(c){return qe(c)}},currentTransaction:{get:function(){return me.trans||null}},waitFor:function(n,i){return i=oe.resolve(typeof n=="function"?Gt.ignoreTransaction(n):n).timeout(i||6e4),me.trans?me.trans.waitFor(i):i},Promise:oe,debug:{get:function(){return Xe},set:function(n){Cn(n)}},derive:K,extend:g,props:S,override:ae,Events:Mn,on:At,liveQuery:fo,extendObservabilitySet:cr,getByKeyPath:A,setByKeyPath:$,delByKeyPath:function(n,i){typeof i=="string"?$(n,i,void 0):"length"in i&&[].map.call(i,function(s){$(n,s,void 0)})},shallowClone:se,deepClone:Q,getObjectDiff:oi,cmp:Ae,asap:T,minKey:-1/0,addons:[],connections:pn,errnames:Ue,dependencies:hr,cache:Ht,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,s){return n+i/Math.pow(10,2*s)})})),Gt.maxKey=Dn(Gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(At(_n,function(n){Bt||(n=new CustomEvent(qr,{detail:n}),Bt=!0,dispatchEvent(n),Bt=!1)}),addEventListener(qr,function(n){n=n.detail,Bt||ui(n)}));var vn,Bt=!1,po=function(){};return typeof BroadcastChannel<"u"&&((po=function(){(vn=new BroadcastChannel(qr)).onmessage=function(n){return n.data&&ui(n.data)}})(),typeof vn.unref=="function"&&vn.unref(),At(_n,function(n){Bt||vn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Mt.disableBfCache&&n.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),vn?.close();for(var i=0,s=pn;i<s.length;i++)s[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Mt.disableBfCache&&n.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),po(),ui({all:new Ge(-1/0,[[]])}))})),oe.rejectionMapper=function(n,i){return!n||n instanceof fe||n instanceof TypeError||n instanceof SyntaxError||!n.name||!be[n.name]?n:(i=new be[n.name](i||n.message,n),"stack"in n&&P(i,"stack",{get:function(){return this.inner.stack}}),i)},Cn(Xe),o(Mt,Object.freeze({__proto__:null,Dexie:Mt,liveQuery:fo,Entity:Ui,cmp:Ae,PropModification:kn,replacePrefix:function(n,i){return new kn({replacePrefix:[n,i]})},add:function(n){return new kn({add:n})},remove:function(n){return new kn({remove:n})},default:Mt,RangeSet:Ge,mergeRanges:Rn,rangesOverlap:to}),{default:Mt}),Mt})})(Lr)),Lr.exports}var tc=ec();const Mi=Ta(tc),Us=Symbol.for("Dexie"),Rr=globalThis[Us]||(globalThis[Us]=Mi);if(Mi.semVer!==Rr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Mi.semVer} and ${Rr.semVer}`);const{liveQuery:Pc,mergeRanges:Oc,rangesOverlap:_c,RangeSet:Dc,cmp:Ic,Entity:jc,PropModification:Rc,replacePrefix:Tc,add:Ac,remove:Bc,DexieYProvider:zc}=Rr,ot=new Rr("ChillGameDB");ot.version(1).stores({exploredCells:"id",claimedCells:"id",gameState:"key"});ot.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const Ks=5e-4,He=zu(Xu((t,e)=>({clouds:10,claimedCells:{},exploredCells:{},selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,o,u,f]=await Promise.all([ot.exploredCells.toArray(),ot.claimedCells.toArray(),ot.gameState.get("clouds"),ot.gameState.get("lastCloudIncrease")]),p={};r.forEach(g=>{p[g.id]=!0});const h={};o.forEach(g=>{h[g.id]=g.data}),t(g=>{g.exploredCells=p,g.claimedCells=h,g.clouds=u?u.value:10,g.lastCloudIncrease=f?f.value:Date.now(),g.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(o=>{o.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(o=>{o.clouds<10&&(o.clouds+=1,o.lastCloudIncrease=r)}),ot.gameState.put({key:"clouds",value:e().clouds}).catch(o=>console.error("Failed to put clouds state:",o)),ot.gameState.put({key:"lastCloudIncrease",value:r}).catch(o=>console.error("Failed to put lastCloudIncrease state:",o))},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:o,longitude:u}=r.coords;t(f=>{f.userLocation={lat:o,lng:u};const p=Math.floor(o/Ks),h=Math.floor(u/Ks),g=e().exploredCells;let L=!1;const w=2,y=[];for(let S=-w;S<=w;S++)for(let j=-w;j<=w;j++)if(S*S+j*j<=w*w){const P=`${p+S}_${h+j}`;g[P]||(f.exploredCells[P]=!0,y.push({id:P}),L=!0)}L&&y.length>0&&ot.exploredCells.bulkAdd(y).catch(S=>console.error("Failed to bulkAdd explored cells:",S))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const o=e().selectedCell,u=e().claimedCells;!r||o&&o.key===r.key||u[r.key]?t({selectedCell:null}):t({selectedCell:r})},updateSelectedCellInfo:r=>{t(o=>{o.selectedCell&&(o.selectedCell={...o.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:o,exploredCells:u}=e();if(!r)return"no-cell";if(o<=0)return"no-clouds";const{key:f}=r,p={owner:"user",color:"#3B82F6"},[h,g]=f.split("_").map(Number),L=[],w=1;for(let y=-w;y<=w;y++)for(let S=-w;S<=w;S++){const j=`${h+y}_${g+S}`;u[j]||L.push({id:j})}return t(y=>{y.clouds-=1,y.claimedCells[f]=p,L.forEach(S=>{y.exploredCells[S.id]=!0}),y.selectedCell=null}),ot.claimedCells.put({id:f,data:p}).catch(y=>console.error("Failed to put claimed cell:",y)),ot.gameState.put({key:"clouds",value:e().clouds}).catch(y=>console.error("Failed to put clouds state:",y)),L.length>0&&ot.exploredCells.bulkAdd(L).catch(y=>console.error("Failed to bulkAdd explored cells:",y)),"claimed"},register:()=>{t({clouds:10}),ot.gameState.put({key:"clouds",value:10}).catch(r=>console.error("Failed to put clouds state on register:",r))}}))),nc="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Ns=new Audio(nc),Pi=()=>{Ns.currentTime=0,Ns.play().catch(t=>{console.error("Audio playback failed:",t)})},it={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},rc=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:o})=>{const{countryName:u,regionName:f,flagUrl:p,isLoading:h}=t;He(w=>w.clouds);const g=w=>{w.stopPropagation(),Pi(),e()},L=w=>{w.stopPropagation(),Pi(),r()};return ue.jsxs("div",{style:it.container,onClick:w=>w.stopPropagation(),children:[ue.jsx("button",{style:it.closeButton,onClick:L,children:"×"}),ue.jsx("div",{style:it.header,children:h?ue.jsx("div",{style:it.loader}):ue.jsxs(ue.Fragment,{children:[p&&ue.jsx("img",{src:p,alt:"Flag",style:it.flag}),ue.jsxs("div",{style:it.location,children:[ue.jsx("span",{style:it.country,children:u}),ue.jsx("span",{style:it.region,children:f}),ue.jsxs("span",{style:it.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),ue.jsxs("div",{style:it.body,children:[ue.jsx("p",{style:it.text,children:"Do you want to claim this area?"}),ue.jsxs("button",{style:it.claimButton,onClick:g,disabled:o,children:[ue.jsx("span",{style:it.cloudIcon,children:"☁️"}),"Claim"]})]})]})},ca=l.memo(rc),yi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},ic=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,oc=()=>(en.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=ic,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),sc=({position:t})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(oc,{}),ue.jsx(Wt,{position:t,mapPaneName:Wt.MARKER_LAYER,children:ue.jsxs("div",{style:yi.pulseContainer,children:[ue.jsx("div",{style:yi.pulse}),ue.jsx("div",{style:yi.dot})]})})]}),ac=l.memo(sc),Nt=(t,e,r,o=null,u=null)=>new Promise(f=>{u&&u(!0);const p=t.getCenter(),h=t.getZoom(),g=Date.now(),L=()=>{const w=Date.now(),y=Math.min((w-g)/r,1),S=y*y*(3-2*y),j={lat:p.lat()+(e.lat-p.lat())*S,lng:p.lng()+(e.lng-p.lng())*S},P=o!==null?h+(o-h)*S:h;t.moveCamera({center:j,zoom:P}),y<1?requestAnimationFrame(L):(u&&u(!1),f())};L()}),Ft=5e-4,lc={width:"100%",height:"100%"},uc={position:"absolute",inset:"0px",width:"100%",height:"100%"},cc=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],fc=({center:t,onSelectCell:e,claimedCells:r,exploredCells:o,setMapRef:u,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:g,onZoomOutLimit:L,effects:w})=>{const[y,S]=l.useState(null),[j,P]=l.useState(15),[K,Z]=l.useState(null),Y=l.useRef(null),F=l.useRef(!1),ae=l.useRef(null),B=150,[T,A]=l.useState(!1),$=l.useCallback(Q=>{Z(Q),u(Q)},[u]),se=l.useCallback(()=>{if(!K||!F.current)return;const Q=K.getZoom(),ce=K.getCenter();Q<=5&&L(),f(Q),p({lat:ce.lat(),lng:ce.lng()}),P(Q)},[K,f,p,L]);l.useEffect(()=>{(async()=>{K&&t&&!F.current&&(await Nt(K,t,2e3,15,A),F.current=!0,se())})()},[K,t,se,A]);const N=l.useCallback(Q=>{Y.current||(Y.current=setTimeout(()=>{if(Y.current=null,j<15){y&&S(null);return}const ce=`${Math.floor(Q.latLng.lat()/Ft)}_${Math.floor(Q.latLng.lng()/Ft)}`;ce!==y&&S(ce)},50))},[j,y,S]),V=l.useCallback(()=>{S(null)},[S]),re=l.useCallback(Q=>{if(j<15){e(null,null);return}const ce=Q.latLng.lat(),le=Q.latLng.lng(),de=Math.floor(ce/Ft),Le=Math.floor(le/Ft),ve=`${de}_${Le}`,ye=de*Ft,pe=Le*Ft,we=ye+Ft/2,xe=pe+Ft/2;e(ve,{lat:we,lng:xe})},[j,e]),ge=l.useCallback(async Q=>{Q.preventDefault(),!ae.current&&(ae.current=setTimeout(async()=>{if(ae.current=null,!K)return;const ce=K.getZoom(),le=Q.deltaY<0?ce+1:ce-1,de=Math.max(5,Math.min(20,le));de!==ce&&await Nt(K,K.getCenter().toJSON(),300,de,A)},B))},[K,A]);return ue.jsx("div",{className:"view-container fade-in",style:uc,onWheel:ge,children:ue.jsxs(Ga,{mapContainerStyle:lc,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:cc,minZoom:5,maxZoom:20,scrollwheel:!1},onLoad:$,onIdle:se,onMouseMove:N,onMouseOut:V,onClick:re,children:[ue.jsx(Ru,{map:K,zoom:j,claimedCells:r,exploredCells:o,hoveredCell:y,isAnimating:T,selectedCell:h,effects:w}),h&&ue.jsx(ca,{cellInfo:h}),g&&ue.jsx(ac,{position:g})]})})},dc=en.memo(fc),pc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},hc={fontSize:"24px"};function gc(){const t=He(e=>e.clouds);return ue.jsxs("div",{style:pc,children:[ue.jsx("span",{style:hc,children:"☁️"}),ue.jsx("span",{children:t})]})}const mc=en.memo(gc),vc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},yc={fontSize:"28px"};function bc({onClick:t}){const[e,r]=l.useState(!1),o={...vc,transform:e?"scale(1.1)":"scale(1)"};return ue.jsx("button",{onClick:t,title:"Reset View",style:o,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:ue.jsx("span",{style:yc,children:"🧭"})})}const wc=l.memo(bc),br={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},Lc=()=>{const t=He(f=>f.clouds),e=He(f=>f.lastCloudIncrease),r=He(f=>f.increaseCloud),[o,u]=l.useState(0);return l.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const g=6e4-(Date.now()-e);g<=0?(r(),u(60)):u(Math.ceil(g/1e3))},1e3):(clearInterval(f),u(0)),()=>clearInterval(f)},[t,e,r]),ue.jsxs("div",{style:br.container,children:[ue.jsx("span",{style:br.icon,children:"☁️"}),t<10?ue.jsxs("span",{style:br.timer,children:[o,"s"]}):ue.jsx("span",{style:br.timer,children:"⏰"})]})},Cc=l.memo(Lc),wr=new Map,qs=.5;function xc(t){const e=He(r=>r.updateSelectedCellInfo);l.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,o=`${Math.floor(r.lat/qs)}_${Math.floor(r.lng/qs)}`;(async()=>{if(wr.has(o)){e(wr.get(o));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const g=p.results[0].address_components,L=g.find(K=>K.types.includes("country")),w=g.find(K=>K.types.includes("administrative_area_level_1")),y=L?L.long_name:"未知領域",S=L?L.short_name.toLowerCase():null,j=w?w.long_name:"",P=S?`https://flagcdn.com/w40/${S}.png`:null;h={countryName:y,regionName:j,flagUrl:P}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};wr.set(o,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};wr.set(o,p),e(p)}})()},[t,e])}const Ec=l.lazy(()=>Oi(()=>import("./Leaderboard-CRJlvsFl.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),Sc=l.lazy(()=>Oi(()=>import("./RegistrationModal-D-RonHKU.js"),__vite__mapDeps([4,1,2]))),kc=l.lazy(()=>Oi(()=>import("./InfoModal-Mhe9DrnX.js"),__vite__mapDeps([5,1,2]))),ft={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"4px",left:"8px",zIndex:50}};function Fc(){const{lat:t,lng:e}=Aa(),r=Ba(),[o,u]=l.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=l.useState(!1),h=l.useRef(null),g=He(H=>H.claimedCells),L=He(H=>H.exploredCells),w=He(H=>H.selectedCell),y=He(H=>H.userLocation),S=He(H=>H.clouds),j=He(H=>H.initializeGeolocation),P=He(H=>H.selectCell),K=He(H=>H.claimSelectedCell),Z=He(H=>H.register),Y=He(H=>H.isHydrated),F=He(H=>H.hydrate);xc(w);const{isLoaded:ae}=al({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});l.useEffect(()=>{j()},[j]),l.useEffect(()=>{F()},[F]),l.useEffect(()=>{o||navigator.geolocation.getCurrentPosition(H=>{u({lat:H.coords.latitude,lng:H.coords.longitude})},()=>{u({lat:25.033,lng:121.5654})})},[o]);const[B,T]=l.useState(!1),[A,$]=l.useState(!1),[se,N]=l.useState(!1),[V,re]=l.useState(10),[ge,Q]=l.useState(!1),[ce,le]=l.useState([]),de=l.useCallback(H=>{h.current=H},[]),Le=l.useCallback((H,Be)=>{Pi(),P(H?{key:H,position:Be,isLoading:!0}:null)},[P]),ve=l.useCallback(()=>{if(!w)return;const H={id:Date.now()+Math.random(),position:w.position,startTime:Date.now(),particleDuration:2500,revealDuration:1e3,onComplete:()=>{K()==="no-clouds"&&T(!0)}};le(Be=>[...Be,H]),setTimeout(()=>{le(Be=>Be.filter(et=>et.id!==H.id))},2500)},[K,w]),ye=l.useCallback(()=>{P(null)},[P]),pe=l.useCallback(()=>{Z(),T(!1)},[Z]),we=l.useCallback(async()=>{if(!h.current)return;const H=h.current.getCenter(),Be=H.lat(),et=H.lng();p(!0),await Nt(h.current,{lat:Be,lng:et},1500,2,Q),r("/",{state:{lat:Be,lng:et}})},[r,Q]),xe=l.useCallback(()=>{window.confirm("您已縮放到最小級別，要返回地球儀嗎？")?we():h.current&&h.current.setZoom(h.current.getZoom()+1)},[we]),fe=l.useCallback(async()=>{if(y&&h.current){const H=h.current,Be=H.getCenter(),et={lat:Be.lat(),lng:Be.lng()};await Nt(H,et,1e3,5,Q),await Nt(H,y,1500,5,Q),await Nt(H,y,1e3,15,Q)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[y,Q]),ke=l.useCallback(H=>{re(H)},[]),q=l.useCallback(H=>{r(`/map/${H.lat.toFixed(7)}/${H.lng.toFixed(7)}`,{replace:!0})},[r]),Re=l.useCallback(async()=>{if(h.current){const H=h.current.getZoom(),Be=Math.min(20,H+1);Be!==H&&await Nt(h.current,h.current.getCenter().toJSON(),300,Be,Q)}},[Q]),Ue=l.useCallback(async()=>{if(h.current){const H=h.current.getZoom(),Be=Math.max(5,H-1);Be!==H&&await Nt(h.current,h.current.getCenter().toJSON(),300,Be,Q)}},[Q]),Ee=l.useCallback(()=>N(!0),[]),ie=l.useCallback(()=>T(!1),[]),be=l.useCallback(()=>$(!1),[]),_e=l.useCallback(()=>N(!1),[]);return!ae||!o||!Y?ue.jsx(ho,{}):ue.jsxs("div",{style:ft.app,className:f?"map-container-fade-out":"",children:[ue.jsx(dc,{center:o,onSelectCell:Le,claimedCells:g,exploredCells:L,setMapRef:de,onZoomChanged:ke,onCenterChanged:q,selectedCell:w,userLocation:y,onZoomOutLimit:xe,isAnimating:ge,effects:ce}),w&&ue.jsx(ca,{cellInfo:w,onClaim:ve,onClose:ye,isClaimDisabled:S<=0&&B}),ue.jsxs("div",{style:ft.topLeftControls,children:[ue.jsx("button",{style:ft.controlButton,onClick:Re,children:"+"}),ue.jsx("button",{style:ft.controlButton,onClick:Ue,children:"-"}),ue.jsx("button",{style:ft.controlButton,onClick:Ee,children:"i"})]}),ue.jsx("div",{style:ft.topCenterContainer,children:ue.jsx(mc,{})}),ue.jsxs("div",{style:ft.topRightContainer,children:[ue.jsx("button",{style:ft.controlButton,onClick:()=>$(!0),children:"🏆"}),ue.jsx("button",{style:ft.controlButton,onClick:we,title:"Return to Globe",children:"🌍"})]}),ue.jsx("div",{style:ft.bottomLeftContainer,children:ue.jsx(Cc,{})}),ue.jsx("div",{style:ft.bottomRightContainer,children:ue.jsx(wc,{onClick:fe})}),ue.jsxs(l.Suspense,{fallback:ue.jsx(ho,{}),children:[B&&ue.jsx(Sc,{onClose:ie,onRegister:pe}),A&&ue.jsx(Ec,{onClose:be}),se&&ue.jsx(kc,{onClose:_e})]})]})}export{Fc as default};
