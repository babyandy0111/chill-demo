const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-B06MkgQ_.js","assets/index-zeQXuVDb.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-CUENZ_nl.js","assets/InfoModal-CY1iFqnQ.js"])))=>i.map(i=>d[i]);
import{r as l,j as oe,b as Ln,R as Qt,c as Aa,g as Ta,d as Ba,a as Ua,L as go,_ as _i}from"./index-zeQXuVDb.js";function Fn(t){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(t)}function za(t,e){if(Fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Fn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=za(t,"string");return Fn(e)=="symbol"?e:e+""}function N(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var di,mo;function Ka(){if(mo)return di;mo=1;var t=function(r,i,a,f,p,h,m,L){if(!r){var w;if(i===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var b=[a,f,p,h,m,L],x=0;w=new Error(i.replace(/%s/g,function(){return b[x++]})),w.name="Invariant Violation"}throw w.framesToPop=1,w}};return di=t,di}var Na=Ka(),We=Zs(Na),Ee=l.createContext(null);function qa(){We(!!l.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=l.useContext(Ee);return We(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function Wa(t,e,r){return Object.keys(t).reduce(function(a,f){return e(a,t[f],f)},r)}function Za(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function $a(t,e,r,i){var a={},f=(p,h)=>{var m=r[h];m!==e[h]&&(a[h]=m,p(i,m))};return Za(t,f),a}function Va(t,e,r){var i=Wa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return i}function Ha(t){google.maps.event.removeListener(t)}function De(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Ha)}function Oe(t){var{updaterMap:e,eventMap:r,prevProps:i,nextProps:a,instance:f}=t,p=Va(a,f,r);return $a(e,i,a,f),p}var vo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},yo={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ga(t){var{children:e,options:r,id:i,mapContainerStyle:a,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:L,onDragEnd:w,onDragStart:b,onMouseMove:x,onMouseOut:P,onMouseOver:E,onMouseDown:A,onMouseUp:z,onRightClick:$,onCenterChanged:W,onLoad:te,onUnmount:K}=t,[j,S]=l.useState(null),F=l.useRef(null),[Y,U]=l.useState(null),[J,G]=l.useState(null),[H,ce]=l.useState(null),[fe,le]=l.useState(null),[de,Le]=l.useState(null),[ye,be]=l.useState(null),[me,Me]=l.useState(null),[Ie,ve]=l.useState(null),[Ae,Z]=l.useState(null),[Te,ze]=l.useState(null),[Q,X]=l.useState(null),[ge,_e]=l.useState(null);return l.useEffect(()=>{r&&j!==null&&j.setOptions(r)},[j,r]),l.useEffect(()=>{j!==null&&typeof p<"u"&&j.setCenter(p)},[j,p]),l.useEffect(()=>{j&&m&&(J!==null&&google.maps.event.removeListener(J),G(google.maps.event.addListener(j,"dblclick",m)))},[m]),l.useEffect(()=>{j&&w&&(H!==null&&google.maps.event.removeListener(H),ce(google.maps.event.addListener(j,"dragend",w)))},[w]),l.useEffect(()=>{j&&b&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(j,"dragstart",b)))},[b]),l.useEffect(()=>{j&&A&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(j,"mousedown",A)))},[A]),l.useEffect(()=>{j&&x&&(ye!==null&&google.maps.event.removeListener(ye),be(google.maps.event.addListener(j,"mousemove",x)))},[x]),l.useEffect(()=>{j&&P&&(me!==null&&google.maps.event.removeListener(me),Me(google.maps.event.addListener(j,"mouseout",P)))},[P]),l.useEffect(()=>{j&&E&&(Ie!==null&&google.maps.event.removeListener(Ie),ve(google.maps.event.addListener(j,"mouseover",E)))},[E]),l.useEffect(()=>{j&&z&&(Ae!==null&&google.maps.event.removeListener(Ae),Z(google.maps.event.addListener(j,"mouseup",z)))},[z]),l.useEffect(()=>{j&&$&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(j,"rightclick",$)))},[$]),l.useEffect(()=>{j&&h&&(Q!==null&&google.maps.event.removeListener(Q),X(google.maps.event.addListener(j,"click",h)))},[h]),l.useEffect(()=>{j&&L&&(ge!==null&&google.maps.event.removeListener(ge),_e(google.maps.event.addListener(j,"drag",L)))},[L]),l.useEffect(()=>{j&&W&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(j,"center_changed",W)))},[h]),l.useEffect(()=>{var ke=F.current===null?null:new google.maps.Map(F.current,r);return S(ke),ke!==null&&te&&te(ke),()=>{ke!==null&&K&&K(ke)}},[]),oe.jsx("div",{id:i,ref:F,style:a,className:f,children:oe.jsx(Ee.Provider,{value:j,children:j!==null?e:null})})}l.memo(Ga);class Ya extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{map:null}),N(this,"registeredEvents",[]),N(this,"mapRef",null),N(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),N(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),N(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),N(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=Oe({updaterMap:yo,eventMap:vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:yo,eventMap:vo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),De(this.registeredEvents))}render(){return oe.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:oe.jsx(Ee.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bo(t,e,r,i,a,f,p){try{var h=t[f](p),m=h.value}catch(L){return void r(L)}h.done?e(m):Promise.resolve(m).then(i,a)}function $s(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var f=t.apply(e,r);function p(m){bo(f,i,a,p,h,"next",m)}function h(m){bo(f,i,a,p,h,"throw",m)}p(void 0)})}}function Vs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:i="weekly",language:a,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:L,apiUrl:w="https://maps.googleapis.com"}=t,b=[];return We(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?b.push("key=".concat(e)):r&&b.push("client=".concat(r)),i&&b.push("v=".concat(i)),a&&b.push("language=".concat(a)),f&&b.push("region=".concat(f)),p&&p.length&&b.push("libraries=".concat(p.sort().join(","))),h&&b.push("channel=".concat(h)),m&&m.length&&b.push("map_ids=".concat(m.join(","))),L&&b.push("auth_referrer_policy=".concat(L)),b.push("loading=async"),b.push("callback=initMap"),"".concat(w,"/maps/api/js?").concat(b.join("&"))}var Nt=typeof document<"u";function Hs(t){var{url:e,id:r,nonce:i}=t;return Nt?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var L=h.getAttribute("data-state");if(h.src===e&&L!=="error"){if(L==="ready")return f(r);var w=m.initMap,b=h.onerror;m.initMap=function(){w&&w(),f(r)},h.onerror=function(P){b&&b(P),p(P)};return}else h.remove()}var x=document.createElement("script");x.type="text/javascript",x.src=e,x.id=r,x.async=!0,x.nonce=i||"",x.onerror=function(E){x.setAttribute("data-state","error"),p(E)},m.initMap=function(){x.setAttribute("data-state","ready"),f(r)},document.head.appendChild(x)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function wo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function Di(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,f){return wo(a)||Reflect.apply(e,t,[a,f]),a};var r=t.appendChild.bind(t);t.appendChild=function(a){return wo(a)||Reflect.apply(r,t,[a]),a}}}var An=!1;function Gs(){return oe.jsx("div",{children:"Loading..."})}var Kn={id:"script-loader",version:"weekly"};class Xa extends l.PureComponent{constructor(){super(...arguments),N(this,"check",null),N(this,"state",{loaded:!1}),N(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),N(this,"isCleaningUp",$s(function*(){function e(r){if(!An)r();else if(Nt)var i=window.setInterval(function(){An||(window.clearInterval(i),r())},1)}return new Promise(e)})),N(this,"cleanup",()=>{An=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),N(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Di(),We(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Vs(this.props)};Hs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),N(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Nt){if(window.google&&window.google.maps&&!An){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Nt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Nt){this.cleanup();var e=()=>{this.check||(delete window.google,An=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return oe.jsxs(oe.Fragment,{children:[oe.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||oe.jsx(Gs,{})]})}}N(Xa,"defaultProps",Kn);function Ja(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function Ii(t,e){if(t==null)return{};var r,i,a=Ja(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(i=0;i<f.length;i++)r=f[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var Lo;function Qa(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:L,channel:w,mapIds:b,authReferrerPolicy:x,apiUrl:P="https://maps.googleapis.com"}=t,E=l.useRef(!1),[A,z]=l.useState(!1),[$,W]=l.useState(void 0);l.useEffect(function(){return E.current=!0,()=>{E.current=!1}},[]),l.useEffect(function(){Nt&&L&&Di()},[L]),l.useEffect(function(){A&&We(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[A]);var te=Vs({version:r,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,channel:w,mapIds:b,authReferrerPolicy:x,apiUrl:P});l.useEffect(function(){if(!Nt)return;function S(){E.current&&(z(!0),Lo=te)}if(window.google&&window.google.maps&&Lo===te){S();return}Hs({id:e,url:te,nonce:i}).then(S).catch(function(Y){E.current&&W(Y),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(Y)})},[e,te,i]);var K=l.useRef(void 0);return l.useEffect(function(){K.current&&m!==K.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),K.current=m},[m]),{isLoaded:A,loadError:$,url:te}}var el=["loadingElement","onLoad","onError","onUnmount","children"],tl=oe.jsx(Gs,{});function nl(t){var{loadingElement:e,onLoad:r,onError:i,onUnmount:a,children:f}=t,p=Ii(t,el),{isLoaded:h,loadError:m}=Qa(p);return l.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),l.useEffect(function(){m&&typeof i=="function"&&i(m)},[m,i]),l.useEffect(function(){return()=>{a&&a()}},[a]),h?f:e||tl}l.memo(nl);function rl(t,e,r,i){function a(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(w){try{L(i.next(w))}catch(b){p(b)}}function m(w){try{L(i.throw(w))}catch(b){p(b)}}function L(w){w.done?f(w.value):a(w.value).then(h,m)}L((i=i.apply(t,[])).next())})}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ol=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},sl=il(ol),xo="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Jt{constructor(e){var{apiKey:r,authReferrerPolicy:i,channel:a,client:f,id:p=xo,language:h,libraries:m=[],mapIds:L,nonce:w,region:b,retries:x=3,url:P="https://maps.googleapis.com/maps/api/js",version:E}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=i,this.channel=a,this.client=f,this.id=p||xo,this.language=h,this.libraries=m,this.mapIds=L,this.nonce=w,this.region=b,this.retries=x,this.url=P,this.version=E,Jt.instance){if(!sl(this.options,Jt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Jt.instance.options)));return Jt.instance}Jt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(i=>{i?r(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(f=>!i[f]&&delete i[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,L="The Google Maps JavaScript API",w="google",b="importLibrary",x="__ib__",P=document,E=window;E=E[w]||(E[w]={});var A=E.maps||(E.maps={}),z=new Set,$=new URLSearchParams,W=()=>p||(p=new Promise((te,K)=>rl(this,void 0,void 0,function*(){var j;yield h=P.createElement("script"),h.id=this.id,$.set("libraries",[...z]+"");for(m in f)$.set(m.replace(/[A-Z]/g,S=>"_"+S[0].toLowerCase()),f[m]);$.set("callback",w+".maps."+x),h.src=this.url+"?"+$,A[x]=te,h.onerror=()=>p=K(Error(L+" could not load.")),h.nonce=this.nonce||((j=P.querySelector("script[nonce]"))===null||j===void 0?void 0:j.nonce)||"",P.head.append(h)})));A[b]?console.warn(L+" only loads once. Ignoring:",f):A[b]=function(te){for(var K=arguments.length,j=new Array(K>1?K-1:0),S=1;S<K;S++)j[S-1]=arguments[S];return z.add(te)&&W().then(()=>A[b](te,...j))}})(i);var a=this.libraries.map(f=>this.importLibrary(f));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var al=["maps"];function ll(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,language:f,region:p,libraries:h=al,preventGoogleFontsLoading:m,mapIds:L,authReferrerPolicy:w}=t,b=l.useRef(!1),[x,P]=l.useState(!1),[E,A]=l.useState(void 0);l.useEffect(function(){return b.current=!0,()=>{b.current=!1}},[]);var z=l.useMemo(()=>new Jt({id:e,apiKey:a,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:L||[],nonce:i||"",authReferrerPolicy:w||"origin"}),[e,a,r,h,f,p,L,i,w]);l.useEffect(function(){x||z.load().then(()=>{b.current&&P(!0)}).catch(te=>{A(te)})},[]),l.useEffect(()=>{Nt&&m&&Di()},[m]);var $=l.useRef();return l.useEffect(()=>{$.current&&h!==$.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),$.current=h},[h]),{isLoaded:x,loadError:E}}function Co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Co(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Eo={},Mo={options(t,e){t.setOptions(e)}};function ul(t){var{options:e,onLoad:r,onUnmount:i}=t,a=l.useContext(Ee),[f,p]=l.useState(null);return l.useEffect(()=>{f!==null&&f.setMap(a)},[a]),l.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),l.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:a}));return p(h),r&&r(h),()=>{f!==null&&(i&&i(f),f.setMap(null))}},[]),null}l.memo(ul);class cl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{trafficLayer:null}),N(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),N(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:Mo,eventMap:Eo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Mo,eventMap:Eo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),De(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}N(cl,"contextType",Ee);function fl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(Ee),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(i),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}l.memo(fl);class dl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{bicyclingLayer:null}),N(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}N(dl,"contextType",Ee);function pl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(Ee),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(i),e&&e(p),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}l.memo(pl);class hl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{transitLayer:null}),N(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}N(hl,"contextType",Ee);function ko(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ko(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ko(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var So={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Po={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function gl(t){var{options:e,drawingMode:r,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:L,onUnmount:w}=t,b=l.useContext(Ee),[x,P]=l.useState(null),[E,A]=l.useState(null),[z,$]=l.useState(null),[W,te]=l.useState(null),[K,j]=l.useState(null),[S,F]=l.useState(null),[Y,U]=l.useState(null);return l.useEffect(()=>{x!==null&&x.setMap(b)},[b]),l.useEffect(()=>{e&&x!==null&&x.setOptions(e)},[x,e]),l.useEffect(()=>{x!==null&&x.setDrawingMode(r??null)},[x,r]),l.useEffect(()=>{x&&i&&(E!==null&&google.maps.event.removeListener(E),A(google.maps.event.addListener(x,"circlecomplete",i)))},[x,i]),l.useEffect(()=>{x&&a&&(z!==null&&google.maps.event.removeListener(z),$(google.maps.event.addListener(x,"markercomplete",a)))},[x,a]),l.useEffect(()=>{x&&f&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(x,"overlaycomplete",f)))},[x,f]),l.useEffect(()=>{x&&p&&(K!==null&&google.maps.event.removeListener(K),j(google.maps.event.addListener(x,"polygoncomplete",p)))},[x,p]),l.useEffect(()=>{x&&h&&(S!==null&&google.maps.event.removeListener(S),F(google.maps.event.addListener(x,"polylinecomplete",h)))},[x,h]),l.useEffect(()=>{x&&m&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(x,"rectanglecomplete",m)))},[x,m]),l.useEffect(()=>{We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var J=new google.maps.drawing.DrawingManager(Er(Er({},e),{},{map:b}));return r&&J.setDrawingMode(r),i&&A(google.maps.event.addListener(J,"circlecomplete",i)),a&&$(google.maps.event.addListener(J,"markercomplete",a)),f&&te(google.maps.event.addListener(J,"overlaycomplete",f)),p&&j(google.maps.event.addListener(J,"polygoncomplete",p)),h&&F(google.maps.event.addListener(J,"polylinecomplete",h)),m&&U(google.maps.event.addListener(J,"rectanglecomplete",m)),P(J),L&&L(J),()=>{x!==null&&(E&&google.maps.event.removeListener(E),z&&google.maps.event.removeListener(z),W&&google.maps.event.removeListener(W),K&&google.maps.event.removeListener(K),S&&google.maps.event.removeListener(S),Y&&google.maps.event.removeListener(Y),w&&w(x),x.setMap(null))}},[]),null}l.memo(gl);class ml extends l.PureComponent{constructor(e){super(e),N(this,"registeredEvents",[]),N(this,"state",{drawingManager:null}),N(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Er(Er({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:Po,eventMap:So,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Po,eventMap:So,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),De(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}N(ml,"contextType",Ee);function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var _o={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Do={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Mr={};function vl(t){var{position:e,options:r,clusterer:i,noClustererRedraw:a,children:f,draggable:p,visible:h,animation:m,clickable:L,cursor:w,icon:b,label:x,opacity:P,shape:E,title:A,zIndex:z,onClick:$,onDblClick:W,onDrag:te,onDragEnd:K,onDragStart:j,onMouseOut:S,onMouseOver:F,onMouseUp:Y,onMouseDown:U,onRightClick:J,onClickableChanged:G,onCursorChanged:H,onAnimationChanged:ce,onDraggableChanged:fe,onFlatChanged:le,onIconChanged:de,onPositionChanged:Le,onShapeChanged:ye,onTitleChanged:be,onVisibleChanged:me,onZindexChanged:Me,onLoad:Ie,onUnmount:ve}=t,Ae=l.useContext(Ee),[Z,Te]=l.useState(null),[ze,Q]=l.useState(null),[X,ge]=l.useState(null),[_e,ke]=l.useState(null),[Xe,qt]=l.useState(null),[je,$n]=l.useState(null),[nn,Vn]=l.useState(null),[rn,on]=l.useState(null),[Je,xn]=l.useState(null),[pt,Cn]=l.useState(null),[Ot,ht]=l.useState(null),[at,sn]=l.useState(null),[gt,an]=l.useState(null),[xt,mt]=l.useState(null),[Ct,ln]=l.useState(null),[et,he]=l.useState(null),[vt,yt]=l.useState(null),[Et,ue]=l.useState(null),[un,En]=l.useState(null),[_t,Mn]=l.useState(null),[Dt,Hn]=l.useState(null),[cn,Mt]=l.useState(null);l.useEffect(()=>{Z!==null&&Z.setMap(Ae)},[Ae]),l.useEffect(()=>{typeof r<"u"&&Z!==null&&Z.setOptions(r)},[Z,r]),l.useEffect(()=>{typeof p<"u"&&Z!==null&&Z.setDraggable(p)},[Z,p]),l.useEffect(()=>{e&&Z!==null&&Z.setPosition(e)},[Z,e]),l.useEffect(()=>{typeof h<"u"&&Z!==null&&Z.setVisible(h)},[Z,h]),l.useEffect(()=>{Z?.setAnimation(m)},[Z,m]),l.useEffect(()=>{Z&&L!==void 0&&Z.setClickable(L)},[Z,L]),l.useEffect(()=>{Z&&w!==void 0&&Z.setCursor(w)},[Z,w]),l.useEffect(()=>{Z&&b!==void 0&&Z.setIcon(b)},[Z,b]),l.useEffect(()=>{Z&&x!==void 0&&Z.setLabel(x)},[Z,x]),l.useEffect(()=>{Z&&P!==void 0&&Z.setOpacity(P)},[Z,P]),l.useEffect(()=>{Z&&E!==void 0&&Z.setShape(E)},[Z,E]),l.useEffect(()=>{Z&&A!==void 0&&Z.setTitle(A)},[Z,A]),l.useEffect(()=>{Z&&z!==void 0&&Z.setZIndex(z)},[Z,z]),l.useEffect(()=>{Z&&W&&(ze!==null&&google.maps.event.removeListener(ze),Q(google.maps.event.addListener(Z,"dblclick",W)))},[W]),l.useEffect(()=>{Z&&K&&(X!==null&&google.maps.event.removeListener(X),ge(google.maps.event.addListener(Z,"dragend",K)))},[K]),l.useEffect(()=>{Z&&j&&(_e!==null&&google.maps.event.removeListener(_e),ke(google.maps.event.addListener(Z,"dragstart",j)))},[j]),l.useEffect(()=>{Z&&U&&(Xe!==null&&google.maps.event.removeListener(Xe),qt(google.maps.event.addListener(Z,"mousedown",U)))},[U]),l.useEffect(()=>{Z&&S&&(je!==null&&google.maps.event.removeListener(je),$n(google.maps.event.addListener(Z,"mouseout",S)))},[S]),l.useEffect(()=>{Z&&F&&(nn!==null&&google.maps.event.removeListener(nn),Vn(google.maps.event.addListener(Z,"mouseover",F)))},[F]),l.useEffect(()=>{Z&&Y&&(rn!==null&&google.maps.event.removeListener(rn),on(google.maps.event.addListener(Z,"mouseup",Y)))},[Y]),l.useEffect(()=>{Z&&J&&(Je!==null&&google.maps.event.removeListener(Je),xn(google.maps.event.addListener(Z,"rightclick",J)))},[J]),l.useEffect(()=>{Z&&$&&(pt!==null&&google.maps.event.removeListener(pt),Cn(google.maps.event.addListener(Z,"click",$)))},[$]),l.useEffect(()=>{Z&&te&&(Ot!==null&&google.maps.event.removeListener(Ot),ht(google.maps.event.addListener(Z,"drag",te)))},[te]),l.useEffect(()=>{Z&&G&&(at!==null&&google.maps.event.removeListener(at),sn(google.maps.event.addListener(Z,"clickable_changed",G)))},[G]),l.useEffect(()=>{Z&&H&&(gt!==null&&google.maps.event.removeListener(gt),an(google.maps.event.addListener(Z,"cursor_changed",H)))},[H]),l.useEffect(()=>{Z&&ce&&(xt!==null&&google.maps.event.removeListener(xt),mt(google.maps.event.addListener(Z,"animation_changed",ce)))},[ce]),l.useEffect(()=>{Z&&fe&&(Ct!==null&&google.maps.event.removeListener(Ct),ln(google.maps.event.addListener(Z,"draggable_changed",fe)))},[fe]),l.useEffect(()=>{Z&&le&&(et!==null&&google.maps.event.removeListener(et),he(google.maps.event.addListener(Z,"flat_changed",le)))},[le]),l.useEffect(()=>{Z&&de&&(vt!==null&&google.maps.event.removeListener(vt),yt(google.maps.event.addListener(Z,"icon_changed",de)))},[de]),l.useEffect(()=>{Z&&Le&&(Et!==null&&google.maps.event.removeListener(Et),ue(google.maps.event.addListener(Z,"position_changed",Le)))},[Le]),l.useEffect(()=>{Z&&ye&&(un!==null&&google.maps.event.removeListener(un),En(google.maps.event.addListener(Z,"shape_changed",ye)))},[ye]),l.useEffect(()=>{Z&&be&&(_t!==null&&google.maps.event.removeListener(_t),Mn(google.maps.event.addListener(Z,"title_changed",be)))},[be]),l.useEffect(()=>{Z&&me&&(Dt!==null&&google.maps.event.removeListener(Dt),Hn(google.maps.event.addListener(Z,"visible_changed",me)))},[me]),l.useEffect(()=>{Z&&Me&&(cn!==null&&google.maps.event.removeListener(cn),Mt(google.maps.event.addListener(Z,"zindex_changed",Me)))},[Me]),l.useEffect(()=>{var kt=bn(bn(bn({},r||Mr),i?Mr:{map:Ae}),{},{position:e}),we=new google.maps.Marker(kt);return i?i.addMarker(we,!!a):we.setMap(Ae),e&&we.setPosition(e),typeof h<"u"&&we.setVisible(h),typeof p<"u"&&we.setDraggable(p),typeof L<"u"&&we.setClickable(L),typeof w=="string"&&we.setCursor(w),b&&we.setIcon(b),typeof x<"u"&&we.setLabel(x),typeof P<"u"&&we.setOpacity(P),E&&we.setShape(E),typeof A=="string"&&we.setTitle(A),typeof z=="number"&&we.setZIndex(z),W&&Q(google.maps.event.addListener(we,"dblclick",W)),K&&ge(google.maps.event.addListener(we,"dragend",K)),j&&ke(google.maps.event.addListener(we,"dragstart",j)),U&&qt(google.maps.event.addListener(we,"mousedown",U)),S&&$n(google.maps.event.addListener(we,"mouseout",S)),F&&Vn(google.maps.event.addListener(we,"mouseover",F)),Y&&on(google.maps.event.addListener(we,"mouseup",Y)),J&&xn(google.maps.event.addListener(we,"rightclick",J)),$&&Cn(google.maps.event.addListener(we,"click",$)),te&&ht(google.maps.event.addListener(we,"drag",te)),G&&sn(google.maps.event.addListener(we,"clickable_changed",G)),H&&an(google.maps.event.addListener(we,"cursor_changed",H)),ce&&mt(google.maps.event.addListener(we,"animation_changed",ce)),fe&&ln(google.maps.event.addListener(we,"draggable_changed",fe)),le&&he(google.maps.event.addListener(we,"flat_changed",le)),de&&yt(google.maps.event.addListener(we,"icon_changed",de)),Le&&ue(google.maps.event.addListener(we,"position_changed",Le)),ye&&En(google.maps.event.addListener(we,"shape_changed",ye)),be&&Mn(google.maps.event.addListener(we,"title_changed",be)),me&&Hn(google.maps.event.addListener(we,"visible_changed",me)),Me&&Mt(google.maps.event.addListener(we,"zindex_changed",Me)),Te(we),Ie&&Ie(we),()=>{ze!==null&&google.maps.event.removeListener(ze),X!==null&&google.maps.event.removeListener(X),_e!==null&&google.maps.event.removeListener(_e),Xe!==null&&google.maps.event.removeListener(Xe),je!==null&&google.maps.event.removeListener(je),nn!==null&&google.maps.event.removeListener(nn),rn!==null&&google.maps.event.removeListener(rn),Je!==null&&google.maps.event.removeListener(Je),pt!==null&&google.maps.event.removeListener(pt),at!==null&&google.maps.event.removeListener(at),gt!==null&&google.maps.event.removeListener(gt),xt!==null&&google.maps.event.removeListener(xt),Ct!==null&&google.maps.event.removeListener(Ct),et!==null&&google.maps.event.removeListener(et),vt!==null&&google.maps.event.removeListener(vt),Et!==null&&google.maps.event.removeListener(Et),_t!==null&&google.maps.event.removeListener(_t),Dt!==null&&google.maps.event.removeListener(Dt),cn!==null&&google.maps.event.removeListener(cn),ve&&ve(we),i?i.removeMarker(we,!!a):we&&we.setMap(null)}},[]);var It=l.useMemo(()=>f?l.Children.map(f,kt=>{if(!l.isValidElement(kt))return kt;var we=kt;return l.cloneElement(we,{anchor:Z})}):null,[f,Z]);return oe.jsx(oe.Fragment,{children:It})||null}l.memo(vl);class yl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this;return $s(function*(){var r=bn(bn(bn({},e.props.options||Mr),e.props.clusterer?Mr:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=Oe({updaterMap:Do,eventMap:_o,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Do,eventMap:_o,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),De(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?l.Children.map(this.props.children,r=>{if(!l.isValidElement(r))return r;var i=r;return l.cloneElement(i,{anchor:this.marker})}):null;return e||null}}N(yl,"contextType",Ee);var bl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var i=r.getMaxZoom(),a=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(a),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(a);var h=p.getZoom()||0;i!==null&&h>i&&p.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,i,a,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),L=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),w=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),b=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(b!==null?"".concat(b.y,"px"):"0","; left: ").concat(b!==null?"".concat(b.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var x=document.createElement("img");x.alt=h,x.src=this.url,x.width=this.width,x.height=this.height,x.setAttribute("style","position: absolute; top: ".concat(w,"px; left: ").concat(L,"px")),this.cluster.getClusterer().enableRetinaIcons||(x.style.clip="rect(-".concat(w,"px, -").concat(L+this.width,"px, -").concat(w+this.height,", -").concat(L,")"));var P=document.createElement("div");P.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(P.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(P.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(x),this.div.appendChild(P),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),i=r[Math.min(r.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),wl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new bl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),i=0,a=r;i<a.length;i++){var f=a[i],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,L=this.markers;m<L.length;m++){var w=L[m];w.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function Ll(t,e){var r=t.length,i=r.toString().length,a=Math.min(i,e);return{text:r.toString(),index:a,title:""}}var xl=2e3,Cl=500,El="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",Ml="png",kl=[53,56,66,78,90],Sl="cluster",Ys=(function(){function t(e,r,i){r===void 0&&(r=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||El,this.imageExtension=i.imageExtension||Ml,this.imageSizes=i.imageSizes||kl,this.calculator=i.calculator||Ll,this.batchSize=i.batchSize||xl,this.batchSizeIE=i.batchSizeIE||Cl,this.clusterClass=i.clusterClass||Sl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var i=r[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,f=this.clusters;a<f.length;a++){var p=f[a];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var L=m[h];google.maps.event.removeListener(L)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var f=a[i],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){r=i;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var i=this.removeMarker_(e);return!r&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,r){for(var i=!1,a=0,f=e;a<f.length;a++){var p=f[a];i=i||this.removeMarker_(p)}return!r&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var f=a[i];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var f=r.fromDivPixelToLatLng(i);f!==null&&e.extend(f)}if(a!==null){var p=r.fromDivPixelToLatLng(a);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,i=this.clusters;r<i.length;r++){var a=i[r];a.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var i=6371,a=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return i*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var i=e.getPosition();return i?r.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var r,i=4e4,a=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),L=e.getPosition();if(m&&L){var w=this.distanceBetweenPoints(m,L);w<i&&(i=w,a=r)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(r=new wl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,f=i?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),L=e;L<m;L++){var w=this.markers[L];w&&!w.isAdded&&this.isMarkerInBounds(w,h)&&(!this.ignoreHidden||this.ignoreHidden&&w.getVisible())&&this.addToClosestCluster(w)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var b=0,x=this.clusters;b<x.length;b++){var P=x[b];P.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype){var p=f;this.prototype[p]=a.prototype[p]}return this}).apply(e,[r])},t})();function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ct={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Ue={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Ol={};function _l(t){var{children:e,options:r,averageCenter:i,batchSizeIE:a,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:L,imageExtension:w,imagePath:b,imageSizes:x,maxZoom:P,minimumClusterSize:E,styles:A,title:z,zoomOnClick:$,onClick:W,onClusteringBegin:te,onClusteringEnd:K,onMouseOver:j,onMouseOut:S,onLoad:F,onUnmount:Y}=t,[U,J]=l.useState(null),G=l.useContext(Ee),[H,ce]=l.useState(null),[fe,le]=l.useState(null),[de,Le]=l.useState(null),[ye,be]=l.useState(null),[me,Me]=l.useState(null);return l.useEffect(()=>{U&&S&&(ye!==null&&google.maps.event.removeListener(ye),be(google.maps.event.addListener(U,ct.onMouseOut,S)))},[S]),l.useEffect(()=>{U&&j&&(me!==null&&google.maps.event.removeListener(me),Me(google.maps.event.addListener(U,ct.onMouseOver,j)))},[j]),l.useEffect(()=>{U&&W&&(H!==null&&google.maps.event.removeListener(H),ce(google.maps.event.addListener(U,ct.onClick,W)))},[W]),l.useEffect(()=>{U&&te&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(U,ct.onClusteringBegin,te)))},[te]),l.useEffect(()=>{U&&K&&(de!==null&&google.maps.event.removeListener(de),le(google.maps.event.addListener(U,ct.onClusteringEnd,K)))},[K]),l.useEffect(()=>{typeof i<"u"&&U!==null&&Ue.averageCenter(U,i)},[U,i]),l.useEffect(()=>{typeof a<"u"&&U!==null&&Ue.batchSizeIE(U,a)},[U,a]),l.useEffect(()=>{typeof f<"u"&&U!==null&&Ue.calculator(U,f)},[U,f]),l.useEffect(()=>{typeof p<"u"&&U!==null&&Ue.clusterClass(U,p)},[U,p]),l.useEffect(()=>{typeof h<"u"&&U!==null&&Ue.enableRetinaIcons(U,h)},[U,h]),l.useEffect(()=>{typeof m<"u"&&U!==null&&Ue.gridSize(U,m)},[U,m]),l.useEffect(()=>{typeof L<"u"&&U!==null&&Ue.ignoreHidden(U,L)},[U,L]),l.useEffect(()=>{typeof w<"u"&&U!==null&&Ue.imageExtension(U,w)},[U,w]),l.useEffect(()=>{typeof b<"u"&&U!==null&&Ue.imagePath(U,b)},[U,b]),l.useEffect(()=>{typeof x<"u"&&U!==null&&Ue.imageSizes(U,x)},[U,x]),l.useEffect(()=>{typeof P<"u"&&U!==null&&Ue.maxZoom(U,P)},[U,P]),l.useEffect(()=>{typeof E<"u"&&U!==null&&Ue.minimumClusterSize(U,E)},[U,E]),l.useEffect(()=>{typeof A<"u"&&U!==null&&Ue.styles(U,A)},[U,A]),l.useEffect(()=>{typeof z<"u"&&U!==null&&Ue.title(U,z)},[U,z]),l.useEffect(()=>{typeof $<"u"&&U!==null&&Ue.zoomOnClick(U,$)},[U,$]),l.useEffect(()=>{if(G){var Ie=Pl({},r||Ol),ve=new Ys(G,[],Ie);return i&&Ue.averageCenter(ve,i),a&&Ue.batchSizeIE(ve,a),f&&Ue.calculator(ve,f),p&&Ue.clusterClass(ve,p),h&&Ue.enableRetinaIcons(ve,h),m&&Ue.gridSize(ve,m),L&&Ue.ignoreHidden(ve,L),w&&Ue.imageExtension(ve,w),b&&Ue.imagePath(ve,b),x&&Ue.imageSizes(ve,x),P&&Ue.maxZoom(ve,P),E&&Ue.minimumClusterSize(ve,E),A&&Ue.styles(ve,A),z&&Ue.title(ve,z),$&&Ue.zoomOnClick(ve,$),S&&be(google.maps.event.addListener(ve,ct.onMouseOut,S)),j&&Me(google.maps.event.addListener(ve,ct.onMouseOver,j)),W&&ce(google.maps.event.addListener(ve,ct.onClick,W)),te&&le(google.maps.event.addListener(ve,ct.onClusteringBegin,te)),K&&Le(google.maps.event.addListener(ve,ct.onClusteringEnd,K)),J(ve),F&&F(ve),()=>{ye!==null&&google.maps.event.removeListener(ye),me!==null&&google.maps.event.removeListener(me),H!==null&&google.maps.event.removeListener(H),fe!==null&&google.maps.event.removeListener(fe),de!==null&&google.maps.event.removeListener(de),Y&&Y(ve)}}},[]),U!==null&&e(U)||null}l.memo(_l);class Dl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{markerClusterer:null}),N(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ys(this.context,[],this.props.options);this.registeredEvents=Oe({updaterMap:Ue,eventMap:ct,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ue,eventMap:ct,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),De(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}N(Dl,"contextType",Ee);function jo(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Xs=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(w){w.returnValue=!1,w.preventDefault&&w.preventDefault(),e.enableEventPropagation||jo(w)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,jo))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var i=0,a=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,L=this.pixelOffset.width,w=this.pixelOffset.height,b=this.div.offsetWidth,x=this.div.offsetHeight,P=this.infoBoxClearance.width,E=this.infoBoxClearance.height,A=this.getProjection(),z=A.fromLatLngToContainerPixel(this.position);z!==null&&(z.x<-L+P?i=z.x+L-P:z.x+b+L+P>h&&(i=z.x+b+L+P-h),this.alignBottom?z.y<-w+E+x?a=z.y+w-E-x:z.y+w+E>m&&(a=z.y+w+E-m):z.y<-w+E?a=z.y+w-E:z.y+x+w+E>m&&(a=z.y+x+w+E-m)),i===0&&a===0||r.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,i=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var i=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){i.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var i=r[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=a.prototype[f]);return this}).apply(e,[r])},t})(),Il=["position"],jl=["position"];function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ro(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ao={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},To={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Rl={};function Al(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:L,onZindexChanged:w,onLoad:b,onUnmount:x}=t,P=l.useContext(Ee),[E,A]=l.useState(null),[z,$]=l.useState(null),[W,te]=l.useState(null),[K,j]=l.useState(null),[S,F]=l.useState(null),[Y,U]=l.useState(null),J=l.useRef(null);return l.useEffect(()=>{P&&E!==null&&(E.close(),r?E.open(P,r):E.getPosition()&&E.open(P))},[P,E,r]),l.useEffect(()=>{i&&E!==null&&E.setOptions(i)},[E,i]),l.useEffect(()=>{if(a&&E!==null){var G=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);E.setPosition(G)}},[a]),l.useEffect(()=>{typeof f=="number"&&E!==null&&E.setZIndex(f)},[f]),l.useEffect(()=>{E&&p&&(z!==null&&google.maps.event.removeListener(z),$(google.maps.event.addListener(E,"closeclick",p)))},[p]),l.useEffect(()=>{E&&h&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(E,"domready",h)))},[h]),l.useEffect(()=>{E&&m&&(K!==null&&google.maps.event.removeListener(K),j(google.maps.event.addListener(E,"content_changed",m)))},[m]),l.useEffect(()=>{E&&L&&(S!==null&&google.maps.event.removeListener(S),F(google.maps.event.addListener(E,"position_changed",L)))},[L]),l.useEffect(()=>{E&&w&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(E,"zindex_changed",w)))},[w]),l.useEffect(()=>{if(P){var G=i||Rl,{position:H}=G,ce=Ii(G,Il),fe;H&&!(H instanceof google.maps.LatLng)&&(fe=new google.maps.LatLng(H.lat,H.lng));var le=new Xs(kr(kr({},ce),fe?{position:fe}:{}));J.current=document.createElement("div"),A(le),p&&$(google.maps.event.addListener(le,"closeclick",p)),h&&te(google.maps.event.addListener(le,"domready",h)),m&&j(google.maps.event.addListener(le,"content_changed",m)),L&&F(google.maps.event.addListener(le,"position_changed",L)),w&&U(google.maps.event.addListener(le,"zindex_changed",w)),le.setContent(J.current),r?le.open(P,r):le.getPosition()?le.open(P):We(!1,"You must provide either an anchor or a position prop for <InfoBox>."),b&&b(le)}return()=>{E!==null&&(z&&google.maps.event.removeListener(z),K&&google.maps.event.removeListener(K),W&&google.maps.event.removeListener(W),S&&google.maps.event.removeListener(S),Y&&google.maps.event.removeListener(Y),x&&x(E),E.close())}},[]),J.current?Ln.createPortal(l.Children.only(e),J.current):null}l.memo(Al);class Tl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoBox:null}),N(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):We(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),N(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,i=Ii(e,jl),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var f=new Xs(kr(kr({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=Oe({updaterMap:To,eventMap:Ao,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:To,eventMap:Ao,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),De(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(Tl,"contextType",Ee);var pi,Bo;function Bl(){return Bo||(Bo=1,pi=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),pi}var Ul=Bl(),Uo=Zs(Ul),zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],hi=1,Tn=8;class ji{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==hi)throw new Error("Got v".concat(a," data when expected v").concat(hi,"."));var f=zo[i&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new ji(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=zo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Tn+p+h+m),this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(hi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return wi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],L=[];m.length;){var w=m.pop()||0,b=m.pop()||0,x=m.pop()||0;if(b-x<=h){for(var P=x;P<=b;P++){var E=p[2*P],A=p[2*P+1];E>=e&&E<=i&&A>=r&&A<=a&&L.push(f[P])}continue}var z=x+b>>1,$=p[2*z],W=p[2*z+1];$>=e&&$<=i&&W>=r&&W<=a&&L.push(f[z]),(w===0?e<=$:r<=W)&&(m.push(x),m.push(z-1),m.push(1-w)),(w===0?i>=$:a>=W)&&(m.push(z+1),m.push(b),m.push(1-w))}return L}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:f,nodeSize:p}=this,h=[0,a.length-1,0],m=[],L=i*i;h.length;){var w=h.pop()||0,b=h.pop()||0,x=h.pop()||0;if(b-x<=p){for(var P=x;P<=b;P++)Fo(f[2*P],f[2*P+1],e,r)<=L&&m.push(a[P]);continue}var E=x+b>>1,A=f[2*E],z=f[2*E+1];Fo(A,z,e,r)<=L&&m.push(a[E]),(w===0?e-i<=A:r-i<=z)&&(h.push(x),h.push(E-1),h.push(1-w)),(w===0?e+i>=A:r+i>=z)&&(h.push(E+1),h.push(b),h.push(1-w))}return m}}function wi(t,e,r,i,a,f){if(!(a-i<=r)){var p=i+a>>1;Js(t,e,p,i,a,f),wi(t,e,r,i,p-1,1-f),wi(t,e,r,p+1,a,1-f)}}function Js(t,e,r,i,a,f){for(;a>i;){if(a-i>600){var p=a-i+1,h=r-i+1,m=Math.log(p),L=.5*Math.exp(2*m/3),w=.5*Math.sqrt(m*L*(p-L)/p)*(h-p/2<0?-1:1),b=Math.max(i,Math.floor(r-h*L/p+w)),x=Math.min(a,Math.floor(r+(p-h)*L/p+w));Js(t,e,r,b,x,f)}var P=e[2*r+f],E=i,A=a;for(Bn(t,e,i,r),e[2*a+f]>P&&Bn(t,e,i,a);E<A;){for(Bn(t,e,E,A),E++,A--;e[2*E+f]<P;)E++;for(;e[2*A+f]>P;)A--}e[2*i+f]===P?Bn(t,e,i,A):(A++,Bn(t,e,A,a)),A<=r&&(i=A+1),r<=A&&(a=A-1)}}function Bn(t,e,r,i){gi(t,r,i),gi(e,2*r,2*i),gi(e,2*r+1,2*i+1)}function gi(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Fo(t,e,r,i){var a=t-r,f=e-i;return a*a+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ko=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Yt=2,Ft=3,mi=4,zt=5,Qs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:i,maxZoom:a}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[L,w]=m.geometry.coordinates,b=Ko(vr(L)),x=Ko(yr(w));p.push(b,x,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var P=this.trees[a+1]=this._createTree(p);r&&console.timeEnd(f);for(var E=a;E>=i;E--){var A=+Date.now();P=this.trees[E]=this._createTree(this._cluster(P,E)),r&&console.log("z%d: %d clusters in %dms",E,P.numItems,+Date.now()-A)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,f=180;else if(i>f){var h=this.getClusters([i,a,180,p],r),m=this.getClusters([-180,a,f,p],r);return h.concat(m)}var L=this.trees[this._limitZoom(r)],w=L.range(vr(i),yr(p),vr(f),yr(a)),b=L.data,x=[];for(var P of w){var E=this.stride*P;x.push(b[E+zt]>1?No(b,E,this.clusterProps):this.points[b[E+Ft]])}return x}getChildren(e){var r=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",f=this.trees[i];if(!f)throw new Error(a);var p=f.data;if(r*this.stride>=p.length)throw new Error(a);var h=this.options.radius/(this.options.extent*Math.pow(2,i-1)),m=p[r*this.stride],L=p[r*this.stride+1],w=f.within(m,L,h),b=[];for(var x of w){var P=x*this.stride;p[P+mi]===e&&b.push(p[P+zt]>1?No(p,P,this.clusterProps):this.points[p[P+Ft]])}if(b.length===0)throw new Error(a);return b}getLeaves(e,r,i){r=r||10,i=i||0;var a=[];return this._appendLeaves(a,e,r,i,0),a}getTile(e,r,i){var a=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,L=(i-m)/f,w=(i+1+m)/f,b={features:[]};return this._addTileFeatures(a.range((r-m)/f,L,(r+1+m)/f,w),a.data,r,i,f,b),r===0&&this._addTileFeatures(a.range(1-m/f,L,1,w),a.data,f,i,f,b),r===f-1&&this._addTileFeatures(a.range(0,L,m/f,w),a.data,-1,i,f,b),b.features.length?b:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var i=this.getChildren(e);if(r++,i.length!==1)break;e=i[0].properties.cluster_id}return r}_appendLeaves(e,r,i,a,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=a?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,i,a,f):f<a?f++:e.push(h),e.length===i)break}return f}_createTree(e){for(var r=new ji(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)r.add(e[i],e[i+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,i,a,f,p){for(var h of e){var m=h*this.stride,L=r[m+zt]>1,w=void 0,b=void 0,x=void 0;if(L)w=ea(r,m,this.clusterProps),b=r[m],x=r[m+1];else{var P=this.points[r[m+Ft]];w=P.properties;var[E,A]=P.geometry.coordinates;b=vr(E),x=yr(A)}var z={type:1,geometry:[[Math.round(this.options.extent*(b*f-i)),Math.round(this.options.extent*(x*f-a))]],tags:w},$=void 0;L||this.options.generateId?$=r[m+Ft]:$=this.points[r[m+Ft]].id,$!==void 0&&(z.id=$),p.features.push(z)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:i,extent:a,reduce:f,minPoints:p}=this.options,h=i/(a*Math.pow(2,r)),m=e.data,L=[],w=this.stride,b=0;b<m.length;b+=w)if(!(m[b+Yt]<=r)){m[b+Yt]=r;var x=m[b],P=m[b+1],E=e.within(m[b],m[b+1],h),A=m[b+zt],z=A;for(var $ of E){var W=$*w;m[W+Yt]>r&&(z+=m[W+zt])}if(z>A&&z>=p){var te=x*A,K=P*A,j=void 0,S=-1,F=((b/w|0)<<5)+(r+1)+this.points.length;for(var Y of E){var U=Y*w;if(!(m[U+Yt]<=r)){m[U+Yt]=r;var J=m[U+zt];te+=m[U]*J,K+=m[U+1]*J,m[U+mi]=F,f&&(j||(j=this._map(m,b,!0),S=this.clusterProps.length,this.clusterProps.push(j)),f(j,this._map(m,U)))}}m[b+mi]=F,L.push(te/z,K/z,1/0,F,-1,z),f&&L.push(S)}else{for(var G=0;G<w;G++)L.push(m[b+G]);if(z>1)for(var H of E){var ce=H*w;if(!(m[ce+Yt]<=r)){m[ce+Yt]=r;for(var fe=0;fe<w;fe++)L.push(m[ce+fe])}}}}return L}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,i){if(e[r+zt]>1){var a=this.clusterProps[e[r+Qs]];return i?Object.assign({},a):a}var f=this.points[e[r+Ft]].properties,p=this.options.map(f);return i&&p===f?Object.assign({},p):p}}function No(t,e,r){return{type:"Feature",id:t[e+Ft],properties:ea(t,e,r),geometry:{type:"Point",coordinates:[Kl(t[e]),Nl(t[e+1])]}}}function ea(t,e,r){var i=t[e+zt],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,f=t[e+Qs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Ft],point_count:i,point_count_abbreviated:a})}function vr(t){return t/360+.5}function yr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Kl(t){return(t-.5)*360}function Nl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ql(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(r[i[a]]=t[i[a]]);return r}class ot{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Li{constructor(e){var{markers:r,position:i}=e;this.markers=r,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(ot.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ot.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ot.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Wl{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Zl(r)}}var Zl=t=>{var e=t.map(r=>new Li({position:ot.getPosition(r),markers:[r]}));return e};class $l extends Wl{constructor(e){var{maxZoom:r,radius:i=60}=e,a=ql(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var r=!1,i={zoom:e.map.getZoom()};if(!Uo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var a=this.markers.map(f=>{var p=ot.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(r=!Uo(this.state,i)),this.state=i,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[r,i]},properties:a}=e;if(a.cluster)return new Li({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:i,lng:r}});var f=a.marker;return new Li({markers:[f],position:ot.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var i=r.map(f=>f.count),a=i.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class Hl{render(e,r,i){var{count:a,position:f}=e,p=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),m="Cluster of ".concat(a," markers"),L=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ot.isAdvancedMarkerAvailable(i)){var w=new DOMParser,b=w.parseFromString(h,"image/svg+xml").documentElement;b.setAttribute("transform","translate(0 25)");var x={map:i,position:f,zIndex:L,title:m,content:b};return new google.maps.marker.AdvancedMarkerElement(x)}var P={position:f,zIndex:L,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(P)}}function Gl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ri{constructor(){Gl(Ri,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Yl=(t,e,r)=>{r.fitBounds(e.bounds)};class Xl extends Ri{constructor(e){var{map:r,markers:i=[],algorithmOptions:a={},algorithm:f=new $l(a),renderer:p=new Hl,onClusterClick:h=Yl}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(i=>{this.addMarker(i,!0)}),r||this.render()}removeMarker(e,r){var i=this.markers.indexOf(e);return i===-1?!1:(ot.setMap(e,null),this.markers.splice(i,1),r||this.render(),!0)}removeMarkers(e,r){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!r&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var f of r)f.markers.length==1&&a.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?a.has(h.marker)||ot.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>ot.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ot.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,r),i.markers.forEach(a=>ot.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,i),this.onClusterClick(a,i,r)})),ot.setMap(i.marker,r)})}}function qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Wo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Jl(t){var e=qa(),[r,i]=l.useState(null);return l.useEffect(()=>{if(e&&r===null){var a=new Xl(Wo(Wo({},t),{},{map:e}));i(a)}},[e]),r}function Ql(t){var{children:e,options:r}=t,i=Jl(r);return i!==null?e(i):null}l.memo(Ql);var Zo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},$o={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function eu(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:L,onZindexChanged:w,onLoad:b,onUnmount:x}=t,P=l.useContext(Ee),[E,A]=l.useState(null),[z,$]=l.useState(null),[W,te]=l.useState(null),[K,j]=l.useState(null),[S,F]=l.useState(null),[Y,U]=l.useState(null),J=l.useRef(null);return l.useEffect(()=>{E!==null&&(E.close(),r?E.open(P,r):E.getPosition()&&E.open(P))},[P,E,r]),l.useEffect(()=>{i&&E!==null&&E.setOptions(i)},[E,i]),l.useEffect(()=>{a&&E!==null&&E.setPosition(a)},[a]),l.useEffect(()=>{typeof f=="number"&&E!==null&&E.setZIndex(f)},[f]),l.useEffect(()=>{E&&p&&(z!==null&&google.maps.event.removeListener(z),$(google.maps.event.addListener(E,"closeclick",p)))},[p]),l.useEffect(()=>{E&&h&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(E,"domready",h)))},[h]),l.useEffect(()=>{E&&m&&(K!==null&&google.maps.event.removeListener(K),j(google.maps.event.addListener(E,"content_changed",m)))},[m]),l.useEffect(()=>{E&&L&&(S!==null&&google.maps.event.removeListener(S),F(google.maps.event.addListener(E,"position_changed",L)))},[L]),l.useEffect(()=>{E&&w&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(E,"zindex_changed",w)))},[w]),l.useEffect(()=>{var G=new google.maps.InfoWindow(i);return A(G),J.current=document.createElement("div"),p&&$(google.maps.event.addListener(G,"closeclick",p)),h&&te(google.maps.event.addListener(G,"domready",h)),m&&j(google.maps.event.addListener(G,"content_changed",m)),L&&F(google.maps.event.addListener(G,"position_changed",L)),w&&U(google.maps.event.addListener(G,"zindex_changed",w)),G.setContent(J.current),a&&G.setPosition(a),f&&G.setZIndex(f),r?G.open(P,r):G.getPosition()?G.open(P):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),b&&b(G),()=>{z&&google.maps.event.removeListener(z),K&&google.maps.event.removeListener(K),W&&google.maps.event.removeListener(W),S&&google.maps.event.removeListener(S),Y&&google.maps.event.removeListener(Y),x&&x(G),G.close()}},[]),J.current?Ln.createPortal(l.Children.only(e),J.current):null}l.memo(eu);class tu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoWindow:null}),N(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),N(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=Oe({updaterMap:$o,eventMap:Zo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:$o,eventMap:Zo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(De(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(tu,"contextType",Ee);function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ho={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Go={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},nu={};function ru(t){var{options:e,draggable:r,editable:i,visible:a,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:L,onMouseMove:w,onMouseOut:b,onMouseOver:x,onMouseUp:P,onRightClick:E,onClick:A,onDrag:z,onLoad:$,onUnmount:W}=t,te=l.useContext(Ee),[K,j]=l.useState(null),[S,F]=l.useState(null),[Y,U]=l.useState(null),[J,G]=l.useState(null),[H,ce]=l.useState(null),[fe,le]=l.useState(null),[de,Le]=l.useState(null),[ye,be]=l.useState(null),[me,Me]=l.useState(null),[Ie,ve]=l.useState(null),[Ae,Z]=l.useState(null),[Te,ze]=l.useState(null);return l.useEffect(()=>{K!==null&&K.setMap(te)},[te]),l.useEffect(()=>{typeof e<"u"&&K!==null&&K.setOptions(e)},[K,e]),l.useEffect(()=>{typeof r<"u"&&K!==null&&K.setDraggable(r)},[K,r]),l.useEffect(()=>{typeof i<"u"&&K!==null&&K.setEditable(i)},[K,i]),l.useEffect(()=>{typeof a<"u"&&K!==null&&K.setVisible(a)},[K,a]),l.useEffect(()=>{typeof f<"u"&&K!==null&&K.setPath(f)},[K,f]),l.useEffect(()=>{K&&p&&(S!==null&&google.maps.event.removeListener(S),F(google.maps.event.addListener(K,"dblclick",p)))},[p]),l.useEffect(()=>{K&&h&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(K,"dragend",h)))},[h]),l.useEffect(()=>{K&&m&&(J!==null&&google.maps.event.removeListener(J),G(google.maps.event.addListener(K,"dragstart",m)))},[m]),l.useEffect(()=>{K&&L&&(H!==null&&google.maps.event.removeListener(H),ce(google.maps.event.addListener(K,"mousedown",L)))},[L]),l.useEffect(()=>{K&&w&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(K,"mousemove",w)))},[w]),l.useEffect(()=>{K&&b&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(K,"mouseout",b)))},[b]),l.useEffect(()=>{K&&x&&(ye!==null&&google.maps.event.removeListener(ye),be(google.maps.event.addListener(K,"mouseover",x)))},[x]),l.useEffect(()=>{K&&P&&(me!==null&&google.maps.event.removeListener(me),Me(google.maps.event.addListener(K,"mouseup",P)))},[P]),l.useEffect(()=>{K&&E&&(Ie!==null&&google.maps.event.removeListener(Ie),ve(google.maps.event.addListener(K,"rightclick",E)))},[E]),l.useEffect(()=>{K&&A&&(Ae!==null&&google.maps.event.removeListener(Ae),Z(google.maps.event.addListener(K,"click",A)))},[A]),l.useEffect(()=>{K&&z&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(K,"drag",z)))},[z]),l.useEffect(()=>{var Q=new google.maps.Polyline(Sr(Sr({},e||nu),{},{map:te}));return f&&Q.setPath(f),typeof a<"u"&&Q.setVisible(a),typeof i<"u"&&Q.setEditable(i),typeof r<"u"&&Q.setDraggable(r),p&&F(google.maps.event.addListener(Q,"dblclick",p)),h&&U(google.maps.event.addListener(Q,"dragend",h)),m&&G(google.maps.event.addListener(Q,"dragstart",m)),L&&ce(google.maps.event.addListener(Q,"mousedown",L)),w&&le(google.maps.event.addListener(Q,"mousemove",w)),b&&Le(google.maps.event.addListener(Q,"mouseout",b)),x&&be(google.maps.event.addListener(Q,"mouseover",x)),P&&Me(google.maps.event.addListener(Q,"mouseup",P)),E&&ve(google.maps.event.addListener(Q,"rightclick",E)),A&&Z(google.maps.event.addListener(Q,"click",A)),z&&ze(google.maps.event.addListener(Q,"drag",z)),j(Q),$&&$(Q),()=>{S!==null&&google.maps.event.removeListener(S),Y!==null&&google.maps.event.removeListener(Y),J!==null&&google.maps.event.removeListener(J),H!==null&&google.maps.event.removeListener(H),fe!==null&&google.maps.event.removeListener(fe),de!==null&&google.maps.event.removeListener(de),ye!==null&&google.maps.event.removeListener(ye),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Ae!==null&&google.maps.event.removeListener(Ae),W&&W(Q),Q.setMap(null)}},[]),null}l.memo(ru);class iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{polyline:null}),N(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Sr(Sr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:Go,eventMap:Ho,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Go,eventMap:Ho,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),De(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}N(iu,"contextType",Ee);function Yo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Xo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Jo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Qo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function ou(t){var{options:e,draggable:r,editable:i,visible:a,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:L,onMouseDown:w,onMouseMove:b,onMouseOut:x,onMouseOver:P,onMouseUp:E,onRightClick:A,onClick:z,onDrag:$,onLoad:W,onUnmount:te,onEdit:K}=t,j=l.useContext(Ee),[S,F]=l.useState(null),[Y,U]=l.useState(null),[J,G]=l.useState(null),[H,ce]=l.useState(null),[fe,le]=l.useState(null),[de,Le]=l.useState(null),[ye,be]=l.useState(null),[me,Me]=l.useState(null),[Ie,ve]=l.useState(null),[Ae,Z]=l.useState(null),[Te,ze]=l.useState(null),[Q,X]=l.useState(null);return l.useEffect(()=>{S!==null&&S.setMap(j)},[j]),l.useEffect(()=>{typeof e<"u"&&S!==null&&S.setOptions(e)},[S,e]),l.useEffect(()=>{typeof r<"u"&&S!==null&&S.setDraggable(r)},[S,r]),l.useEffect(()=>{typeof i<"u"&&S!==null&&S.setEditable(i)},[S,i]),l.useEffect(()=>{typeof a<"u"&&S!==null&&S.setVisible(a)},[S,a]),l.useEffect(()=>{typeof f<"u"&&S!==null&&S.setPath(f)},[S,f]),l.useEffect(()=>{typeof p<"u"&&S!==null&&S.setPaths(p)},[S,p]),l.useEffect(()=>{S&&typeof h=="function"&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(S,"dblclick",h)))},[h]),l.useEffect(()=>{S&&(google.maps.event.addListener(S.getPath(),"insert_at",()=>{K?.(S)}),google.maps.event.addListener(S.getPath(),"set_at",()=>{K?.(S)}),google.maps.event.addListener(S.getPath(),"remove_at",()=>{K?.(S)}))},[S,K]),l.useEffect(()=>{S&&typeof m=="function"&&(J!==null&&google.maps.event.removeListener(J),G(google.maps.event.addListener(S,"dragend",m)))},[m]),l.useEffect(()=>{S&&typeof L=="function"&&(H!==null&&google.maps.event.removeListener(H),ce(google.maps.event.addListener(S,"dragstart",L)))},[L]),l.useEffect(()=>{S&&typeof w=="function"&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(S,"mousedown",w)))},[w]),l.useEffect(()=>{S&&typeof b=="function"&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(S,"mousemove",b)))},[b]),l.useEffect(()=>{S&&typeof x=="function"&&(ye!==null&&google.maps.event.removeListener(ye),be(google.maps.event.addListener(S,"mouseout",x)))},[x]),l.useEffect(()=>{S&&typeof P=="function"&&(me!==null&&google.maps.event.removeListener(me),Me(google.maps.event.addListener(S,"mouseover",P)))},[P]),l.useEffect(()=>{S&&typeof E=="function"&&(Ie!==null&&google.maps.event.removeListener(Ie),ve(google.maps.event.addListener(S,"mouseup",E)))},[E]),l.useEffect(()=>{S&&typeof A=="function"&&(Ae!==null&&google.maps.event.removeListener(Ae),Z(google.maps.event.addListener(S,"rightclick",A)))},[A]),l.useEffect(()=>{S&&typeof z=="function"&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(S,"click",z)))},[z]),l.useEffect(()=>{S&&typeof $=="function"&&(Q!==null&&google.maps.event.removeListener(Q),X(google.maps.event.addListener(S,"drag",$)))},[$]),l.useEffect(()=>{var ge=new google.maps.Polygon(Xo(Xo({},e),{},{map:j}));return f&&ge.setPath(f),p&&ge.setPaths(p),typeof a<"u"&&ge.setVisible(a),typeof i<"u"&&ge.setEditable(i),typeof r<"u"&&ge.setDraggable(r),h&&U(google.maps.event.addListener(ge,"dblclick",h)),m&&G(google.maps.event.addListener(ge,"dragend",m)),L&&ce(google.maps.event.addListener(ge,"dragstart",L)),w&&le(google.maps.event.addListener(ge,"mousedown",w)),b&&Le(google.maps.event.addListener(ge,"mousemove",b)),x&&be(google.maps.event.addListener(ge,"mouseout",x)),P&&Me(google.maps.event.addListener(ge,"mouseover",P)),E&&ve(google.maps.event.addListener(ge,"mouseup",E)),A&&Z(google.maps.event.addListener(ge,"rightclick",A)),z&&ze(google.maps.event.addListener(ge,"click",z)),$&&X(google.maps.event.addListener(ge,"drag",$)),F(ge),W&&W(ge),()=>{Y!==null&&google.maps.event.removeListener(Y),J!==null&&google.maps.event.removeListener(J),H!==null&&google.maps.event.removeListener(H),fe!==null&&google.maps.event.removeListener(fe),de!==null&&google.maps.event.removeListener(de),ye!==null&&google.maps.event.removeListener(ye),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Ae!==null&&google.maps.event.removeListener(Ae),Te!==null&&google.maps.event.removeListener(Te),te&&te(ge),ge.setMap(null)}},[]),null}l.memo(ou);class su extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=Oe({updaterMap:Qo,eventMap:Jo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Qo,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),De(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}N(su,"contextType",Ee);function es(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?es(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ts={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ns={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function au(t){var{options:e,bounds:r,draggable:i,editable:a,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:L,onMouseMove:w,onMouseOut:b,onMouseOver:x,onMouseUp:P,onRightClick:E,onClick:A,onDrag:z,onBoundsChanged:$,onLoad:W,onUnmount:te}=t,K=l.useContext(Ee),[j,S]=l.useState(null),[F,Y]=l.useState(null),[U,J]=l.useState(null),[G,H]=l.useState(null),[ce,fe]=l.useState(null),[le,de]=l.useState(null),[Le,ye]=l.useState(null),[be,me]=l.useState(null),[Me,Ie]=l.useState(null),[ve,Ae]=l.useState(null),[Z,Te]=l.useState(null),[ze,Q]=l.useState(null),[X,ge]=l.useState(null);return l.useEffect(()=>{j!==null&&j.setMap(K)},[K]),l.useEffect(()=>{typeof e<"u"&&j!==null&&j.setOptions(e)},[j,e]),l.useEffect(()=>{typeof i<"u"&&j!==null&&j.setDraggable(i)},[j,i]),l.useEffect(()=>{typeof a<"u"&&j!==null&&j.setEditable(a)},[j,a]),l.useEffect(()=>{typeof f<"u"&&j!==null&&j.setVisible(f)},[j,f]),l.useEffect(()=>{typeof r<"u"&&j!==null&&j.setBounds(r)},[j,r]),l.useEffect(()=>{j&&p&&(F!==null&&google.maps.event.removeListener(F),Y(google.maps.event.addListener(j,"dblclick",p)))},[p]),l.useEffect(()=>{j&&h&&(U!==null&&google.maps.event.removeListener(U),J(google.maps.event.addListener(j,"dragend",h)))},[h]),l.useEffect(()=>{j&&m&&(G!==null&&google.maps.event.removeListener(G),H(google.maps.event.addListener(j,"dragstart",m)))},[m]),l.useEffect(()=>{j&&L&&(ce!==null&&google.maps.event.removeListener(ce),fe(google.maps.event.addListener(j,"mousedown",L)))},[L]),l.useEffect(()=>{j&&w&&(le!==null&&google.maps.event.removeListener(le),de(google.maps.event.addListener(j,"mousemove",w)))},[w]),l.useEffect(()=>{j&&b&&(Le!==null&&google.maps.event.removeListener(Le),ye(google.maps.event.addListener(j,"mouseout",b)))},[b]),l.useEffect(()=>{j&&x&&(be!==null&&google.maps.event.removeListener(be),me(google.maps.event.addListener(j,"mouseover",x)))},[x]),l.useEffect(()=>{j&&P&&(Me!==null&&google.maps.event.removeListener(Me),Ie(google.maps.event.addListener(j,"mouseup",P)))},[P]),l.useEffect(()=>{j&&E&&(ve!==null&&google.maps.event.removeListener(ve),Ae(google.maps.event.addListener(j,"rightclick",E)))},[E]),l.useEffect(()=>{j&&A&&(Z!==null&&google.maps.event.removeListener(Z),Te(google.maps.event.addListener(j,"click",A)))},[A]),l.useEffect(()=>{j&&z&&(ze!==null&&google.maps.event.removeListener(ze),Q(google.maps.event.addListener(j,"drag",z)))},[z]),l.useEffect(()=>{j&&$&&(X!==null&&google.maps.event.removeListener(X),ge(google.maps.event.addListener(j,"bounds_changed",$)))},[$]),l.useEffect(()=>{var _e=new google.maps.Rectangle(Pr(Pr({},e),{},{map:K}));return typeof f<"u"&&_e.setVisible(f),typeof a<"u"&&_e.setEditable(a),typeof i<"u"&&_e.setDraggable(i),typeof r<"u"&&_e.setBounds(r),p&&Y(google.maps.event.addListener(_e,"dblclick",p)),h&&J(google.maps.event.addListener(_e,"dragend",h)),m&&H(google.maps.event.addListener(_e,"dragstart",m)),L&&fe(google.maps.event.addListener(_e,"mousedown",L)),w&&de(google.maps.event.addListener(_e,"mousemove",w)),b&&ye(google.maps.event.addListener(_e,"mouseout",b)),x&&me(google.maps.event.addListener(_e,"mouseover",x)),P&&Ie(google.maps.event.addListener(_e,"mouseup",P)),E&&Ae(google.maps.event.addListener(_e,"rightclick",E)),A&&Te(google.maps.event.addListener(_e,"click",A)),z&&Q(google.maps.event.addListener(_e,"drag",z)),$&&ge(google.maps.event.addListener(_e,"bounds_changed",$)),S(_e),W&&W(_e),()=>{F!==null&&google.maps.event.removeListener(F),U!==null&&google.maps.event.removeListener(U),G!==null&&google.maps.event.removeListener(G),ce!==null&&google.maps.event.removeListener(ce),le!==null&&google.maps.event.removeListener(le),Le!==null&&google.maps.event.removeListener(Le),be!==null&&google.maps.event.removeListener(be),Me!==null&&google.maps.event.removeListener(Me),ve!==null&&google.maps.event.removeListener(ve),Z!==null&&google.maps.event.removeListener(Z),ze!==null&&google.maps.event.removeListener(ze),X!==null&&google.maps.event.removeListener(X),te&&te(_e),_e.setMap(null)}},[]),null}l.memo(au);class lu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{rectangle:null}),N(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ns,eventMap:ts,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ns,eventMap:ts,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),De(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}N(lu,"contextType",Ee);function rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var is={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},os={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},uu={};function cu(t){var{options:e,center:r,radius:i,draggable:a,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:L,onMouseDown:w,onMouseMove:b,onMouseOut:x,onMouseOver:P,onMouseUp:E,onRightClick:A,onClick:z,onDrag:$,onCenterChanged:W,onRadiusChanged:te,onLoad:K,onUnmount:j}=t,S=l.useContext(Ee),[F,Y]=l.useState(null),[U,J]=l.useState(null),[G,H]=l.useState(null),[ce,fe]=l.useState(null),[le,de]=l.useState(null),[Le,ye]=l.useState(null),[be,me]=l.useState(null),[Me,Ie]=l.useState(null),[ve,Ae]=l.useState(null),[Z,Te]=l.useState(null),[ze,Q]=l.useState(null),[X,ge]=l.useState(null),[_e,ke]=l.useState(null),[Xe,qt]=l.useState(null);return l.useEffect(()=>{F!==null&&F.setMap(S)},[S]),l.useEffect(()=>{typeof e<"u"&&F!==null&&F.setOptions(e)},[F,e]),l.useEffect(()=>{typeof a<"u"&&F!==null&&F.setDraggable(a)},[F,a]),l.useEffect(()=>{typeof f<"u"&&F!==null&&F.setEditable(f)},[F,f]),l.useEffect(()=>{typeof p<"u"&&F!==null&&F.setVisible(p)},[F,p]),l.useEffect(()=>{typeof i=="number"&&F!==null&&F.setRadius(i)},[F,i]),l.useEffect(()=>{typeof r<"u"&&F!==null&&F.setCenter(r)},[F,r]),l.useEffect(()=>{F&&h&&(U!==null&&google.maps.event.removeListener(U),J(google.maps.event.addListener(F,"dblclick",h)))},[h]),l.useEffect(()=>{F&&m&&(G!==null&&google.maps.event.removeListener(G),H(google.maps.event.addListener(F,"dragend",m)))},[m]),l.useEffect(()=>{F&&L&&(ce!==null&&google.maps.event.removeListener(ce),fe(google.maps.event.addListener(F,"dragstart",L)))},[L]),l.useEffect(()=>{F&&w&&(le!==null&&google.maps.event.removeListener(le),de(google.maps.event.addListener(F,"mousedown",w)))},[w]),l.useEffect(()=>{F&&b&&(Le!==null&&google.maps.event.removeListener(Le),ye(google.maps.event.addListener(F,"mousemove",b)))},[b]),l.useEffect(()=>{F&&x&&(be!==null&&google.maps.event.removeListener(be),me(google.maps.event.addListener(F,"mouseout",x)))},[x]),l.useEffect(()=>{F&&P&&(Me!==null&&google.maps.event.removeListener(Me),Ie(google.maps.event.addListener(F,"mouseover",P)))},[P]),l.useEffect(()=>{F&&E&&(ve!==null&&google.maps.event.removeListener(ve),Ae(google.maps.event.addListener(F,"mouseup",E)))},[E]),l.useEffect(()=>{F&&A&&(Z!==null&&google.maps.event.removeListener(Z),Te(google.maps.event.addListener(F,"rightclick",A)))},[A]),l.useEffect(()=>{F&&z&&(ze!==null&&google.maps.event.removeListener(ze),Q(google.maps.event.addListener(F,"click",z)))},[z]),l.useEffect(()=>{F&&$&&(X!==null&&google.maps.event.removeListener(X),ge(google.maps.event.addListener(F,"drag",$)))},[$]),l.useEffect(()=>{F&&W&&(_e!==null&&google.maps.event.removeListener(_e),ke(google.maps.event.addListener(F,"center_changed",W)))},[z]),l.useEffect(()=>{F&&te&&(Xe!==null&&google.maps.event.removeListener(Xe),qt(google.maps.event.addListener(F,"radius_changed",te)))},[te]),l.useEffect(()=>{var je=new google.maps.Circle(Or(Or({},e||uu),{},{map:S}));return typeof i=="number"&&je.setRadius(i),typeof r<"u"&&je.setCenter(r),typeof i=="number"&&je.setRadius(i),typeof p<"u"&&je.setVisible(p),typeof f<"u"&&je.setEditable(f),typeof a<"u"&&je.setDraggable(a),h&&J(google.maps.event.addListener(je,"dblclick",h)),m&&H(google.maps.event.addListener(je,"dragend",m)),L&&fe(google.maps.event.addListener(je,"dragstart",L)),w&&de(google.maps.event.addListener(je,"mousedown",w)),b&&ye(google.maps.event.addListener(je,"mousemove",b)),x&&me(google.maps.event.addListener(je,"mouseout",x)),P&&Ie(google.maps.event.addListener(je,"mouseover",P)),E&&Ae(google.maps.event.addListener(je,"mouseup",E)),A&&Te(google.maps.event.addListener(je,"rightclick",A)),z&&Q(google.maps.event.addListener(je,"click",z)),$&&ge(google.maps.event.addListener(je,"drag",$)),W&&ke(google.maps.event.addListener(je,"center_changed",W)),te&&qt(google.maps.event.addListener(je,"radius_changed",te)),Y(je),K&&K(je),()=>{U!==null&&google.maps.event.removeListener(U),G!==null&&google.maps.event.removeListener(G),ce!==null&&google.maps.event.removeListener(ce),le!==null&&google.maps.event.removeListener(le),Le!==null&&google.maps.event.removeListener(Le),be!==null&&google.maps.event.removeListener(be),Me!==null&&google.maps.event.removeListener(Me),ve!==null&&google.maps.event.removeListener(ve),Z!==null&&google.maps.event.removeListener(Z),ze!==null&&google.maps.event.removeListener(ze),_e!==null&&google.maps.event.removeListener(_e),Xe!==null&&google.maps.event.removeListener(Xe),j&&j(je),je.setMap(null)}},[]),null}l.memo(cu);class fu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{circle:null}),N(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:os,eventMap:is,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:os,eventMap:is,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),De(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}N(fu,"contextType",Ee);function ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var as={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ls={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,i){t.loadGeoJson(e,r,i)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function du(t){var{options:e,onClick:r,onDblClick:i,onMouseDown:a,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:L,onAddFeature:w,onRemoveFeature:b,onRemoveProperty:x,onSetGeometry:P,onSetProperty:E,onLoad:A,onUnmount:z}=t,$=l.useContext(Ee),[W,te]=l.useState(null),[K,j]=l.useState(null),[S,F]=l.useState(null),[Y,U]=l.useState(null),[J,G]=l.useState(null),[H,ce]=l.useState(null),[fe,le]=l.useState(null),[de,Le]=l.useState(null),[ye,be]=l.useState(null),[me,Me]=l.useState(null),[Ie,ve]=l.useState(null),[Ae,Z]=l.useState(null),[Te,ze]=l.useState(null),[Q,X]=l.useState(null);return l.useEffect(()=>{W!==null&&W.setMap($)},[$]),l.useEffect(()=>{W&&i&&(K!==null&&google.maps.event.removeListener(K),j(google.maps.event.addListener(W,"dblclick",i)))},[i]),l.useEffect(()=>{W&&a&&(S!==null&&google.maps.event.removeListener(S),F(google.maps.event.addListener(W,"mousedown",a)))},[a]),l.useEffect(()=>{W&&f&&(Y!==null&&google.maps.event.removeListener(Y),U(google.maps.event.addListener(W,"mousemove",f)))},[f]),l.useEffect(()=>{W&&p&&(J!==null&&google.maps.event.removeListener(J),G(google.maps.event.addListener(W,"mouseout",p)))},[p]),l.useEffect(()=>{W&&h&&(H!==null&&google.maps.event.removeListener(H),ce(google.maps.event.addListener(W,"mouseover",h)))},[h]),l.useEffect(()=>{W&&m&&(fe!==null&&google.maps.event.removeListener(fe),le(google.maps.event.addListener(W,"mouseup",m)))},[m]),l.useEffect(()=>{W&&L&&(de!==null&&google.maps.event.removeListener(de),Le(google.maps.event.addListener(W,"rightclick",L)))},[L]),l.useEffect(()=>{W&&r&&(ye!==null&&google.maps.event.removeListener(ye),be(google.maps.event.addListener(W,"click",r)))},[r]),l.useEffect(()=>{W&&w&&(me!==null&&google.maps.event.removeListener(me),Me(google.maps.event.addListener(W,"addfeature",w)))},[w]),l.useEffect(()=>{W&&b&&(Ie!==null&&google.maps.event.removeListener(Ie),ve(google.maps.event.addListener(W,"removefeature",b)))},[b]),l.useEffect(()=>{W&&x&&(Ae!==null&&google.maps.event.removeListener(Ae),Z(google.maps.event.addListener(W,"removeproperty",x)))},[x]),l.useEffect(()=>{W&&P&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(W,"setgeometry",P)))},[P]),l.useEffect(()=>{W&&E&&(Q!==null&&google.maps.event.removeListener(Q),X(google.maps.event.addListener(W,"setproperty",E)))},[E]),l.useEffect(()=>{if($!==null){var ge=new google.maps.Data(_r(_r({},e),{},{map:$}));i&&j(google.maps.event.addListener(ge,"dblclick",i)),a&&F(google.maps.event.addListener(ge,"mousedown",a)),f&&U(google.maps.event.addListener(ge,"mousemove",f)),p&&G(google.maps.event.addListener(ge,"mouseout",p)),h&&ce(google.maps.event.addListener(ge,"mouseover",h)),m&&le(google.maps.event.addListener(ge,"mouseup",m)),L&&Le(google.maps.event.addListener(ge,"rightclick",L)),r&&be(google.maps.event.addListener(ge,"click",r)),w&&Me(google.maps.event.addListener(ge,"addfeature",w)),b&&ve(google.maps.event.addListener(ge,"removefeature",b)),x&&Z(google.maps.event.addListener(ge,"removeproperty",x)),P&&ze(google.maps.event.addListener(ge,"setgeometry",P)),E&&X(google.maps.event.addListener(ge,"setproperty",E)),te(ge),A&&A(ge)}return()=>{W&&(K!==null&&google.maps.event.removeListener(K),S!==null&&google.maps.event.removeListener(S),Y!==null&&google.maps.event.removeListener(Y),J!==null&&google.maps.event.removeListener(J),H!==null&&google.maps.event.removeListener(H),fe!==null&&google.maps.event.removeListener(fe),de!==null&&google.maps.event.removeListener(de),ye!==null&&google.maps.event.removeListener(ye),me!==null&&google.maps.event.removeListener(me),Ie!==null&&google.maps.event.removeListener(Ie),Ae!==null&&google.maps.event.removeListener(Ae),Te!==null&&google.maps.event.removeListener(Te),Q!==null&&google.maps.event.removeListener(Q),z&&z(W),W.setMap(null))}},[]),null}l.memo(du);class pu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{data:null}),N(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ls,eventMap:as,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ls,eventMap:as,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),De(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}N(pu,"contextType",Ee);function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function cs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var fs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},ds={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class hu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{kmlLayer:null}),N(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(cs(cs({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ds,eventMap:fs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ds,eventMap:fs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),De(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}N(hu,"contextType",Ee);function ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function gu(t,e){return new e(t.lat,t.lng)}function mu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){return t instanceof e?t:r(t,e)}function bu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r.getNorthEast()),a=t&&t.fromLatLngToDivPixel(r.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function wu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r);if(i){var{x:a,y:f}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function na(t,e,r,i){return r!==void 0?bu(t,e,yu(r,google.maps.LatLngBounds,mu)):wu(t,e,vu(i,google.maps.LatLng,gu))}function Lu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Cu(t,e,r,i,a){class f extends google.maps.OverlayView{constructor(h,m,L,w){super(),this.container=h,this.pane=m,this.position=L,this.bounds=w}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=xu({},this.container?ta(this.container,a):{x:0,y:0}),L=na(h,m,this.bounds,this.position);for(var[w,b]of Object.entries(L))this.container.style[w]=b}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,i)}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Eu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function ms(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Mu(t){var{position:e,bounds:r,mapPaneName:i,zIndex:a,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,L=l.useContext(Ee),w=l.useMemo(()=>{var x=document.createElement("div");return x.style.position="absolute",x},[]),b=l.useMemo(()=>Cu(w,i,e,r,h),[w,i,e,r]);return l.useEffect(()=>(f?.(b),b?.setMap(L),()=>{p?.(b),b?.setMap(null)}),[L,b]),l.useEffect(()=>{w.style.zIndex="".concat(a)},[a,w]),Ln.createPortal(m,w)}l.memo(Mu);class Lt extends l.PureComponent{constructor(e){super(e),N(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),N(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();We(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),N(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),N(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=Eu({x:0,y:0},this.containerRef.current?ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=na(i,a,this.props.bounds,this.props.position);if(!Lu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,L;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(L=f.height)!==null&&L!==void 0?L:0,position:"absolute"}})}}),N(this,"draw",()=>{this.onPositionElement()}),N(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=l.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=gs(e.position),i=gs(this.props.position),a=ms(e.bounds),f=ms(this.props.bounds);(r!==i||a!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(oe.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:l.Children.only(this.props.children)}),e):null}}N(Lt,"FLOAT_PANE","floatPane");N(Lt,"MAP_PANE","mapPane");N(Lt,"MARKER_LAYER","markerLayer");N(Lt,"OVERLAY_LAYER","overlayLayer");N(Lt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");N(Lt,"contextType",Ee);function ku(){}function vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var bs={onDblClick:"dblclick",onClick:"click"},ws={opacity(t,e){t.setOpacity(e)}};function Su(t){var{url:e,bounds:r,options:i,visible:a}=t,f=l.useContext(Ee),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=l.useMemo(()=>new google.maps.GroundOverlay(e,p,i),[]);return l.useEffect(()=>{h!==null&&h.setMap(f)},[f]),l.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),l.useEffect(()=>{typeof a<"u"&&h!==null&&h.setOpacity(a?1:0)},[h,a]),l.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}l.memo(Su);class ra extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{groundOverlay:null}),N(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){We(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ys(ys({},this.props.options),{},{map:this.context}));this.registeredEvents=Oe({updaterMap:ws,eventMap:bs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:ws,eventMap:bs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}N(ra,"defaultProps",{onLoad:ku});N(ra,"contextType",Ee);function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var xs={},Cs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Pu(t){var{data:e,onLoad:r,onUnmount:i,options:a}=t,f=l.useContext(Ee),[p,h]=l.useState(null);return l.useEffect(()=>{google.maps.visualization||We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),l.useEffect(()=>{We(!!e,"data property is required in HeatmapLayer %s",e)},[e]),l.useEffect(()=>{p!==null&&p.setMap(f)},[f]),l.useEffect(()=>{a&&p!==null&&p.setOptions(a)},[p,a]),l.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Dr(Dr({},a),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(i&&i(p),p.setMap(null))}},[]),null}l.memo(Pu);class Ou extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{heatmapLayer:null}),N(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),We(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Dr(Dr({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=Oe({updaterMap:Cs,eventMap:xs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Cs,eventMap:xs,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),De(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}N(Ou,"contextType",Ee);var Es={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Ms={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{streetViewPanorama:null}),N(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,i=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=Oe({updaterMap:Ms,eventMap:Es,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ms,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),De(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}N(_u,"contextType",Ee);class Du extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{streetViewService:null}),N(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}N(Du,"contextType",Ee);var ks={onDirectionsChanged:"directions_changed"},Ss={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{directionsRenderer:null}),N(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=Oe({updaterMap:Ss,eventMap:ks,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ss,eventMap:ks,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),De(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}N(Iu,"contextType",Ee);var Ps={onPlacesChanged:"places_changed"},Os={bounds(t,e){t.setBounds(e)}};class ju extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{searchBox:null}),N(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=Oe({updaterMap:Os,eventMap:Ps,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Os,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),De(this.registeredEvents))}render(){return oe.jsx("div",{ref:this.containerElement,children:l.Children.only(this.props.children)})}}N(ju,"contextType",Ee);var _s={onPlaceChanged:"place_changed"},Ds={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ia extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{autocomplete:null}),N(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var i=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=Oe({updaterMap:Ds,eventMap:_s,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){De(this.registeredEvents),this.registeredEvents=Oe({updaterMap:Ds,eventMap:_s,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&De(this.registeredEvents)}render(){return oe.jsx("div",{ref:this.containerElement,className:this.props.className,children:l.Children.only(this.props.children)})}}N(ia,"defaultProps",{className:""});N(ia,"contextType",Ee);const ut=5e-4,Ru=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const i=e.createImageData(r,r),a=i.data;for(let f=0;f<a.length;f+=4){const p=Math.random()*100;a[f]=p,a[f+1]=p,a[f+2]=p,a[f+3]=5}return e.putImageData(i,0,0),e.createPattern(t,"repeat")},Au=({map:t,zoom:e,claimedCells:r,exploredCells:i,hoveredCell:a,isAnimating:f,selectedCell:p,effects:h})=>{const m=l.useRef(null),L=l.useRef(null),[w,b]=l.useState({claimed:[],explored:[]}),x=l.useRef(),P=l.useRef(null),E=l.useRef(null);return l.useEffect(()=>{L.current&&L.current.postMessage({type:"DATA_UPDATED"})},[r,i]),l.useEffect(()=>{if(!t)return;class A extends window.google.maps.OverlayView{constructor(S,F){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.noisePattern=S,this.hoveredCellRef=F,this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.effectsCanvas=document.createElement("canvas"),this.effectsCtx=this.effectsCanvas.getContext("2d"),this.effectsCanvas.style.position="absolute",this.effectsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none"}setProps(S){this.props={...this.props,...S}}setDrawableCells(S,F){this.drawableClaimed=S,this.drawableExplored=F}onAdd(){const S=this.getPanes();S.overlayLayer.appendChild(this.fogCanvas),S.overlayMouseTarget.appendChild(this.effectsCanvas),S.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(S=>{S.parentElement&&S.parentElement.removeChild(S)})}draw(){const S=this.getProjection();if(!S)return;const F=.5,Y=this.getMap().getBounds(),U=Y.getSouthWest(),J=Y.getNorthEast(),G=S.fromLatLngToDivPixel(U),H=S.fromLatLngToDivPixel(J);if(!G||!H)return;const ce=H.x-G.x,fe=G.y-H.y,le=Math.round(ce*F),de=Math.round(fe*F),Le=ce+2*le,ye=fe+2*de;this.swPixel={x:G.x-le,y:G.y+de},this.nePixel={x:H.x+le,y:H.y-de},[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(be=>{be.style.left=`${G.x-le}px`,be.style.top=`${H.y-de}px`,be.width=Le,be.height=ye}),this.drawFog(),this.drawDynamic()}drawFog(){this.swPixel&&(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.noisePattern&&(this.fogCtx.fillStyle=this.noisePattern,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(S=>this.drawStaticReveal(S)),this.fogCtx.globalCompositeOperation="source-over")}drawStaticReveal(S){const F=this.getProjection();if(!F||!this.swPixel)return;const{south:Y,west:U}=S,J=new window.google.maps.LatLng(Y,U),G=new window.google.maps.LatLng(Y+ut,U+ut),H=F.fromLatLngToDivPixel(J),ce=F.fromLatLngToDivPixel(G);if(!H||!ce)return;const fe=H.x-this.swPixel.x,le=ce.y-this.nePixel.y,de=ce.x-H.x,Le=H.y-ce.y;if(this.props.zoom<14)this.fogCtx.fillStyle="rgba(0, 0, 0, 1)",this.fogCtx.fillRect(fe,le,de,Le);else{const ye=fe+de/2,be=le+Le/2,me=de*2.5,Me=Le*2.5,Ie=this.fogCtx.createRadialGradient(ye,be,0,ye,be,Math.max(me,Me));Ie.addColorStop(0,"rgba(0, 0, 0, 1)"),Ie.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=Ie,this.fogCtx.beginPath(),this.fogCtx.ellipse(ye,be,me,Me,0,0,2*Math.PI),this.fogCtx.fill()}}drawRevealEffect(S,F,Y){const U=new window.google.maps.LatLng(S.position.lat,S.position.lng),J=Y.fromLatLngToDivPixel(U);if(!J||!this.swPixel)return;const G=J.x-this.swPixel.x,H=J.y-this.nePixel.y,ce=new window.google.maps.LatLng(S.position.lat,S.position.lng),fe=new window.google.maps.LatLng(S.position.lat+ut,S.position.lng+ut),le=Y.fromLatLngToDivPixel(ce),de=Y.fromLatLngToDivPixel(fe);if(!le||!de)return;const be=(de.x-le.x)*2.5*F,me=this.fogCtx.createRadialGradient(G,H,0,G,H,be);me.addColorStop(0,"rgba(0, 0, 0, 1)"),me.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.globalCompositeOperation="destination-out",this.fogCtx.fillStyle=me,this.fogCtx.beginPath(),this.fogCtx.arc(G,H,be,0,2*Math.PI),this.fogCtx.fill(),this.fogCtx.globalCompositeOperation="source-over"}drawParticleEffect(S,F,Y){const U=new window.google.maps.LatLng(S.position.lat,S.position.lng),J=Y.fromLatLngToDivPixel(U);if(!J||!this.swPixel)return;const G=J.x-this.swPixel.x,H=J.y-this.nePixel.y,fe=80*(.1+1.4*F),le=.6*(1-F),de=this.effectsCtx.createRadialGradient(G,H,0,G,H,fe);de.addColorStop(0,`rgba(255, 255, 255, ${le*.5})`),de.addColorStop(.5,`rgba(255, 255, 255, ${le*.5})`),de.addColorStop(1,"rgba(255, 255, 255, 0)"),this.effectsCtx.fillStyle=de,this.effectsCtx.filter="blur(20px)",this.effectsCtx.beginPath(),this.effectsCtx.arc(G,H,fe,0,2*Math.PI),this.effectsCtx.fill(),this.effectsCtx.filter="none"}clearEffects(){this.effectsCtx&&this.effectsCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)}drawClaimedCells(S){this.drawableClaimed.forEach(F=>{const{south:Y,west:U}=F,J=new window.google.maps.LatLng(Y,U),G=new window.google.maps.LatLng(Y+ut,U+ut),H=S.fromLatLngToDivPixel(J),ce=S.fromLatLngToDivPixel(G);if(!H||!ce)return;const fe=H.x-this.swPixel.x,le=ce.y-this.nePixel.y,de=ce.x-H.x,Le=H.y-ce.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.2)",this.dynamicCtx.fillRect(fe,le,de,Le)})}drawDynamic(){const S=this.getProjection();if(!S||!this.swPixel)return;const{selectedCell:F}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height),this.drawClaimedCells(S);const Y=F?F.key:this.hoveredCellRef.current;if(!Y)return;const[U,J]=Y.split("_").map(Number),G=U*ut,H=J*ut,ce=new window.google.maps.LatLng(G,H),fe=new window.google.maps.LatLng(G+ut,H+ut),le=S.fromLatLngToDivPixel(ce),de=S.fromLatLngToDivPixel(fe);if(!le||!de)return;const Le=le.x-this.swPixel.x,ye=de.y-this.nePixel.y,be=de.x-le.x,me=le.y-de.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(Le,ye,be,me)}}P.current=Ru();const z=new A(P.current,E);z.setMap(t),m.current=z;const $=new Worker(new URL("/chill-demo/assets/grid.worker-I8HEKdUQ.js",import.meta.url),{type:"module"});L.current=$,$.onmessage=j=>{const{claimedCellsToDraw:S,exploredCellsToDraw:F}=j.data;b({claimed:S,explored:F})};const W=t.addListener("idle",()=>{if(L.current){const j=t.getBounds();j&&L.current.postMessage({type:"BOUNDS_CHANGED",payload:{bounds:{southwest:{lat:j.getSouthWest().lat(),lng:j.getSouthWest().lng()},northeast:{lat:j.getNorthEast().lat(),lng:j.getNorthEast().lng()}}}})}}),te=j=>{if(t.getZoom()<15){E.current&&(E.current=null);return}const S=`${Math.floor(j.latLng.lat()/ut)}_${Math.floor(j.latLng.lng()/ut)}`;S!==E.current&&(E.current=S)},K=()=>{E.current&&(E.current=null)};return t.addListener("mousemove",te),t.addListener("mouseout",K),()=>{$.terminate(),z.setMap(null),window.google.maps.event.removeListener(W),window.google.maps.event.removeListener(te),window.google.maps.event.removeListener(K),x.current&&cancelAnimationFrame(x.current)}},[t]),l.useEffect(()=>{const A=m.current;if(!A)return;let z=null;const $=()=>{E.current!==z&&(A.drawDynamic(),z=E.current),x.current=requestAnimationFrame($)};return x.current=requestAnimationFrame($),()=>{x.current&&cancelAnimationFrame(x.current)}},[]),l.useEffect(()=>{m.current&&(m.current.setDrawableCells(w.claimed,w.explored),m.current.drawFog())},[w]),l.useEffect(()=>{m.current&&(m.current.setProps({zoom:e,hoveredCell:a,isAnimating:f,selectedCell:p}),m.current.drawDynamic())},[e,a,f,p]),l.useEffect(()=>{const A=m.current;if(!A||h.length===0)return;const z=new Map,$=()=>{const W=A.getProjection();if(!W||!A.swPixel){x.current=requestAnimationFrame($);return}A.effectsCtx.clearRect(0,0,A.effectsCanvas.width,A.effectsCanvas.height),A.drawFog();let te=!1;const K=Date.now();h.forEach(j=>{const S=K-j.startTime;S<j.particleDuration&&(te=!0,A.drawParticleEffect(j,S/j.particleDuration,W)),S<j.revealDuration&&(te=!0,A.drawRevealEffect(j,S/j.revealDuration,W)),S>=j.revealDuration&&!z.has(j.id)&&(j.onComplete?.(),z.set(j.id,!0))}),te?x.current=requestAnimationFrame($):A.drawFog()};return x.current=requestAnimationFrame($),()=>{x.current&&cancelAnimationFrame(x.current),A&&(A.clearEffects(),A.drawFog())}},[h]),null},Tu="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Is=new Audio(Tu),xi=()=>{Is.currentTime=0,Is.play().catch(t=>{console.error("Audio playback failed:",t)})},rt={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},Bu=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:i})=>{const{countryName:a,regionName:f,flagUrl:p,isLoading:h}=t,m=w=>{w.stopPropagation(),xi(),e()},L=w=>{w.stopPropagation(),xi(),r()};return oe.jsxs("div",{style:rt.container,onClick:w=>w.stopPropagation(),children:[oe.jsx("button",{style:rt.closeButton,onClick:L,children:"×"}),oe.jsx("div",{style:rt.header,children:h?oe.jsx("div",{style:rt.loader}):oe.jsxs(oe.Fragment,{children:[p&&oe.jsx("img",{src:p,alt:"Flag",style:rt.flag}),oe.jsxs("div",{style:rt.location,children:[oe.jsx("span",{style:rt.country,children:a}),oe.jsx("span",{style:rt.region,children:f}),oe.jsxs("span",{style:rt.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),oe.jsxs("div",{style:rt.body,children:[oe.jsx("p",{style:rt.text,children:"Do you want to claim this area?"}),oe.jsxs("button",{style:rt.claimButton,onClick:m,disabled:i,children:[oe.jsx("span",{style:rt.cloudIcon,children:"☁️"}),"Claim"]})]})]})},oa=l.memo(Bu),vi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},Uu=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,zu=()=>(Qt.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=Uu,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),Fu=({position:t})=>oe.jsxs(oe.Fragment,{children:[oe.jsx(zu,{}),oe.jsx(Lt,{position:t,mapPaneName:Lt.MARKER_LAYER,children:oe.jsxs("div",{style:vi.pulseContainer,children:[oe.jsx("div",{style:vi.pulse}),oe.jsx("div",{style:vi.dot})]})})]}),Ku=l.memo(Fu),Kt=(t,e,r,i=null,a=null)=>new Promise(f=>{a&&a(!0);const p=t.getCenter(),h=t.getZoom(),m=Date.now(),L=()=>{const w=Date.now(),b=Math.min((w-m)/r,1),x=b*b*(3-2*b),P={lat:p.lat()+(e.lat-p.lat())*x,lng:p.lng()+(e.lng-p.lng())*x},E=i!==null?h+(i-h)*x:h;t.moveCamera({center:P,zoom:E}),b<1?requestAnimationFrame(L):(a&&a(!1),f())};L()});let Un=null;function Nu(){return Un||(Un=new Promise((t,e)=>{const r=new Worker(new URL("/chill-demo/assets/data.worker-CHrZMG89.js",import.meta.url),{type:"module"});r.onmessage=i=>{i.data.success?t(i.data.users):(console.error("Error message from worker:",i.data.error),e(new Error(i.data.error))),r.terminate()},r.onerror=i=>{console.error("Error with worker:",i),e(new Error(`Worker error: ${i.message}`)),r.terminate(),Un=null},r.postMessage({csvPath:"/chill-demo/user_location.csv"})}),Un)}const qu=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=64;t.width=r,t.height=r,e.fillStyle="#E0E0E0",e.beginPath(),e.arc(r/2,r/2,r/2,0,Math.PI*2),e.fill(),e.fillStyle="#A0A0A0",e.beginPath(),e.arc(r/2,r/2-8,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(r/2,r/2+15,15,Math.PI,Math.PI*2,!1),e.fill();const i=new Image;return i.src=t.toDataURL(),i},Wu=({user:t,onClose:e})=>{const r=(i,a)=>!i||!a?{x:0,y:0}:{x:-(i/2),y:-(a+40)};return oe.jsx(Lt,{position:{lat:t.lat,lng:t.lng},mapPaneName:Lt.FLOAT_PANE,getPixelPositionOffset:r,children:oe.jsxs("div",{onMouseDown:i=>i.stopPropagation(),style:{background:"white",padding:"10px 15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",width:"150px"},children:[oe.jsx("img",{src:t.avatarUrl,alt:t.name,style:{width:"50px",height:"50px",borderRadius:"50%"}}),oe.jsx("strong",{style:{fontSize:"14px"},children:t.name||"Anonymous"}),oe.jsx("button",{onClick:e,style:{position:"absolute",top:"8px",right:"8px",background:"#F0F0F0",border:"none",fontSize:"14px",cursor:"pointer",color:"#888",zIndex:10,width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]})})},Zu=({map:t,users:e,isVisible:r})=>{const i=l.useRef(null),a=l.useRef(new Map).current,f=l.useRef(new Map).current,p=l.useRef(null),[h,m]=l.useState(null),[L,w]=l.useState(null),b=l.useCallback((x,P,E,A)=>{const z=document.createElement("canvas"),$=z.getContext("2d");return z.width=P,z.height=P,$.beginPath(),$.arc(P/2,P/2,P/2-A/2,0,Math.PI*2,!0),$.clip(),$.drawImage(x,0,0,P,P),$.beginPath(),$.arc(P/2,P/2,P/2-A/2,0,Math.PI*2,!0),$.strokeStyle=E,$.lineWidth=A,$.stroke(),z},[]);return p.current||(p.current=qu()),l.useEffect(()=>{if(!e||e.length===0)return;const x="/chill-demo/vite.svg";if(!a.has(x)){const P=new Image;P.crossOrigin="Anonymous",P.src=x;const E={image:P,loaded:!1};a.set(x,E),P.onload=()=>{E.loaded=!0;const A=b(P,128,"red",4);f.set(x,A)},P.onerror=()=>{E.loaded="error",E.image=p.current;const A=b(p.current,128,"red",4);f.set("default",A)}}},[e,a,f,b]),l.useEffect(()=>{if(!t)return;class x extends window.google.maps.OverlayView{constructor(){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="5",this.props={},this.mapDiv=null,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this)}setProps(A){this.props={...this.props,...A},this.draw()}onAdd(){this.getPanes().overlayLayer.appendChild(this.canvas),this.mapDiv=this.getMap().getDiv(),this.mapDiv.addEventListener("mousemove",this.handleMouseMove),this.mapDiv.addEventListener("click",this.handleClick)}onRemove(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.mapDiv&&(this.mapDiv.removeEventListener("mousemove",this.handleMouseMove),this.mapDiv.removeEventListener("click",this.handleClick),this.mapDiv=null)}findUserAtPixel(A,z){const $=this.getProjection();if(!$||!this.props.users)return null;const W=this.props.users.filter(j=>{const S=$.fromLatLngToDivPixel(new window.google.maps.LatLng(j.lat,j.lng));if(!S)return!1;const F=Math.sqrt(Math.pow(A-S.x,2)+Math.pow(z-S.y,2)),Y=this.getMap().getZoom(),U=Math.max(16,Math.min(80,(Y-12)*8));return F<=U/2});let te=null,K=1/0;for(const j of W){const S=$.fromLatLngToDivPixel(new window.google.maps.LatLng(j.lat,j.lng));if(!S)continue;const F=Math.sqrt(Math.pow(A-S.x,2)+Math.pow(z-S.y,2));F<K&&(K=F,te=j)}return te}handleMouseMove(A){const z=this.findUserAtPixel(A.offsetX,A.offsetY);this.props.onSetHoveredUser(z),this.getMap().getDiv().style.cursor=z?"pointer":""}handleClick(A){const z=this.findUserAtPixel(A.offsetX,A.offsetY);z&&this.props.onSetClickedUser(z)}draw(){const A=this.getProjection();if(!A)return;const z=this.getMap().getBounds();if(!z)return;const $=this.getMap().getZoom(),W=.1,te=z.getSouthWest(),K=z.getNorthEast(),j=(K.lng()-te.lng())*W,S=(K.lat()-te.lat())*W,F=new window.google.maps.LatLngBounds(new window.google.maps.LatLng(te.lat()-S,te.lng()-j),new window.google.maps.LatLng(K.lat()+S,K.lng()+j)),Y=A.fromLatLngToDivPixel(te),U=A.fromLatLngToDivPixel(K),J=U.x-Y.x,G=Y.y-U.y;if(this.canvas.style.left=`${Y.x}px`,this.canvas.style.top=`${U.y}px`,(this.canvas.width!==J||this.canvas.height!==G)&&(this.canvas.width=J,this.canvas.height=G,this.canvas.style.width=`${J}px`,this.canvas.style.height=`${G}px`),this.ctx.clearRect(0,0,J,G),!this.props.isVisible)return;$<12?this.drawClusters(A,Y,U,F):this.drawIndividualMarkers(A,Y,U,F)}drawSingleMarker(A,z,$,W){const{renderedImageCache:te,hoveredUser:K}=this.props,j=z.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!j)return;const S=j.x-$.x,F=j.y-W.y,Y=this.getMap().getZoom(),U=Math.max(16,Math.min(80,(Y-12)*8)),J=K&&K.seq===A.seq;let H=te.get("/chill-demo/vite.svg")||te.get("default");H?this.ctx.drawImage(H,S-U/2,F-U/2,U,U):(this.ctx.beginPath(),this.ctx.arc(S,F,U/2,0,Math.PI*2,!0),this.ctx.fillStyle=J?"#007BFF":"#E0E0E0",this.ctx.fill()),this.ctx.beginPath(),this.ctx.arc(S,F,U/2,0,Math.PI*2,!0),this.ctx.strokeStyle=J?"#007BFF":"red",this.ctx.lineWidth=J?6:2,this.ctx.stroke()}drawClusters(A,z,$,W){const{users:te}=this.props,K=this.getMap().getZoom(),j=1/Math.pow(2,K-5),S=new Map,F=te.filter(Y=>W.contains({lat:Y.lat,lng:Y.lng}));for(const Y of F){const U=`${Math.floor(Y.lat/j)}|${Math.floor(Y.lng/j)}`;S.has(U)||S.set(U,{points:[],sumLat:0,sumLng:0});const J=S.get(U);J.points.push(Y),J.sumLat+=Y.lat,J.sumLng+=Y.lng}for(const Y of S.values()){const U=Y.points.length;if(U>1){const J=Y.sumLat/U,G=Y.sumLng/U,H=A.fromLatLngToDivPixel(new window.google.maps.LatLng(J,G));if(!H)continue;const ce=H.x-z.x,fe=H.y-$.y,le=18+Math.log2(U)*2;this.ctx.beginPath(),this.ctx.arc(ce,fe,le,0,Math.PI*2),this.ctx.fillStyle="rgba(0, 123, 255, 0.7)",this.ctx.fill(),this.ctx.strokeStyle="rgba(0, 123, 255, 1)",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 18px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(U,ce,fe)}else this.drawSingleMarker(Y.points[0],A,z,$)}}drawIndividualMarkers(A,z,$,W){const{users:te}=this.props;for(const K of te)W.contains({lat:K.lat,lng:K.lng})&&this.drawSingleMarker(K,A,z,$)}}const P=new x;return P.setMap(t),i.current=P,()=>{i.current&&i.current.setMap(null)}},[t,b]),l.useEffect(()=>{i.current&&i.current.setProps({users:e,renderedImageCache:f,imageCache:a,isVisible:r,defaultAvatarRef:p.current,hoveredUser:h,clickedUser:L,onSetHoveredUser:m,onSetClickedUser:w})},[e,f,r,h,L,a]),oe.jsx(oe.Fragment,{children:L&&oe.jsx(Wu,{user:L,onClose:()=>w(null)})})},vn=5e-4,$u={width:"100%",height:"100%"},Vu={position:"absolute",inset:"0px",width:"100%",height:"100%"},Hu=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],Gu=({center:t,onSelectCell:e,claimedCells:r,exploredCells:i,setMapRef:a,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m,onZoomOutLimit:L,effects:w})=>{const[b,x]=l.useState(15),[P,E]=l.useState(null),A=l.useRef(!1),z=l.useRef(null),$=150,[W,te]=l.useState(!1),[K,j]=l.useState([]);l.useEffect(()=>{Nu().then(j)},[]);const S=l.useCallback(H=>{E(H),a(H)},[a]),F=l.useCallback(()=>{if(!P||!A.current)return;const H=P.getZoom(),ce=P.getCenter();H<=5&&L(),f(H),p({lat:ce.lat(),lng:ce.lng()}),x(H)},[P,f,p,L]);l.useEffect(()=>{(async()=>{P&&t&&!A.current&&(await Kt(P,t,2e3,16,te),A.current=!0,F())})()},[P,t,F,te]);const Y=l.useCallback(H=>{const ce=H.latLng.lat(),fe=H.latLng.lng(),le=Math.floor(ce/vn),de=Math.floor(fe/vn),Le=`${le}_${de}`,ye=le*vn,be=de*vn,me=ye+vn/2,Me=be+vn/2;e(Le,{lat:me,lng:Me})},[e]),U=l.useCallback(async H=>{H.preventDefault(),!z.current&&(z.current=setTimeout(async()=>{if(z.current=null,!P)return;const ce=P.getZoom(),fe=H.deltaY<0?ce+1:ce-1,le=Math.max(2,Math.min(20,fe));le!==ce&&await Kt(P,P.getCenter().toJSON(),300,le,te)},$))},[P,te]),J=l.useCallback(()=>{if(!P)return;const H=P.getCenter();p({lat:H.lat(),lng:H.lng()})},[P,p]),G=l.useRef(null);return l.useEffect(()=>{const H=G.current;if(H)return H.addEventListener("wheel",U,{passive:!1}),()=>{H.removeEventListener("wheel",U)}},[U]),oe.jsx("div",{ref:G,className:"view-container fade-in",style:Vu,children:oe.jsxs(Ya,{mapContainerStyle:$u,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:Hu,minZoom:2,maxZoom:20,scrollwheel:!1},onLoad:S,onIdle:F,onDragEnd:J,onClick:Y,children:[oe.jsx(Au,{map:P,zoom:b,claimedCells:r,exploredCells:i,isAnimating:W,selectedCell:h,effects:w}),P&&K.length>0&&oe.jsx(Zu,{map:P,users:K,isVisible:!0}),h&&oe.jsx(oa,{cellInfo:h}),m&&oe.jsx(Ku,{position:m})]})})},Yu=Qt.memo(Gu),js=t=>{let e;const r=new Set,i=(L,w)=>{const b=typeof L=="function"?L(e):L;if(!Object.is(b,e)){const x=e;e=w??(typeof b!="object"||b===null)?b:Object.assign({},e,b),r.forEach(P=>P(e,x))}},a=()=>e,h={setState:i,getState:a,getInitialState:()=>m,subscribe:L=>(r.add(L),()=>r.delete(L))},m=e=t(i,a,h);return h},Xu=(t=>t?js(t):js),Ju=t=>t;function Qu(t,e=Ju){const r=Qt.useSyncExternalStore(t.subscribe,Qt.useCallback(()=>e(t.getState()),[t,e]),Qt.useCallback(()=>e(t.getInitialState()),[t,e]));return Qt.useDebugValue(r),r}const Rs=t=>{const e=Xu(t),r=i=>Qu(e,i);return Object.assign(r,e),r},ec=(t=>t?Rs(t):Rs);var sa=Symbol.for("immer-nothing"),As=Symbol.for("immer-draftable"),st=Symbol.for("immer-state");function dt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Nn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[st]}function en(t){return t?aa(t)||Array.isArray(t)||!!t[As]||!!t.constructor?.[As]||Zn(t)||Br(t):!1}var tc=Object.prototype.constructor.toString(),Ts=new WeakMap;function aa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let i=Ts.get(r);return i===void 0&&(i=Function.toString.call(r),Ts.set(r,i)),i===tc}function Ir(t,e,r=!0){Tr(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((i,a)=>e(a,i,t))}function Tr(t){const e=t[st];return e?e.type_:Array.isArray(t)?1:Zn(t)?2:Br(t)?3:0}function Ci(t,e){return Tr(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function la(t,e,r){const i=Tr(t);i===2?t.set(e,r):i===3?t.add(r):t[e]=r}function nc(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Zn(t){return t instanceof Map}function Br(t){return t instanceof Set}function Xt(t){return t.copy_||t.base_}function Ei(t,e){if(Zn(t))return new Map(t);if(Br(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=aa(t);if(e===!0||e==="class_only"&&!r){const i=Object.getOwnPropertyDescriptors(t);delete i[st];let a=Reflect.ownKeys(i);for(let f=0;f<a.length;f++){const p=a[f],h=i[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(i[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Nn(t),i)}else{const i=Nn(t);if(i!==null&&r)return{...t};const a=Object.create(i);return Object.assign(a,t)}}function Ai(t,e=!1){return Ur(t)||wn(t)||!en(t)||(Tr(t)>1&&Object.defineProperties(t,{set:br,add:br,clear:br,delete:br}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ai(r,!0))),t}function rc(){dt(2)}var br={value:rc};function Ur(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var ic={};function tn(t){const e=ic[t];return e||dt(0,t),e}var qn;function ua(){return qn}function oc(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Bs(t,e){e&&(tn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Mi(t){ki(t),t.drafts_.forEach(sc),t.drafts_=null}function ki(t){t===qn&&(qn=t.parent_)}function Us(t){return qn=oc(qn,t)}function sc(t){const e=t[st];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[st].modified_&&(Mi(e),dt(4)),en(t)&&(t=jr(e,t),e.parent_||Rr(e,t)),e.patches_&&tn("Patches").generateReplacementPatches_(r[st].base_,t,e.patches_,e.inversePatches_)):t=jr(e,r,[]),Mi(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==sa?t:void 0}function jr(t,e,r){if(Ur(e))return e;const i=t.immer_.shouldUseStrictIteration(),a=e[st];if(!a)return Ir(e,(f,p)=>Fs(t,a,e,f,p,r),i),e;if(a.scope_!==t)return e;if(!a.modified_)return Rr(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const f=a.copy_;let p=f,h=!1;a.type_===3&&(p=new Set(f),f.clear(),h=!0),Ir(p,(m,L)=>Fs(t,a,f,m,L,r,h),i),Rr(t,f,!1),r&&t.patches_&&tn("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function Fs(t,e,r,i,a,f,p){if(a==null||typeof a!="object"&&!p)return;const h=Ur(a);if(!(h&&!p)){if(wn(a)){const m=f&&e&&e.type_!==3&&!Ci(e.assigned_,i)?f.concat(i):void 0,L=jr(t,a,m);if(la(r,i,L),wn(L))t.canAutoFreeze_=!1;else return}else p&&r.add(a);if(en(a)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===a&&h)return;jr(t,a),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Zn(r)?r.has(i):Object.prototype.propertyIsEnumerable.call(r,i))&&Rr(t,a)}}}function Rr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ai(e,r)}function ac(t,e){const r=Array.isArray(t),i={type_:r?1:0,scope_:e?e.scope_:ua(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,f=Ti;r&&(a=[i],f=Wn);const{revoke:p,proxy:h}=Proxy.revocable(a,f);return i.draft_=h,i.revoke_=p,h}var Ti={get(t,e){if(e===st)return t;const r=Xt(t);if(!Ci(r,e))return lc(t,r,e);const i=r[e];return t.finalized_||!en(i)?i:i===yi(t.base_,e)?(bi(t),t.copy_[e]=Pi(i,t)):i},has(t,e){return e in Xt(t)},ownKeys(t){return Reflect.ownKeys(Xt(t))},set(t,e,r){const i=ca(Xt(t),e);if(i?.set)return i.set.call(t.draft_,r),!0;if(!t.modified_){const a=yi(Xt(t),e),f=a?.[st];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(nc(r,a)&&(r!==void 0||Ci(t.base_,e)))return!0;bi(t),Si(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return yi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bi(t),Si(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xt(t),i=Reflect.getOwnPropertyDescriptor(r,e);return i&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:i.enumerable,value:r[e]}},defineProperty(){dt(11)},getPrototypeOf(t){return Nn(t.base_)},setPrototypeOf(){dt(12)}},Wn={};Ir(Ti,(t,e)=>{Wn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wn.deleteProperty=function(t,e){return Wn.set.call(this,t,e,void 0)};Wn.set=function(t,e,r){return Ti.set.call(this,t[0],e,r,t[0])};function yi(t,e){const r=t[st];return(r?Xt(r):t)[e]}function lc(t,e,r){const i=ca(e,r);return i?"value"in i?i.value:i.get?.call(t.draft_):void 0}function ca(t,e){if(!(e in t))return;let r=Nn(t);for(;r;){const i=Object.getOwnPropertyDescriptor(r,e);if(i)return i;r=Nn(r)}}function Si(t){t.modified_||(t.modified_=!0,t.parent_&&Si(t.parent_))}function bi(t){t.copy_||(t.copy_=Ei(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var uc=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,i)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...L){return p.produce(m,w=>r.call(this,w,...L))}}typeof r!="function"&&dt(6),i!==void 0&&typeof i!="function"&&dt(7);let a;if(en(e)){const f=Us(this),p=Pi(e,void 0);let h=!0;try{a=r(p),h=!1}finally{h?Mi(f):ki(f)}return Bs(f,i),zs(a,f)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===sa&&(a=void 0),this.autoFreeze_&&Ai(a,!0),i){const f=[],p=[];tn("Patches").generateReplacementPatches_(e,a,f,p),i(f,p)}return a}else dt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let i,a;return[this.produce(e,r,(p,h)=>{i=p,a=h}),i,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){en(t)||dt(8),wn(t)&&(t=cc(t));const e=Us(this),r=Pi(t,void 0);return r[st].isManual_=!0,ki(e),r}finishDraft(t,e){const r=t&&t[st];(!r||!r.isManual_)&&dt(9);const{scope_:i}=r;return Bs(i,e),zs(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const i=tn("Patches").applyPatches_;return wn(t)?i(t,e):this.produce(t,a=>i(a,e))}};function Pi(t,e){const r=Zn(t)?tn("MapSet").proxyMap_(t,e):Br(t)?tn("MapSet").proxySet_(t,e):ac(t,e);return(e?e.scope_:ua()).drafts_.push(r),r}function cc(t){return wn(t)||dt(10,t),fa(t)}function fa(t){if(!en(t)||Ur(t))return t;const e=t[st];let r,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ei(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else r=Ei(t,!0);return Ir(r,(a,f)=>{la(r,a,fa(f))},i),e&&(e.finalized_=!1),r}var fc=new uc,dc=fc.produce;const pc=t=>(e,r,i)=>(i.setState=(a,f,...p)=>{const h=typeof a=="function"?dc(a):a;return e(h,f,...p)},t(i.setState,r,i)),hc=pc;var xr={exports:{}},gc=xr.exports,Ks;function mc(){return Ks||(Ks=1,(function(t,e){(function(r,i){t.exports=i()})(gc,function(){var r=function(n,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(s[c]=u[c])})(n,o)},i=function(){return(i=Object.assign||function(n){for(var o,s=1,u=arguments.length;s<u;s++)for(var c in o=arguments[s])Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c]);return n}).apply(this,arguments)};function a(n,o,s){for(var u,c=0,d=o.length;c<d;c++)!u&&c in o||((u=u||Array.prototype.slice.call(o,0,c))[c]=o[c]);return n.concat(u||Array.prototype.slice.call(o))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Aa,p=Object.keys,h=Array.isArray;function m(n,o){return typeof o!="object"||p(o).forEach(function(s){n[s]=o[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var L=Object.getPrototypeOf,w={}.hasOwnProperty;function b(n,o){return w.call(n,o)}function x(n,o){typeof o=="function"&&(o=o(L(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(o).forEach(function(s){E(n,s,o[s])})}var P=Object.defineProperty;function E(n,o,s,u){P(n,o,m(s&&b(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},u))}function A(n){return{from:function(o){return n.prototype=Object.create(o.prototype),E(n.prototype,"constructor",n),{extend:x.bind(null,n.prototype)}}}}var z=Object.getOwnPropertyDescriptor,$=[].slice;function W(n,o,s){return $.call(n,o,s)}function te(n,o){return o(n)}function K(n){if(!n)throw new Error("Assertion Failed")}function j(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function S(n,o){if(typeof o=="string"&&b(n,o))return n[o];if(!o)return n;if(typeof o!="string"){for(var s=[],u=0,c=o.length;u<c;++u){var d=S(n,o[u]);s.push(d)}return s}var g=o.indexOf(".");if(g!==-1){var v=n[o.substr(0,g)];return v==null?void 0:S(v,o.substr(g+1))}}function F(n,o,s){if(n&&o!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof o!="string"&&"length"in o){K(typeof s!="string"&&"length"in s);for(var u=0,c=o.length;u<c;++u)F(n,o[u],s[u])}else{var d,g,v=o.indexOf(".");v!==-1?(d=o.substr(0,v),(g=o.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:F(v=!(v=n[d])||!b(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=s}}function Y(n){var o,s={};for(o in n)b(n,o)&&(s[o]=n[o]);return s}var U=[].concat;function J(n){return U.apply([],n)}var ht="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(J([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(o){return o+n+"Array"})}))).filter(function(n){return f[n]}),G=new Set(ht.map(function(n){return f[n]})),H=null;function ce(n){return H=new WeakMap,n=(function o(s){if(!s||typeof s!="object")return s;var u=H.get(s);if(u)return u;if(h(s)){u=[],H.set(s,u);for(var c=0,d=s.length;c<d;++c)u.push(o(s[c]))}else if(G.has(s.constructor))u=s;else{var g,v=L(s);for(g in u=v===Object.prototype?{}:Object.create(v),H.set(s,u),s)b(s,g)&&(u[g]=o(s[g]))}return u})(n),H=null,n}var fe={}.toString;function le(n){return fe.call(n).slice(8,-1)}var de=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Le=typeof de=="symbol"?function(n){var o;return n!=null&&(o=n[de])&&o.apply(n)}:function(){return null};function ye(n,o){return o=n.indexOf(o),0<=o&&n.splice(o,1),0<=o}var be={};function me(n){var o,s,u,c;if(arguments.length===1){if(h(n))return n.slice();if(this===be&&typeof n=="string")return[n];if(c=Le(n)){for(s=[];!(u=c.next()).done;)s.push(u.value);return s}if(n==null)return[n];if(typeof(o=n.length)!="number")return[n];for(s=new Array(o);o--;)s[o]=n[o];return s}for(o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return s}var Me=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ot=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ot),Ie={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ve(n,o){this.name=n,this.message=o}function Ae(n,o){return n+". Errors: "+Object.keys(o).map(function(s){return o[s].toString()}).filter(function(s,u,c){return c.indexOf(s)===u}).join(`
`)}function Z(n,o,s,u){this.failures=o,this.failedKeys=u,this.successCount=s,this.message=Ae(n,o)}function Te(n,o){this.name="BulkError",this.failures=Object.keys(o).map(function(s){return o[s]}),this.failuresByPos=o,this.message=Ae(n,this.failures)}A(ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),A(Z).from(ve),A(Te).from(ve);var ze=lt.reduce(function(n,o){return n[o]=o+"Error",n},{}),Q=ve,X=lt.reduce(function(n,o){var s=o+"Error";function u(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=Ie[o]||s,this.inner=null)}return A(u).from(Q),n[o]=u,n},{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var ge=Ot.reduce(function(n,o){return n[o+"Error"]=X[o],n},{}),_e=lt.reduce(function(n,o){return["Syntax","Type","Range"].indexOf(o)===-1&&(n[o+"Error"]=X[o]),n},{});function ke(){}function Xe(n){return n}function qt(n,o){return n==null||n===Xe?o:function(s){return o(n(s))}}function je(n,o){return function(){n.apply(this,arguments),o.apply(this,arguments)}}function $n(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var u=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=o.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?je(u,this.onsuccess):u),c&&(this.onerror=this.onerror?je(c,this.onerror):c),d!==void 0?d:s}}function nn(n,o){return n===ke?o:function(){n.apply(this,arguments);var s=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,o.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?je(s,this.onsuccess):s),u&&(this.onerror=this.onerror?je(u,this.onerror):u)}}function Vn(n,o){return n===ke?o:function(s){var u=n.apply(this,arguments);m(s,u);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=o.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?je(c,this.onsuccess):c),d&&(this.onerror=this.onerror?je(d,this.onerror):d),u===void 0?s===void 0?void 0:s:m(u,s)}}function rn(n,o){return n===ke?o:function(){return o.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function on(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var u=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return o.apply(u,d)})}return o.apply(this,arguments)}}_e.ModifyError=Z,_e.DexieError=ve,_e.BulkError=Te;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xn(n){Je=n}var pt={},Cn=100,ht=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,L(n),n];var o=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[o,L(o),n]})(),Ot=ht[0],lt=ht[1],ht=ht[2],lt=lt&&lt.then,at=Ot&&Ot.constructor,sn=!!ht,gt=function(n,o){vt.push([n,o]),xt&&(queueMicrotask(cn),xt=!1)},an=!0,xt=!0,mt=[],Ct=[],ln=Xe,et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},he=et,vt=[],yt=0,Et=[];function ue(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var o=this._PSD=he;if(typeof n!="function"){if(n!==pt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&_t(this,this._value))}this._state=null,this._value=null,++o.ref,(function s(u,c){try{c(function(d){if(u._state===null){if(d===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&Mt();d&&typeof d.then=="function"?s(u,function(v,C){d instanceof ue?d._then(v,C):d.then(v,C)}):(u._state=!0,u._value=d,Mn(u)),g&&It()}},_t.bind(null,u))}catch(d){_t(u,d)}})(this,n)}var un={get:function(){var n=he,o=Xn;function s(u,c){var d=this,g=!n.global&&(n!==he||o!==Xn),v=g&&!Rt(),C=new ue(function(M,D){Dt(d,new En(Ui(u,n,g,v),Ui(c,n,g,v),M,D,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return s.prototype=pt,s},set:function(n){E(this,"then",n&&n.prototype===pt?un:{get:function(){return n},set:un.set})}};function En(n,o,s,u,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof o=="function"?o:null,this.resolve=s,this.reject=u,this.psd=c}function _t(n,o){var s,u;Ct.push(o),n._state===null&&(s=n._lib&&Mt(),o=ln(o),n._state=!1,n._value=o,u=n,mt.some(function(c){return c._value===u._value})||mt.push(u),Mn(n),s&&It())}function Mn(n){var o=n._listeners;n._listeners=[];for(var s=0,u=o.length;s<u;++s)Dt(n,o[s]);var c=n._PSD;--c.ref||c.finalize(),yt===0&&(++yt,gt(function(){--yt==0&&kt()},[]))}function Dt(n,o){if(n._state!==null){var s=n._state?o.onFulfilled:o.onRejected;if(s===null)return(n._state?o.resolve:o.reject)(n._value);++o.psd.ref,++yt,gt(Hn,[s,n,o])}else n._listeners.push(o)}function Hn(n,o,s){try{var u,c=o._value;!o._state&&Ct.length&&(Ct=[]),u=Je&&o._consoleTask?o._consoleTask.run(function(){return n(c)}):n(c),o._state||Ct.indexOf(c)!==-1||(function(d){for(var g=mt.length;g;)if(mt[--g]._value===d._value)return mt.splice(g,1)})(o),s.resolve(u)}catch(d){s.reject(d)}finally{--yt==0&&kt(),--s.psd.ref||s.psd.finalize()}}function cn(){Wt(et,function(){Mt()&&It()})}function Mt(){var n=an;return xt=an=!1,n}function It(){var n,o,s;do for(;0<vt.length;)for(n=vt,vt=[],s=n.length,o=0;o<s;++o){var u=n[o];u[0].apply(null,u[1])}while(0<vt.length);xt=an=!0}function kt(){var n=mt;mt=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var o=Et.slice(0),s=o.length;s;)o[--s]()}function we(n){return new ue(pt,!1,n)}function Ke(n,o){var s=he;return function(){var u=Mt(),c=he;try{return At(s,!0),n.apply(this,arguments)}catch(d){o&&o(d)}finally{At(c,!1),u&&It()}}}x(ue.prototype,{then:un,_then:function(n,o){Dt(this,new En(null,null,n,o,he))},catch:function(n){if(arguments.length===1)return this.then(null,n);var o=n,s=arguments[1];return typeof o=="function"?this.then(null,function(u){return(u instanceof o?s:we)(u)}):this.then(null,function(u){return(u&&u.name===o?s:we)(u)})},finally:function(n){return this.then(function(o){return ue.resolve(n()).then(function(){return o})},function(o){return ue.resolve(n()).then(function(){return we(o)})})},timeout:function(n,o){var s=this;return n<1/0?new ue(function(u,c){var d=setTimeout(function(){return c(new X.Timeout(o))},n);s.then(u,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&E(ue.prototype,Symbol.toStringTag,"Dexie.Promise"),et.env=Bi(),x(ue,{all:function(){var n=me.apply(null,arguments).map(Jn);return new ue(function(o,s){n.length===0&&o([]);var u=n.length;n.forEach(function(c,d){return ue.resolve(c).then(function(g){n[d]=g,--u||o(n)},s)})})},resolve:function(n){return n instanceof ue?n:n&&typeof n.then=="function"?new ue(function(o,s){n.then(o,s)}):new ue(pt,!0,n)},reject:we,race:function(){var n=me.apply(null,arguments).map(Jn);return new ue(function(o,s){n.map(function(u){return ue.resolve(u).then(o,s)})})},PSD:{get:function(){return he},set:function(n){return he=n}},totalEchoes:{get:function(){return Xn}},newPSD:jt,usePSD:Wt,scheduler:{get:function(){return gt},set:function(n){gt=n}},rejectionMapper:{get:function(){return ln},set:function(n){ln=n}},follow:function(n,o){return new ue(function(s,u){return jt(function(c,d){var g=he;g.unhandleds=[],g.onunhandled=d,g.finalize=je(function(){var v,C=this;v=function(){C.unhandleds.length===0?c():d(C.unhandleds[0])},Et.push(function M(){v(),Et.splice(Et.indexOf(M),1)}),++yt,gt(function(){--yt==0&&kt()},[])},g.finalize),n()},o,s,u)})}}),at&&(at.allSettled&&E(ue,"allSettled",function(){var n=me.apply(null,arguments).map(Jn);return new ue(function(o){n.length===0&&o([]);var s=n.length,u=new Array(s);n.forEach(function(c,d){return ue.resolve(c).then(function(g){return u[d]={status:"fulfilled",value:g}},function(g){return u[d]={status:"rejected",reason:g}}).then(function(){return--s||o(u)})})})}),at.any&&typeof AggregateError<"u"&&E(ue,"any",function(){var n=me.apply(null,arguments).map(Jn);return new ue(function(o,s){n.length===0&&s(new AggregateError([]));var u=n.length,c=new Array(u);n.forEach(function(d,g){return ue.resolve(d).then(function(v){return o(v)},function(v){c[g]=v,--u||s(new AggregateError(c))})})})}),at.withResolvers&&(ue.withResolvers=at.withResolvers));var Ze={awaits:0,echoes:0,id:0},da=0,Gn=[],Yn=0,Xn=0,pa=0;function jt(n,o,s,u){var c=he,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++pa,et.env,d.env=sn?{Promise:ue,PromiseProp:{value:ue,configurable:!0,writable:!0},all:ue.all,race:ue.race,allSettled:ue.allSettled,any:ue.any,resolve:ue.resolve,reject:ue.reject}:{},o&&m(d,o),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},u=Wt(d,n,s,u),d.ref===0&&d.finalize(),u}function fn(){return Ze.id||(Ze.id=++da),++Ze.awaits,Ze.echoes+=Cn,Ze.id}function Rt(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*Cn,!0)}function Jn(n){return Ze.echoes&&n&&n.constructor===at?(fn(),n.then(function(o){return Rt(),o},function(o){return Rt(),Ne(o)})):n}function ha(){var n=Gn[Gn.length-1];Gn.pop(),At(n,!1)}function At(n,o){var s,u=he;(o?!Ze.echoes||Yn++&&n===he:!Yn||--Yn&&n===he)||queueMicrotask(o?(function(c){++Xn,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Gn.push(he),At(c,!0)}).bind(null,n):ha),n!==he&&(he=n,u===et&&(et.env=Bi()),sn&&(s=et.env.Promise,o=n.env,(u.global||n.global)&&(Object.defineProperty(f,"Promise",o.PromiseProp),s.all=o.all,s.race=o.race,s.resolve=o.resolve,s.reject=o.reject,o.allSettled&&(s.allSettled=o.allSettled),o.any&&(s.any=o.any))))}function Bi(){var n=f.Promise;return sn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Wt(n,o,s,u,c){var d=he;try{return At(n,!0),o(s,u,c)}finally{At(d,!1)}}function Ui(n,o,s,u){return typeof n!="function"?n:function(){var c=he;s&&fn(),At(o,!0);try{return n.apply(this,arguments)}finally{At(c,!1),u&&queueMicrotask(Rt)}}}function zr(n){Promise===at&&Ze.echoes===0?Yn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+lt).indexOf("[native code]")===-1&&(fn=Rt=ke);var Ne=ue.reject,Zt="￿",St="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",dn=[],Qn="__dbnames",Fr="readonly",Kr="readwrite";function $t(n,o){return n?o?function(){return n.apply(this,arguments)&&o.apply(this,arguments)}:n:o}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function er(n){return typeof n!="string"||/\./.test(n)?function(o){return o}:function(o){return o[n]===void 0&&n in o&&delete(o=ce(o))[n],o}}function Ki(){throw X.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Re(n,o){try{var s=Ni(n),u=Ni(o);if(s!==u)return s==="Array"?1:u==="Array"?-1:s==="binary"?1:u==="binary"?-1:s==="string"?1:u==="string"?-1:s==="Date"?1:u!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return o<n?1:n<o?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,C=g<v?g:v,M=0;M<C;++M)if(c[M]!==d[M])return c[M]<d[M]?-1:1;return g===v?0:g<v?-1:1})(qi(n),qi(o));case"Array":return(function(c,d){for(var g=c.length,v=d.length,C=g<v?g:v,M=0;M<C;++M){var D=Re(c[M],d[M]);if(D!==0)return D}return g===v?0:g<v?-1:1})(n,o)}}catch{}return NaN}function Ni(n){var o=typeof n;return o!="object"?o:ArrayBuffer.isView(n)?"binary":(n=le(n),n==="ArrayBuffer"?"binary":n)}function qi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function tr(n,o,s){var u=n.schema.yProps;return u?(o&&0<s.numFailures&&(o=o.filter(function(c,d){return!s.failures[d]})),Promise.all(u.map(function(c){return c=c.updatesTable,o?n.db.table(c).where("k").anyOf(o).delete():n.db.table(c).clear()})).then(function(){return s})):s}var kn=(Wi.prototype.execute=function(n){var o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(h(s))return a(a([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var u=o.remove;if(h(u))return h(n)?n.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return s=(s=o.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?o.replacePrefix[1]+n.substring(s.length):n},Wi);function Wi(n){this["@@propmod"]=n}function Zi(n,o){for(var s=p(o),u=s.length,c=!1,d=0;d<u;++d){var g=s[d],v=o[g],C=S(n,g);v instanceof kn?(F(n,g,v.execute(C)),c=!0):C!==v&&(F(n,g,v),c=!0)}return c}var $i=(Fe.prototype._trans=function(n,o,s){var u=this._tx||he.trans,c=this.name,d=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(M,D,y){if(!y.schema[c])throw new X.NotFound("Table "+c+" not part of transaction");return o(y.idbtrans,y)}var v=Mt();try{var C=u&&u.db._novip===this.db._novip?u===he.trans?u._promise(n,g,s):jt(function(){return u._promise(n,g,s)},{trans:u,transless:he.transless||he}):(function M(D,y,R,k){if(D.idbdb&&(D._state.openComplete||he.letThrough||D._vip)){var O=D._createTransaction(y,R,D._dbSchema);try{O.create(),D._state.PR1398_maxLoop=3}catch(_){return _.name===ze.InvalidState&&D.isOpen()&&0<--D._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),D.close({disableAutoOpen:!1}),D.open().then(function(){return M(D,y,R,k)})):Ne(_)}return O._promise(y,function(_,I){return jt(function(){return he.trans=O,k(_,I,O)})}).then(function(_){if(y==="readwrite")try{O.idbtrans.commit()}catch{}return y==="readonly"?_:O._completion.then(function(){return _})})}if(D._state.openComplete)return Ne(new X.DatabaseClosed(D._state.dbOpenError));if(!D._state.isBeingOpened){if(!D._state.autoOpen)return Ne(new X.DatabaseClosed);D.open().catch(ke)}return D._state.dbReadyPromise.then(function(){return M(D,y,R,k)})})(this.db,n,[this.name],g);return d&&(C._consoleTask=d,C=C.catch(function(M){return console.trace(M),Ne(M)})),C}finally{v&&It()}},Fe.prototype.get=function(n,o){var s=this;return n&&n.constructor===Object?this.where(n).first(o):n==null?Ne(new X.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return s.core.get({trans:u,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(o)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var o=p(n);if(o.length===1)return this.where(o[0]).equals(n[o[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&o.every(function(M){return 0<=v.keyPath.indexOf(M)})){for(var C=0;C<o.length;++C)if(o.indexOf(v.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(v,C){return v.keyPath.length-C.keyPath.length})[0];if(s&&this.db._maxKey!==Zt){var d=s.keyPath.slice(0,o.length);return this.where(d).equals(d.map(function(C){return n[C]}))}!s&&Je&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var u=this.schema.idxByName;function c(v,C){return Re(v,C)===0}var g=o.reduce(function(y,C){var M=y[0],D=y[1],y=u[C],R=n[C];return[M||y,M||!y?$t(D,y&&y.multi?function(k){return k=S(k,C),h(k)&&k.some(function(O){return c(R,O)})}:function(k){return c(R,S(k,C))}):D]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(o).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var o,s=this.db,u=this.name;function c(){return o!==null&&o.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ki&&((function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function D(){this.constructor=C}r(C,M),C.prototype=M===null?Object.create(M):(D.prototype=M.prototype,new D)})(c,o=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return u},n=c);for(var d=new Set,g=n.prototype;g;g=L(g))Object.getOwnPropertyNames(g).forEach(function(C){return d.add(C)});function v(C){if(!C)return C;var M,D=Object.create(n.prototype);for(M in C)if(!d.has(M))try{D[M]=C[M]}catch{}return D}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:o!=null?[o]:null,values:[g]})}).then(function(v){return v.numFailures?ue.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{F(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,o){var s=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return Zi(g,o),u&&F(g,u,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[o]}}).then(function(v){return v.numFailures?ue.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,o){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(o):(n=S(n,this.schema.primKey.keyPath),n===void 0?Ne(new X.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(o))},Fe.prototype.put=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:o!=null?[o]:null})}).then(function(v){return v.numFailures?ue.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{F(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(u){return tr(o,[n],u)}).then(function(u){return u.numFailures?ue.reject(u.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"deleteRange",range:Fi}).then(function(s){return tr(n,null,s)})}).then(function(o){return o.numFailures?ue.reject(o.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var o=this;return this._trans("readonly",function(s){return o.core.getMany({keys:n,trans:s}).then(function(u){return u.map(function(c){return o.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var M=u.schema.primKey,v=M.auto,M=M.keyPath;if(M&&c)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,M=M&&v?n.map(er(M)):n;return u.core.mutate({trans:g,type:"add",keys:c,values:M,wantResults:d}).then(function(O){var y=O.numFailures,R=O.results,k=O.lastResult,O=O.failures;if(y===0)return d?R:k;throw new Te("".concat(u.name,".bulkAdd(): ").concat(y," of ").concat(C," operations failed"),O)})})},Fe.prototype.bulkPut=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var M=u.schema.primKey,v=M.auto,M=M.keyPath;if(M&&c)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,M=M&&v?n.map(er(M)):n;return u.core.mutate({trans:g,type:"put",keys:c,values:M,wantResults:d}).then(function(O){var y=O.numFailures,R=O.results,k=O.lastResult,O=O.failures;if(y===0)return d?R:k;throw new Te("".concat(u.name,".bulkPut(): ").concat(y," of ").concat(C," operations failed"),O)})})},Fe.prototype.bulkUpdate=function(n){var o=this,s=this.core,u=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:u,cache:"clone"}).then(function(v){var C=[],M=[];n.forEach(function(y,R){var k=y.key,O=y.changes,_=v[R];if(_){for(var I=0,T=Object.keys(O);I<T.length;I++){var B=T[I],q=O[B];if(B===o.schema.primKey.keyPath){if(Re(q,k)!==0)throw new X.Constraint("Cannot update primary key in bulkUpdate()")}else F(_,B,q)}d.push(R),C.push(k),M.push(_)}});var D=C.length;return s.mutate({trans:g,type:"put",keys:C,values:M,updates:{keys:u,changeSpecs:c}}).then(function(y){var R=y.numFailures,k=y.failures;if(R===0)return D;for(var O=0,_=Object.keys(k);O<_.length;O++){var I,T=_[O],B=d[Number(T)];B!=null&&(I=k[T],delete k[T],k[B]=I)}throw new Te("".concat(o.name,".bulkUpdate(): ").concat(R," of ").concat(D," operations failed"),k)})})})},Fe.prototype.bulkDelete=function(n){var o=this,s=n.length;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"delete",keys:n}).then(function(c){return tr(o,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Te("".concat(o.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function Sn(n){function o(g,v){if(v){for(var C=arguments.length,M=new Array(C-1);--C;)M[C-1]=arguments[C];return s[g].subscribe.apply(null,M),n}if(typeof g=="string")return s[g]}var s={};o.addEventType=d;for(var u=1,c=arguments.length;u<c;++u)d(arguments[u]);return o;function d(g,v,C){if(typeof g!="object"){var M;v=v||rn;var D={subscribers:[],fire:C=C||ke,subscribe:function(y){D.subscribers.indexOf(y)===-1&&(D.subscribers.push(y),D.fire=v(D.fire,y))},unsubscribe:function(y){D.subscribers=D.subscribers.filter(function(R){return R!==y}),D.fire=D.subscribers.reduce(v,C)}};return s[g]=o[g]=D}p(M=g).forEach(function(y){var R=M[y];if(h(R))d(y,M[y][0],M[y][1]);else{if(R!=="asap")throw new X.InvalidArgument("Invalid event config");var k=d(y,Xe,function(){for(var O=arguments.length,_=new Array(O);O--;)_[O]=arguments[O];k.subscribers.forEach(function(I){j(function(){I.apply(null,_)})})})}})}}function Pn(n,o){return A(o).from({prototype:n}),o}function pn(n,o){return!(n.filter||n.algorithm||n.or)&&(o?n.justLimit:!n.replayFilter)}function Nr(n,o){n.filter=$t(n.filter,o)}function qr(n,o,s){var u=n.replayFilter;n.replayFilter=u?function(){return $t(u(),o())}:o,n.justLimit=s&&!u}function nr(n,o){if(n.isPrimKey)return o.primaryKey;var s=o.getIndexByKeyPath(n.index);if(!s)throw new X.Schema("KeyPath "+n.index+" on object store "+o.name+" is not indexed");return s}function Vi(n,o,s){var u=nr(n,o.schema);return o.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function rr(n,o,s,u){var c=n.replayFilter?$t(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,C,M){var D,y;c&&!c(C,M,function(R){return C.stop(R)},function(R){return C.fail(R)})||((y=""+(D=C.primaryKey))=="[object ArrayBuffer]"&&(y=""+new Uint8Array(D)),b(d,y)||(d[y]=!0,o(v,C,M)))};return Promise.all([n.or._iterate(g,s),Hi(Vi(n,u,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Hi(Vi(n,u,s),$t(n.algorithm,c),o,!n.keysOnly&&n.valueMapper)}function Hi(n,o,s,u){var c=Ke(u?function(d,g,v){return s(u(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};o&&!o(d,function(v){return g=v},function(v){d.stop(v),g=ke},function(v){d.fail(v),g=ke})||c(d.value,d,function(v){return g=v}),g()})})}var ga=(Be.prototype._read=function(n,o){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(o)},Be.prototype._write=function(n){var o=this._ctx;return o.error?o.table._trans(null,Ne.bind(null,o.error)):o.table._trans("readwrite",n,"locked")},Be.prototype._addAlgorithm=function(n){var o=this._ctx;o.algorithm=$t(o.algorithm,n)},Be.prototype._iterate=function(n,o){return rr(this._ctx,n,o,this._ctx.table.core)},Be.prototype.clone=function(n){var o=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),o._ctx=s,o},Be.prototype.raw=function(){return this._ctx.valueMapper=null,this},Be.prototype.each=function(n){var o=this._ctx;return this._read(function(s){return rr(o,n,s,o.table.core)})},Be.prototype.count=function(n){var o=this;return this._read(function(s){var u=o._ctx,c=u.table.core;if(pn(u,!0))return c.count({trans:s,query:{index:nr(u,c.schema),range:u.range}}).then(function(g){return Math.min(g,u.limit)});var d=0;return rr(u,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},Be.prototype.sortBy=function(n,o){var s=n.split(".").reverse(),u=s[0],c=s.length-1;function d(C,M){return M?d(C[s[M]],M-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function v(C,M){return Re(d(C,c),d(M,c))*g}return this.toArray(function(C){return C.sort(v)}).then(o)},Be.prototype.toArray=function(n){var o=this;return this._read(function(s){var u=o._ctx;if(u.dir==="next"&&pn(u,!0)&&0<u.limit){var c=u.valueMapper,d=nr(u,u.table.core.schema);return u.table.core.query({trans:s,limit:u.limit,values:!0,query:{index:d,range:u.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return rr(u,function(v){return g.push(v)},s,u.table.core).then(function(){return g})},n)},Be.prototype.offset=function(n){var o=this._ctx;return n<=0||(o.offset+=n,pn(o)?qr(o,function(){var s=n;return function(u,c){return s===0||(s===1?--s:c(function(){u.advance(s),s=0}),!1)}}):qr(o,function(){var s=n;return function(){return--s<0}})),this},Be.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),qr(this._ctx,function(){var o=n;return function(s,u,c){return--o<=0&&u(c),0<=o}},!0),this},Be.prototype.until=function(n,o){return Nr(this._ctx,function(s,u,c){return!n(s.value)||(u(c),o)}),this},Be.prototype.first=function(n){return this.limit(1).toArray(function(o){return o[0]}).then(n)},Be.prototype.last=function(n){return this.reverse().first(n)},Be.prototype.filter=function(n){var o;return Nr(this._ctx,function(s){return n(s.value)}),(o=this._ctx).isMatch=$t(o.isMatch,n),this},Be.prototype.and=function(n){return this.filter(n)},Be.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Be.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Be.prototype.desc=function(){return this.reverse()},Be.prototype.eachKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.key,u)})},Be.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Be.prototype.eachPrimaryKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.primaryKey,u)})},Be.prototype.keys=function(n){var o=this._ctx;o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.key)}).then(function(){return s}).then(n)},Be.prototype.primaryKeys=function(n){var o=this._ctx;if(o.dir==="next"&&pn(o,!0)&&0<o.limit)return this._read(function(u){var c=nr(o,o.table.core.schema);return o.table.core.query({trans:u,values:!1,limit:o.limit,query:{index:c,range:o.range}})}).then(function(u){return u.result}).then(n);o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},Be.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Be.prototype.firstKey=function(n){return this.limit(1).keys(function(o){return o[0]}).then(n)},Be.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Be.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var o={};return Nr(this._ctx,function(c){var u=c.primaryKey.toString(),c=b(o,u);return o[u]=!0,!c}),this},Be.prototype.modify=function(n){var o=this,s=this._ctx;return this._write(function(u){var c=typeof n=="function"?n:function(_){return Zi(_,n)},d=s.table.core,M=d.schema.primaryKey,g=M.outbound,v=M.extractKey,C=200,M=o.db._options.modifyChunkSize;M&&(C=typeof M=="object"?M[d.name]||M["*"]||200:M);function D(_,B){var T=B.failures,B=B.numFailures;R+=_-B;for(var q=0,V=p(T);q<V.length;q++){var ne=V[q];y.push(T[ne])}}var y=[],R=0,k=[],O=n===Gi;return o.clone().primaryKeys().then(function(_){function I(B){var q=Math.min(C,_.length-B),V=_.slice(B,B+q);return(O?Promise.resolve([]):d.getMany({trans:u,keys:V,cache:"immutable"})).then(function(ne){var se=[],ee=[],re=g?[]:null,ae=O?V:[];if(!O)for(var ie=0;ie<q;++ie){var pe=ne[ie],Ce={value:ce(pe),primKey:_[B+ie]};c.call(Ce,Ce.value,Ce)!==!1&&(Ce.value==null?ae.push(_[B+ie]):g||Re(v(pe),v(Ce.value))===0?(ee.push(Ce.value),g&&re.push(_[B+ie])):(ae.push(_[B+ie]),se.push(Ce.value)))}return Promise.resolve(0<se.length&&d.mutate({trans:u,type:"add",values:se}).then(function(Se){for(var Pe in Se.failures)ae.splice(parseInt(Pe),1);D(se.length,Se)})).then(function(){return(0<ee.length||T&&typeof n=="object")&&d.mutate({trans:u,type:"put",keys:re,values:ee,criteria:T,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<B}).then(function(Se){return D(ee.length,Se)})}).then(function(){return(0<ae.length||T&&O)&&d.mutate({trans:u,type:"delete",keys:ae,criteria:T,isAdditionalChunk:0<B}).then(function(Se){return tr(s.table,ae,Se)}).then(function(Se){return D(ae.length,Se)})}).then(function(){return _.length>B+q&&I(B+C)})})}var T=pn(s)&&s.limit===1/0&&(typeof n!="function"||O)&&{index:s.index,range:s.range};return I(0).then(function(){if(0<y.length)throw new Z("Error modifying one or more objects",y,R,k);return _.length})})})},Be.prototype.delete=function(){var n=this._ctx,o=n.range;return!pn(n)||n.table.schema.yProps||!n.isPrimKey&&o.type!==3?this.modify(Gi):this._write(function(s){var u=n.table.core.schema.primaryKey,c=o;return n.table.core.count({trans:s,query:{index:u,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(C){var v=C.failures,C=C.numFailures;if(C)throw new Z("Could not delete some values",Object.keys(v).map(function(M){return v[M]}),d-C);return d-C})})})},Be);function Be(){}var Gi=function(n,o){return o.value=null};function ma(n,o){return n<o?-1:n===o?0:1}function va(n,o){return o<n?-1:n===o?0:1}function tt(n,o,s){return n=n instanceof Xi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(o),n}function hn(n){return new n.Collection(n,function(){return Yi("")}).limit(0)}function ir(n,o,s,u){var c,d,g,v,C,M,D,y=s.length;if(!s.every(function(O){return typeof O=="string"}))return tt(n,zi);function R(O){c=O==="next"?function(I){return I.toUpperCase()}:function(I){return I.toLowerCase()},d=O==="next"?function(I){return I.toLowerCase()}:function(I){return I.toUpperCase()},g=O==="next"?ma:va;var _=s.map(function(I){return{lower:d(I),upper:c(I)}}).sort(function(I,T){return g(I.lower,T.lower)});v=_.map(function(I){return I.upper}),C=_.map(function(I){return I.lower}),D=(M=O)==="next"?"":u}R("next"),n=new n.Collection(n,function(){return Tt(v[0],C[y-1]+u)}),n._ondirectionchange=function(O){R(O)};var k=0;return n._addAlgorithm(function(O,_,I){var T=O.key;if(typeof T!="string")return!1;var B=d(T);if(o(B,C,k))return!0;for(var q=null,V=k;V<y;++V){var ne=(function(se,ee,re,ae,ie,pe){for(var Ce=Math.min(se.length,ae.length),Se=-1,Pe=0;Pe<Ce;++Pe){var nt=ee[Pe];if(nt!==ae[Pe])return ie(se[Pe],re[Pe])<0?se.substr(0,Pe)+re[Pe]+re.substr(Pe+1):ie(se[Pe],ae[Pe])<0?se.substr(0,Pe)+ae[Pe]+re.substr(Pe+1):0<=Se?se.substr(0,Se)+ee[Se]+re.substr(Se+1):null;ie(se[Pe],nt)<0&&(Se=Pe)}return Ce<ae.length&&pe==="next"?se+re.substr(se.length):Ce<se.length&&pe==="prev"?se.substr(0,re.length):Se<0?null:se.substr(0,Se)+ae[Se]+re.substr(Se+1)})(T,B,v[V],C[V],g,M);ne===null&&q===null?k=V+1:(q===null||0<g(q,ne))&&(q=ne)}return _(q!==null?function(){O.continue(q+D)}:I),!1}),n}function Tt(n,o,s,u){return{type:2,lower:n,upper:o,lowerOpen:s,upperOpen:u}}function Yi(n){return{type:1,lower:n,upper:n}}var Xi=(Object.defineProperty($e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$e.prototype.between=function(n,o,s,u){s=s!==!1,u=u===!0;try{return 0<this._cmp(n,o)||this._cmp(n,o)===0&&(s||u)&&(!s||!u)?hn(this):new this.Collection(this,function(){return Tt(n,o,!s,!u)})}catch{return tt(this,St)}},$e.prototype.equals=function(n){return n==null?tt(this,St):new this.Collection(this,function(){return Yi(n)})},$e.prototype.above=function(n){return n==null?tt(this,St):new this.Collection(this,function(){return Tt(n,void 0,!0)})},$e.prototype.aboveOrEqual=function(n){return n==null?tt(this,St):new this.Collection(this,function(){return Tt(n,void 0,!1)})},$e.prototype.below=function(n){return n==null?tt(this,St):new this.Collection(this,function(){return Tt(void 0,n,!1,!0)})},$e.prototype.belowOrEqual=function(n){return n==null?tt(this,St):new this.Collection(this,function(){return Tt(void 0,n)})},$e.prototype.startsWith=function(n){return typeof n!="string"?tt(this,zi):this.between(n,n+Zt,!0,!0)},$e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):ir(this,function(o,s){return o.indexOf(s[0])===0},[n],Zt)},$e.prototype.equalsIgnoreCase=function(n){return ir(this,function(o,s){return o===s[0]},[n],"")},$e.prototype.anyOfIgnoreCase=function(){var n=me.apply(be,arguments);return n.length===0?hn(this):ir(this,function(o,s){return s.indexOf(o)!==-1},n,"")},$e.prototype.startsWithAnyOfIgnoreCase=function(){var n=me.apply(be,arguments);return n.length===0?hn(this):ir(this,function(o,s){return s.some(function(u){return o.indexOf(u)===0})},n,Zt)},$e.prototype.anyOf=function(){var n=this,o=me.apply(be,arguments),s=this._cmp;try{o.sort(s)}catch{return tt(this,St)}if(o.length===0)return hn(this);var u=new this.Collection(this,function(){return Tt(o[0],o[o.length-1])});u._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,o.sort(s)};var c=0;return u._addAlgorithm(function(d,g,v){for(var C=d.key;0<s(C,o[c]);)if(++c===o.length)return g(v),!1;return s(C,o[c])===0||(g(function(){d.continue(o[c])}),!1)}),u},$e.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$e.prototype.noneOf=function(){var n=me.apply(be,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return tt(this,St)}var o=n.reduce(function(s,u){return s?s.concat([[s[s.length-1][1],u]]):[[-1/0,u]]},null);return o.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},$e.prototype.inAnyRange=function(T,o){var s=this,u=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(T.length===0)return hn(this);if(!T.every(function(B){return B[0]!==void 0&&B[1]!==void 0&&c(B[0],B[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);var C=!o||o.includeLowers!==!1,M=o&&o.includeUppers===!0,D,y=c;function R(B,q){return y(B[0],q[0])}try{(D=T.reduce(function(B,q){for(var V=0,ne=B.length;V<ne;++V){var se=B[V];if(u(q[0],se[1])<0&&0<u(q[1],se[0])){se[0]=g(se[0],q[0]),se[1]=v(se[1],q[1]);break}}return V===ne&&B.push(q),B},[])).sort(R)}catch{return tt(this,St)}var k=0,O=M?function(B){return 0<c(B,D[k][1])}:function(B){return 0<=c(B,D[k][1])},_=C?function(B){return 0<d(B,D[k][0])}:function(B){return 0<=d(B,D[k][0])},I=O,T=new this.Collection(this,function(){return Tt(D[0][0],D[D.length-1][1],!C,!M)});return T._ondirectionchange=function(B){y=B==="next"?(I=O,c):(I=_,d),D.sort(R)},T._addAlgorithm(function(B,q,V){for(var ne,se=B.key;I(se);)if(++k===D.length)return q(V),!1;return!O(ne=se)&&!_(ne)||(s._cmp(se,D[k][1])===0||s._cmp(se,D[k][0])===0||q(function(){y===c?B.continue(D[k][0]):B.continue(D[k][1])}),!1)}),T},$e.prototype.startsWithAnyOf=function(){var n=me.apply(be,arguments);return n.every(function(o){return typeof o=="string"})?n.length===0?hn(this):this.inAnyRange(n.map(function(o){return[o,o+Zt]})):tt(this,"startsWithAnyOf() only works with strings")},$e);function $e(){}function bt(n){return Ke(function(o){return On(o),n(o.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",Wr="x-storagemutated-1",Bt=Sn(null,_n),ya=(wt.prototype._lock=function(){return K(!he.global),++this._reculock,this._reculock!==1||he.global||(he.lockOwnerFor=this),this},wt.prototype._unlock=function(){if(K(!he.global),--this._reculock==0)for(he.global||(he.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Wt(n[1],n[0])}catch{}}return this},wt.prototype._locked=function(){return this._reculock&&he.lockOwnerFor!==this},wt.prototype.create=function(n){var o=this;if(!this.mode)return this;var s=this.db.idbdb,u=this.db._state.dbOpenError;if(K(!this.idbtrans),!n&&!s)switch(u&&u.name){case"DatabaseClosedError":throw new X.DatabaseClosed(u);case"MissingAPIError":throw new X.MissingAPI(u.message,u);default:throw new X.OpenFailed(u)}if(!this.active)throw new X.TransactionInactive;return K(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){On(c),o._reject(n.error)}),n.onabort=Ke(function(c){On(c),o.active&&o._reject(new X.Abort(n.error)),o.active=!1,o.on("abort").fire(c)}),n.oncomplete=Ke(function(){o.active=!1,o._resolve(),"mutatedParts"in n&&Bt.storagemutated.fire(n.mutatedParts)}),this},wt.prototype._promise=function(n,o,s){var u=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new X.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new X.TransactionInactive);if(this._locked())return new ue(function(d,g){u._blockedFuncs.push([function(){u._promise(n,o,s).then(d,g)},he])});if(s)return jt(function(){var d=new ue(function(g,v){u._lock();var C=o(g,v,u);C&&C.then&&C.then(g,v)});return d.finally(function(){return u._unlock()}),d._lib=!0,d});var c=new ue(function(d,g){var v=o(d,g,u);v&&v.then&&v.then(d,g)});return c._lib=!0,c},wt.prototype._root=function(){return this.parent?this.parent._root():this},wt.prototype.waitFor=function(n){var o,s=this._root(),u=ue.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return u}):(s._waitingFor=u,s._waitingQueue=[],o=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(o.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new ue(function(d,g){u.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},wt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))},wt.prototype.table=function(n){var o=this._memoizedTables||(this._memoizedTables={});if(b(o,n))return o[n];var s=this.schema[n];if(!s)throw new X.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),o[n]=s},wt);function wt(){}function Zr(n,o,s,u,c,d,g,v){return{name:n,keyPath:o,unique:s,multi:u,auto:c,compound:d,src:(s&&!g?"&":"")+(u?"*":"")+(c?"++":"")+Ji(o),type:v}}function Ji(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function $r(n,o,s){return{name:n,primKey:o,indexes:s,mappedClass:null,idxByName:(u=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=u(d,g),g&&(c[g[0]]=g[1]),c},{}))};var u}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return Zt},Zt}};function Vr(n){return n==null?function(){}:typeof n=="string"?(o=n).split(".").length===1?function(s){return s[o]}:function(s){return S(s,o)}:function(s){return S(s,n)};var o}function Qi(n){return[].slice.call(n)}var ba=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function wa(n,o,C){function u(I){if(I.type===3)return null;if(I.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var k=I.lower,O=I.upper,_=I.lowerOpen,I=I.upperOpen;return k===void 0?O===void 0?null:o.upperBound(O,!!I):O===void 0?o.lowerBound(k,!!_):o.bound(k,O,!!_,!!I)}function c(R){var k,O=R.name;return{name:O,schema:R,mutate:function(_){var I=_.trans,T=_.type,B=_.keys,q=_.values,V=_.range;return new Promise(function(ne,se){ne=Ke(ne);var ee=I.objectStore(O),re=ee.keyPath==null,ae=T==="put"||T==="add";if(!ae&&T!=="delete"&&T!=="deleteRange")throw new Error("Invalid operation type: "+T);var ie,pe=(B||q||{length:1}).length;if(B&&q&&B.length!==q.length)throw new Error("Given keys array must have same length as given values array.");if(pe===0)return ne({numFailures:0,failures:{},results:[],lastResult:void 0});function Ce(Qe){++nt,On(Qe)}var Se=[],Pe=[],nt=0;if(T==="deleteRange"){if(V.type===4)return ne({numFailures:nt,failures:Pe,results:[],lastResult:void 0});V.type===3?Se.push(ie=ee.clear()):Se.push(ie=ee.delete(u(V)))}else{var re=ae?re?[q,B]:[q,null]:[B,null],xe=re[0],He=re[1];if(ae)for(var Ge=0;Ge<pe;++Ge)Se.push(ie=He&&He[Ge]!==void 0?ee[T](xe[Ge],He[Ge]):ee[T](xe[Ge])),ie.onerror=Ce;else for(Ge=0;Ge<pe;++Ge)Se.push(ie=ee[T](xe[Ge])),ie.onerror=Ce}function mr(Qe){Qe=Qe.target.result,Se.forEach(function(Gt,fi){return Gt.error!=null&&(Pe[fi]=Gt.error)}),ne({numFailures:nt,failures:Pe,results:T==="delete"?B:Se.map(function(Gt){return Gt.result}),lastResult:Qe})}ie.onerror=function(Qe){Ce(Qe),mr(Qe)},ie.onsuccess=mr})},getMany:function(_){var I=_.trans,T=_.keys;return new Promise(function(B,q){B=Ke(B);for(var V,ne=I.objectStore(O),se=T.length,ee=new Array(se),re=0,ae=0,ie=function(Se){Se=Se.target,ee[Se._pos]=Se.result,++ae===re&&B(ee)},pe=bt(q),Ce=0;Ce<se;++Ce)T[Ce]!=null&&((V=ne.get(T[Ce]))._pos=Ce,V.onsuccess=ie,V.onerror=pe,++re);re===0&&B(ee)})},get:function(_){var I=_.trans,T=_.key;return new Promise(function(B,q){B=Ke(B);var V=I.objectStore(O).get(T);V.onsuccess=function(ne){return B(ne.target.result)},V.onerror=bt(q)})},query:(k=M,function(_){return new Promise(function(I,T){I=Ke(I);var B,q,V,re=_.trans,ne=_.values,se=_.limit,ie=_.query,ee=se===1/0?void 0:se,ae=ie.index,ie=ie.range,re=re.objectStore(O),ae=ae.isPrimaryKey?re:re.index(ae.name),ie=u(ie);if(se===0)return I({result:[]});k?((ee=ne?ae.getAll(ie,ee):ae.getAllKeys(ie,ee)).onsuccess=function(pe){return I({result:pe.target.result})},ee.onerror=bt(T)):(B=0,q=!ne&&"openKeyCursor"in ae?ae.openKeyCursor(ie):ae.openCursor(ie),V=[],q.onsuccess=function(pe){var Ce=q.result;return Ce?(V.push(ne?Ce.value:Ce.primaryKey),++B===se?I({result:V}):void Ce.continue()):I({result:V})},q.onerror=bt(T))})}),openCursor:function(_){var I=_.trans,T=_.values,B=_.query,q=_.reverse,V=_.unique;return new Promise(function(ne,se){ne=Ke(ne);var ae=B.index,ee=B.range,re=I.objectStore(O),re=ae.isPrimaryKey?re:re.index(ae.name),ae=q?V?"prevunique":"prev":V?"nextunique":"next",ie=!T&&"openKeyCursor"in re?re.openKeyCursor(u(ee),ae):re.openCursor(u(ee),ae);ie.onerror=bt(se),ie.onsuccess=Ke(function(pe){var Ce,Se,Pe,nt,xe=ie.result;xe?(xe.___id=++ba,xe.done=!1,Ce=xe.continue.bind(xe),Se=(Se=xe.continuePrimaryKey)&&Se.bind(xe),Pe=xe.advance.bind(xe),nt=function(){throw new Error("Cursor not stopped")},xe.trans=I,xe.stop=xe.continue=xe.continuePrimaryKey=xe.advance=function(){throw new Error("Cursor not started")},xe.fail=Ke(se),xe.next=function(){var He=this,Ge=1;return this.start(function(){return Ge--?He.continue():He.stop()}).then(function(){return He})},xe.start=function(He){function Ge(){if(ie.result)try{He()}catch(Qe){xe.fail(Qe)}else xe.done=!0,xe.start=function(){throw new Error("Cursor behind last entry")},xe.stop()}var mr=new Promise(function(Qe,Gt){Qe=Ke(Qe),ie.onerror=bt(Gt),xe.fail=Gt,xe.stop=function(fi){xe.stop=xe.continue=xe.continuePrimaryKey=xe.advance=nt,Qe(fi)}});return ie.onsuccess=Ke(function(Qe){ie.onsuccess=Ge,Ge()}),xe.continue=Ce,xe.continuePrimaryKey=Se,xe.advance=Pe,Ge(),mr},ne(xe)):ne(null)},se)})},count:function(_){var I=_.query,T=_.trans,B=I.index,q=I.range;return new Promise(function(V,ne){var se=T.objectStore(O),ee=B.isPrimaryKey?se:se.index(B.name),se=u(q),ee=se?ee.count(se):ee.count();ee.onsuccess=Ke(function(re){return V(re.target.result)}),ee.onerror=bt(ne)})}}}var d,g,v,D=(g=C,v=Qi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(R){return g.objectStore(R)}).map(function(R){var k=R.keyPath,I=R.autoIncrement,O=h(k),_={},I={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:k==null,compound:O,keyPath:k,autoIncrement:I,unique:!0,extractKey:Vr(k)},indexes:Qi(R.indexNames).map(function(T){return R.index(T)}).map(function(V){var B=V.name,q=V.unique,ne=V.multiEntry,V=V.keyPath,ne={name:B,compound:h(V),keyPath:V,unique:q,multiEntry:ne,extractKey:Vr(V)};return _[In(V)]=ne}),getIndexByKeyPath:function(T){return _[In(T)]}};return _[":id"]=I.primaryKey,k!=null&&(_[In(k)]=I.primaryKey),I})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),C=D.schema,M=D.hasGetAll,D=C.tables.map(c),y={};return D.forEach(function(R){return y[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(!y[R])throw new Error("Table '".concat(R,"' not found"));return y[R]},MIN_KEY:-1/0,MAX_KEY:Dn(o),schema:C}}function La(n,o,s,u){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(u=wa(o,c,u),n.dbcore.reduce(function(d,g){return g=g.create,i(i({},d),g(d))},u))}}function or(n,u){var s=u.db,u=La(n._middlewares,s,n._deps,u);n.core=u.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function sr(n,o,s,u){s.forEach(function(c){var d=u[c];o.forEach(function(g){var v=(function C(M,D){return z(M,D)||(M=L(M))&&C(M,D)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?E(g,c,{get:function(){return this.table(c)},set:function(C){P(this,c,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function Hr(n,o){o.forEach(function(s){for(var u in s)s[u]instanceof n.Table&&delete s[u]})}function xa(n,o){return n._cfg.version-o._cfg.version}function Ca(n,o,s,u){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=$r("$meta",to("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(u);var g=d._reject.bind(d),v=he.transless||he;jt(function(){return he.trans=d,he.transless=v,o!==0?(or(n,s),M=o,((C=d).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(D){return D??M}):ue.resolve(M)).then(function(D){return R=D,k=d,O=s,_=[],D=(y=n)._versions,I=y._dbSchema=lr(0,y.idbdb,O),(D=D.filter(function(T){return T._cfg.version>=R})).length!==0?(D.forEach(function(T){_.push(function(){var B=I,q=T._cfg.dbschema;ur(y,B,O),ur(y,q,O),I=y._dbSchema=q;var V=Gr(B,q);V.add.forEach(function(ae){Yr(O,ae[0],ae[1].primKey,ae[1].indexes)}),V.change.forEach(function(ae){if(ae.recreate)throw new X.Upgrade("Not yet support for changing primary key");var ie=O.objectStore(ae.name);ae.add.forEach(function(pe){return ar(ie,pe)}),ae.change.forEach(function(pe){ie.deleteIndex(pe.name),ar(ie,pe)}),ae.del.forEach(function(pe){return ie.deleteIndex(pe)})});var ne=T._cfg.contentUpgrade;if(ne&&T._cfg.version>R){or(y,O),k._memoizedTables={};var se=Y(q);V.del.forEach(function(ae){se[ae]=B[ae]}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],p(se),se),k.schema=se;var ee,re=Me(ne);return re&&fn(),V=ue.follow(function(){var ae;(ee=ne(k))&&re&&(ae=Rt.bind(null,null),ee.then(ae,ae))}),ee&&typeof ee.then=="function"?ue.resolve(ee):V.then(function(){return ee})}}),_.push(function(B){var q,V,ne=T._cfg.dbschema;q=ne,V=B,[].slice.call(V.db.objectStoreNames).forEach(function(se){return q[se]==null&&V.db.deleteObjectStore(se)}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],y._storeNames,y._dbSchema),k.schema=y._dbSchema}),_.push(function(B){y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(y.idbdb.version/10)===T._cfg.version?(y.idbdb.deleteObjectStore("$meta"),delete y._dbSchema.$meta,y._storeNames=y._storeNames.filter(function(q){return q!=="$meta"})):B.objectStore("$meta").put(T._cfg.version,"version"))})}),(function T(){return _.length?ue.resolve(_.shift()(k.idbtrans)).then(T):ue.resolve()})().then(function(){eo(I,O)})):ue.resolve();var y,R,k,O,_,I}).catch(g)):(p(c).forEach(function(D){Yr(s,D,c[D].primKey,c[D].indexes)}),or(n,s),void ue.follow(function(){return n.on.populate.fire(d)}).catch(g));var C,M})}function Ea(n,o){eo(n._dbSchema,o),o.db.version%10!=0||o.objectStoreNames.contains("$meta")||o.db.createObjectStore("$meta").add(Math.ceil(o.db.version/10-1),"version");var s=lr(0,n.idbdb,o);ur(n,n._dbSchema,o);for(var u=0,c=Gr(s,n._dbSchema).change;u<c.length;u++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=o.objectStore(g.name);g.add.forEach(function(C){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),ar(v,C)})})(c[u]);if(typeof d=="object")return d.value}}function Gr(n,o){var s,u={del:[],add:[],change:[]};for(s in n)o[s]||u.del.push(s);for(s in o){var c=n[s],d=o[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,u.change.push(g);else{var v=c.idxByName,C=d.idxByName,M=void 0;for(M in v)C[M]||g.del.push(M);for(M in C){var D=v[M],y=C[M];D?D.src!==y.src&&g.change.push(y):g.add.push(y)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([s,d])}return u}function Yr(n,o,s,u){var c=n.db.createObjectStore(o,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return u.forEach(function(d){return ar(c,d)}),c}function eo(n,o){p(n).forEach(function(s){o.db.objectStoreNames.contains(s)||(Je&&console.debug("Dexie: Creating missing table",s),Yr(o,s,n[s].primKey,n[s].indexes))})}function ar(n,o){n.createIndex(o.name,o.keyPath,{unique:o.unique,multiEntry:o.multi})}function lr(n,o,s){var u={};return W(o.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Zr(Ji(M=d.keyPath),M||"",!0,!1,!!d.autoIncrement,M&&typeof M!="string",!0),v=[],C=0;C<d.indexNames.length;++C){var D=d.index(d.indexNames[C]),M=D.keyPath,D=Zr(D.name,M,!!D.unique,!!D.multiEntry,!1,M&&typeof M!="string",!1);v.push(D)}u[c]=$r(c,g,v)}),u}function ur(n,o,s){for(var u=s.db.objectStoreNames,c=0;c<u.length;++c){var d=u[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var C=g.indexNames[v],M=g.index(C).keyPath,D=typeof M=="string"?M:"["+W(M).join("+")+"]";!o[d]||(M=o[d].idxByName[D])&&(M.name=C,delete o[d].idxByName[D],o[d].idxByName[C]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function to(n){return n.split(",").map(function(o,s){var d=o.split(":"),u=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(o=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Zr(c,d||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),h(d),s===0,u)})}var Ma=(gn.prototype._createTableSchema=$r,gn.prototype._parseIndexSyntax=to,gn.prototype._parseStoresSpec=function(n,o){var s=this;p(n).forEach(function(u){if(n[u]!==null){var c=s._parseIndexSyntax(n[u]),d=c.shift();if(!d)throw new X.Schema("Invalid schema for table "+u+": "+n[u]);if(d.unique=!0,d.multi)throw new X.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(u,d,c),o[u]=c}})},gn.prototype.stores=function(s){var o=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=o._versions,u={},c={};return s.forEach(function(d){m(u,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(u,c)}),o._dbSchema=c,Hr(o,[o._allTables,o,o.Transaction.prototype]),sr(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],p(c),c),o._storeNames=p(c),this},gn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=on(this._cfg.contentUpgrade||ke,n),this},gn);function gn(){}function Xr(n,o){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Pt(Qn,{addons:[],indexedDB:n,IDBKeyRange:o})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Jr(n){return n&&typeof n.databases=="function"}function Qr(n){return jt(function(){return he.letThrough=!0,n()})}function ei(n){return!("from"in n)}var Ve=function(n,o){if(!this){var s=new Ve;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?o:n}:{d:0})};function jn(n,o,s){var u=Re(o,s);if(!isNaN(u)){if(0<u)throw RangeError();if(ei(n))return m(n,{from:o,to:s,d:1});var c=n.l,u=n.r;if(Re(s,n.from)<0)return c?jn(c,o,s):n.l={from:o,to:s,d:1,l:null,r:null},ro(n);if(0<Re(o,n.to))return u?jn(u,o,s):n.r={from:o,to:s,d:1,l:null,r:null},ro(n);Re(o,n.from)<0&&(n.from=o,n.l=null,n.d=u?u.d+1:1),0<Re(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),u&&s&&Rn(n,u)}}function Rn(n,o){ei(o)||(function s(u,C){var d=C.from,g=C.to,v=C.l,C=C.r;jn(u,d,g),v&&s(u,v),C&&s(u,C)})(n,o)}function no(n,o){var s=cr(o),u=s.next();if(u.done)return!1;for(var c=u.value,d=cr(n),g=d.next(c.from),v=g.value;!u.done&&!g.done;){if(Re(v.from,c.to)<=0&&0<=Re(v.to,c.from))return!0;Re(c.from,v.from)<0?c=(u=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function cr(n){var o=ei(n)?null:{s:0,n};return{next:function(s){for(var u=0<arguments.length;o;)switch(o.s){case 0:if(o.s=1,u)for(;o.n.l&&Re(s,o.n.from)<0;)o={up:o,n:o.n.l,s:1};else for(;o.n.l;)o={up:o,n:o.n.l,s:1};case 1:if(o.s=2,!u||Re(s,o.n.to)<=0)return{value:o.n,done:!1};case 2:if(o.n.r){o.s=3,o={up:o,n:o.n.r,s:0};continue}case 3:o=o.up}return{done:!0}}}}function ro(n){var o,s,u=(((o=n.r)===null||o===void 0?void 0:o.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<u?"r":u<-1?"l":"";c&&(o=c=="r"?"l":"r",s=i({},n),u=n[c],n.from=u.from,n.to=u.to,n[c]=u[c],s[c]=u[o],(n[o]=s).d=io(s)),n.d=io(n)}function io(s){var o=s.r,s=s.l;return(o?s?Math.max(o.d,s.d):o.d:s?s.d:0)+1}function fr(n,o){return p(o).forEach(function(s){n[s]?Rn(n[s],o[s]):n[s]=(function u(c){var d,g,v={};for(d in c)b(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||G.has(g.constructor)?g:u(g));return v})(o[s])}),n}function ti(n,o){return n.all||o.all||Object.keys(n).some(function(s){return o[s]&&no(o[s],n[s])})}x(Ve.prototype,((lt={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var o=this;return n.forEach(function(s){return jn(o,s,s)}),this},hasKey:function(n){var o=cr(this).next(n).value;return o&&Re(o.from,n)<=0&&0<=Re(o.to,n)}})[de]=function(){return cr(this)},lt));var Vt={},ni={},ri=!1;function dr(n){fr(ni,n),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(n,o){o===void 0&&(o=!1);var s=new Set;if(n.all)for(var u=0,c=Object.values(Vt);u<c.length;u++)oo(g=c[u],n,s,o);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Vt["idb://".concat(d,"/").concat(v)])&&oo(g,n,s,o))}s.forEach(function(C){return C()})}function oo(n,o,s,u){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],C=v[0],M=[],D=0,y=v[1];D<y.length;D++){var R=y[D];ti(o,R.obsSet)?R.subscribers.forEach(function(I){return s.add(I)}):u&&M.push(R)}u&&c.push([C,M])}if(u)for(var k=0,O=c;k<O.length;k++){var _=O[k],C=_[0],M=_[1];n.queries.query[C]=M}}function ka(n){var o=n._state,s=n._deps.indexedDB;if(o.isBeingOpened||n.idbdb)return o.dbReadyPromise.then(function(){return o.dbOpenError?Ne(o.dbOpenError):n});o.isBeingOpened=!0,o.dbOpenError=null,o.openComplete=!1;var u=o.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(o.openCanceller!==u)throw new X.DatabaseClosed("db.open() was cancelled")}function v(){return new ue(function(R,k){if(g(),!s)throw new X.MissingAPI;var O=n.name,_=o.autoSchema||!c?s.open(O):s.open(O,c);if(!_)throw new X.MissingAPI;_.onerror=bt(k),_.onblocked=Ke(n._fireOnBlocked),_.onupgradeneeded=Ke(function(I){var T;D=_.transaction,o.autoSchema&&!n._options.allowEmptyDB?(_.onerror=On,D.abort(),_.result.close(),(T=s.deleteDatabase(O)).onsuccess=T.onerror=Ke(function(){k(new X.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(D.onerror=bt(k),I=I.oldVersion>Math.pow(2,62)?0:I.oldVersion,y=I<1,n.idbdb=_.result,d&&Ea(n,D),Ca(n,I/10,D,k))},k),_.onsuccess=Ke(function(){D=null;var I,T,B,q,V,ne=n.idbdb=_.result,se=W(ne.objectStoreNames);if(0<se.length)try{var ee=ne.transaction((q=se).length===1?q[0]:q,"readonly");if(o.autoSchema)T=ne,B=ee,(I=n).verno=T.version/10,B=I._dbSchema=lr(0,T,B),I._storeNames=W(T.objectStoreNames,0),sr(I,[I._allTables],p(B),B);else if(ur(n,n._dbSchema,ee),((V=Gr(lr(0,(V=n).idbdb,ee),V._dbSchema)).add.length||V.change.some(function(re){return re.add.length||re.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ne.close(),c=ne.version+1,d=!0,R(v());or(n,ee)}catch{}dn.push(n),ne.onversionchange=Ke(function(re){o.vcFired=!0,n.on("versionchange").fire(re)}),ne.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),y&&(V=n._deps,ee=O,ne=V.indexedDB,V=V.IDBKeyRange,Jr(ne)||ee===Qn||Xr(ne,V).put({name:ee}).catch(ke)),R()},k)}).catch(function(R){switch(R?.name){case"UnknownError":if(0<o.PR1398_maxLoop)return o.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return ue.reject(R)})}var C,M=o.dbReadyResolve,D=null,y=!1;return ue.race([u,(typeof navigator>"u"?ue.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(R){function k(){return indexedDB.databases().finally(R)}C=setInterval(k,100),k()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(v)]).then(function(){return g(),o.onReadyBeingFired=[],ue.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function R(){if(0<o.onReadyBeingFired.length){var k=o.onReadyBeingFired.reduce(on,ke);return o.onReadyBeingFired=[],ue.resolve(Qr(function(){return k(n.vip)})).then(R)}})}).finally(function(){o.openCanceller===u&&(o.onReadyBeingFired=null,o.isBeingOpened=!1)}).catch(function(R){o.dbOpenError=R;try{D&&D.abort()}catch{}return u===o.openCanceller&&n._close(),Ne(R)}).finally(function(){o.openComplete=!0,M()}).then(function(){var R;return y&&(R={},n.tables.forEach(function(k){k.schema.indexes.forEach(function(O){O.name&&(R["idb://".concat(n.name,"/").concat(k.name,"/").concat(O.name)]=new Ve(-1/0,[[[]]]))}),R["idb://".concat(n.name,"/").concat(k.name,"/")]=R["idb://".concat(n.name,"/").concat(k.name,"/:dels")]=new Ve(-1/0,[[[]]])}),Bt(_n).fire(R),ii(R,!0)),n})}function oi(n){function o(d){return n.next(d)}var s=c(o),u=c(function(d){return n.throw(d)});function c(d){return function(C){var v=d(C),C=v.value;return v.done?C:C&&typeof C.then=="function"?C.then(s,u):h(C)?Promise.all(C).then(s,u):s(C)}}return c(o)()}function pr(n,o,s){for(var u=h(n)?n.slice():[n],c=0;c<s;++c)u.push(o);return u}var Sa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema,c={},d=[];function g(y,R,k){var O=In(y),_=c[O]=c[O]||[],I=y==null?0:typeof y=="string"?1:y.length,T=0<R,T=i(i({},k),{name:T?"".concat(O,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:T,keyTail:R,keyLength:I,extractKey:Vr(y),unique:!T&&k.unique});return _.push(T),T.isPrimaryKey||d.push(T),1<I&&g(I===2?y[0]:y.slice(0,I-1),R+1,k),_.sort(function(B,q){return B.keyTail-q.keyTail}),T}o=g(u.primaryKey.keyPath,0,u.primaryKey),c[":id"]=[o];for(var v=0,C=u.indexes;v<C.length;v++){var M=C[v];g(M.keyPath,0,M)}function D(y){var R,k=y.query.index;return k.isVirtual?i(i({},y),{query:{index:k.lowLevelIndex,range:(R=y.query.range,k=k.keyTail,{type:R.type===1?2:R.type,lower:pr(R.lower,R.lowerOpen?n.MAX_KEY:n.MIN_KEY,k),lowerOpen:!0,upper:pr(R.upper,R.upperOpen?n.MIN_KEY:n.MAX_KEY,k),upperOpen:!0})}}):y}return i(i({},s),{schema:i(i({},u),{primaryKey:o,indexes:d,getIndexByKeyPath:function(y){return(y=c[In(y)])&&y[0]}}),count:function(y){return s.count(D(y))},query:function(y){return s.query(D(y))},openCursor:function(y){var R=y.query.index,k=R.keyTail,O=R.isVirtual,_=R.keyLength;return O?s.openCursor(D(y)).then(function(T){return T&&I(T)}):s.openCursor(y);function I(T){return Object.create(T,{continue:{value:function(B){B!=null?T.continue(pr(B,y.reverse?n.MAX_KEY:n.MIN_KEY,k)):y.unique?T.continue(T.key.slice(0,_).concat(y.reverse?n.MIN_KEY:n.MAX_KEY,k)):T.continue()}},continuePrimaryKey:{value:function(B,q){T.continuePrimaryKey(pr(B,n.MAX_KEY,k),q)}},primaryKey:{get:function(){return T.primaryKey}},key:{get:function(){var B=T.key;return _===1?B[0]:B.slice(0,_)}},value:{get:function(){return T.value}}})}}})}})}};function si(n,o,s,u){return s=s||{},u=u||"",p(n).forEach(function(c){var d,g,v;b(o,c)?(d=n[c],g=o[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=le(d))!==le(g)?s[u+c]=o[c]:v==="Object"?si(d,g,s,u+c+"."):d!==g&&(s[u+c]=o[c]):d!==g&&(s[u+c]=o[c])):s[u+c]=void 0}),p(o).forEach(function(c){b(n,c)||(s[u+c]=o[c])}),s}function ai(n,o){return o.type==="delete"?o.keys:o.keys||o.values.map(n.extractKey)}var Pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema.primaryKey;return i(i({},s),{mutate:function(c){var d=he.trans,g=d.table(o).hook,v=g.deleting,C=g.creating,M=g.updating;switch(c.type){case"add":if(C.fire===ke)break;return d._promise("readwrite",function(){return D(c)},!0);case"put":if(C.fire===ke&&M.fire===ke)break;return d._promise("readwrite",function(){return D(c)},!0);case"delete":if(v.fire===ke)break;return d._promise("readwrite",function(){return D(c)},!0);case"deleteRange":if(v.fire===ke)break;return d._promise("readwrite",function(){return(function y(R,k,O){return s.query({trans:R,values:!1,query:{index:u,range:k},limit:O}).then(function(_){var I=_.result;return D({type:"delete",keys:I,trans:R}).then(function(T){return 0<T.numFailures?Promise.reject(T.failures[0]):I.length<O?{failures:[],numFailures:0,lastResult:void 0}:y(R,i(i({},k),{lower:I[I.length-1],lowerOpen:!0}),O)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function D(y){var R,k,O,_=he.trans,I=y.keys||ai(u,y);if(!I)throw new Error("Keys missing");return(y=y.type==="add"||y.type==="put"?i(i({},y),{keys:I}):i({},y)).type!=="delete"&&(y.values=a([],y.values)),y.keys&&(y.keys=a([],y.keys)),R=s,O=I,((k=y).type==="add"?Promise.resolve([]):R.getMany({trans:k.trans,keys:O,cache:"immutable"})).then(function(T){var B=I.map(function(q,V){var ne,se,ee,re=T[V],ae={onerror:null,onsuccess:null};return y.type==="delete"?v.fire.call(ae,q,re,_):y.type==="add"||re===void 0?(ne=C.fire.call(ae,q,y.values[V],_),q==null&&ne!=null&&(y.keys[V]=q=ne,u.outbound||F(y.values[V],u.keyPath,q))):(ne=si(re,y.values[V]),(se=M.fire.call(ae,ne,q,re,_))&&(ee=y.values[V],Object.keys(se).forEach(function(ie){b(ee,ie)?ee[ie]=se[ie]:F(ee,ie,se[ie])}))),ae});return s.mutate(y).then(function(q){for(var V=q.failures,ne=q.results,se=q.numFailures,q=q.lastResult,ee=0;ee<I.length;++ee){var re=(ne||I)[ee],ae=B[ee];re==null?ae.onerror&&ae.onerror(V[ee]):ae.onsuccess&&ae.onsuccess(y.type==="put"&&T[ee]?y.values[ee]:re)}return{failures:V,results:ne,numFailures:se,lastResult:q}}).catch(function(q){return B.forEach(function(V){return V.onerror&&V.onerror(q)}),Promise.reject(q)})})}}})}})}};function so(n,o,s){try{if(!o||o.keys.length<n.length)return null;for(var u=[],c=0,d=0;c<o.keys.length&&d<n.length;++c)Re(o.keys[c],n[d])===0&&(u.push(s?ce(o.values[c]):o.values[c]),++d);return u.length===n.length?u:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(n){return{table:function(o){var s=n.table(o);return i(i({},s),{getMany:function(u){if(!u.cache)return s.getMany(u);var c=so(u.keys,u.trans._cache,u.cache==="clone");return c?ue.resolve(c):s.getMany(u).then(function(d){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ce(d):d},d})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),s.mutate(u)}})}}}};function ao(n,o){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!o.schema.primaryKey.outbound}function lo(n,o){switch(n){case"query":return o.values&&!o.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var o=n.schema.name,s=new Ve(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(u,c,d){if(he.subscr&&c!=="readonly")throw new X.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(he.querier));return n.transaction(u,c,d)},table:function(u){var c=n.table(u),d=c.schema,g=d.primaryKey,y=d.indexes,v=g.extractKey,C=g.outbound,M=g.autoIncrement&&y.filter(function(k){return k.compound&&k.keyPath.includes(g.keyPath)}),D=i(i({},c),{mutate:function(k){function O(ie){return ie="idb://".concat(o,"/").concat(u,"/").concat(ie),q[ie]||(q[ie]=new Ve)}var _,I,T,B=k.trans,q=k.mutatedParts||(k.mutatedParts={}),V=O(""),ne=O(":dels"),se=k.type,ae=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[ai(g,k).filter(function(ie){return ie}),k.values]:[],ee=ae[0],re=ae[1],ae=k.trans._cache;return h(ee)?(V.addKeys(ee),(ae=se==="delete"||ee.length===re.length?so(ee,ae):null)||ne.addKeys(ee),(ae||re)&&(_=O,I=ae,T=re,d.indexes.forEach(function(ie){var pe=_(ie.name||"");function Ce(Pe){return Pe!=null?ie.extractKey(Pe):null}function Se(Pe){return ie.multiEntry&&h(Pe)?Pe.forEach(function(nt){return pe.addKey(nt)}):pe.addKey(Pe)}(I||T).forEach(function(Pe,He){var xe=I&&Ce(I[He]),He=T&&Ce(T[He]);Re(xe,He)!==0&&(xe!=null&&Se(xe),He!=null&&Se(He))})}))):ee?(re={from:(re=ee.lower)!==null&&re!==void 0?re:n.MIN_KEY,to:(re=ee.upper)!==null&&re!==void 0?re:n.MAX_KEY},ne.add(re),V.add(re)):(V.add(s),ne.add(s),d.indexes.forEach(function(ie){return O(ie.name).add(s)})),c.mutate(k).then(function(ie){return!ee||k.type!=="add"&&k.type!=="put"||(V.addKeys(ie.results),M&&M.forEach(function(pe){for(var Ce=k.values.map(function(xe){return pe.extractKey(xe)}),Se=pe.keyPath.findIndex(function(xe){return xe===g.keyPath}),Pe=0,nt=ie.results.length;Pe<nt;++Pe)Ce[Pe][Se]=ie.results[Pe];O(pe.name).addKeys(Ce)})),B.mutatedParts=fr(B.mutatedParts||{},q),ie})}}),y=function(O){var _=O.query,O=_.index,_=_.range;return[O,new Ve((O=_.lower)!==null&&O!==void 0?O:n.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:n.MAX_KEY)]},R={get:function(k){return[g,new Ve(k.key)]},getMany:function(k){return[g,new Ve().addKeys(k.keys)]},count:y,query:y,openCursor:y};return p(R).forEach(function(k){D[k]=function(O){var _=he.subscr,I=!!_,T=ao(he,c)&&lo(k,O)?O.obsSet={}:_;if(I){var B=function(re){return re="idb://".concat(o,"/").concat(u,"/").concat(re),T[re]||(T[re]=new Ve)},q=B(""),V=B(":dels"),_=R[k](O),I=_[0],_=_[1];if((k==="query"&&I.isPrimaryKey&&!O.values?V:B(I.name||"")).add(_),!I.isPrimaryKey){if(k!=="count"){var ne=k==="query"&&C&&O.values&&c.query(i(i({},O),{values:!1}));return c[k].apply(this,arguments).then(function(re){if(k==="query"){if(C&&O.values)return ne.then(function(Ce){return Ce=Ce.result,q.addKeys(Ce),re});var ae=O.values?re.result.map(v):re.result;(O.values?q:V).addKeys(ae)}else if(k==="openCursor"){var ie=re,pe=O.values;return ie&&Object.create(ie,{key:{get:function(){return V.addKey(ie.primaryKey),ie.key}},primaryKey:{get:function(){var Ce=ie.primaryKey;return V.addKey(Ce),Ce}},value:{get:function(){return pe&&q.addKey(ie.primaryKey),ie.value}}})}return re})}V.add(s)}}return c[k].apply(this,arguments)}}),D}})}};function uo(n,o,s){if(s.numFailures===0)return o;if(o.type==="deleteRange")return null;var u=o.keys?o.keys.length:"values"in o&&o.values?o.values.length:1;return s.numFailures===u?null:(o=i({},o),h(o.keys)&&(o.keys=o.keys.filter(function(c,d){return!(d in s.failures)})),"values"in o&&h(o.values)&&(o.values=o.values.filter(function(c,d){return!(d in s.failures)})),o)}function li(n,o){return s=n,((u=o).lower===void 0||(u.lowerOpen?0<Re(s,u.lower):0<=Re(s,u.lower)))&&(n=n,(o=o).upper===void 0||(o.upperOpen?Re(n,o.upper)<0:Re(n,o.upper)<=0));var s,u}function co(n,o,R,u,c,d){if(!R||R.length===0)return n;var g=o.query.index,v=g.multiEntry,C=o.query.range,M=u.schema.primaryKey.extractKey,D=g.extractKey,y=(g.lowLevelIndex||g).extractKey,R=R.reduce(function(k,O){var _=k,I=[];if(O.type==="add"||O.type==="put")for(var T=new Ve,B=O.values.length-1;0<=B;--B){var q,V=O.values[B],ne=M(V);T.hasKey(ne)||(q=D(V),(v&&h(q)?q.some(function(ie){return li(ie,C)}):li(q,C))&&(T.addKey(ne),I.push(V)))}switch(O.type){case"add":var se=new Ve().addKeys(o.values?k.map(function(pe){return M(pe)}):k),_=k.concat(o.values?I.filter(function(pe){return pe=M(pe),!se.hasKey(pe)&&(se.addKey(pe),!0)}):I.map(function(pe){return M(pe)}).filter(function(pe){return!se.hasKey(pe)&&(se.addKey(pe),!0)}));break;case"put":var ee=new Ve().addKeys(O.values.map(function(pe){return M(pe)}));_=k.filter(function(pe){return!ee.hasKey(o.values?M(pe):pe)}).concat(o.values?I:I.map(function(pe){return M(pe)}));break;case"delete":var re=new Ve().addKeys(O.keys);_=k.filter(function(pe){return!re.hasKey(o.values?M(pe):pe)});break;case"deleteRange":var ae=O.range;_=k.filter(function(pe){return!li(M(pe),ae)})}return _},n);return R===n?n:(R.sort(function(k,O){return Re(y(k),y(O))||Re(M(k),M(O))}),o.limit&&o.limit<1/0&&(R.length>o.limit?R.length=o.limit:n.length===o.limit&&R.length<o.limit&&(c.dirty=!0)),d?Object.freeze(R):R)}function fo(n,o){return Re(n.lower,o.lower)===0&&Re(n.upper,o.upper)===0&&!!n.lowerOpen==!!o.lowerOpen&&!!n.upperOpen==!!o.upperOpen}function Da(n,o){return(function(s,u,c,d){if(s===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((u=Re(s,u))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return u})(n.lower,o.lower,n.lowerOpen,o.lowerOpen)<=0&&0<=(function(s,u,c,d){if(s===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((u=Re(s,u))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return u})(n.upper,o.upper,n.upperOpen,o.upperOpen)}function Ia(n,o,s,u){n.subscribers.add(s),u.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=o,setTimeout(function(){c.subscribers.size===0&&ye(d,c)},3e3))})}var ja={stack:"dbcore",level:0,name:"Cache",create:function(n){var o=n.schema.name;return i(i({},n),{transaction:function(s,u,c){var d,g,v=n.transaction(s,u,c);return u==="readwrite"&&(g=(d=new AbortController).signal,c=function(C){return function(){if(d.abort(),u==="readwrite"){for(var M=new Set,D=0,y=s;D<y.length;D++){var R=y[D],k=Vt["idb://".concat(o,"/").concat(R)];if(k){var O=n.table(R),_=k.optimisticOps.filter(function(pe){return pe.trans===v});if(v._explicit&&C&&v.mutatedParts)for(var I=0,T=Object.values(k.queries.query);I<T.length;I++)for(var B=0,q=(se=T[I]).slice();B<q.length;B++)ti((ee=q[B]).obsSet,v.mutatedParts)&&(ye(se,ee),ee.subscribers.forEach(function(pe){return M.add(pe)}));else if(0<_.length){k.optimisticOps=k.optimisticOps.filter(function(pe){return pe.trans!==v});for(var V=0,ne=Object.values(k.queries.query);V<ne.length;V++)for(var se,ee,re,ae=0,ie=(se=ne[V]).slice();ae<ie.length;ae++)(ee=ie[ae]).res!=null&&v.mutatedParts&&(C&&!ee.dirty?(re=Object.isFrozen(ee.res),re=co(ee.res,ee.req,_,O,ee,re),ee.dirty?(ye(se,ee),ee.subscribers.forEach(function(pe){return M.add(pe)})):re!==ee.res&&(ee.res=re,ee.promise=ue.resolve({result:re}))):(ee.dirty&&ye(se,ee),ee.subscribers.forEach(function(pe){return M.add(pe)})))}}}M.forEach(function(pe){return pe()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var u=n.table(s),c=u.schema.primaryKey;return i(i({},u),{mutate:function(d){var g=he.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return u.mutate(d);var v=Vt["idb://".concat(o,"/").concat(s)];return v?(g=u.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ai(c,d).some(function(C){return C==null}))?(v.optimisticOps.push(d),d.mutatedParts&&dr(d.mutatedParts),g.then(function(C){0<C.numFailures&&(ye(v.optimisticOps,d),(C=uo(0,d,C))&&v.optimisticOps.push(C),d.mutatedParts&&dr(d.mutatedParts))}),g.catch(function(){ye(v.optimisticOps,d),d.mutatedParts&&dr(d.mutatedParts)})):g.then(function(C){var M=uo(0,i(i({},d),{values:d.values.map(function(D,y){var R;return C.failures[y]?D:(D=(R=c.keyPath)!==null&&R!==void 0&&R.includes(".")?ce(D):i({},D),F(D,c.keyPath,C.results[y]),D)})}),C);v.optimisticOps.push(M),queueMicrotask(function(){return d.mutatedParts&&dr(d.mutatedParts)})}),g):u.mutate(d)},query:function(d){if(!ao(he,u)||!lo("query",d))return u.query(d);var g=((M=he.trans)===null||M===void 0?void 0:M.db._options.cache)==="immutable",y=he,v=y.requery,C=y.signal,M=(function(O,_,I,T){var B=Vt["idb://".concat(O,"/").concat(_)];if(!B)return[];if(!(_=B.queries[I]))return[null,!1,B,null];var q=_[(T.query?T.query.index.name:null)||""];if(!q)return[null,!1,B,null];switch(I){case"query":var V=q.find(function(ne){return ne.req.limit===T.limit&&ne.req.values===T.values&&fo(ne.req.query.range,T.query.range)});return V?[V,!0,B,q]:[q.find(function(ne){return("limit"in ne.req?ne.req.limit:1/0)>=T.limit&&(!T.values||ne.req.values)&&Da(ne.req.query.range,T.query.range)}),!1,B,q];case"count":return V=q.find(function(ne){return fo(ne.req.query.range,T.query.range)}),[V,!!V,B,q]}})(o,s,"query",d),D=M[0],y=M[1],R=M[2],k=M[3];return D&&y?D.obsSet=d.obsSet:(y=u.query(d).then(function(O){var _=O.result;if(D&&(D.res=_),g){for(var I=0,T=_.length;I<T;++I)Object.freeze(_[I]);Object.freeze(_)}else O.result=ce(_);return O}).catch(function(O){return k&&D&&ye(k,D),Promise.reject(O)}),D={obsSet:d.obsSet,promise:y,subscribers:new Set,type:"query",req:d,dirty:!1},k?k.push(D):(k=[D],(R=R||(Vt["idb://".concat(o,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=k)),Ia(D,k,v,C),D.promise.then(function(O){return{result:co(O.result,d,R?.optimisticOps,u,D,g)}})}})}})}};function hr(n,o){return new Proxy(n,{get:function(s,u,c){return u==="db"?o:Reflect.get(s,u,c)}})}var Pt=(qe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new X.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var o=this._versions,s=o.filter(function(u){return u._cfg.version===n})[0];return s||(s=new this.Version(n),o.push(s),o.sort(xa),s.stores({}),this._state.autoSchema=!1,s)},qe.prototype._whenReady=function(n){var o=this;return this.idbdb&&(this._state.openComplete||he.letThrough||this._vip)?n():new ue(function(s,u){if(o._state.openComplete)return u(new X.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return void u(new X.DatabaseClosed);o.open().catch(ke)}o._state.dbReadyPromise.then(s,u)}).then(n)},qe.prototype.use=function(n){var o=n.stack,s=n.create,u=n.level,c=n.name;return c&&this.unuse({stack:o,name:c}),n=this._middlewares[o]||(this._middlewares[o]=[]),n.push({stack:o,create:s,level:u??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},qe.prototype.unuse=function(n){var o=n.stack,s=n.name,u=n.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(c){return u?c.create!==u:!!s&&c.name!==s})),this},qe.prototype.open=function(){var n=this;return Wt(et,function(){return ka(n)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,o=dn.indexOf(this);if(0<=o&&dn.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new ue(function(s){n.dbReadyResolve=s}),n.openCanceller=new ue(function(s,u){n.cancelOpen=u}))},qe.prototype.close=function(s){var o=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new X.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new X.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},qe.prototype.delete=function(n){var o=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",u=this._state;return new ue(function(c,d){function g(){o.close(n);var v=o._deps.indexedDB.deleteDatabase(o.name);v.onsuccess=Ke(function(){var C,M,D;C=o._deps,M=o.name,D=C.indexedDB,C=C.IDBKeyRange,Jr(D)||M===Qn||Xr(D,C).delete(M).catch(ke),c()}),v.onerror=bt(d),v.onblocked=o._fireOnBlocked}if(s)throw new X.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(o){return n._allTables[o]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var n=(function(o,s,u){var c=arguments.length;if(c<2)throw new X.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return u=d.pop(),[o,J(d),u]}).apply(this,arguments);return this._transaction.apply(this,n)},qe.prototype._transaction=function(n,o,s){var u=this,c=he.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=o.map(function(M){if(M=M instanceof u.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Kr)throw new X.InvalidArgument("Invalid transaction mode: "+n);d=Kr}if(c){if(c.mode===Fr&&d===Kr){if(!v)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(M){if(c&&c.storeNames.indexOf(M)===-1){if(!v)throw new X.SubTransaction("Table "+M+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(M){return c?c._promise(null,function(D,y){y(M)}):Ne(M)}var C=(function M(D,y,R,k,O){return ue.resolve().then(function(){var _=he.transless||he,I=D._createTransaction(y,R,D._dbSchema,k);if(I.explicit=!0,_={trans:I,transless:_},k)I.idbtrans=k.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,D._state.PR1398_maxLoop=3}catch(q){return q.name===ze.InvalidState&&D.isOpen()&&0<--D._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),D.close({disableAutoOpen:!1}),D.open().then(function(){return M(D,y,R,null,O)})):Ne(q)}var T,B=Me(O);return B&&fn(),_=ue.follow(function(){var q;(T=O.call(I,I))&&(B?(q=Rt.bind(null,null),T.then(q,q)):typeof T.next=="function"&&typeof T.throw=="function"&&(T=oi(T)))},_),(T&&typeof T.then=="function"?ue.resolve(T).then(function(q){return I.active?q:Ne(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return T})).then(function(q){return k&&I._resolve(),I._completion.then(function(){return q})}).catch(function(q){return I._reject(q),Ne(q)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,C,"lock"):he.trans?Wt(he.transless,function(){return u._whenReady(C)}):this._whenReady(C)},qe.prototype.table=function(n){if(!b(this._allTables,n))throw new X.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},qe);function qe(n,o){var s=this;this._middlewares={},this.verno=0;var u=qe.dependencies;this._options=o=i({addons:qe.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},u=o.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,C,M={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen};M.dbReadyPromise=new ue(function(y){M.dbReadyResolve=y}),M.openCanceller=new ue(function(y,R){M.cancelOpen=R}),this._state=M,this.name=n,this.on=Sn(this,"populate","blocked","versionchange","close",{ready:[on,ke]}),this.once=function(y,R){var k=function(){for(var O=[],_=0;_<arguments.length;_++)O[_]=arguments[_];s.on(y).unsubscribe(k),R.apply(s,O)};return s.on(y,k)},this.on.ready.subscribe=te(this.on.ready.subscribe,function(y){return function(R,k){qe.vip(function(){var O,_=s._state;_.openComplete?(_.dbOpenError||ue.resolve().then(R),k&&y(R)):_.onReadyBeingFired?(_.onReadyBeingFired.push(R),k&&y(R)):(y(R),O=s,k||y(function I(){O.on.ready.unsubscribe(R),O.on.ready.unsubscribe(I)}))})}}),this.Collection=(c=this,Pn(ga.prototype,function(T,I){this.db=c;var k=Fi,O=null;if(I)try{k=I()}catch(B){O=B}var _=T._ctx,I=_.table,T=I.hook.reading.fire;this._ctx={table:I,index:_.index,isPrimKey:!_.index||I.schema.primKey.keyPath&&_.index===I.schema.primKey.name,range:k,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:_.or,valueMapper:T!==Xe?T:null}})),this.Table=(d=this,Pn($i.prototype,function(y,R,k){this.db=d,this._tx=k,this.name=y,this.schema=R,this.hook=d._allTables[y]?d._allTables[y].hook:Sn(null,{creating:[$n,ke],reading:[qt,Xe],updating:[Vn,ke],deleting:[nn,ke]})})),this.Transaction=(g=this,Pn(ya.prototype,function(y,R,k,O,_){var I=this;y!=="readonly"&&R.forEach(function(T){T=(T=k[T])===null||T===void 0?void 0:T.yProps,T&&(R=R.concat(T.map(function(B){return B.updatesTable})))}),this.db=g,this.mode=y,this.storeNames=R,this.schema=k,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Sn(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ue(function(T,B){I._resolve=T,I._reject=B}),this._completion.then(function(){I.active=!1,I.on.complete.fire()},function(T){var B=I.active;return I.active=!1,I.on.error.fire(T),I.parent?I.parent._reject(T):B&&I.idbtrans&&I.idbtrans.abort(),Ne(T)})})),this.Version=(v=this,Pn(Ma.prototype,function(y){this.db=v,this._cfg={version:y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(C=this,Pn(Xi.prototype,function(y,R,k){if(this.db=C,this._ctx={table:y,index:R===":id"?null:R,or:k},this._cmp=this._ascending=Re,this._descending=function(O,_){return Re(_,O)},this._max=function(O,_){return 0<Re(O,_)?O:_},this._min=function(O,_){return Re(O,_)<0?O:_},this._IDBKeyRange=C._deps.IDBKeyRange,!this._IDBKeyRange)throw new X.MissingAPI})),this.on("versionchange",function(y){0<y.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(y){!y.newVersion||y.newVersion<y.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(y.oldVersion/10))}),this._maxKey=Dn(o.IDBKeyRange),this._createTransaction=function(y,R,k,O){return new s.Transaction(y,R,k,s._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(y){s.on("blocked").fire(y),dn.filter(function(R){return R.name===s.name&&R!==s&&!R._state.vcFired}).map(function(R){return R.on("versionchange").fire(y)})},this.use(Oa),this.use(ja),this.use(_a),this.use(Sa),this.use(Pa);var D=new Proxy(this,{get:function(y,R,k){if(R==="_vip")return!0;if(R==="table")return function(_){return hr(s.table(_),D)};var O=Reflect.get(y,R,k);return O instanceof $i?hr(O,D):R==="tables"?O.map(function(_){return hr(_,D)}):R==="_createTransaction"?function(){return hr(O.apply(this,arguments),D)}:O}});this.vip=D,u.forEach(function(y){return y(s)})}var gr,lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ra=(ui.prototype.subscribe=function(n,o,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:o,complete:s})},ui.prototype[lt]=function(){return this},ui);function ui(n){this._subscribe=n}try{gr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{gr={indexedDB:null,IDBKeyRange:null}}function po(n){var o,s=!1,u=new Ra(function(c){var d=Me(n),g,v=!1,C={},M={},D={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),y&&Bt.storagemutated.unsubscribe(k))}};c.start&&c.start(D);var y=!1,R=function(){return zr(O)},k=function(_){fr(C,_),ti(M,C)&&R()},O=function(){var _,I,T;!v&&gr.indexedDB&&(C={},_={},g&&g.abort(),g=new AbortController,T=(function(B){var q=Mt();try{d&&fn();var V=jt(n,B);return V=d?V.finally(Rt):V}finally{q&&It()}})(I={subscr:_,signal:g.signal,requery:R,querier:n,trans:null}),Promise.resolve(T).then(function(B){s=!0,o=B,v||I.signal.aborted||(C={},(function(q){for(var V in q)if(b(q,V))return;return 1})(M=_)||y||(Bt(_n,k),y=!0),zr(function(){return!v&&c.next&&c.next(B)}))},function(B){s=!1,["DatabaseClosedError","AbortError"].includes(B?.name)||v||zr(function(){v||c.error&&c.error(B)})}))};return setTimeout(R,0),D});return u.hasValue=function(){return s},u.getValue=function(){return o},u}var Ht=Pt;function ci(n){var o=Ut;try{Ut=!0,Bt.storagemutated.fire(n),ii(n,!0)}finally{Ut=o}}x(Ht,i(i({},_e),{delete:function(n){return new Ht(n,{addons:[]}).delete()},exists:function(n){return new Ht(n,{addons:[]}).open().then(function(o){return o.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return o=Ht.dependencies,s=o.indexedDB,o=o.IDBKeyRange,(Jr(s)?Promise.resolve(s.databases()).then(function(u){return u.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Xr(s,o).toCollection().primaryKeys()).then(n)}catch{return Ne(new X.MissingAPI)}var o,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return he.trans?Wt(he.transless,n):n()},vip:Qr,async:function(n){return function(){try{var o=oi(n.apply(this,arguments));return o&&typeof o.then=="function"?o:ue.resolve(o)}catch(s){return Ne(s)}}},spawn:function(n,o,s){try{var u=oi(n.apply(s,o||[]));return u&&typeof u.then=="function"?u:ue.resolve(u)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return he.trans||null}},waitFor:function(n,o){return o=ue.resolve(typeof n=="function"?Ht.ignoreTransaction(n):n).timeout(o||6e4),he.trans?he.trans.waitFor(o):o},Promise:ue,debug:{get:function(){return Je},set:function(n){xn(n)}},derive:A,extend:m,props:x,override:te,Events:Sn,on:Bt,liveQuery:po,extendObservabilitySet:fr,getByKeyPath:S,setByKeyPath:F,delByKeyPath:function(n,o){typeof o=="string"?F(n,o,void 0):"length"in o&&[].map.call(o,function(s){F(n,s,void 0)})},shallowClone:Y,deepClone:ce,getObjectDiff:si,cmp:Re,asap:j,minKey:-1/0,addons:[],connections:dn,errnames:ze,dependencies:gr,cache:Vt,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,o,s){return n+o/Math.pow(10,2*s)})})),Ht.maxKey=Dn(Ht.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Bt(_n,function(n){Ut||(n=new CustomEvent(Wr,{detail:n}),Ut=!0,dispatchEvent(n),Ut=!1)}),addEventListener(Wr,function(n){n=n.detail,Ut||ci(n)}));var mn,Ut=!1,ho=function(){};return typeof BroadcastChannel<"u"&&((ho=function(){(mn=new BroadcastChannel(Wr)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof mn.unref=="function"&&mn.unref(),Bt(_n,function(n){Ut||mn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Pt.disableBfCache&&n.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),mn?.close();for(var o=0,s=dn;o<s.length;o++)s[o].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Pt.disableBfCache&&n.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),ho(),ci({all:new Ve(-1/0,[[]])}))})),ue.rejectionMapper=function(n,o){return!n||n instanceof ve||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ge[n.name]?n:(o=new ge[n.name](o||n.message,n),"stack"in n&&E(o,"stack",{get:function(){return this.inner.stack}}),o)},xn(Je),i(Pt,Object.freeze({__proto__:null,Dexie:Pt,liveQuery:po,Entity:Ki,cmp:Re,PropModification:kn,replacePrefix:function(n,o){return new kn({replacePrefix:[n,o]})},add:function(n){return new kn({add:n})},remove:function(n){return new kn({remove:n})},default:Pt,RangeSet:Ve,mergeRanges:Rn,rangesOverlap:no}),{default:Pt}),Pt})})(xr)),xr.exports}var vc=mc();const Oi=Ta(vc),Ns=Symbol.for("Dexie"),Ar=globalThis[Ns]||(globalThis[Ns]=Oi);if(Oi.semVer!==Ar.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Oi.semVer} and ${Ar.semVer}`);const{liveQuery:jc,mergeRanges:Rc,rangesOverlap:Ac,RangeSet:Tc,cmp:Bc,Entity:Uc,PropModification:zc,replacePrefix:Fc,add:Kc,remove:Nc,DexieYProvider:qc}=Ar,it=new Ar("ChillGameDB");it.version(1).stores({exploredCells:"id, [iy+ix]",claimedCells:"id, [iy+ix]",gameState:"key"});it.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const qs=5e-4,Ye=ec(hc((t,e)=>({clouds:10,claimedCells:[],exploredCells:[],selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,i,a,f]=await Promise.all([it.exploredCells.toArray(),it.claimedCells.toArray(),it.gameState.get("clouds"),it.gameState.get("lastCloudIncrease")]);t(p=>{p.exploredCells=r,p.claimedCells=i,p.clouds=a?a.value:10,p.lastCloudIncrease=f?f.value:Date.now(),p.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(i=>{i.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(i=>{i.clouds<10&&(i.clouds+=1,i.lastCloudIncrease=r)}),it.gameState.put({key:"clouds",value:e().clouds}),it.gameState.put({key:"lastCloudIncrease",value:r})},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:i,longitude:a}=r.coords,f=new Set(e().exploredCells.map(p=>p.id));t(p=>{p.userLocation={lat:i,lng:a};const h=Math.floor(i/qs),m=Math.floor(a/qs),L=[],w=2;for(let b=-w;b<=w;b++)for(let x=-w;x<=w;x++)if(b*b+x*x<=w*w){const P=`${h+b}_${m+x}`;if(!f.has(P)){const E={id:P,iy:h+b,ix:m+x};p.exploredCells.push(E),L.push(E),f.add(P)}}L.length>0&&it.exploredCells.bulkAdd(L).catch(b=>console.error("Failed to bulkAdd explored cells:",b))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const i=e().selectedCell,a=e().claimedCells,f=r?.key;console.log(`[selectCell] Checking cell with key: ${f}`);const p=a.some(h=>h.id===f);if(console.log(`[selectCell] Is this cell claimed? ${p}`),p){console.log("[selectCell] Reason: Cell is already in the claimedCells list.");const h=a.find(m=>m.id===f);console.log("[selectCell] Problematic cell data:",h)}r?i&&i.key===f?(console.log("[selectCell] Decision: Deselecting (clicking the same cell again)."),t({selectedCell:null})):p?(console.log("[selectCell] Decision: Deselecting (cell is already claimed)."),t({selectedCell:null})):(console.log("[selectCell] Decision: Selecting cell."),t({selectedCell:r})):(console.log("[selectCell] Decision: Deselecting (cell is null)."),t({selectedCell:null}))},updateSelectedCellInfo:r=>{t(i=>{i.selectedCell&&(i.selectedCell={...i.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:i}=e();if(!r)return"no-cell";if(i<=0)return"no-clouds";const{key:a}=r,[f,p]=a.split("_").map(Number),m={id:a,iy:f,ix:p,data:{owner:"user",color:"#3B82F6"}},L=new Set(e().exploredCells.map(x=>x.id)),w=[],b=1;for(let x=-b;x<=b;x++)for(let P=-b;P<=b;P++){const E=f+x,A=p+P,z=`${E}_${A}`;L.has(z)||w.push({id:z,iy:E,ix:A})}return t(x=>{x.clouds-=1,x.claimedCells.push(m),x.exploredCells.push(...w),x.selectedCell=null}),it.claimedCells.put(m),it.gameState.put({key:"clouds",value:e().clouds}),w.length>0&&it.exploredCells.bulkAdd(w),"claimed"},register:()=>{t({clouds:10}),it.gameState.put({key:"clouds",value:10})}}))),yc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},bc={fontSize:"24px"};function wc(){const t=Ye(e=>e.clouds);return oe.jsxs("div",{style:yc,children:[oe.jsx("span",{style:bc,children:"☁️"}),oe.jsx("span",{children:t})]})}const Lc=Qt.memo(wc),xc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},Cc={fontSize:"28px"};function Ec({onClick:t}){const[e,r]=l.useState(!1),i={...xc,transform:e?"scale(1.1)":"scale(1)"};return oe.jsx("button",{onClick:t,title:"Reset View",style:i,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:oe.jsx("span",{style:Cc,children:"🧭"})})}const Mc=l.memo(Ec),wr={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},kc=()=>{const t=Ye(f=>f.clouds),e=Ye(f=>f.lastCloudIncrease),r=Ye(f=>f.increaseCloud),[i,a]=l.useState(0);return l.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const m=6e4-(Date.now()-e);m<=0?(r(),a(60)):a(Math.ceil(m/1e3))},1e3):(clearInterval(f),a(0)),()=>clearInterval(f)},[t,e,r]),oe.jsxs("div",{style:wr.container,children:[oe.jsx("span",{style:wr.icon,children:"☁️"}),t<10?oe.jsxs("span",{style:wr.timer,children:[i,"s"]}):oe.jsx("span",{style:wr.timer,children:"⏰"})]})},Sc=l.memo(kc),Lr=new Map,Ws=.5;function Pc(t){const e=Ye(r=>r.updateSelectedCellInfo);l.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,i=`${Math.floor(r.lat/Ws)}_${Math.floor(r.lng/Ws)}`;(async()=>{if(Lr.has(i)){e(Lr.get(i));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,L=m.find(A=>A.types.includes("country")),w=m.find(A=>A.types.includes("administrative_area_level_1")),b=L?L.long_name:"未知領域",x=L?L.short_name.toLowerCase():null,P=w?w.long_name:"",E=x?`https://flagcdn.com/w40/${x}.png`:null;h={countryName:b,regionName:P,flagUrl:E}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};Lr.set(i,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};Lr.set(i,p),e(p)}})()},[t,e])}const Oc=l.lazy(()=>_i(()=>import("./Leaderboard-B06MkgQ_.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),_c=l.lazy(()=>_i(()=>import("./RegistrationModal-CUENZ_nl.js"),__vite__mapDeps([4,1,2]))),Dc=l.lazy(()=>_i(()=>import("./InfoModal-CY1iFqnQ.js"),__vite__mapDeps([5,1,2]))),ft={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"4px",left:"8px",zIndex:50}};function Wc(){const{lat:t,lng:e}=Ba(),r=Ua(),[i,a]=l.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=l.useState(!1),h=l.useRef(null),m=Ye(Q=>Q.claimedCells),L=Ye(Q=>Q.exploredCells),w=Ye(Q=>Q.selectedCell),b=Ye(Q=>Q.userLocation),x=Ye(Q=>Q.clouds),P=Ye(Q=>Q.initializeGeolocation),E=Ye(Q=>Q.selectCell),A=Ye(Q=>Q.claimSelectedCell),z=Ye(Q=>Q.register),$=Ye(Q=>Q.isHydrated),W=Ye(Q=>Q.hydrate);Pc(w);const{isLoaded:te}=ll({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});l.useEffect(()=>{P()},[P]),l.useEffect(()=>{W()},[W]),l.useEffect(()=>{i||navigator.geolocation.getCurrentPosition(Q=>{a({lat:Q.coords.latitude,lng:Q.coords.longitude})},()=>{a({lat:25.033,lng:121.5654})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},[i]);const[K,j]=l.useState(!1),[S,F]=l.useState(!1),[Y,U]=l.useState(!1),[J,G]=l.useState(!1),[H,ce]=l.useState([]),fe=l.useCallback(Q=>{h.current=Q},[]),le=l.useCallback((Q,X)=>{xi(),E(Q?{key:Q,position:X,isLoading:!0}:null)},[E]),de=l.useCallback(()=>{if(!w)return;const Q={id:Date.now()+Math.random(),position:w.position,startTime:Date.now(),particleDuration:2500,revealDuration:1e3,onComplete:()=>{A()==="no-clouds"&&j(!0)}};ce(X=>[...X,Q]),setTimeout(()=>{ce(X=>X.filter(ge=>ge.id!==Q.id))},2500)},[A,w]),Le=l.useCallback(()=>{E(null)},[E]),ye=l.useCallback(()=>{z(),j(!1)},[z]),be=l.useCallback(async()=>{if(!h.current)return;const Q=h.current.getCenter(),X=Q.lat(),ge=Q.lng();p(!0),await Kt(h.current,{lat:X,lng:ge},1500,2,G),r("/",{state:{lat:X,lng:ge}})},[r,G]),me=l.useCallback(async()=>{if(b&&h.current){const Q=h.current,X=Q.getCenter(),ge={lat:X.lat(),lng:X.lng()};await Kt(Q,ge,1e3,5,G),await Kt(Q,b,1500,5,G),await Kt(Q,b,1e3,15,G)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[b,G]),Me=l.useCallback(Q=>{r(`/map/${Q.lat.toFixed(7)}/${Q.lng.toFixed(7)}`,{replace:!0})},[r]),Ie=l.useCallback(async()=>{if(h.current){const Q=h.current.getZoom(),X=Math.min(20,Q+1);X!==Q&&await Kt(h.current,h.current.getCenter().toJSON(),300,X,G)}},[G]),ve=l.useCallback(async()=>{if(h.current){const Q=h.current.getZoom(),X=Math.max(2,Q-1);X!==Q&&await Kt(h.current,h.current.getCenter().toJSON(),300,X,G)}},[G]),Ae=l.useCallback(()=>U(!0),[]),Z=l.useCallback(()=>j(!1),[]),Te=l.useCallback(()=>F(!1),[]),ze=l.useCallback(()=>U(!1),[]);return!te||!i||!$?oe.jsx(go,{}):oe.jsxs("div",{style:ft.app,className:f?"map-container-fade-out":"",children:[oe.jsx(Yu,{center:i,onSelectCell:le,claimedCells:m,exploredCells:L,setMapRef:fe,onZoomChanged:()=>{},onCenterChanged:Me,selectedCell:w,userLocation:b,isAnimating:J,effects:H}),w&&oe.jsx(oa,{cellInfo:w,onClaim:de,onClose:Le,isClaimDisabled:x<=0&&K}),oe.jsxs("div",{style:ft.topLeftControls,children:[oe.jsx("button",{style:ft.controlButton,onClick:Ie,children:"+"}),oe.jsx("button",{style:ft.controlButton,onClick:ve,children:"-"}),oe.jsx("button",{style:ft.controlButton,onClick:Ae,children:"i"})]}),oe.jsx("div",{style:ft.topCenterContainer,children:oe.jsx(Lc,{})}),oe.jsxs("div",{style:ft.topRightContainer,children:[oe.jsx("button",{style:ft.controlButton,onClick:()=>F(!0),children:"🏆"}),oe.jsx("button",{style:ft.controlButton,onClick:be,title:"Return to Globe",children:"🌍"})]}),oe.jsx("div",{style:ft.bottomLeftContainer,children:oe.jsx(Sc,{})}),oe.jsx("div",{style:ft.bottomRightContainer,children:oe.jsx(Mc,{onClick:me})}),oe.jsxs(l.Suspense,{fallback:oe.jsx(go,{}),children:[K&&oe.jsx(_c,{onClose:Z,onRegister:ye}),S&&oe.jsx(Oc,{onClose:Te}),Y&&oe.jsx(Dc,{onClose:ze})]})]})}export{Wc as default};
