const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-CeJL5m5-.js","assets/index-CDUIqDhi.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-D7NH75kU.js","assets/InfoModal-nL5Y5zy1.js"])))=>i.map(i=>d[i]);
import{r as u,j as ie,a as Ln,R as Qt,c as Aa,g as Ta,b as Ba,u as Ua,L as go,_ as _i}from"./index-CDUIqDhi.js";function Fn(t){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(t)}function za(t,e){if(Fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Fn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=za(t,"string");return Fn(e)=="symbol"?e:e+""}function K(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var di,mo;function Ka(){if(mo)return di;mo=1;var t=function(r,i,a,f,p,h,m,b){if(!r){var y;if(i===void 0)y=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var w=[a,f,p,h,m,b],C=0;y=new Error(i.replace(/%s/g,function(){return w[C++]})),y.name="Invariant Violation"}throw y.framesToPop=1,y}};return di=t,di}var Na=Ka(),We=Zs(Na),Me=u.createContext(null);function qa(){We(!!u.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=u.useContext(Me);return We(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function Wa(t,e,r){return Object.keys(t).reduce(function(a,f){return e(a,t[f],f)},r)}function Za(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function $a(t,e,r,i){var a={},f=(p,h)=>{var m=r[h];m!==e[h]&&(a[h]=m,p(i,m))};return Za(t,f),a}function Va(t,e,r){var i=Wa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return i}function Ha(t){google.maps.event.removeListener(t)}function je(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Ha)}function _e(t){var{updaterMap:e,eventMap:r,prevProps:i,nextProps:a,instance:f}=t,p=Va(a,f,r);return $a(e,i,a,f),p}var vo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},yo={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ga(t){var{children:e,options:r,id:i,mapContainerStyle:a,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:b,onDragEnd:y,onDragStart:w,onMouseMove:C,onMouseOut:_,onMouseOver:x,onMouseDown:A,onMouseUp:B,onRightClick:Z,onCenterChanged:q,onLoad:X,onUnmount:F}=t,[R,z]=u.useState(null),W=u.useRef(null),[H,U]=u.useState(null),[oe,ee]=u.useState(null),[ne,ue]=u.useState(null),[se,fe]=u.useState(null),[me,be]=u.useState(null),[de,we]=u.useState(null),[ve,Le]=u.useState(null),[Se,ge]=u.useState(null),[De,$]=u.useState(null),[Te,ze]=u.useState(null),[G,Y]=u.useState(null),[ye,Ie]=u.useState(null);return u.useEffect(()=>{r&&R!==null&&R.setOptions(r)},[R,r]),u.useEffect(()=>{R!==null&&typeof p<"u"&&R.setCenter(p)},[R,p]),u.useEffect(()=>{R&&m&&(oe!==null&&google.maps.event.removeListener(oe),ee(google.maps.event.addListener(R,"dblclick",m)))},[m]),u.useEffect(()=>{R&&y&&(ne!==null&&google.maps.event.removeListener(ne),ue(google.maps.event.addListener(R,"dragend",y)))},[y]),u.useEffect(()=>{R&&w&&(se!==null&&google.maps.event.removeListener(se),fe(google.maps.event.addListener(R,"dragstart",w)))},[w]),u.useEffect(()=>{R&&A&&(me!==null&&google.maps.event.removeListener(me),be(google.maps.event.addListener(R,"mousedown",A)))},[A]),u.useEffect(()=>{R&&C&&(de!==null&&google.maps.event.removeListener(de),we(google.maps.event.addListener(R,"mousemove",C)))},[C]),u.useEffect(()=>{R&&_&&(ve!==null&&google.maps.event.removeListener(ve),Le(google.maps.event.addListener(R,"mouseout",_)))},[_]),u.useEffect(()=>{R&&x&&(Se!==null&&google.maps.event.removeListener(Se),ge(google.maps.event.addListener(R,"mouseover",x)))},[x]),u.useEffect(()=>{R&&B&&(De!==null&&google.maps.event.removeListener(De),$(google.maps.event.addListener(R,"mouseup",B)))},[B]),u.useEffect(()=>{R&&Z&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(R,"rightclick",Z)))},[Z]),u.useEffect(()=>{R&&h&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(R,"click",h)))},[h]),u.useEffect(()=>{R&&b&&(ye!==null&&google.maps.event.removeListener(ye),Ie(google.maps.event.addListener(R,"drag",b)))},[b]),u.useEffect(()=>{R&&q&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(R,"center_changed",q)))},[h]),u.useEffect(()=>{var ke=W.current===null?null:new google.maps.Map(W.current,r);return z(ke),ke!==null&&X&&X(ke),()=>{ke!==null&&F&&F(ke)}},[]),ie.jsx("div",{id:i,ref:W,style:a,className:f,children:ie.jsx(Me.Provider,{value:R,children:R!==null?e:null})})}u.memo(Ga);class Ya extends u.PureComponent{constructor(){super(...arguments),K(this,"state",{map:null}),K(this,"registeredEvents",[]),K(this,"mapRef",null),K(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),K(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),K(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),K(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),je(this.registeredEvents))}render(){return ie.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:ie.jsx(Me.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bo(t,e,r,i,a,f,p){try{var h=t[f](p),m=h.value}catch(b){return void r(b)}h.done?e(m):Promise.resolve(m).then(i,a)}function $s(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var f=t.apply(e,r);function p(m){bo(f,i,a,p,h,"next",m)}function h(m){bo(f,i,a,p,h,"throw",m)}p(void 0)})}}function Vs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:i="weekly",language:a,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:b,apiUrl:y="https://maps.googleapis.com"}=t,w=[];return We(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?w.push("key=".concat(e)):r&&w.push("client=".concat(r)),i&&w.push("v=".concat(i)),a&&w.push("language=".concat(a)),f&&w.push("region=".concat(f)),p&&p.length&&w.push("libraries=".concat(p.sort().join(","))),h&&w.push("channel=".concat(h)),m&&m.length&&w.push("map_ids=".concat(m.join(","))),b&&w.push("auth_referrer_policy=".concat(b)),w.push("loading=async"),w.push("callback=initMap"),"".concat(y,"/maps/api/js?").concat(w.join("&"))}var Nt=typeof document<"u";function Hs(t){var{url:e,id:r,nonce:i}=t;return Nt?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var b=h.getAttribute("data-state");if(h.src===e&&b!=="error"){if(b==="ready")return f(r);var y=m.initMap,w=h.onerror;m.initMap=function(){y&&y(),f(r)},h.onerror=function(_){w&&w(_),p(_)};return}else h.remove()}var C=document.createElement("script");C.type="text/javascript",C.src=e,C.id=r,C.async=!0,C.nonce=i||"",C.onerror=function(x){C.setAttribute("data-state","error"),p(x)},m.initMap=function(){C.setAttribute("data-state","ready"),f(r)},document.head.appendChild(C)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function wo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function Di(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,f){return wo(a)||Reflect.apply(e,t,[a,f]),a};var r=t.appendChild.bind(t);t.appendChild=function(a){return wo(a)||Reflect.apply(r,t,[a]),a}}}var An=!1;function Gs(){return ie.jsx("div",{children:"Loading..."})}var Kn={id:"script-loader",version:"weekly"};class Xa extends u.PureComponent{constructor(){super(...arguments),K(this,"check",null),K(this,"state",{loaded:!1}),K(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),K(this,"isCleaningUp",$s(function*(){function e(r){if(!An)r();else if(Nt)var i=window.setInterval(function(){An||(window.clearInterval(i),r())},1)}return new Promise(e)})),K(this,"cleanup",()=>{An=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),K(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Di(),We(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Vs(this.props)};Hs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),K(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Nt){if(window.google&&window.google.maps&&!An){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Nt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Nt){this.cleanup();var e=()=>{this.check||(delete window.google,An=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return ie.jsxs(ie.Fragment,{children:[ie.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||ie.jsx(Gs,{})]})}}K(Xa,"defaultProps",Kn);function Ja(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function Ii(t,e){if(t==null)return{};var r,i,a=Ja(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(i=0;i<f.length;i++)r=f[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var Lo;function Qa(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:b,channel:y,mapIds:w,authReferrerPolicy:C,apiUrl:_="https://maps.googleapis.com"}=t,x=u.useRef(!1),[A,B]=u.useState(!1),[Z,q]=u.useState(void 0);u.useEffect(function(){return x.current=!0,()=>{x.current=!1}},[]),u.useEffect(function(){Nt&&b&&Di()},[b]),u.useEffect(function(){A&&We(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[A]);var X=Vs({version:r,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,channel:y,mapIds:w,authReferrerPolicy:C,apiUrl:_});u.useEffect(function(){if(!Nt)return;function z(){x.current&&(B(!0),Lo=X)}if(window.google&&window.google.maps&&Lo===X){z();return}Hs({id:e,url:X,nonce:i}).then(z).catch(function(H){x.current&&q(H),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(H)})},[e,X,i]);var F=u.useRef(void 0);return u.useEffect(function(){F.current&&m!==F.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),F.current=m},[m]),{isLoaded:A,loadError:Z,url:X}}var el=["loadingElement","onLoad","onError","onUnmount","children"],tl=ie.jsx(Gs,{});function nl(t){var{loadingElement:e,onLoad:r,onError:i,onUnmount:a,children:f}=t,p=Ii(t,el),{isLoaded:h,loadError:m}=Qa(p);return u.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),u.useEffect(function(){m&&typeof i=="function"&&i(m)},[m,i]),u.useEffect(function(){return()=>{a&&a()}},[a]),h?f:e||tl}u.memo(nl);function rl(t,e,r,i){function a(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(y){try{b(i.next(y))}catch(w){p(w)}}function m(y){try{b(i.throw(y))}catch(w){p(w)}}function b(y){y.done?f(y.value):a(y.value).then(h,m)}b((i=i.apply(t,[])).next())})}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ol=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},sl=il(ol),xo="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Jt{constructor(e){var{apiKey:r,authReferrerPolicy:i,channel:a,client:f,id:p=xo,language:h,libraries:m=[],mapIds:b,nonce:y,region:w,retries:C=3,url:_="https://maps.googleapis.com/maps/api/js",version:x}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=i,this.channel=a,this.client=f,this.id=p||xo,this.language=h,this.libraries=m,this.mapIds=b,this.nonce=y,this.region=w,this.retries=C,this.url=_,this.version=x,Jt.instance){if(!sl(this.options,Jt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Jt.instance.options)));return Jt.instance}Jt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(i=>{i?r(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(f=>!i[f]&&delete i[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,b="The Google Maps JavaScript API",y="google",w="importLibrary",C="__ib__",_=document,x=window;x=x[y]||(x[y]={});var A=x.maps||(x.maps={}),B=new Set,Z=new URLSearchParams,q=()=>p||(p=new Promise((X,F)=>rl(this,void 0,void 0,function*(){var R;yield h=_.createElement("script"),h.id=this.id,Z.set("libraries",[...B]+"");for(m in f)Z.set(m.replace(/[A-Z]/g,z=>"_"+z[0].toLowerCase()),f[m]);Z.set("callback",y+".maps."+C),h.src=this.url+"?"+Z,A[C]=X,h.onerror=()=>p=F(Error(b+" could not load.")),h.nonce=this.nonce||((R=_.querySelector("script[nonce]"))===null||R===void 0?void 0:R.nonce)||"",_.head.append(h)})));A[w]?console.warn(b+" only loads once. Ignoring:",f):A[w]=function(X){for(var F=arguments.length,R=new Array(F>1?F-1:0),z=1;z<F;z++)R[z-1]=arguments[z];return B.add(X)&&q().then(()=>A[w](X,...R))}})(i);var a=this.libraries.map(f=>this.importLibrary(f));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var al=["maps"];function ll(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,language:f,region:p,libraries:h=al,preventGoogleFontsLoading:m,mapIds:b,authReferrerPolicy:y}=t,w=u.useRef(!1),[C,_]=u.useState(!1),[x,A]=u.useState(void 0);u.useEffect(function(){return w.current=!0,()=>{w.current=!1}},[]);var B=u.useMemo(()=>new Jt({id:e,apiKey:a,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:b||[],nonce:i||"",authReferrerPolicy:y||"origin"}),[e,a,r,h,f,p,b,i,y]);u.useEffect(function(){C||B.load().then(()=>{w.current&&_(!0)}).catch(X=>{A(X)})},[]),u.useEffect(()=>{Nt&&m&&Di()},[m]);var Z=u.useRef();return u.useEffect(()=>{Z.current&&h!==Z.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Z.current=h},[h]),{isLoaded:C,loadError:x}}function Co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Co(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Eo={},So={options(t,e){t.setOptions(e)}};function ul(t){var{options:e,onLoad:r,onUnmount:i}=t,a=u.useContext(Me),[f,p]=u.useState(null);return u.useEffect(()=>{f!==null&&f.setMap(a)},[a]),u.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),u.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:a}));return p(h),r&&r(h),()=>{f!==null&&(i&&i(f),f.setMap(null))}},[]),null}u.memo(ul);class cl extends u.PureComponent{constructor(){super(...arguments),K(this,"state",{trafficLayer:null}),K(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),K(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:So,eventMap:Eo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:So,eventMap:Eo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),je(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}K(cl,"contextType",Me);function fl(t){var{onLoad:e,onUnmount:r}=t,i=u.useContext(Me),[a,f]=u.useState(null);return u.useEffect(()=>{a!==null&&a.setMap(i)},[i]),u.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(i),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}u.memo(fl);class dl extends u.PureComponent{constructor(){super(...arguments),K(this,"state",{bicyclingLayer:null}),K(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}K(dl,"contextType",Me);function pl(t){var{onLoad:e,onUnmount:r}=t,i=u.useContext(Me),[a,f]=u.useState(null);return u.useEffect(()=>{a!==null&&a.setMap(i)},[i]),u.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(i),e&&e(p),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}u.memo(pl);class hl extends u.PureComponent{constructor(){super(...arguments),K(this,"state",{transitLayer:null}),K(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}K(hl,"contextType",Me);function Mo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mo(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ko={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Po={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function gl(t){var{options:e,drawingMode:r,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:b,onUnmount:y}=t,w=u.useContext(Me),[C,_]=u.useState(null),[x,A]=u.useState(null),[B,Z]=u.useState(null),[q,X]=u.useState(null),[F,R]=u.useState(null),[z,W]=u.useState(null),[H,U]=u.useState(null);return u.useEffect(()=>{C!==null&&C.setMap(w)},[w]),u.useEffect(()=>{e&&C!==null&&C.setOptions(e)},[C,e]),u.useEffect(()=>{C!==null&&C.setDrawingMode(r??null)},[C,r]),u.useEffect(()=>{C&&i&&(x!==null&&google.maps.event.removeListener(x),A(google.maps.event.addListener(C,"circlecomplete",i)))},[C,i]),u.useEffect(()=>{C&&a&&(B!==null&&google.maps.event.removeListener(B),Z(google.maps.event.addListener(C,"markercomplete",a)))},[C,a]),u.useEffect(()=>{C&&f&&(q!==null&&google.maps.event.removeListener(q),X(google.maps.event.addListener(C,"overlaycomplete",f)))},[C,f]),u.useEffect(()=>{C&&p&&(F!==null&&google.maps.event.removeListener(F),R(google.maps.event.addListener(C,"polygoncomplete",p)))},[C,p]),u.useEffect(()=>{C&&h&&(z!==null&&google.maps.event.removeListener(z),W(google.maps.event.addListener(C,"polylinecomplete",h)))},[C,h]),u.useEffect(()=>{C&&m&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(C,"rectanglecomplete",m)))},[C,m]),u.useEffect(()=>{We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var oe=new google.maps.drawing.DrawingManager(Er(Er({},e),{},{map:w}));return r&&oe.setDrawingMode(r),i&&A(google.maps.event.addListener(oe,"circlecomplete",i)),a&&Z(google.maps.event.addListener(oe,"markercomplete",a)),f&&X(google.maps.event.addListener(oe,"overlaycomplete",f)),p&&R(google.maps.event.addListener(oe,"polygoncomplete",p)),h&&W(google.maps.event.addListener(oe,"polylinecomplete",h)),m&&U(google.maps.event.addListener(oe,"rectanglecomplete",m)),_(oe),b&&b(oe),()=>{C!==null&&(x&&google.maps.event.removeListener(x),B&&google.maps.event.removeListener(B),q&&google.maps.event.removeListener(q),F&&google.maps.event.removeListener(F),z&&google.maps.event.removeListener(z),H&&google.maps.event.removeListener(H),y&&y(C),C.setMap(null))}},[]),null}u.memo(gl);class ml extends u.PureComponent{constructor(e){super(e),K(this,"registeredEvents",[]),K(this,"state",{drawingManager:null}),K(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Er(Er({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Po,eventMap:ko,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Po,eventMap:ko,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),je(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}K(ml,"contextType",Me);function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var _o={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Do={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Sr={};function vl(t){var{position:e,options:r,clusterer:i,noClustererRedraw:a,children:f,draggable:p,visible:h,animation:m,clickable:b,cursor:y,icon:w,label:C,opacity:_,shape:x,title:A,zIndex:B,onClick:Z,onDblClick:q,onDrag:X,onDragEnd:F,onDragStart:R,onMouseOut:z,onMouseOver:W,onMouseUp:H,onMouseDown:U,onRightClick:oe,onClickableChanged:ee,onCursorChanged:ne,onAnimationChanged:ue,onDraggableChanged:se,onFlatChanged:fe,onIconChanged:me,onPositionChanged:be,onShapeChanged:de,onTitleChanged:we,onVisibleChanged:ve,onZindexChanged:Le,onLoad:Se,onUnmount:ge}=t,De=u.useContext(Me),[$,Te]=u.useState(null),[ze,G]=u.useState(null),[Y,ye]=u.useState(null),[Ie,ke]=u.useState(null),[Xe,qt]=u.useState(null),[Re,$n]=u.useState(null),[nn,Vn]=u.useState(null),[rn,on]=u.useState(null),[Je,xn]=u.useState(null),[pt,Cn]=u.useState(null),[Ot,ht]=u.useState(null),[at,sn]=u.useState(null),[gt,an]=u.useState(null),[xt,mt]=u.useState(null),[Ct,ln]=u.useState(null),[et,he]=u.useState(null),[vt,yt]=u.useState(null),[Et,ce]=u.useState(null),[un,En]=u.useState(null),[_t,Sn]=u.useState(null),[Dt,Hn]=u.useState(null),[cn,St]=u.useState(null);u.useEffect(()=>{$!==null&&$.setMap(De)},[De]),u.useEffect(()=>{typeof r<"u"&&$!==null&&$.setOptions(r)},[$,r]),u.useEffect(()=>{typeof p<"u"&&$!==null&&$.setDraggable(p)},[$,p]),u.useEffect(()=>{e&&$!==null&&$.setPosition(e)},[$,e]),u.useEffect(()=>{typeof h<"u"&&$!==null&&$.setVisible(h)},[$,h]),u.useEffect(()=>{$?.setAnimation(m)},[$,m]),u.useEffect(()=>{$&&b!==void 0&&$.setClickable(b)},[$,b]),u.useEffect(()=>{$&&y!==void 0&&$.setCursor(y)},[$,y]),u.useEffect(()=>{$&&w!==void 0&&$.setIcon(w)},[$,w]),u.useEffect(()=>{$&&C!==void 0&&$.setLabel(C)},[$,C]),u.useEffect(()=>{$&&_!==void 0&&$.setOpacity(_)},[$,_]),u.useEffect(()=>{$&&x!==void 0&&$.setShape(x)},[$,x]),u.useEffect(()=>{$&&A!==void 0&&$.setTitle(A)},[$,A]),u.useEffect(()=>{$&&B!==void 0&&$.setZIndex(B)},[$,B]),u.useEffect(()=>{$&&q&&(ze!==null&&google.maps.event.removeListener(ze),G(google.maps.event.addListener($,"dblclick",q)))},[q]),u.useEffect(()=>{$&&F&&(Y!==null&&google.maps.event.removeListener(Y),ye(google.maps.event.addListener($,"dragend",F)))},[F]),u.useEffect(()=>{$&&R&&(Ie!==null&&google.maps.event.removeListener(Ie),ke(google.maps.event.addListener($,"dragstart",R)))},[R]),u.useEffect(()=>{$&&U&&(Xe!==null&&google.maps.event.removeListener(Xe),qt(google.maps.event.addListener($,"mousedown",U)))},[U]),u.useEffect(()=>{$&&z&&(Re!==null&&google.maps.event.removeListener(Re),$n(google.maps.event.addListener($,"mouseout",z)))},[z]),u.useEffect(()=>{$&&W&&(nn!==null&&google.maps.event.removeListener(nn),Vn(google.maps.event.addListener($,"mouseover",W)))},[W]),u.useEffect(()=>{$&&H&&(rn!==null&&google.maps.event.removeListener(rn),on(google.maps.event.addListener($,"mouseup",H)))},[H]),u.useEffect(()=>{$&&oe&&(Je!==null&&google.maps.event.removeListener(Je),xn(google.maps.event.addListener($,"rightclick",oe)))},[oe]),u.useEffect(()=>{$&&Z&&(pt!==null&&google.maps.event.removeListener(pt),Cn(google.maps.event.addListener($,"click",Z)))},[Z]),u.useEffect(()=>{$&&X&&(Ot!==null&&google.maps.event.removeListener(Ot),ht(google.maps.event.addListener($,"drag",X)))},[X]),u.useEffect(()=>{$&&ee&&(at!==null&&google.maps.event.removeListener(at),sn(google.maps.event.addListener($,"clickable_changed",ee)))},[ee]),u.useEffect(()=>{$&&ne&&(gt!==null&&google.maps.event.removeListener(gt),an(google.maps.event.addListener($,"cursor_changed",ne)))},[ne]),u.useEffect(()=>{$&&ue&&(xt!==null&&google.maps.event.removeListener(xt),mt(google.maps.event.addListener($,"animation_changed",ue)))},[ue]),u.useEffect(()=>{$&&se&&(Ct!==null&&google.maps.event.removeListener(Ct),ln(google.maps.event.addListener($,"draggable_changed",se)))},[se]),u.useEffect(()=>{$&&fe&&(et!==null&&google.maps.event.removeListener(et),he(google.maps.event.addListener($,"flat_changed",fe)))},[fe]),u.useEffect(()=>{$&&me&&(vt!==null&&google.maps.event.removeListener(vt),yt(google.maps.event.addListener($,"icon_changed",me)))},[me]),u.useEffect(()=>{$&&be&&(Et!==null&&google.maps.event.removeListener(Et),ce(google.maps.event.addListener($,"position_changed",be)))},[be]),u.useEffect(()=>{$&&de&&(un!==null&&google.maps.event.removeListener(un),En(google.maps.event.addListener($,"shape_changed",de)))},[de]),u.useEffect(()=>{$&&we&&(_t!==null&&google.maps.event.removeListener(_t),Sn(google.maps.event.addListener($,"title_changed",we)))},[we]),u.useEffect(()=>{$&&ve&&(Dt!==null&&google.maps.event.removeListener(Dt),Hn(google.maps.event.addListener($,"visible_changed",ve)))},[ve]),u.useEffect(()=>{$&&Le&&(cn!==null&&google.maps.event.removeListener(cn),St(google.maps.event.addListener($,"zindex_changed",Le)))},[Le]),u.useEffect(()=>{var Mt=bn(bn(bn({},r||Sr),i?Sr:{map:De}),{},{position:e}),xe=new google.maps.Marker(Mt);return i?i.addMarker(xe,!!a):xe.setMap(De),e&&xe.setPosition(e),typeof h<"u"&&xe.setVisible(h),typeof p<"u"&&xe.setDraggable(p),typeof b<"u"&&xe.setClickable(b),typeof y=="string"&&xe.setCursor(y),w&&xe.setIcon(w),typeof C<"u"&&xe.setLabel(C),typeof _<"u"&&xe.setOpacity(_),x&&xe.setShape(x),typeof A=="string"&&xe.setTitle(A),typeof B=="number"&&xe.setZIndex(B),q&&G(google.maps.event.addListener(xe,"dblclick",q)),F&&ye(google.maps.event.addListener(xe,"dragend",F)),R&&ke(google.maps.event.addListener(xe,"dragstart",R)),U&&qt(google.maps.event.addListener(xe,"mousedown",U)),z&&$n(google.maps.event.addListener(xe,"mouseout",z)),W&&Vn(google.maps.event.addListener(xe,"mouseover",W)),H&&on(google.maps.event.addListener(xe,"mouseup",H)),oe&&xn(google.maps.event.addListener(xe,"rightclick",oe)),Z&&Cn(google.maps.event.addListener(xe,"click",Z)),X&&ht(google.maps.event.addListener(xe,"drag",X)),ee&&sn(google.maps.event.addListener(xe,"clickable_changed",ee)),ne&&an(google.maps.event.addListener(xe,"cursor_changed",ne)),ue&&mt(google.maps.event.addListener(xe,"animation_changed",ue)),se&&ln(google.maps.event.addListener(xe,"draggable_changed",se)),fe&&he(google.maps.event.addListener(xe,"flat_changed",fe)),me&&yt(google.maps.event.addListener(xe,"icon_changed",me)),be&&ce(google.maps.event.addListener(xe,"position_changed",be)),de&&En(google.maps.event.addListener(xe,"shape_changed",de)),we&&Sn(google.maps.event.addListener(xe,"title_changed",we)),ve&&Hn(google.maps.event.addListener(xe,"visible_changed",ve)),Le&&St(google.maps.event.addListener(xe,"zindex_changed",Le)),Te(xe),Se&&Se(xe),()=>{ze!==null&&google.maps.event.removeListener(ze),Y!==null&&google.maps.event.removeListener(Y),Ie!==null&&google.maps.event.removeListener(Ie),Xe!==null&&google.maps.event.removeListener(Xe),Re!==null&&google.maps.event.removeListener(Re),nn!==null&&google.maps.event.removeListener(nn),rn!==null&&google.maps.event.removeListener(rn),Je!==null&&google.maps.event.removeListener(Je),pt!==null&&google.maps.event.removeListener(pt),at!==null&&google.maps.event.removeListener(at),gt!==null&&google.maps.event.removeListener(gt),xt!==null&&google.maps.event.removeListener(xt),Ct!==null&&google.maps.event.removeListener(Ct),et!==null&&google.maps.event.removeListener(et),vt!==null&&google.maps.event.removeListener(vt),Et!==null&&google.maps.event.removeListener(Et),_t!==null&&google.maps.event.removeListener(_t),Dt!==null&&google.maps.event.removeListener(Dt),cn!==null&&google.maps.event.removeListener(cn),ge&&ge(xe),i?i.removeMarker(xe,!!a):xe&&xe.setMap(null)}},[]);var It=u.useMemo(()=>f?u.Children.map(f,Mt=>{if(!u.isValidElement(Mt))return Mt;var xe=Mt;return u.cloneElement(xe,{anchor:$})}):null,[f,$]);return ie.jsx(ie.Fragment,{children:It})||null}u.memo(vl);class yl extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[])}componentDidMount(){var e=this;return $s(function*(){var r=bn(bn(bn({},e.props.options||Sr),e.props.clusterer?Sr:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),je(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?u.Children.map(this.props.children,r=>{if(!u.isValidElement(r))return r;var i=r;return u.cloneElement(i,{anchor:this.marker})}):null;return e||null}}K(yl,"contextType",Me);var bl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var i=r.getMaxZoom(),a=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(a),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(a);var h=p.getZoom()||0;i!==null&&h>i&&p.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,i,a,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),b=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),y=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),w=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(w!==null?"".concat(w.y,"px"):"0","; left: ").concat(w!==null?"".concat(w.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var C=document.createElement("img");C.alt=h,C.src=this.url,C.width=this.width,C.height=this.height,C.setAttribute("style","position: absolute; top: ".concat(y,"px; left: ").concat(b,"px")),this.cluster.getClusterer().enableRetinaIcons||(C.style.clip="rect(-".concat(y,"px, -").concat(b+this.width,"px, -").concat(y+this.height,", -").concat(b,")"));var _=document.createElement("div");_.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(_.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(_.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(C),this.div.appendChild(_),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),i=r[Math.min(r.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),wl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new bl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),i=0,a=r;i<a.length;i++){var f=a[i],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,b=this.markers;m<b.length;m++){var y=b[m];y.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function Ll(t,e){var r=t.length,i=r.toString().length,a=Math.min(i,e);return{text:r.toString(),index:a,title:""}}var xl=2e3,Cl=500,El="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",Sl="png",Ml=[53,56,66,78,90],kl="cluster",Ys=(function(){function t(e,r,i){r===void 0&&(r=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||El,this.imageExtension=i.imageExtension||Sl,this.imageSizes=i.imageSizes||Ml,this.calculator=i.calculator||Ll,this.batchSize=i.batchSize||xl,this.batchSizeIE=i.batchSizeIE||Cl,this.clusterClass=i.clusterClass||kl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var i=r[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,f=this.clusters;a<f.length;a++){var p=f[a];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var b=m[h];google.maps.event.removeListener(b)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var f=a[i],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){r=i;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var i=this.removeMarker_(e);return!r&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,r){for(var i=!1,a=0,f=e;a<f.length;a++){var p=f[a];i=i||this.removeMarker_(p)}return!r&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var f=a[i];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var f=r.fromDivPixelToLatLng(i);f!==null&&e.extend(f)}if(a!==null){var p=r.fromDivPixelToLatLng(a);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,i=this.clusters;r<i.length;r++){var a=i[r];a.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var i=6371,a=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return i*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var i=e.getPosition();return i?r.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var r,i=4e4,a=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),b=e.getPosition();if(m&&b){var y=this.distanceBetweenPoints(m,b);y<i&&(i=y,a=r)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(r=new wl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,f=i?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),b=e;b<m;b++){var y=this.markers[b];y&&!y.isAdded&&this.isMarkerInBounds(y,h)&&(!this.ignoreHidden||this.ignoreHidden&&y.getVisible())&&this.addToClosestCluster(y)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var w=0,C=this.clusters;w<C.length;w++){var _=C[w];_.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype){var p=f;this.prototype[p]=a.prototype[p]}return this}).apply(e,[r])},t})();function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ct={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Ue={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Ol={};function _l(t){var{children:e,options:r,averageCenter:i,batchSizeIE:a,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:b,imageExtension:y,imagePath:w,imageSizes:C,maxZoom:_,minimumClusterSize:x,styles:A,title:B,zoomOnClick:Z,onClick:q,onClusteringBegin:X,onClusteringEnd:F,onMouseOver:R,onMouseOut:z,onLoad:W,onUnmount:H}=t,[U,oe]=u.useState(null),ee=u.useContext(Me),[ne,ue]=u.useState(null),[se,fe]=u.useState(null),[me,be]=u.useState(null),[de,we]=u.useState(null),[ve,Le]=u.useState(null);return u.useEffect(()=>{U&&z&&(de!==null&&google.maps.event.removeListener(de),we(google.maps.event.addListener(U,ct.onMouseOut,z)))},[z]),u.useEffect(()=>{U&&R&&(ve!==null&&google.maps.event.removeListener(ve),Le(google.maps.event.addListener(U,ct.onMouseOver,R)))},[R]),u.useEffect(()=>{U&&q&&(ne!==null&&google.maps.event.removeListener(ne),ue(google.maps.event.addListener(U,ct.onClick,q)))},[q]),u.useEffect(()=>{U&&X&&(se!==null&&google.maps.event.removeListener(se),fe(google.maps.event.addListener(U,ct.onClusteringBegin,X)))},[X]),u.useEffect(()=>{U&&F&&(me!==null&&google.maps.event.removeListener(me),fe(google.maps.event.addListener(U,ct.onClusteringEnd,F)))},[F]),u.useEffect(()=>{typeof i<"u"&&U!==null&&Ue.averageCenter(U,i)},[U,i]),u.useEffect(()=>{typeof a<"u"&&U!==null&&Ue.batchSizeIE(U,a)},[U,a]),u.useEffect(()=>{typeof f<"u"&&U!==null&&Ue.calculator(U,f)},[U,f]),u.useEffect(()=>{typeof p<"u"&&U!==null&&Ue.clusterClass(U,p)},[U,p]),u.useEffect(()=>{typeof h<"u"&&U!==null&&Ue.enableRetinaIcons(U,h)},[U,h]),u.useEffect(()=>{typeof m<"u"&&U!==null&&Ue.gridSize(U,m)},[U,m]),u.useEffect(()=>{typeof b<"u"&&U!==null&&Ue.ignoreHidden(U,b)},[U,b]),u.useEffect(()=>{typeof y<"u"&&U!==null&&Ue.imageExtension(U,y)},[U,y]),u.useEffect(()=>{typeof w<"u"&&U!==null&&Ue.imagePath(U,w)},[U,w]),u.useEffect(()=>{typeof C<"u"&&U!==null&&Ue.imageSizes(U,C)},[U,C]),u.useEffect(()=>{typeof _<"u"&&U!==null&&Ue.maxZoom(U,_)},[U,_]),u.useEffect(()=>{typeof x<"u"&&U!==null&&Ue.minimumClusterSize(U,x)},[U,x]),u.useEffect(()=>{typeof A<"u"&&U!==null&&Ue.styles(U,A)},[U,A]),u.useEffect(()=>{typeof B<"u"&&U!==null&&Ue.title(U,B)},[U,B]),u.useEffect(()=>{typeof Z<"u"&&U!==null&&Ue.zoomOnClick(U,Z)},[U,Z]),u.useEffect(()=>{if(ee){var Se=Pl({},r||Ol),ge=new Ys(ee,[],Se);return i&&Ue.averageCenter(ge,i),a&&Ue.batchSizeIE(ge,a),f&&Ue.calculator(ge,f),p&&Ue.clusterClass(ge,p),h&&Ue.enableRetinaIcons(ge,h),m&&Ue.gridSize(ge,m),b&&Ue.ignoreHidden(ge,b),y&&Ue.imageExtension(ge,y),w&&Ue.imagePath(ge,w),C&&Ue.imageSizes(ge,C),_&&Ue.maxZoom(ge,_),x&&Ue.minimumClusterSize(ge,x),A&&Ue.styles(ge,A),B&&Ue.title(ge,B),Z&&Ue.zoomOnClick(ge,Z),z&&we(google.maps.event.addListener(ge,ct.onMouseOut,z)),R&&Le(google.maps.event.addListener(ge,ct.onMouseOver,R)),q&&ue(google.maps.event.addListener(ge,ct.onClick,q)),X&&fe(google.maps.event.addListener(ge,ct.onClusteringBegin,X)),F&&be(google.maps.event.addListener(ge,ct.onClusteringEnd,F)),oe(ge),W&&W(ge),()=>{de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),ne!==null&&google.maps.event.removeListener(ne),se!==null&&google.maps.event.removeListener(se),me!==null&&google.maps.event.removeListener(me),H&&H(ge)}}},[]),U!==null&&e(U)||null}u.memo(_l);class Dl extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{markerClusterer:null}),K(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ys(this.context,[],this.props.options);this.registeredEvents=_e({updaterMap:Ue,eventMap:ct,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ue,eventMap:ct,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),je(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}K(Dl,"contextType",Me);function jo(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Xs=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(y){y.returnValue=!1,y.preventDefault&&y.preventDefault(),e.enableEventPropagation||jo(y)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,jo))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var i=0,a=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,b=this.pixelOffset.width,y=this.pixelOffset.height,w=this.div.offsetWidth,C=this.div.offsetHeight,_=this.infoBoxClearance.width,x=this.infoBoxClearance.height,A=this.getProjection(),B=A.fromLatLngToContainerPixel(this.position);B!==null&&(B.x<-b+_?i=B.x+b-_:B.x+w+b+_>h&&(i=B.x+w+b+_-h),this.alignBottom?B.y<-y+x+C?a=B.y+y-x-C:B.y+y+x>m&&(a=B.y+y+x-m):B.y<-y+x?a=B.y+y-x:B.y+C+y+x>m&&(a=B.y+C+y+x-m)),i===0&&a===0||r.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,i=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var i=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){i.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var i=r[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=a.prototype[f]);return this}).apply(e,[r])},t})(),Il=["position"],jl=["position"];function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ro(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ao={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},To={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Rl={};function Al(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:b,onZindexChanged:y,onLoad:w,onUnmount:C}=t,_=u.useContext(Me),[x,A]=u.useState(null),[B,Z]=u.useState(null),[q,X]=u.useState(null),[F,R]=u.useState(null),[z,W]=u.useState(null),[H,U]=u.useState(null),oe=u.useRef(null);return u.useEffect(()=>{_&&x!==null&&(x.close(),r?x.open(_,r):x.getPosition()&&x.open(_))},[_,x,r]),u.useEffect(()=>{i&&x!==null&&x.setOptions(i)},[x,i]),u.useEffect(()=>{if(a&&x!==null){var ee=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);x.setPosition(ee)}},[a]),u.useEffect(()=>{typeof f=="number"&&x!==null&&x.setZIndex(f)},[f]),u.useEffect(()=>{x&&p&&(B!==null&&google.maps.event.removeListener(B),Z(google.maps.event.addListener(x,"closeclick",p)))},[p]),u.useEffect(()=>{x&&h&&(q!==null&&google.maps.event.removeListener(q),X(google.maps.event.addListener(x,"domready",h)))},[h]),u.useEffect(()=>{x&&m&&(F!==null&&google.maps.event.removeListener(F),R(google.maps.event.addListener(x,"content_changed",m)))},[m]),u.useEffect(()=>{x&&b&&(z!==null&&google.maps.event.removeListener(z),W(google.maps.event.addListener(x,"position_changed",b)))},[b]),u.useEffect(()=>{x&&y&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(x,"zindex_changed",y)))},[y]),u.useEffect(()=>{if(_){var ee=i||Rl,{position:ne}=ee,ue=Ii(ee,Il),se;ne&&!(ne instanceof google.maps.LatLng)&&(se=new google.maps.LatLng(ne.lat,ne.lng));var fe=new Xs(Mr(Mr({},ue),se?{position:se}:{}));oe.current=document.createElement("div"),A(fe),p&&Z(google.maps.event.addListener(fe,"closeclick",p)),h&&X(google.maps.event.addListener(fe,"domready",h)),m&&R(google.maps.event.addListener(fe,"content_changed",m)),b&&W(google.maps.event.addListener(fe,"position_changed",b)),y&&U(google.maps.event.addListener(fe,"zindex_changed",y)),fe.setContent(oe.current),r?fe.open(_,r):fe.getPosition()?fe.open(_):We(!1,"You must provide either an anchor or a position prop for <InfoBox>."),w&&w(fe)}return()=>{x!==null&&(B&&google.maps.event.removeListener(B),F&&google.maps.event.removeListener(F),q&&google.maps.event.removeListener(q),z&&google.maps.event.removeListener(z),H&&google.maps.event.removeListener(H),C&&C(x),x.close())}},[]),oe.current?Ln.createPortal(u.Children.only(e),oe.current):null}u.memo(Al);class Tl extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"containerElement",null),K(this,"state",{infoBox:null}),K(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):We(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),K(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,i=Ii(e,jl),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var f=new Xs(Mr(Mr({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:To,eventMap:Ao,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:To,eventMap:Ao,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),je(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(u.Children.only(this.props.children),this.containerElement):null}}K(Tl,"contextType",Me);var pi,Bo;function Bl(){return Bo||(Bo=1,pi=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),pi}var Ul=Bl(),Uo=Zs(Ul),zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],hi=1,Tn=8;class ji{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==hi)throw new Error("Got v".concat(a," data when expected v").concat(hi,"."));var f=zo[i&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new ji(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=zo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Tn+p+h+m),this.ids=new this.IndexArrayType(this.data,Tn,e),this.coords=new this.ArrayType(this.data,Tn+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(hi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return wi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],b=[];m.length;){var y=m.pop()||0,w=m.pop()||0,C=m.pop()||0;if(w-C<=h){for(var _=C;_<=w;_++){var x=p[2*_],A=p[2*_+1];x>=e&&x<=i&&A>=r&&A<=a&&b.push(f[_])}continue}var B=C+w>>1,Z=p[2*B],q=p[2*B+1];Z>=e&&Z<=i&&q>=r&&q<=a&&b.push(f[B]),(y===0?e<=Z:r<=q)&&(m.push(C),m.push(B-1),m.push(1-y)),(y===0?i>=Z:a>=q)&&(m.push(B+1),m.push(w),m.push(1-y))}return b}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:f,nodeSize:p}=this,h=[0,a.length-1,0],m=[],b=i*i;h.length;){var y=h.pop()||0,w=h.pop()||0,C=h.pop()||0;if(w-C<=p){for(var _=C;_<=w;_++)Fo(f[2*_],f[2*_+1],e,r)<=b&&m.push(a[_]);continue}var x=C+w>>1,A=f[2*x],B=f[2*x+1];Fo(A,B,e,r)<=b&&m.push(a[x]),(y===0?e-i<=A:r-i<=B)&&(h.push(C),h.push(x-1),h.push(1-y)),(y===0?e+i>=A:r+i>=B)&&(h.push(x+1),h.push(w),h.push(1-y))}return m}}function wi(t,e,r,i,a,f){if(!(a-i<=r)){var p=i+a>>1;Js(t,e,p,i,a,f),wi(t,e,r,i,p-1,1-f),wi(t,e,r,p+1,a,1-f)}}function Js(t,e,r,i,a,f){for(;a>i;){if(a-i>600){var p=a-i+1,h=r-i+1,m=Math.log(p),b=.5*Math.exp(2*m/3),y=.5*Math.sqrt(m*b*(p-b)/p)*(h-p/2<0?-1:1),w=Math.max(i,Math.floor(r-h*b/p+y)),C=Math.min(a,Math.floor(r+(p-h)*b/p+y));Js(t,e,r,w,C,f)}var _=e[2*r+f],x=i,A=a;for(Bn(t,e,i,r),e[2*a+f]>_&&Bn(t,e,i,a);x<A;){for(Bn(t,e,x,A),x++,A--;e[2*x+f]<_;)x++;for(;e[2*A+f]>_;)A--}e[2*i+f]===_?Bn(t,e,i,A):(A++,Bn(t,e,A,a)),A<=r&&(i=A+1),r<=A&&(a=A-1)}}function Bn(t,e,r,i){gi(t,r,i),gi(e,2*r,2*i),gi(e,2*r+1,2*i+1)}function gi(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Fo(t,e,r,i){var a=t-r,f=e-i;return a*a+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ko=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Yt=2,Ft=3,mi=4,zt=5,Qs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:i,maxZoom:a}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[b,y]=m.geometry.coordinates,w=Ko(vr(b)),C=Ko(yr(y));p.push(w,C,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var _=this.trees[a+1]=this._createTree(p);r&&console.timeEnd(f);for(var x=a;x>=i;x--){var A=+Date.now();_=this.trees[x]=this._createTree(this._cluster(_,x)),r&&console.log("z%d: %d clusters in %dms",x,_.numItems,+Date.now()-A)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,f=180;else if(i>f){var h=this.getClusters([i,a,180,p],r),m=this.getClusters([-180,a,f,p],r);return h.concat(m)}var b=this.trees[this._limitZoom(r)],y=b.range(vr(i),yr(p),vr(f),yr(a)),w=b.data,C=[];for(var _ of y){var x=this.stride*_;C.push(w[x+zt]>1?No(w,x,this.clusterProps):this.points[w[x+Ft]])}return C}getChildren(e){var r=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",f=this.trees[i];if(!f)throw new Error(a);var p=f.data;if(r*this.stride>=p.length)throw new Error(a);var h=this.options.radius/(this.options.extent*Math.pow(2,i-1)),m=p[r*this.stride],b=p[r*this.stride+1],y=f.within(m,b,h),w=[];for(var C of y){var _=C*this.stride;p[_+mi]===e&&w.push(p[_+zt]>1?No(p,_,this.clusterProps):this.points[p[_+Ft]])}if(w.length===0)throw new Error(a);return w}getLeaves(e,r,i){r=r||10,i=i||0;var a=[];return this._appendLeaves(a,e,r,i,0),a}getTile(e,r,i){var a=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,b=(i-m)/f,y=(i+1+m)/f,w={features:[]};return this._addTileFeatures(a.range((r-m)/f,b,(r+1+m)/f,y),a.data,r,i,f,w),r===0&&this._addTileFeatures(a.range(1-m/f,b,1,y),a.data,f,i,f,w),r===f-1&&this._addTileFeatures(a.range(0,b,m/f,y),a.data,-1,i,f,w),w.features.length?w:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var i=this.getChildren(e);if(r++,i.length!==1)break;e=i[0].properties.cluster_id}return r}_appendLeaves(e,r,i,a,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=a?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,i,a,f):f<a?f++:e.push(h),e.length===i)break}return f}_createTree(e){for(var r=new ji(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)r.add(e[i],e[i+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,i,a,f,p){for(var h of e){var m=h*this.stride,b=r[m+zt]>1,y=void 0,w=void 0,C=void 0;if(b)y=ea(r,m,this.clusterProps),w=r[m],C=r[m+1];else{var _=this.points[r[m+Ft]];y=_.properties;var[x,A]=_.geometry.coordinates;w=vr(x),C=yr(A)}var B={type:1,geometry:[[Math.round(this.options.extent*(w*f-i)),Math.round(this.options.extent*(C*f-a))]],tags:y},Z=void 0;b||this.options.generateId?Z=r[m+Ft]:Z=this.points[r[m+Ft]].id,Z!==void 0&&(B.id=Z),p.features.push(B)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:i,extent:a,reduce:f,minPoints:p}=this.options,h=i/(a*Math.pow(2,r)),m=e.data,b=[],y=this.stride,w=0;w<m.length;w+=y)if(!(m[w+Yt]<=r)){m[w+Yt]=r;var C=m[w],_=m[w+1],x=e.within(m[w],m[w+1],h),A=m[w+zt],B=A;for(var Z of x){var q=Z*y;m[q+Yt]>r&&(B+=m[q+zt])}if(B>A&&B>=p){var X=C*A,F=_*A,R=void 0,z=-1,W=((w/y|0)<<5)+(r+1)+this.points.length;for(var H of x){var U=H*y;if(!(m[U+Yt]<=r)){m[U+Yt]=r;var oe=m[U+zt];X+=m[U]*oe,F+=m[U+1]*oe,m[U+mi]=W,f&&(R||(R=this._map(m,w,!0),z=this.clusterProps.length,this.clusterProps.push(R)),f(R,this._map(m,U)))}}m[w+mi]=W,b.push(X/B,F/B,1/0,W,-1,B),f&&b.push(z)}else{for(var ee=0;ee<y;ee++)b.push(m[w+ee]);if(B>1)for(var ne of x){var ue=ne*y;if(!(m[ue+Yt]<=r)){m[ue+Yt]=r;for(var se=0;se<y;se++)b.push(m[ue+se])}}}}return b}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,i){if(e[r+zt]>1){var a=this.clusterProps[e[r+Qs]];return i?Object.assign({},a):a}var f=this.points[e[r+Ft]].properties,p=this.options.map(f);return i&&p===f?Object.assign({},p):p}}function No(t,e,r){return{type:"Feature",id:t[e+Ft],properties:ea(t,e,r),geometry:{type:"Point",coordinates:[Kl(t[e]),Nl(t[e+1])]}}}function ea(t,e,r){var i=t[e+zt],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,f=t[e+Qs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Ft],point_count:i,point_count_abbreviated:a})}function vr(t){return t/360+.5}function yr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Kl(t){return(t-.5)*360}function Nl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ql(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(r[i[a]]=t[i[a]]);return r}class ot{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Li{constructor(e){var{markers:r,position:i}=e;this.markers=r,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(ot.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ot.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ot.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Wl{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Zl(r)}}var Zl=t=>{var e=t.map(r=>new Li({position:ot.getPosition(r),markers:[r]}));return e};class $l extends Wl{constructor(e){var{maxZoom:r,radius:i=60}=e,a=ql(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var r=!1,i={zoom:e.map.getZoom()};if(!Uo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var a=this.markers.map(f=>{var p=ot.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(r=!Uo(this.state,i)),this.state=i,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[r,i]},properties:a}=e;if(a.cluster)return new Li({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:i,lng:r}});var f=a.marker;return new Li({markers:[f],position:ot.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var i=r.map(f=>f.count),a=i.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class Hl{render(e,r,i){var{count:a,position:f}=e,p=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),m="Cluster of ".concat(a," markers"),b=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ot.isAdvancedMarkerAvailable(i)){var y=new DOMParser,w=y.parseFromString(h,"image/svg+xml").documentElement;w.setAttribute("transform","translate(0 25)");var C={map:i,position:f,zIndex:b,title:m,content:w};return new google.maps.marker.AdvancedMarkerElement(C)}var _={position:f,zIndex:b,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(_)}}function Gl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ri{constructor(){Gl(Ri,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Yl=(t,e,r)=>{r.fitBounds(e.bounds)};class Xl extends Ri{constructor(e){var{map:r,markers:i=[],algorithmOptions:a={},algorithm:f=new $l(a),renderer:p=new Hl,onClusterClick:h=Yl}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(i=>{this.addMarker(i,!0)}),r||this.render()}removeMarker(e,r){var i=this.markers.indexOf(e);return i===-1?!1:(ot.setMap(e,null),this.markers.splice(i,1),r||this.render(),!0)}removeMarkers(e,r){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!r&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var f of r)f.markers.length==1&&a.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?a.has(h.marker)||ot.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>ot.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ot.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,r),i.markers.forEach(a=>ot.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,i),this.onClusterClick(a,i,r)})),ot.setMap(i.marker,r)})}}function qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Wo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qo(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Jl(t){var e=qa(),[r,i]=u.useState(null);return u.useEffect(()=>{if(e&&r===null){var a=new Xl(Wo(Wo({},t),{},{map:e}));i(a)}},[e]),r}function Ql(t){var{children:e,options:r}=t,i=Jl(r);return i!==null?e(i):null}u.memo(Ql);var Zo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},$o={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function eu(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:b,onZindexChanged:y,onLoad:w,onUnmount:C}=t,_=u.useContext(Me),[x,A]=u.useState(null),[B,Z]=u.useState(null),[q,X]=u.useState(null),[F,R]=u.useState(null),[z,W]=u.useState(null),[H,U]=u.useState(null),oe=u.useRef(null);return u.useEffect(()=>{x!==null&&(x.close(),r?x.open(_,r):x.getPosition()&&x.open(_))},[_,x,r]),u.useEffect(()=>{i&&x!==null&&x.setOptions(i)},[x,i]),u.useEffect(()=>{a&&x!==null&&x.setPosition(a)},[a]),u.useEffect(()=>{typeof f=="number"&&x!==null&&x.setZIndex(f)},[f]),u.useEffect(()=>{x&&p&&(B!==null&&google.maps.event.removeListener(B),Z(google.maps.event.addListener(x,"closeclick",p)))},[p]),u.useEffect(()=>{x&&h&&(q!==null&&google.maps.event.removeListener(q),X(google.maps.event.addListener(x,"domready",h)))},[h]),u.useEffect(()=>{x&&m&&(F!==null&&google.maps.event.removeListener(F),R(google.maps.event.addListener(x,"content_changed",m)))},[m]),u.useEffect(()=>{x&&b&&(z!==null&&google.maps.event.removeListener(z),W(google.maps.event.addListener(x,"position_changed",b)))},[b]),u.useEffect(()=>{x&&y&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(x,"zindex_changed",y)))},[y]),u.useEffect(()=>{var ee=new google.maps.InfoWindow(i);return A(ee),oe.current=document.createElement("div"),p&&Z(google.maps.event.addListener(ee,"closeclick",p)),h&&X(google.maps.event.addListener(ee,"domready",h)),m&&R(google.maps.event.addListener(ee,"content_changed",m)),b&&W(google.maps.event.addListener(ee,"position_changed",b)),y&&U(google.maps.event.addListener(ee,"zindex_changed",y)),ee.setContent(oe.current),a&&ee.setPosition(a),f&&ee.setZIndex(f),r?ee.open(_,r):ee.getPosition()?ee.open(_):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),w&&w(ee),()=>{B&&google.maps.event.removeListener(B),F&&google.maps.event.removeListener(F),q&&google.maps.event.removeListener(q),z&&google.maps.event.removeListener(z),H&&google.maps.event.removeListener(H),C&&C(ee),ee.close()}},[]),oe.current?Ln.createPortal(u.Children.only(e),oe.current):null}u.memo(eu);class tu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"containerElement",null),K(this,"state",{infoWindow:null}),K(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),K(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(je(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(u.Children.only(this.props.children),this.containerElement):null}}K(tu,"contextType",Me);function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ho={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Go={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},nu={};function ru(t){var{options:e,draggable:r,editable:i,visible:a,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:b,onMouseMove:y,onMouseOut:w,onMouseOver:C,onMouseUp:_,onRightClick:x,onClick:A,onDrag:B,onLoad:Z,onUnmount:q}=t,X=u.useContext(Me),[F,R]=u.useState(null),[z,W]=u.useState(null),[H,U]=u.useState(null),[oe,ee]=u.useState(null),[ne,ue]=u.useState(null),[se,fe]=u.useState(null),[me,be]=u.useState(null),[de,we]=u.useState(null),[ve,Le]=u.useState(null),[Se,ge]=u.useState(null),[De,$]=u.useState(null),[Te,ze]=u.useState(null);return u.useEffect(()=>{F!==null&&F.setMap(X)},[X]),u.useEffect(()=>{typeof e<"u"&&F!==null&&F.setOptions(e)},[F,e]),u.useEffect(()=>{typeof r<"u"&&F!==null&&F.setDraggable(r)},[F,r]),u.useEffect(()=>{typeof i<"u"&&F!==null&&F.setEditable(i)},[F,i]),u.useEffect(()=>{typeof a<"u"&&F!==null&&F.setVisible(a)},[F,a]),u.useEffect(()=>{typeof f<"u"&&F!==null&&F.setPath(f)},[F,f]),u.useEffect(()=>{F&&p&&(z!==null&&google.maps.event.removeListener(z),W(google.maps.event.addListener(F,"dblclick",p)))},[p]),u.useEffect(()=>{F&&h&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(F,"dragend",h)))},[h]),u.useEffect(()=>{F&&m&&(oe!==null&&google.maps.event.removeListener(oe),ee(google.maps.event.addListener(F,"dragstart",m)))},[m]),u.useEffect(()=>{F&&b&&(ne!==null&&google.maps.event.removeListener(ne),ue(google.maps.event.addListener(F,"mousedown",b)))},[b]),u.useEffect(()=>{F&&y&&(se!==null&&google.maps.event.removeListener(se),fe(google.maps.event.addListener(F,"mousemove",y)))},[y]),u.useEffect(()=>{F&&w&&(me!==null&&google.maps.event.removeListener(me),be(google.maps.event.addListener(F,"mouseout",w)))},[w]),u.useEffect(()=>{F&&C&&(de!==null&&google.maps.event.removeListener(de),we(google.maps.event.addListener(F,"mouseover",C)))},[C]),u.useEffect(()=>{F&&_&&(ve!==null&&google.maps.event.removeListener(ve),Le(google.maps.event.addListener(F,"mouseup",_)))},[_]),u.useEffect(()=>{F&&x&&(Se!==null&&google.maps.event.removeListener(Se),ge(google.maps.event.addListener(F,"rightclick",x)))},[x]),u.useEffect(()=>{F&&A&&(De!==null&&google.maps.event.removeListener(De),$(google.maps.event.addListener(F,"click",A)))},[A]),u.useEffect(()=>{F&&B&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(F,"drag",B)))},[B]),u.useEffect(()=>{var G=new google.maps.Polyline(kr(kr({},e||nu),{},{map:X}));return f&&G.setPath(f),typeof a<"u"&&G.setVisible(a),typeof i<"u"&&G.setEditable(i),typeof r<"u"&&G.setDraggable(r),p&&W(google.maps.event.addListener(G,"dblclick",p)),h&&U(google.maps.event.addListener(G,"dragend",h)),m&&ee(google.maps.event.addListener(G,"dragstart",m)),b&&ue(google.maps.event.addListener(G,"mousedown",b)),y&&fe(google.maps.event.addListener(G,"mousemove",y)),w&&be(google.maps.event.addListener(G,"mouseout",w)),C&&we(google.maps.event.addListener(G,"mouseover",C)),_&&Le(google.maps.event.addListener(G,"mouseup",_)),x&&ge(google.maps.event.addListener(G,"rightclick",x)),A&&$(google.maps.event.addListener(G,"click",A)),B&&ze(google.maps.event.addListener(G,"drag",B)),R(G),Z&&Z(G),()=>{z!==null&&google.maps.event.removeListener(z),H!==null&&google.maps.event.removeListener(H),oe!==null&&google.maps.event.removeListener(oe),ne!==null&&google.maps.event.removeListener(ne),se!==null&&google.maps.event.removeListener(se),me!==null&&google.maps.event.removeListener(me),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),Se!==null&&google.maps.event.removeListener(Se),De!==null&&google.maps.event.removeListener(De),q&&q(G),G.setMap(null)}},[]),null}u.memo(ru);class iu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{polyline:null}),K(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(kr(kr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),je(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}K(iu,"contextType",Me);function Yo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Xo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Jo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Qo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function ou(t){var{options:e,draggable:r,editable:i,visible:a,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:b,onMouseDown:y,onMouseMove:w,onMouseOut:C,onMouseOver:_,onMouseUp:x,onRightClick:A,onClick:B,onDrag:Z,onLoad:q,onUnmount:X,onEdit:F}=t,R=u.useContext(Me),[z,W]=u.useState(null),[H,U]=u.useState(null),[oe,ee]=u.useState(null),[ne,ue]=u.useState(null),[se,fe]=u.useState(null),[me,be]=u.useState(null),[de,we]=u.useState(null),[ve,Le]=u.useState(null),[Se,ge]=u.useState(null),[De,$]=u.useState(null),[Te,ze]=u.useState(null),[G,Y]=u.useState(null);return u.useEffect(()=>{z!==null&&z.setMap(R)},[R]),u.useEffect(()=>{typeof e<"u"&&z!==null&&z.setOptions(e)},[z,e]),u.useEffect(()=>{typeof r<"u"&&z!==null&&z.setDraggable(r)},[z,r]),u.useEffect(()=>{typeof i<"u"&&z!==null&&z.setEditable(i)},[z,i]),u.useEffect(()=>{typeof a<"u"&&z!==null&&z.setVisible(a)},[z,a]),u.useEffect(()=>{typeof f<"u"&&z!==null&&z.setPath(f)},[z,f]),u.useEffect(()=>{typeof p<"u"&&z!==null&&z.setPaths(p)},[z,p]),u.useEffect(()=>{z&&typeof h=="function"&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(z,"dblclick",h)))},[h]),u.useEffect(()=>{z&&(google.maps.event.addListener(z.getPath(),"insert_at",()=>{F?.(z)}),google.maps.event.addListener(z.getPath(),"set_at",()=>{F?.(z)}),google.maps.event.addListener(z.getPath(),"remove_at",()=>{F?.(z)}))},[z,F]),u.useEffect(()=>{z&&typeof m=="function"&&(oe!==null&&google.maps.event.removeListener(oe),ee(google.maps.event.addListener(z,"dragend",m)))},[m]),u.useEffect(()=>{z&&typeof b=="function"&&(ne!==null&&google.maps.event.removeListener(ne),ue(google.maps.event.addListener(z,"dragstart",b)))},[b]),u.useEffect(()=>{z&&typeof y=="function"&&(se!==null&&google.maps.event.removeListener(se),fe(google.maps.event.addListener(z,"mousedown",y)))},[y]),u.useEffect(()=>{z&&typeof w=="function"&&(me!==null&&google.maps.event.removeListener(me),be(google.maps.event.addListener(z,"mousemove",w)))},[w]),u.useEffect(()=>{z&&typeof C=="function"&&(de!==null&&google.maps.event.removeListener(de),we(google.maps.event.addListener(z,"mouseout",C)))},[C]),u.useEffect(()=>{z&&typeof _=="function"&&(ve!==null&&google.maps.event.removeListener(ve),Le(google.maps.event.addListener(z,"mouseover",_)))},[_]),u.useEffect(()=>{z&&typeof x=="function"&&(Se!==null&&google.maps.event.removeListener(Se),ge(google.maps.event.addListener(z,"mouseup",x)))},[x]),u.useEffect(()=>{z&&typeof A=="function"&&(De!==null&&google.maps.event.removeListener(De),$(google.maps.event.addListener(z,"rightclick",A)))},[A]),u.useEffect(()=>{z&&typeof B=="function"&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(z,"click",B)))},[B]),u.useEffect(()=>{z&&typeof Z=="function"&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(z,"drag",Z)))},[Z]),u.useEffect(()=>{var ye=new google.maps.Polygon(Xo(Xo({},e),{},{map:R}));return f&&ye.setPath(f),p&&ye.setPaths(p),typeof a<"u"&&ye.setVisible(a),typeof i<"u"&&ye.setEditable(i),typeof r<"u"&&ye.setDraggable(r),h&&U(google.maps.event.addListener(ye,"dblclick",h)),m&&ee(google.maps.event.addListener(ye,"dragend",m)),b&&ue(google.maps.event.addListener(ye,"dragstart",b)),y&&fe(google.maps.event.addListener(ye,"mousedown",y)),w&&be(google.maps.event.addListener(ye,"mousemove",w)),C&&we(google.maps.event.addListener(ye,"mouseout",C)),_&&Le(google.maps.event.addListener(ye,"mouseover",_)),x&&ge(google.maps.event.addListener(ye,"mouseup",x)),A&&$(google.maps.event.addListener(ye,"rightclick",A)),B&&ze(google.maps.event.addListener(ye,"click",B)),Z&&Y(google.maps.event.addListener(ye,"drag",Z)),W(ye),q&&q(ye),()=>{H!==null&&google.maps.event.removeListener(H),oe!==null&&google.maps.event.removeListener(oe),ne!==null&&google.maps.event.removeListener(ne),se!==null&&google.maps.event.removeListener(se),me!==null&&google.maps.event.removeListener(me),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),Se!==null&&google.maps.event.removeListener(Se),De!==null&&google.maps.event.removeListener(De),Te!==null&&google.maps.event.removeListener(Te),X&&X(ye),ye.setMap(null)}},[]),null}u.memo(ou);class su extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),je(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}K(su,"contextType",Me);function es(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?es(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ts={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ns={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function au(t){var{options:e,bounds:r,draggable:i,editable:a,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:b,onMouseMove:y,onMouseOut:w,onMouseOver:C,onMouseUp:_,onRightClick:x,onClick:A,onDrag:B,onBoundsChanged:Z,onLoad:q,onUnmount:X}=t,F=u.useContext(Me),[R,z]=u.useState(null),[W,H]=u.useState(null),[U,oe]=u.useState(null),[ee,ne]=u.useState(null),[ue,se]=u.useState(null),[fe,me]=u.useState(null),[be,de]=u.useState(null),[we,ve]=u.useState(null),[Le,Se]=u.useState(null),[ge,De]=u.useState(null),[$,Te]=u.useState(null),[ze,G]=u.useState(null),[Y,ye]=u.useState(null);return u.useEffect(()=>{R!==null&&R.setMap(F)},[F]),u.useEffect(()=>{typeof e<"u"&&R!==null&&R.setOptions(e)},[R,e]),u.useEffect(()=>{typeof i<"u"&&R!==null&&R.setDraggable(i)},[R,i]),u.useEffect(()=>{typeof a<"u"&&R!==null&&R.setEditable(a)},[R,a]),u.useEffect(()=>{typeof f<"u"&&R!==null&&R.setVisible(f)},[R,f]),u.useEffect(()=>{typeof r<"u"&&R!==null&&R.setBounds(r)},[R,r]),u.useEffect(()=>{R&&p&&(W!==null&&google.maps.event.removeListener(W),H(google.maps.event.addListener(R,"dblclick",p)))},[p]),u.useEffect(()=>{R&&h&&(U!==null&&google.maps.event.removeListener(U),oe(google.maps.event.addListener(R,"dragend",h)))},[h]),u.useEffect(()=>{R&&m&&(ee!==null&&google.maps.event.removeListener(ee),ne(google.maps.event.addListener(R,"dragstart",m)))},[m]),u.useEffect(()=>{R&&b&&(ue!==null&&google.maps.event.removeListener(ue),se(google.maps.event.addListener(R,"mousedown",b)))},[b]),u.useEffect(()=>{R&&y&&(fe!==null&&google.maps.event.removeListener(fe),me(google.maps.event.addListener(R,"mousemove",y)))},[y]),u.useEffect(()=>{R&&w&&(be!==null&&google.maps.event.removeListener(be),de(google.maps.event.addListener(R,"mouseout",w)))},[w]),u.useEffect(()=>{R&&C&&(we!==null&&google.maps.event.removeListener(we),ve(google.maps.event.addListener(R,"mouseover",C)))},[C]),u.useEffect(()=>{R&&_&&(Le!==null&&google.maps.event.removeListener(Le),Se(google.maps.event.addListener(R,"mouseup",_)))},[_]),u.useEffect(()=>{R&&x&&(ge!==null&&google.maps.event.removeListener(ge),De(google.maps.event.addListener(R,"rightclick",x)))},[x]),u.useEffect(()=>{R&&A&&($!==null&&google.maps.event.removeListener($),Te(google.maps.event.addListener(R,"click",A)))},[A]),u.useEffect(()=>{R&&B&&(ze!==null&&google.maps.event.removeListener(ze),G(google.maps.event.addListener(R,"drag",B)))},[B]),u.useEffect(()=>{R&&Z&&(Y!==null&&google.maps.event.removeListener(Y),ye(google.maps.event.addListener(R,"bounds_changed",Z)))},[Z]),u.useEffect(()=>{var Ie=new google.maps.Rectangle(Pr(Pr({},e),{},{map:F}));return typeof f<"u"&&Ie.setVisible(f),typeof a<"u"&&Ie.setEditable(a),typeof i<"u"&&Ie.setDraggable(i),typeof r<"u"&&Ie.setBounds(r),p&&H(google.maps.event.addListener(Ie,"dblclick",p)),h&&oe(google.maps.event.addListener(Ie,"dragend",h)),m&&ne(google.maps.event.addListener(Ie,"dragstart",m)),b&&se(google.maps.event.addListener(Ie,"mousedown",b)),y&&me(google.maps.event.addListener(Ie,"mousemove",y)),w&&de(google.maps.event.addListener(Ie,"mouseout",w)),C&&ve(google.maps.event.addListener(Ie,"mouseover",C)),_&&Se(google.maps.event.addListener(Ie,"mouseup",_)),x&&De(google.maps.event.addListener(Ie,"rightclick",x)),A&&Te(google.maps.event.addListener(Ie,"click",A)),B&&G(google.maps.event.addListener(Ie,"drag",B)),Z&&ye(google.maps.event.addListener(Ie,"bounds_changed",Z)),z(Ie),q&&q(Ie),()=>{W!==null&&google.maps.event.removeListener(W),U!==null&&google.maps.event.removeListener(U),ee!==null&&google.maps.event.removeListener(ee),ue!==null&&google.maps.event.removeListener(ue),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),we!==null&&google.maps.event.removeListener(we),Le!==null&&google.maps.event.removeListener(Le),ge!==null&&google.maps.event.removeListener(ge),$!==null&&google.maps.event.removeListener($),ze!==null&&google.maps.event.removeListener(ze),Y!==null&&google.maps.event.removeListener(Y),X&&X(Ie),Ie.setMap(null)}},[]),null}u.memo(au);class lu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{rectangle:null}),K(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),je(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}K(lu,"contextType",Me);function rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var is={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},os={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},uu={};function cu(t){var{options:e,center:r,radius:i,draggable:a,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:b,onMouseDown:y,onMouseMove:w,onMouseOut:C,onMouseOver:_,onMouseUp:x,onRightClick:A,onClick:B,onDrag:Z,onCenterChanged:q,onRadiusChanged:X,onLoad:F,onUnmount:R}=t,z=u.useContext(Me),[W,H]=u.useState(null),[U,oe]=u.useState(null),[ee,ne]=u.useState(null),[ue,se]=u.useState(null),[fe,me]=u.useState(null),[be,de]=u.useState(null),[we,ve]=u.useState(null),[Le,Se]=u.useState(null),[ge,De]=u.useState(null),[$,Te]=u.useState(null),[ze,G]=u.useState(null),[Y,ye]=u.useState(null),[Ie,ke]=u.useState(null),[Xe,qt]=u.useState(null);return u.useEffect(()=>{W!==null&&W.setMap(z)},[z]),u.useEffect(()=>{typeof e<"u"&&W!==null&&W.setOptions(e)},[W,e]),u.useEffect(()=>{typeof a<"u"&&W!==null&&W.setDraggable(a)},[W,a]),u.useEffect(()=>{typeof f<"u"&&W!==null&&W.setEditable(f)},[W,f]),u.useEffect(()=>{typeof p<"u"&&W!==null&&W.setVisible(p)},[W,p]),u.useEffect(()=>{typeof i=="number"&&W!==null&&W.setRadius(i)},[W,i]),u.useEffect(()=>{typeof r<"u"&&W!==null&&W.setCenter(r)},[W,r]),u.useEffect(()=>{W&&h&&(U!==null&&google.maps.event.removeListener(U),oe(google.maps.event.addListener(W,"dblclick",h)))},[h]),u.useEffect(()=>{W&&m&&(ee!==null&&google.maps.event.removeListener(ee),ne(google.maps.event.addListener(W,"dragend",m)))},[m]),u.useEffect(()=>{W&&b&&(ue!==null&&google.maps.event.removeListener(ue),se(google.maps.event.addListener(W,"dragstart",b)))},[b]),u.useEffect(()=>{W&&y&&(fe!==null&&google.maps.event.removeListener(fe),me(google.maps.event.addListener(W,"mousedown",y)))},[y]),u.useEffect(()=>{W&&w&&(be!==null&&google.maps.event.removeListener(be),de(google.maps.event.addListener(W,"mousemove",w)))},[w]),u.useEffect(()=>{W&&C&&(we!==null&&google.maps.event.removeListener(we),ve(google.maps.event.addListener(W,"mouseout",C)))},[C]),u.useEffect(()=>{W&&_&&(Le!==null&&google.maps.event.removeListener(Le),Se(google.maps.event.addListener(W,"mouseover",_)))},[_]),u.useEffect(()=>{W&&x&&(ge!==null&&google.maps.event.removeListener(ge),De(google.maps.event.addListener(W,"mouseup",x)))},[x]),u.useEffect(()=>{W&&A&&($!==null&&google.maps.event.removeListener($),Te(google.maps.event.addListener(W,"rightclick",A)))},[A]),u.useEffect(()=>{W&&B&&(ze!==null&&google.maps.event.removeListener(ze),G(google.maps.event.addListener(W,"click",B)))},[B]),u.useEffect(()=>{W&&Z&&(Y!==null&&google.maps.event.removeListener(Y),ye(google.maps.event.addListener(W,"drag",Z)))},[Z]),u.useEffect(()=>{W&&q&&(Ie!==null&&google.maps.event.removeListener(Ie),ke(google.maps.event.addListener(W,"center_changed",q)))},[B]),u.useEffect(()=>{W&&X&&(Xe!==null&&google.maps.event.removeListener(Xe),qt(google.maps.event.addListener(W,"radius_changed",X)))},[X]),u.useEffect(()=>{var Re=new google.maps.Circle(Or(Or({},e||uu),{},{map:z}));return typeof i=="number"&&Re.setRadius(i),typeof r<"u"&&Re.setCenter(r),typeof i=="number"&&Re.setRadius(i),typeof p<"u"&&Re.setVisible(p),typeof f<"u"&&Re.setEditable(f),typeof a<"u"&&Re.setDraggable(a),h&&oe(google.maps.event.addListener(Re,"dblclick",h)),m&&ne(google.maps.event.addListener(Re,"dragend",m)),b&&se(google.maps.event.addListener(Re,"dragstart",b)),y&&me(google.maps.event.addListener(Re,"mousedown",y)),w&&de(google.maps.event.addListener(Re,"mousemove",w)),C&&ve(google.maps.event.addListener(Re,"mouseout",C)),_&&Se(google.maps.event.addListener(Re,"mouseover",_)),x&&De(google.maps.event.addListener(Re,"mouseup",x)),A&&Te(google.maps.event.addListener(Re,"rightclick",A)),B&&G(google.maps.event.addListener(Re,"click",B)),Z&&ye(google.maps.event.addListener(Re,"drag",Z)),q&&ke(google.maps.event.addListener(Re,"center_changed",q)),X&&qt(google.maps.event.addListener(Re,"radius_changed",X)),H(Re),F&&F(Re),()=>{U!==null&&google.maps.event.removeListener(U),ee!==null&&google.maps.event.removeListener(ee),ue!==null&&google.maps.event.removeListener(ue),fe!==null&&google.maps.event.removeListener(fe),be!==null&&google.maps.event.removeListener(be),we!==null&&google.maps.event.removeListener(we),Le!==null&&google.maps.event.removeListener(Le),ge!==null&&google.maps.event.removeListener(ge),$!==null&&google.maps.event.removeListener($),ze!==null&&google.maps.event.removeListener(ze),Ie!==null&&google.maps.event.removeListener(Ie),Xe!==null&&google.maps.event.removeListener(Xe),R&&R(Re),Re.setMap(null)}},[]),null}u.memo(cu);class fu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{circle:null}),K(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),je(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}K(fu,"contextType",Me);function ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var as={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ls={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,i){t.loadGeoJson(e,r,i)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function du(t){var{options:e,onClick:r,onDblClick:i,onMouseDown:a,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:b,onAddFeature:y,onRemoveFeature:w,onRemoveProperty:C,onSetGeometry:_,onSetProperty:x,onLoad:A,onUnmount:B}=t,Z=u.useContext(Me),[q,X]=u.useState(null),[F,R]=u.useState(null),[z,W]=u.useState(null),[H,U]=u.useState(null),[oe,ee]=u.useState(null),[ne,ue]=u.useState(null),[se,fe]=u.useState(null),[me,be]=u.useState(null),[de,we]=u.useState(null),[ve,Le]=u.useState(null),[Se,ge]=u.useState(null),[De,$]=u.useState(null),[Te,ze]=u.useState(null),[G,Y]=u.useState(null);return u.useEffect(()=>{q!==null&&q.setMap(Z)},[Z]),u.useEffect(()=>{q&&i&&(F!==null&&google.maps.event.removeListener(F),R(google.maps.event.addListener(q,"dblclick",i)))},[i]),u.useEffect(()=>{q&&a&&(z!==null&&google.maps.event.removeListener(z),W(google.maps.event.addListener(q,"mousedown",a)))},[a]),u.useEffect(()=>{q&&f&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(q,"mousemove",f)))},[f]),u.useEffect(()=>{q&&p&&(oe!==null&&google.maps.event.removeListener(oe),ee(google.maps.event.addListener(q,"mouseout",p)))},[p]),u.useEffect(()=>{q&&h&&(ne!==null&&google.maps.event.removeListener(ne),ue(google.maps.event.addListener(q,"mouseover",h)))},[h]),u.useEffect(()=>{q&&m&&(se!==null&&google.maps.event.removeListener(se),fe(google.maps.event.addListener(q,"mouseup",m)))},[m]),u.useEffect(()=>{q&&b&&(me!==null&&google.maps.event.removeListener(me),be(google.maps.event.addListener(q,"rightclick",b)))},[b]),u.useEffect(()=>{q&&r&&(de!==null&&google.maps.event.removeListener(de),we(google.maps.event.addListener(q,"click",r)))},[r]),u.useEffect(()=>{q&&y&&(ve!==null&&google.maps.event.removeListener(ve),Le(google.maps.event.addListener(q,"addfeature",y)))},[y]),u.useEffect(()=>{q&&w&&(Se!==null&&google.maps.event.removeListener(Se),ge(google.maps.event.addListener(q,"removefeature",w)))},[w]),u.useEffect(()=>{q&&C&&(De!==null&&google.maps.event.removeListener(De),$(google.maps.event.addListener(q,"removeproperty",C)))},[C]),u.useEffect(()=>{q&&_&&(Te!==null&&google.maps.event.removeListener(Te),ze(google.maps.event.addListener(q,"setgeometry",_)))},[_]),u.useEffect(()=>{q&&x&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(q,"setproperty",x)))},[x]),u.useEffect(()=>{if(Z!==null){var ye=new google.maps.Data(_r(_r({},e),{},{map:Z}));i&&R(google.maps.event.addListener(ye,"dblclick",i)),a&&W(google.maps.event.addListener(ye,"mousedown",a)),f&&U(google.maps.event.addListener(ye,"mousemove",f)),p&&ee(google.maps.event.addListener(ye,"mouseout",p)),h&&ue(google.maps.event.addListener(ye,"mouseover",h)),m&&fe(google.maps.event.addListener(ye,"mouseup",m)),b&&be(google.maps.event.addListener(ye,"rightclick",b)),r&&we(google.maps.event.addListener(ye,"click",r)),y&&Le(google.maps.event.addListener(ye,"addfeature",y)),w&&ge(google.maps.event.addListener(ye,"removefeature",w)),C&&$(google.maps.event.addListener(ye,"removeproperty",C)),_&&ze(google.maps.event.addListener(ye,"setgeometry",_)),x&&Y(google.maps.event.addListener(ye,"setproperty",x)),X(ye),A&&A(ye)}return()=>{q&&(F!==null&&google.maps.event.removeListener(F),z!==null&&google.maps.event.removeListener(z),H!==null&&google.maps.event.removeListener(H),oe!==null&&google.maps.event.removeListener(oe),ne!==null&&google.maps.event.removeListener(ne),se!==null&&google.maps.event.removeListener(se),me!==null&&google.maps.event.removeListener(me),de!==null&&google.maps.event.removeListener(de),ve!==null&&google.maps.event.removeListener(ve),Se!==null&&google.maps.event.removeListener(Se),De!==null&&google.maps.event.removeListener(De),Te!==null&&google.maps.event.removeListener(Te),G!==null&&google.maps.event.removeListener(G),B&&B(q),q.setMap(null))}},[]),null}u.memo(du);class pu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{data:null}),K(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),je(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}K(pu,"contextType",Me);function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function cs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var fs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},ds={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class hu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{kmlLayer:null}),K(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(cs(cs({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),je(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}K(hu,"contextType",Me);function ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function gu(t,e){return new e(t.lat,t.lng)}function mu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){return t instanceof e?t:r(t,e)}function bu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r.getNorthEast()),a=t&&t.fromLatLngToDivPixel(r.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function wu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r);if(i){var{x:a,y:f}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function na(t,e,r,i){return r!==void 0?bu(t,e,yu(r,google.maps.LatLngBounds,mu)):wu(t,e,vu(i,google.maps.LatLng,gu))}function Lu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Cu(t,e,r,i,a){class f extends google.maps.OverlayView{constructor(h,m,b,y){super(),this.container=h,this.pane=m,this.position=b,this.bounds=y}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=xu({},this.container?ta(this.container,a):{x:0,y:0}),b=na(h,m,this.bounds,this.position);for(var[y,w]of Object.entries(b))this.container.style[y]=w}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,i)}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Eu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function ms(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Su(t){var{position:e,bounds:r,mapPaneName:i,zIndex:a,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,b=u.useContext(Me),y=u.useMemo(()=>{var C=document.createElement("div");return C.style.position="absolute",C},[]),w=u.useMemo(()=>Cu(y,i,e,r,h),[y,i,e,r]);return u.useEffect(()=>(f?.(w),w?.setMap(b),()=>{p?.(w),w?.setMap(null)}),[b,w]),u.useEffect(()=>{y.style.zIndex="".concat(a)},[a,y]),Ln.createPortal(m,y)}u.memo(Su);class Lt extends u.PureComponent{constructor(e){super(e),K(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),K(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();We(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),K(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),K(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=Eu({x:0,y:0},this.containerRef.current?ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=na(i,a,this.props.bounds,this.props.position);if(!Lu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,b;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(b=f.height)!==null&&b!==void 0?b:0,position:"absolute"}})}}),K(this,"draw",()=>{this.onPositionElement()}),K(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=u.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=gs(e.position),i=gs(this.props.position),a=ms(e.bounds),f=ms(this.props.bounds);(r!==i||a!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(ie.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:u.Children.only(this.props.children)}),e):null}}K(Lt,"FLOAT_PANE","floatPane");K(Lt,"MAP_PANE","mapPane");K(Lt,"MARKER_LAYER","markerLayer");K(Lt,"OVERLAY_LAYER","overlayLayer");K(Lt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");K(Lt,"contextType",Me);function Mu(){}function vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var bs={onDblClick:"dblclick",onClick:"click"},ws={opacity(t,e){t.setOpacity(e)}};function ku(t){var{url:e,bounds:r,options:i,visible:a}=t,f=u.useContext(Me),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=u.useMemo(()=>new google.maps.GroundOverlay(e,p,i),[]);return u.useEffect(()=>{h!==null&&h.setMap(f)},[f]),u.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),u.useEffect(()=>{typeof a<"u"&&h!==null&&h.setOpacity(a?1:0)},[h,a]),u.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}u.memo(ku);class ra extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{groundOverlay:null}),K(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){We(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ys(ys({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}K(ra,"defaultProps",{onLoad:Mu});K(ra,"contextType",Me);function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(i){K(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var xs={},Cs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Pu(t){var{data:e,onLoad:r,onUnmount:i,options:a}=t,f=u.useContext(Me),[p,h]=u.useState(null);return u.useEffect(()=>{google.maps.visualization||We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),u.useEffect(()=>{We(!!e,"data property is required in HeatmapLayer %s",e)},[e]),u.useEffect(()=>{p!==null&&p.setMap(f)},[f]),u.useEffect(()=>{a&&p!==null&&p.setOptions(a)},[p,a]),u.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Dr(Dr({},a),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(i&&i(p),p.setMap(null))}},[]),null}u.memo(Pu);class Ou extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{heatmapLayer:null}),K(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),We(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Dr(Dr({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),je(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}K(Ou,"contextType",Me);var Es={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Ss={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{streetViewPanorama:null}),K(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,i=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=_e({updaterMap:Ss,eventMap:Es,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ss,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),je(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}K(_u,"contextType",Me);class Du extends u.PureComponent{constructor(){super(...arguments),K(this,"state",{streetViewService:null}),K(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}K(Du,"contextType",Me);var Ms={onDirectionsChanged:"directions_changed"},ks={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Iu extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"state",{directionsRenderer:null}),K(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=_e({updaterMap:ks,eventMap:Ms,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:ks,eventMap:Ms,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),je(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}K(Iu,"contextType",Me);var Ps={onPlacesChanged:"places_changed"},Os={bounds(t,e){t.setBounds(e)}};class ju extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"containerElement",u.createRef()),K(this,"state",{searchBox:null}),K(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),je(this.registeredEvents))}render(){return ie.jsx("div",{ref:this.containerElement,children:u.Children.only(this.props.children)})}}K(ju,"contextType",Me);var _s={onPlaceChanged:"place_changed"},Ds={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ia extends u.PureComponent{constructor(){super(...arguments),K(this,"registeredEvents",[]),K(this,"containerElement",u.createRef()),K(this,"state",{autocomplete:null}),K(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var i=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){je(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&je(this.registeredEvents)}render(){return ie.jsx("div",{ref:this.containerElement,className:this.props.className,children:u.Children.only(this.props.children)})}}K(ia,"defaultProps",{className:""});K(ia,"contextType",Me);const ut=5e-4,Ru=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const i=e.createImageData(r,r),a=i.data;for(let f=0;f<a.length;f+=4){const p=Math.random()*100;a[f]=p,a[f+1]=p,a[f+2]=p,a[f+3]=5}return e.putImageData(i,0,0),e.createPattern(t,"repeat")},Au=({map:t,zoom:e,claimedCells:r,exploredCells:i,hoveredCell:a,isAnimating:f,selectedCell:p,effects:h})=>{const m=u.useRef(null),b=u.useRef(null),[y,w]=u.useState({claimed:[],explored:[]}),C=u.useRef(),_=u.useRef(null),x=u.useRef(null);return u.useEffect(()=>{b.current&&b.current.postMessage({type:"DATA_UPDATED"})},[r,i]),u.useEffect(()=>{if(!t)return;class A extends window.google.maps.OverlayView{constructor(H,U){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.noisePattern=H,this.hoveredCellRef=U,this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.effectsCanvas=document.createElement("canvas"),this.effectsCtx=this.effectsCanvas.getContext("2d"),this.effectsCanvas.style.position="absolute",this.effectsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none"}setProps(H){this.props={...this.props,...H}}setDrawableCells(H,U){this.drawableClaimed=H,this.drawableExplored=U}onAdd(){const H=this.getPanes();H.overlayLayer.appendChild(this.fogCanvas),H.overlayMouseTarget.appendChild(this.effectsCanvas),H.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(H=>{H.parentElement&&H.parentElement.removeChild(H)})}draw(){const H=this.getProjection();if(!H)return;const U=.5,oe=this.getMap().getBounds(),ee=oe.getSouthWest(),ne=oe.getNorthEast(),ue=H.fromLatLngToDivPixel(ee),se=H.fromLatLngToDivPixel(ne);if(!ue||!se)return;const fe=se.x-ue.x,me=ue.y-se.y,be=Math.round(fe*U),de=Math.round(me*U),we=fe+2*be,ve=me+2*de;this.swPixel={x:ue.x-be,y:ue.y+de},this.nePixel={x:se.x+be,y:se.y-de},[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(Le=>{Le.style.left=`${ue.x-be}px`,Le.style.top=`${se.y-de}px`,Le.width=we,Le.height=ve}),this.drawFog(),this.drawDynamic()}drawFog(){!this.swPixel||this.props.isAnimating||(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.noisePattern&&(this.fogCtx.fillStyle=this.noisePattern,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(H=>this.drawStaticReveal(H)),this.fogCtx.globalCompositeOperation="source-over")}drawStaticReveal(H){const U=this.getProjection();if(!U||!this.swPixel)return;const{south:oe,west:ee}=H,ne=new window.google.maps.LatLng(oe,ee),ue=new window.google.maps.LatLng(oe+ut,ee+ut),se=U.fromLatLngToDivPixel(ne),fe=U.fromLatLngToDivPixel(ue);if(!se||!fe)return;const me=se.x-this.swPixel.x,be=fe.y-this.nePixel.y,de=fe.x-se.x,we=se.y-fe.y;if(this.props.zoom<14)this.fogCtx.fillStyle="rgba(0, 0, 0, 1)",this.fogCtx.fillRect(me,be,de,we);else{const ve=me+de/2,Le=be+we/2,Se=de*2.5,ge=we*2.5,De=this.fogCtx.createRadialGradient(ve,Le,0,ve,Le,Math.max(Se,ge));De.addColorStop(0,"rgba(0, 0, 0, 1)"),De.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=De,this.fogCtx.beginPath(),this.fogCtx.ellipse(ve,Le,Se,ge,0,0,2*Math.PI),this.fogCtx.fill()}}drawRevealEffect(H,U,oe){const ee=new window.google.maps.LatLng(H.position.lat,H.position.lng),ne=oe.fromLatLngToDivPixel(ee);if(!ne||!this.swPixel)return;const ue=ne.x-this.swPixel.x,se=ne.y-this.nePixel.y,fe=new window.google.maps.LatLng(H.position.lat,H.position.lng),me=new window.google.maps.LatLng(H.position.lat+ut,H.position.lng+ut),be=oe.fromLatLngToDivPixel(fe),de=oe.fromLatLngToDivPixel(me);if(!be||!de)return;const Le=(de.x-be.x)*2.5*U,Se=this.fogCtx.createRadialGradient(ue,se,0,ue,se,Le);Se.addColorStop(0,"rgba(0, 0, 0, 1)"),Se.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.globalCompositeOperation="destination-out",this.fogCtx.fillStyle=Se,this.fogCtx.beginPath(),this.fogCtx.arc(ue,se,Le,0,2*Math.PI),this.fogCtx.fill(),this.fogCtx.globalCompositeOperation="source-over"}drawParticleEffect(H,U,oe){const ee=new window.google.maps.LatLng(H.position.lat,H.position.lng),ne=oe.fromLatLngToDivPixel(ee);if(!ne||!this.swPixel)return;const ue=ne.x-this.swPixel.x,se=ne.y-this.nePixel.y,me=80*(.1+1.4*U),be=.6*(1-U),de=this.effectsCtx.createRadialGradient(ue,se,0,ue,se,me);de.addColorStop(0,`rgba(255, 255, 255, ${be*.5})`),de.addColorStop(.5,`rgba(255, 255, 255, ${be*.5})`),de.addColorStop(1,"rgba(255, 255, 255, 0)"),this.effectsCtx.fillStyle=de,this.effectsCtx.filter="blur(20px)",this.effectsCtx.beginPath(),this.effectsCtx.arc(ue,se,me,0,2*Math.PI),this.effectsCtx.fill(),this.effectsCtx.filter="none"}clearEffects(){this.effectsCtx&&this.effectsCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)}drawClaimedCells(H){this.drawableClaimed.forEach(U=>{const{south:oe,west:ee}=U,ne=new window.google.maps.LatLng(oe,ee),ue=new window.google.maps.LatLng(oe+ut,ee+ut),se=H.fromLatLngToDivPixel(ne),fe=H.fromLatLngToDivPixel(ue);if(!se||!fe)return;const me=se.x-this.swPixel.x,be=fe.y-this.nePixel.y,de=fe.x-se.x,we=se.y-fe.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.2)",this.dynamicCtx.fillRect(me,be,de,we)})}drawDynamic(){if(this.props.isAnimating)return;const H=this.getProjection();if(!H||!this.swPixel)return;const{selectedCell:U}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height),this.drawClaimedCells(H);const oe=U?U.key:this.hoveredCellRef.current;if(!oe)return;const[ee,ne]=oe.split("_").map(Number),ue=ee*ut,se=ne*ut,fe=new window.google.maps.LatLng(ue,se),me=new window.google.maps.LatLng(ue+ut,se+ut),be=H.fromLatLngToDivPixel(fe),de=H.fromLatLngToDivPixel(me);if(!be||!de)return;const we=be.x-this.swPixel.x,ve=de.y-this.nePixel.y,Le=de.x-be.x,Se=be.y-de.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(we,ve,Le,Se)}}_.current=Ru();const B=new A(_.current,x);B.setMap(t),m.current=B;const Z=new Worker(new URL("/chill-demo/assets/grid.worker-I8HEKdUQ.js",import.meta.url),{type:"module"});b.current=Z,Z.onmessage=W=>{const{claimedCellsToDraw:H,exploredCellsToDraw:U}=W.data;w({claimed:H,explored:U})};const q=t.addListener("idle",()=>{if(b.current){const W=t.getBounds();W&&b.current.postMessage({type:"BOUNDS_CHANGED",payload:{bounds:{southwest:{lat:W.getSouthWest().lat(),lng:W.getSouthWest().lng()},northeast:{lat:W.getNorthEast().lat(),lng:W.getNorthEast().lng()}}}})}}),X=W=>{if(t.getZoom()<15){x.current&&(x.current=null);return}const H=`${Math.floor(W.latLng.lat()/ut)}_${Math.floor(W.latLng.lng()/ut)}`;H!==x.current&&(x.current=H)},F=()=>{x.current&&(x.current=null)},R=t.addListener("mousemove",X),z=t.addListener("mouseout",F);return()=>{Z.terminate(),B.setMap(null),q.remove(),R.remove(),z.remove(),C.current&&cancelAnimationFrame(C.current)}},[t]),u.useEffect(()=>{const A=m.current;if(!A)return;let B=null;const Z=()=>{x.current!==B&&(A.drawDynamic(),B=x.current),C.current=requestAnimationFrame(Z)};return C.current=requestAnimationFrame(Z),()=>{C.current&&cancelAnimationFrame(C.current)}},[]),u.useEffect(()=>{m.current&&(m.current.setDrawableCells(y.claimed,y.explored),m.current.drawFog())},[y]),u.useEffect(()=>{m.current&&(m.current.setProps({zoom:e,hoveredCell:a,isAnimating:f,selectedCell:p}),m.current.drawDynamic())},[e,a,f,p]),u.useEffect(()=>{const A=m.current;if(!A||h.length===0)return;const B=new Map,Z=()=>{const q=A.getProjection();if(!q||!A.swPixel){C.current=requestAnimationFrame(Z);return}A.effectsCtx.clearRect(0,0,A.effectsCanvas.width,A.effectsCanvas.height),A.drawFog();let X=!1;const F=Date.now();h.forEach(R=>{const z=F-R.startTime;z<R.particleDuration&&(X=!0,A.drawParticleEffect(R,z/R.particleDuration,q)),z<R.revealDuration&&(X=!0,A.drawRevealEffect(R,z/R.revealDuration,q)),z>=R.revealDuration&&!B.has(R.id)&&(R.onComplete?.(),B.set(R.id,!0))}),X?C.current=requestAnimationFrame(Z):A.drawFog()};return C.current=requestAnimationFrame(Z),()=>{C.current&&cancelAnimationFrame(C.current),A&&(A.clearEffects(),A.drawFog())}},[h]),null},Tu="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Is=new Audio(Tu),xi=()=>{Is.currentTime=0,Is.play().catch(t=>{console.error("Audio playback failed:",t)})},rt={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},Bu=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:i})=>{const{countryName:a,regionName:f,flagUrl:p,isLoading:h}=t,m=y=>{y.stopPropagation(),xi(),e()},b=y=>{y.stopPropagation(),xi(),r()};return ie.jsxs("div",{style:rt.container,onClick:y=>y.stopPropagation(),children:[ie.jsx("button",{style:rt.closeButton,onClick:b,children:""}),ie.jsx("div",{style:rt.header,children:h?ie.jsx("div",{style:rt.loader}):ie.jsxs(ie.Fragment,{children:[p&&ie.jsx("img",{src:p,alt:"Flag",style:rt.flag}),ie.jsxs("div",{style:rt.location,children:[ie.jsx("span",{style:rt.country,children:a}),ie.jsx("span",{style:rt.region,children:f}),ie.jsxs("span",{style:rt.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),ie.jsxs("div",{style:rt.body,children:[ie.jsx("p",{style:rt.text,children:"Do you want to claim this area?"}),ie.jsxs("button",{style:rt.claimButton,onClick:m,disabled:i,children:[ie.jsx("span",{style:rt.cloudIcon,children:""}),"Claim"]})]})]})},oa=u.memo(Bu),vi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},Uu=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,zu=()=>(Qt.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=Uu,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),Fu=({position:t})=>ie.jsxs(ie.Fragment,{children:[ie.jsx(zu,{}),ie.jsx(Lt,{position:t,mapPaneName:Lt.MARKER_LAYER,children:ie.jsxs("div",{style:vi.pulseContainer,children:[ie.jsx("div",{style:vi.pulse}),ie.jsx("div",{style:vi.dot})]})})]}),Ku=u.memo(Fu),Kt=(t,e,r,i=null,a=null)=>new Promise(f=>{a&&a(!0);const p=t.getCenter(),h=t.getZoom(),m=Date.now(),b=()=>{const y=Date.now(),w=Math.min((y-m)/r,1),C=w*w*(3-2*w),_={lat:p.lat()+(e.lat-p.lat())*C,lng:p.lng()+(e.lng-p.lng())*C},x=i!==null?h+(i-h)*C:h;t.moveCamera({center:_,zoom:x}),w<1?requestAnimationFrame(b):(a&&a(!1),f())};b()});let Un=null;function Nu(){return Un||(Un=new Promise((t,e)=>{const r=new Worker(new URL("/chill-demo/assets/data.worker-CHrZMG89.js",import.meta.url),{type:"module"});r.onmessage=i=>{i.data.success?t(i.data.users):(console.error("Error message from worker:",i.data.error),e(new Error(i.data.error))),r.terminate()},r.onerror=i=>{console.error("Error with worker:",i),e(new Error(`Worker error: ${i.message}`)),r.terminate(),Un=null},r.postMessage({csvPath:"/chill-demo/user_location.csv"})}),Un)}const qu=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=64;return t.width=r,t.height=r,e.fillStyle="#E0E0E0",e.beginPath(),e.arc(r/2,r/2,r/2,0,Math.PI*2),e.fill(),e.fillStyle="#A0A0A0",e.beginPath(),e.arc(r/2,r/2-8,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(r/2,r/2+15,15,Math.PI,Math.PI*2,!1),e.fill(),t},Wu=({user:t,onClose:e})=>{const r=(i,a)=>({x:-(i/2),y:-(a+40)});return ie.jsx(Lt,{position:{lat:t.lat,lng:t.lng},mapPaneName:Lt.FLOAT_PANE,getPixelPositionOffset:r,children:ie.jsxs("div",{onMouseDown:i=>i.stopPropagation(),style:{background:"white",padding:"10px 15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",width:"150px"},children:[ie.jsx("img",{src:t.avatarUrl||"/chill-demo/vite.svg",alt:t.name,style:{width:"50px",height:"50px",borderRadius:"50%"}}),ie.jsx("strong",{style:{fontSize:"14px"},children:t.name||"Anonymous"}),ie.jsx("button",{onClick:e,style:{position:"absolute",top:"8px",right:"8px",background:"#F0F0F0",border:"none",fontSize:"14px",cursor:"pointer",color:"#888",width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]})})},Zu=({map:t,users:e,isVisible:r})=>{const i=u.useRef(null),[a,f]=u.useState(null);return u.useEffect(()=>{if(!t)return;class p extends window.google.maps.OverlayView{constructor(){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="5",this.props={},this.mapDiv=null,this.hoveredUser=null,this.imageCache=new Map,this.defaultAvatar=qu(),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this)}setProps(b){this.props={...this.props,...b},this.draw()}onAdd(){this.getPanes().overlayLayer.appendChild(this.canvas),this.mapDiv=this.getMap().getDiv(),this.mapDiv.addEventListener("mousemove",this.handleMouseMove),this.mapDiv.addEventListener("click",this.handleClick)}onRemove(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.mapDiv&&(this.mapDiv.removeEventListener("mousemove",this.handleMouseMove),this.mapDiv.removeEventListener("click",this.handleClick),this.mapDiv=null)}findUserAtPixel(b,y){const w=this.getProjection();if(!w||!this.props.users)return null;const C=this.props.users.filter(A=>{const B=w.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!B)return!1;const Z=Math.sqrt(Math.pow(b-B.x,2)+Math.pow(y-B.y,2)),q=this.getMap().getZoom(),X=Math.max(16,Math.min(80,(q-12)*8));return Z<=X/2});let _=null,x=1/0;for(const A of C){const B=w.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!B)continue;const Z=Math.sqrt(Math.pow(b-B.x,2)+Math.pow(y-B.y,2));Z<x&&(x=Z,_=A)}return _}handleMouseMove(b){const y=this.findUserAtPixel(b.offsetX,b.offsetY);y!==this.hoveredUser&&(this.hoveredUser=y,this.draw()),this.getMap().getDiv().style.cursor=y?"pointer":""}handleClick(b){const y=this.findUserAtPixel(b.offsetX,b.offsetY);y&&this.props.onSetClickedUser(y)}draw(){const b=this.getProjection();if(!b)return;const y=this.getMap().getBounds();if(!y)return;const w=this.getMap().getZoom(),C=y.getSouthWest(),_=y.getNorthEast(),x=b.fromLatLngToDivPixel(C),A=b.fromLatLngToDivPixel(_),B=A.x-x.x,Z=x.y-A.y;if((this.canvas.width!==B||this.canvas.height!==Z)&&(this.canvas.width=B,this.canvas.height=Z),this.canvas.style.left=`${x.x}px`,this.canvas.style.top=`${A.y}px`,this.ctx.clearRect(0,0,B,Z),!this.props.isVisible)return;w<12?this.drawClusters(b,x,A,y):this.drawIndividualMarkers(b,x,A,y)}drawSingleMarker(b,y,w,C){const _=y.fromLatLngToDivPixel(new window.google.maps.LatLng(b.lat,b.lng));if(!_)return;const x=_.x-w.x,A=_.y-C.y,B=this.getMap().getZoom(),Z=Math.max(16,Math.min(80,(B-12)*8)),q=this.hoveredUser&&this.hoveredUser.seq===b.seq,X=b.avatarUrl||"/chill-demo/vite.svg",F=this.imageCache.get(X);if(F&&F.loaded)this.ctx.drawImage(F.image,x-Z/2,A-Z/2,Z,Z);else if(F&&!F.loaded)this.ctx.drawImage(this.defaultAvatar,x-Z/2,A-Z/2,Z,Z);else{const R=new Image;R.crossOrigin="Anonymous",this.imageCache.set(X,{image:R,loaded:!1}),R.onload=()=>{this.imageCache.get(X).loaded=!0,this.draw()},R.onerror=()=>{this.imageCache.get(X).image=this.defaultAvatar,this.imageCache.get(X).loaded=!0,this.draw()},R.src=X,this.ctx.drawImage(this.defaultAvatar,x-Z/2,A-Z/2,Z,Z)}this.ctx.beginPath(),this.ctx.arc(x,A,Z/2,0,Math.PI*2,!0),this.ctx.strokeStyle=q?"#007BFF":"red",this.ctx.lineWidth=q?6:2,this.ctx.stroke()}drawClusters(b,y,w,C){const{users:_}=this.props,x=this.getMap().getZoom(),A=1/Math.pow(2,x-5),B=new Map,Z=_.filter(q=>C.contains({lat:q.lat,lng:q.lng}));for(const q of Z){const X=`${Math.floor(q.lat/A)}|${Math.floor(q.lng/A)}`;B.has(X)||B.set(X,{points:[],sumLat:0,sumLng:0});const F=B.get(X);F.points.push(q),F.sumLat+=q.lat,F.sumLng+=q.lng}for(const q of B.values()){const X=q.points.length;if(X>1){const F=q.sumLat/X,R=q.sumLng/X,z=b.fromLatLngToDivPixel(new window.google.maps.LatLng(F,R));if(!z)continue;const W=z.x-y.x,H=z.y-w.y,U=18+Math.log2(X)*2;this.ctx.beginPath(),this.ctx.arc(W,H,U,0,Math.PI*2),this.ctx.fillStyle="rgba(0, 123, 255, 0.7)",this.ctx.fill(),this.ctx.strokeStyle="rgba(0, 123, 255, 1)",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 18px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(X,W,H)}else this.drawSingleMarker(q.points[0],b,y,w)}}drawIndividualMarkers(b,y,w,C){const{users:_}=this.props;for(const x of _)C.contains({lat:x.lat,lng:x.lng})&&this.drawSingleMarker(x,b,y,w)}}const h=new p;return h.setMap(t),i.current=h,()=>{i.current&&i.current.setMap(null)}},[t]),u.useEffect(()=>{i.current&&i.current.setProps({users:e,isVisible:r,onSetClickedUser:f})},[e,r]),ie.jsx(ie.Fragment,{children:a&&ie.jsx(Wu,{user:a,onClose:()=>f(null)})})},vn=5e-4,$u={width:"100%",height:"100%"},Vu={position:"absolute",inset:"0px",width:"100%",height:"100%"},Hu=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],Gu=({center:t,onSelectCell:e,claimedCells:r,exploredCells:i,setMapRef:a,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m,onZoomOutLimit:b,effects:y})=>{const[w,C]=u.useState(15),[_,x]=u.useState(null),A=u.useRef(!1),B=u.useRef(null),Z=150,[q,X]=u.useState(!1),[F,R]=u.useState([]);u.useEffect(()=>{Nu().then(R)},[]);const z=u.useCallback(ne=>{x(ne),a(ne)},[a]),W=u.useCallback(()=>{if(!_||!A.current)return;const ne=_.getZoom(),ue=_.getCenter();ne<=5&&b(),f(ne),p({lat:ue.lat(),lng:ue.lng()}),C(ne)},[_,f,p,b]);u.useEffect(()=>{(async()=>{_&&t&&!A.current&&(await Kt(_,t,2e3,16,X),A.current=!0,W())})()},[_,t,W,X]);const H=u.useCallback(ne=>{const ue=ne.latLng.lat(),se=ne.latLng.lng(),fe=Math.floor(ue/vn),me=Math.floor(se/vn),be=`${fe}_${me}`,de=fe*vn,we=me*vn,ve=de+vn/2,Le=we+vn/2;e(be,{lat:ve,lng:Le})},[e]),U=u.useCallback(async ne=>{ne.preventDefault(),!B.current&&(B.current=setTimeout(async()=>{if(B.current=null,!_)return;const ue=_.getZoom(),se=ne.deltaY<0?ue+1:ue-1,fe=Math.max(2,Math.min(20,se));fe!==ue&&await Kt(_,_.getCenter().toJSON(),300,fe,X)},Z))},[_,X]),oe=u.useCallback(()=>{},[_]),ee=u.useRef(null);return u.useEffect(()=>{const ne=ee.current;if(ne)return ne.addEventListener("wheel",U,{passive:!1}),()=>{ne.removeEventListener("wheel",U)}},[U]),ie.jsx("div",{ref:ee,className:"view-container fade-in",style:Vu,children:ie.jsxs(Ya,{mapContainerStyle:$u,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:Hu,minZoom:2,maxZoom:20,scrollwheel:!1},onLoad:z,onIdle:W,onDragEnd:oe,onClick:H,children:[ie.jsx(Au,{map:_,zoom:w,claimedCells:r,exploredCells:i,isAnimating:q,selectedCell:h,effects:y}),_&&F.length>0&&ie.jsx(Zu,{map:_,users:F,isVisible:!0}),h&&ie.jsx(oa,{cellInfo:h}),m&&ie.jsx(Ku,{position:m})]})})},Yu=Qt.memo(Gu),js=t=>{let e;const r=new Set,i=(b,y)=>{const w=typeof b=="function"?b(e):b;if(!Object.is(w,e)){const C=e;e=y??(typeof w!="object"||w===null)?w:Object.assign({},e,w),r.forEach(_=>_(e,C))}},a=()=>e,h={setState:i,getState:a,getInitialState:()=>m,subscribe:b=>(r.add(b),()=>r.delete(b))},m=e=t(i,a,h);return h},Xu=(t=>t?js(t):js),Ju=t=>t;function Qu(t,e=Ju){const r=Qt.useSyncExternalStore(t.subscribe,Qt.useCallback(()=>e(t.getState()),[t,e]),Qt.useCallback(()=>e(t.getInitialState()),[t,e]));return Qt.useDebugValue(r),r}const Rs=t=>{const e=Xu(t),r=i=>Qu(e,i);return Object.assign(r,e),r},ec=(t=>t?Rs(t):Rs);var sa=Symbol.for("immer-nothing"),As=Symbol.for("immer-draftable"),st=Symbol.for("immer-state");function dt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Nn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[st]}function en(t){return t?aa(t)||Array.isArray(t)||!!t[As]||!!t.constructor?.[As]||Zn(t)||Br(t):!1}var tc=Object.prototype.constructor.toString(),Ts=new WeakMap;function aa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let i=Ts.get(r);return i===void 0&&(i=Function.toString.call(r),Ts.set(r,i)),i===tc}function Ir(t,e,r=!0){Tr(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((i,a)=>e(a,i,t))}function Tr(t){const e=t[st];return e?e.type_:Array.isArray(t)?1:Zn(t)?2:Br(t)?3:0}function Ci(t,e){return Tr(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function la(t,e,r){const i=Tr(t);i===2?t.set(e,r):i===3?t.add(r):t[e]=r}function nc(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Zn(t){return t instanceof Map}function Br(t){return t instanceof Set}function Xt(t){return t.copy_||t.base_}function Ei(t,e){if(Zn(t))return new Map(t);if(Br(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=aa(t);if(e===!0||e==="class_only"&&!r){const i=Object.getOwnPropertyDescriptors(t);delete i[st];let a=Reflect.ownKeys(i);for(let f=0;f<a.length;f++){const p=a[f],h=i[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(i[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Nn(t),i)}else{const i=Nn(t);if(i!==null&&r)return{...t};const a=Object.create(i);return Object.assign(a,t)}}function Ai(t,e=!1){return Ur(t)||wn(t)||!en(t)||(Tr(t)>1&&Object.defineProperties(t,{set:br,add:br,clear:br,delete:br}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ai(r,!0))),t}function rc(){dt(2)}var br={value:rc};function Ur(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var ic={};function tn(t){const e=ic[t];return e||dt(0,t),e}var qn;function ua(){return qn}function oc(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Bs(t,e){e&&(tn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Si(t){Mi(t),t.drafts_.forEach(sc),t.drafts_=null}function Mi(t){t===qn&&(qn=t.parent_)}function Us(t){return qn=oc(qn,t)}function sc(t){const e=t[st];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[st].modified_&&(Si(e),dt(4)),en(t)&&(t=jr(e,t),e.parent_||Rr(e,t)),e.patches_&&tn("Patches").generateReplacementPatches_(r[st].base_,t,e.patches_,e.inversePatches_)):t=jr(e,r,[]),Si(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==sa?t:void 0}function jr(t,e,r){if(Ur(e))return e;const i=t.immer_.shouldUseStrictIteration(),a=e[st];if(!a)return Ir(e,(f,p)=>Fs(t,a,e,f,p,r),i),e;if(a.scope_!==t)return e;if(!a.modified_)return Rr(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const f=a.copy_;let p=f,h=!1;a.type_===3&&(p=new Set(f),f.clear(),h=!0),Ir(p,(m,b)=>Fs(t,a,f,m,b,r,h),i),Rr(t,f,!1),r&&t.patches_&&tn("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function Fs(t,e,r,i,a,f,p){if(a==null||typeof a!="object"&&!p)return;const h=Ur(a);if(!(h&&!p)){if(wn(a)){const m=f&&e&&e.type_!==3&&!Ci(e.assigned_,i)?f.concat(i):void 0,b=jr(t,a,m);if(la(r,i,b),wn(b))t.canAutoFreeze_=!1;else return}else p&&r.add(a);if(en(a)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===a&&h)return;jr(t,a),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Zn(r)?r.has(i):Object.prototype.propertyIsEnumerable.call(r,i))&&Rr(t,a)}}}function Rr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ai(e,r)}function ac(t,e){const r=Array.isArray(t),i={type_:r?1:0,scope_:e?e.scope_:ua(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,f=Ti;r&&(a=[i],f=Wn);const{revoke:p,proxy:h}=Proxy.revocable(a,f);return i.draft_=h,i.revoke_=p,h}var Ti={get(t,e){if(e===st)return t;const r=Xt(t);if(!Ci(r,e))return lc(t,r,e);const i=r[e];return t.finalized_||!en(i)?i:i===yi(t.base_,e)?(bi(t),t.copy_[e]=Pi(i,t)):i},has(t,e){return e in Xt(t)},ownKeys(t){return Reflect.ownKeys(Xt(t))},set(t,e,r){const i=ca(Xt(t),e);if(i?.set)return i.set.call(t.draft_,r),!0;if(!t.modified_){const a=yi(Xt(t),e),f=a?.[st];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(nc(r,a)&&(r!==void 0||Ci(t.base_,e)))return!0;bi(t),ki(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return yi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bi(t),ki(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Xt(t),i=Reflect.getOwnPropertyDescriptor(r,e);return i&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:i.enumerable,value:r[e]}},defineProperty(){dt(11)},getPrototypeOf(t){return Nn(t.base_)},setPrototypeOf(){dt(12)}},Wn={};Ir(Ti,(t,e)=>{Wn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wn.deleteProperty=function(t,e){return Wn.set.call(this,t,e,void 0)};Wn.set=function(t,e,r){return Ti.set.call(this,t[0],e,r,t[0])};function yi(t,e){const r=t[st];return(r?Xt(r):t)[e]}function lc(t,e,r){const i=ca(e,r);return i?"value"in i?i.value:i.get?.call(t.draft_):void 0}function ca(t,e){if(!(e in t))return;let r=Nn(t);for(;r;){const i=Object.getOwnPropertyDescriptor(r,e);if(i)return i;r=Nn(r)}}function ki(t){t.modified_||(t.modified_=!0,t.parent_&&ki(t.parent_))}function bi(t){t.copy_||(t.copy_=Ei(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var uc=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,i)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...b){return p.produce(m,y=>r.call(this,y,...b))}}typeof r!="function"&&dt(6),i!==void 0&&typeof i!="function"&&dt(7);let a;if(en(e)){const f=Us(this),p=Pi(e,void 0);let h=!0;try{a=r(p),h=!1}finally{h?Si(f):Mi(f)}return Bs(f,i),zs(a,f)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===sa&&(a=void 0),this.autoFreeze_&&Ai(a,!0),i){const f=[],p=[];tn("Patches").generateReplacementPatches_(e,a,f,p),i(f,p)}return a}else dt(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let i,a;return[this.produce(e,r,(p,h)=>{i=p,a=h}),i,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){en(t)||dt(8),wn(t)&&(t=cc(t));const e=Us(this),r=Pi(t,void 0);return r[st].isManual_=!0,Mi(e),r}finishDraft(t,e){const r=t&&t[st];(!r||!r.isManual_)&&dt(9);const{scope_:i}=r;return Bs(i,e),zs(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const i=tn("Patches").applyPatches_;return wn(t)?i(t,e):this.produce(t,a=>i(a,e))}};function Pi(t,e){const r=Zn(t)?tn("MapSet").proxyMap_(t,e):Br(t)?tn("MapSet").proxySet_(t,e):ac(t,e);return(e?e.scope_:ua()).drafts_.push(r),r}function cc(t){return wn(t)||dt(10,t),fa(t)}function fa(t){if(!en(t)||Ur(t))return t;const e=t[st];let r,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ei(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else r=Ei(t,!0);return Ir(r,(a,f)=>{la(r,a,fa(f))},i),e&&(e.finalized_=!1),r}var fc=new uc,dc=fc.produce;const pc=t=>(e,r,i)=>(i.setState=(a,f,...p)=>{const h=typeof a=="function"?dc(a):a;return e(h,f,...p)},t(i.setState,r,i)),hc=pc;var xr={exports:{}},gc=xr.exports,Ks;function mc(){return Ks||(Ks=1,(function(t,e){(function(r,i){t.exports=i()})(gc,function(){var r=function(n,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])})(n,o)},i=function(){return(i=Object.assign||function(n){for(var o,s=1,l=arguments.length;s<l;s++)for(var c in o=arguments[s])Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c]);return n}).apply(this,arguments)};function a(n,o,s){for(var l,c=0,d=o.length;c<d;c++)!l&&c in o||((l=l||Array.prototype.slice.call(o,0,c))[c]=o[c]);return n.concat(l||Array.prototype.slice.call(o))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Aa,p=Object.keys,h=Array.isArray;function m(n,o){return typeof o!="object"||p(o).forEach(function(s){n[s]=o[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var b=Object.getPrototypeOf,y={}.hasOwnProperty;function w(n,o){return y.call(n,o)}function C(n,o){typeof o=="function"&&(o=o(b(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(o).forEach(function(s){x(n,s,o[s])})}var _=Object.defineProperty;function x(n,o,s,l){_(n,o,m(s&&w(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},l))}function A(n){return{from:function(o){return n.prototype=Object.create(o.prototype),x(n.prototype,"constructor",n),{extend:C.bind(null,n.prototype)}}}}var B=Object.getOwnPropertyDescriptor,Z=[].slice;function q(n,o,s){return Z.call(n,o,s)}function X(n,o){return o(n)}function F(n){if(!n)throw new Error("Assertion Failed")}function R(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function z(n,o){if(typeof o=="string"&&w(n,o))return n[o];if(!o)return n;if(typeof o!="string"){for(var s=[],l=0,c=o.length;l<c;++l){var d=z(n,o[l]);s.push(d)}return s}var g=o.indexOf(".");if(g!==-1){var v=n[o.substr(0,g)];return v==null?void 0:z(v,o.substr(g+1))}}function W(n,o,s){if(n&&o!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof o!="string"&&"length"in o){F(typeof s!="string"&&"length"in s);for(var l=0,c=o.length;l<c;++l)W(n,o[l],s[l])}else{var d,g,v=o.indexOf(".");v!==-1?(d=o.substr(0,v),(g=o.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:W(v=!(v=n[d])||!w(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=s}}function H(n){var o,s={};for(o in n)w(n,o)&&(s[o]=n[o]);return s}var U=[].concat;function oe(n){return U.apply([],n)}var ht="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(oe([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(o){return o+n+"Array"})}))).filter(function(n){return f[n]}),ee=new Set(ht.map(function(n){return f[n]})),ne=null;function ue(n){return ne=new WeakMap,n=(function o(s){if(!s||typeof s!="object")return s;var l=ne.get(s);if(l)return l;if(h(s)){l=[],ne.set(s,l);for(var c=0,d=s.length;c<d;++c)l.push(o(s[c]))}else if(ee.has(s.constructor))l=s;else{var g,v=b(s);for(g in l=v===Object.prototype?{}:Object.create(v),ne.set(s,l),s)w(s,g)&&(l[g]=o(s[g]))}return l})(n),ne=null,n}var se={}.toString;function fe(n){return se.call(n).slice(8,-1)}var me=typeof Symbol<"u"?Symbol.iterator:"@@iterator",be=typeof me=="symbol"?function(n){var o;return n!=null&&(o=n[me])&&o.apply(n)}:function(){return null};function de(n,o){return o=n.indexOf(o),0<=o&&n.splice(o,1),0<=o}var we={};function ve(n){var o,s,l,c;if(arguments.length===1){if(h(n))return n.slice();if(this===we&&typeof n=="string")return[n];if(c=be(n)){for(s=[];!(l=c.next()).done;)s.push(l.value);return s}if(n==null)return[n];if(typeof(o=n.length)!="number")return[n];for(s=new Array(o);o--;)s[o]=n[o];return s}for(o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return s}var Le=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ot=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ot),Se={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ge(n,o){this.name=n,this.message=o}function De(n,o){return n+". Errors: "+Object.keys(o).map(function(s){return o[s].toString()}).filter(function(s,l,c){return c.indexOf(s)===l}).join(`
`)}function $(n,o,s,l){this.failures=o,this.failedKeys=l,this.successCount=s,this.message=De(n,o)}function Te(n,o){this.name="BulkError",this.failures=Object.keys(o).map(function(s){return o[s]}),this.failuresByPos=o,this.message=De(n,this.failures)}A(ge).from(Error).extend({toString:function(){return this.name+": "+this.message}}),A($).from(ge),A(Te).from(ge);var ze=lt.reduce(function(n,o){return n[o]=o+"Error",n},{}),G=ge,Y=lt.reduce(function(n,o){var s=o+"Error";function l(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=Se[o]||s,this.inner=null)}return A(l).from(G),n[o]=l,n},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var ye=Ot.reduce(function(n,o){return n[o+"Error"]=Y[o],n},{}),Ie=lt.reduce(function(n,o){return["Syntax","Type","Range"].indexOf(o)===-1&&(n[o+"Error"]=Y[o]),n},{});function ke(){}function Xe(n){return n}function qt(n,o){return n==null||n===Xe?o:function(s){return o(n(s))}}function Re(n,o){return function(){n.apply(this,arguments),o.apply(this,arguments)}}function $n(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var l=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=o.apply(this,arguments);return l&&(this.onsuccess=this.onsuccess?Re(l,this.onsuccess):l),c&&(this.onerror=this.onerror?Re(c,this.onerror):c),d!==void 0?d:s}}function nn(n,o){return n===ke?o:function(){n.apply(this,arguments);var s=this.onsuccess,l=this.onerror;this.onsuccess=this.onerror=null,o.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Re(s,this.onsuccess):s),l&&(this.onerror=this.onerror?Re(l,this.onerror):l)}}function Vn(n,o){return n===ke?o:function(s){var l=n.apply(this,arguments);m(s,l);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=o.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?Re(c,this.onsuccess):c),d&&(this.onerror=this.onerror?Re(d,this.onerror):d),l===void 0?s===void 0?void 0:s:m(l,s)}}function rn(n,o){return n===ke?o:function(){return o.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function on(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var l=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return o.apply(l,d)})}return o.apply(this,arguments)}}Ie.ModifyError=$,Ie.DexieError=ge,Ie.BulkError=Te;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xn(n){Je=n}var pt={},Cn=100,ht=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,b(n),n];var o=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[o,b(o),n]})(),Ot=ht[0],lt=ht[1],ht=ht[2],lt=lt&&lt.then,at=Ot&&Ot.constructor,sn=!!ht,gt=function(n,o){vt.push([n,o]),xt&&(queueMicrotask(cn),xt=!1)},an=!0,xt=!0,mt=[],Ct=[],ln=Xe,et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},he=et,vt=[],yt=0,Et=[];function ce(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var o=this._PSD=he;if(typeof n!="function"){if(n!==pt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&_t(this,this._value))}this._state=null,this._value=null,++o.ref,(function s(l,c){try{c(function(d){if(l._state===null){if(d===l)throw new TypeError("A promise cannot be resolved with itself.");var g=l._lib&&St();d&&typeof d.then=="function"?s(l,function(v,E){d instanceof ce?d._then(v,E):d.then(v,E)}):(l._state=!0,l._value=d,Sn(l)),g&&It()}},_t.bind(null,l))}catch(d){_t(l,d)}})(this,n)}var un={get:function(){var n=he,o=Xn;function s(l,c){var d=this,g=!n.global&&(n!==he||o!==Xn),v=g&&!Rt(),E=new ce(function(S,O){Dt(d,new En(Ui(l,n,g,v),Ui(c,n,g,v),S,O,n))});return this._consoleTask&&(E._consoleTask=this._consoleTask),E}return s.prototype=pt,s},set:function(n){x(this,"then",n&&n.prototype===pt?un:{get:function(){return n},set:un.set})}};function En(n,o,s,l,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof o=="function"?o:null,this.resolve=s,this.reject=l,this.psd=c}function _t(n,o){var s,l;Ct.push(o),n._state===null&&(s=n._lib&&St(),o=ln(o),n._state=!1,n._value=o,l=n,mt.some(function(c){return c._value===l._value})||mt.push(l),Sn(n),s&&It())}function Sn(n){var o=n._listeners;n._listeners=[];for(var s=0,l=o.length;s<l;++s)Dt(n,o[s]);var c=n._PSD;--c.ref||c.finalize(),yt===0&&(++yt,gt(function(){--yt==0&&Mt()},[]))}function Dt(n,o){if(n._state!==null){var s=n._state?o.onFulfilled:o.onRejected;if(s===null)return(n._state?o.resolve:o.reject)(n._value);++o.psd.ref,++yt,gt(Hn,[s,n,o])}else n._listeners.push(o)}function Hn(n,o,s){try{var l,c=o._value;!o._state&&Ct.length&&(Ct=[]),l=Je&&o._consoleTask?o._consoleTask.run(function(){return n(c)}):n(c),o._state||Ct.indexOf(c)!==-1||(function(d){for(var g=mt.length;g;)if(mt[--g]._value===d._value)return mt.splice(g,1)})(o),s.resolve(l)}catch(d){s.reject(d)}finally{--yt==0&&Mt(),--s.psd.ref||s.psd.finalize()}}function cn(){Wt(et,function(){St()&&It()})}function St(){var n=an;return xt=an=!1,n}function It(){var n,o,s;do for(;0<vt.length;)for(n=vt,vt=[],s=n.length,o=0;o<s;++o){var l=n[o];l[0].apply(null,l[1])}while(0<vt.length);xt=an=!0}function Mt(){var n=mt;mt=[],n.forEach(function(l){l._PSD.onunhandled.call(null,l._value,l)});for(var o=Et.slice(0),s=o.length;s;)o[--s]()}function xe(n){return new ce(pt,!1,n)}function Ke(n,o){var s=he;return function(){var l=St(),c=he;try{return At(s,!0),n.apply(this,arguments)}catch(d){o&&o(d)}finally{At(c,!1),l&&It()}}}C(ce.prototype,{then:un,_then:function(n,o){Dt(this,new En(null,null,n,o,he))},catch:function(n){if(arguments.length===1)return this.then(null,n);var o=n,s=arguments[1];return typeof o=="function"?this.then(null,function(l){return(l instanceof o?s:xe)(l)}):this.then(null,function(l){return(l&&l.name===o?s:xe)(l)})},finally:function(n){return this.then(function(o){return ce.resolve(n()).then(function(){return o})},function(o){return ce.resolve(n()).then(function(){return xe(o)})})},timeout:function(n,o){var s=this;return n<1/0?new ce(function(l,c){var d=setTimeout(function(){return c(new Y.Timeout(o))},n);s.then(l,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&x(ce.prototype,Symbol.toStringTag,"Dexie.Promise"),et.env=Bi(),C(ce,{all:function(){var n=ve.apply(null,arguments).map(Jn);return new ce(function(o,s){n.length===0&&o([]);var l=n.length;n.forEach(function(c,d){return ce.resolve(c).then(function(g){n[d]=g,--l||o(n)},s)})})},resolve:function(n){return n instanceof ce?n:n&&typeof n.then=="function"?new ce(function(o,s){n.then(o,s)}):new ce(pt,!0,n)},reject:xe,race:function(){var n=ve.apply(null,arguments).map(Jn);return new ce(function(o,s){n.map(function(l){return ce.resolve(l).then(o,s)})})},PSD:{get:function(){return he},set:function(n){return he=n}},totalEchoes:{get:function(){return Xn}},newPSD:jt,usePSD:Wt,scheduler:{get:function(){return gt},set:function(n){gt=n}},rejectionMapper:{get:function(){return ln},set:function(n){ln=n}},follow:function(n,o){return new ce(function(s,l){return jt(function(c,d){var g=he;g.unhandleds=[],g.onunhandled=d,g.finalize=Re(function(){var v,E=this;v=function(){E.unhandleds.length===0?c():d(E.unhandleds[0])},Et.push(function S(){v(),Et.splice(Et.indexOf(S),1)}),++yt,gt(function(){--yt==0&&Mt()},[])},g.finalize),n()},o,s,l)})}}),at&&(at.allSettled&&x(ce,"allSettled",function(){var n=ve.apply(null,arguments).map(Jn);return new ce(function(o){n.length===0&&o([]);var s=n.length,l=new Array(s);n.forEach(function(c,d){return ce.resolve(c).then(function(g){return l[d]={status:"fulfilled",value:g}},function(g){return l[d]={status:"rejected",reason:g}}).then(function(){return--s||o(l)})})})}),at.any&&typeof AggregateError<"u"&&x(ce,"any",function(){var n=ve.apply(null,arguments).map(Jn);return new ce(function(o,s){n.length===0&&s(new AggregateError([]));var l=n.length,c=new Array(l);n.forEach(function(d,g){return ce.resolve(d).then(function(v){return o(v)},function(v){c[g]=v,--l||s(new AggregateError(c))})})})}),at.withResolvers&&(ce.withResolvers=at.withResolvers));var Ze={awaits:0,echoes:0,id:0},da=0,Gn=[],Yn=0,Xn=0,pa=0;function jt(n,o,s,l){var c=he,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++pa,et.env,d.env=sn?{Promise:ce,PromiseProp:{value:ce,configurable:!0,writable:!0},all:ce.all,race:ce.race,allSettled:ce.allSettled,any:ce.any,resolve:ce.resolve,reject:ce.reject}:{},o&&m(d,o),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},l=Wt(d,n,s,l),d.ref===0&&d.finalize(),l}function fn(){return Ze.id||(Ze.id=++da),++Ze.awaits,Ze.echoes+=Cn,Ze.id}function Rt(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*Cn,!0)}function Jn(n){return Ze.echoes&&n&&n.constructor===at?(fn(),n.then(function(o){return Rt(),o},function(o){return Rt(),Ne(o)})):n}function ha(){var n=Gn[Gn.length-1];Gn.pop(),At(n,!1)}function At(n,o){var s,l=he;(o?!Ze.echoes||Yn++&&n===he:!Yn||--Yn&&n===he)||queueMicrotask(o?(function(c){++Xn,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Gn.push(he),At(c,!0)}).bind(null,n):ha),n!==he&&(he=n,l===et&&(et.env=Bi()),sn&&(s=et.env.Promise,o=n.env,(l.global||n.global)&&(Object.defineProperty(f,"Promise",o.PromiseProp),s.all=o.all,s.race=o.race,s.resolve=o.resolve,s.reject=o.reject,o.allSettled&&(s.allSettled=o.allSettled),o.any&&(s.any=o.any))))}function Bi(){var n=f.Promise;return sn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Wt(n,o,s,l,c){var d=he;try{return At(n,!0),o(s,l,c)}finally{At(d,!1)}}function Ui(n,o,s,l){return typeof n!="function"?n:function(){var c=he;s&&fn(),At(o,!0);try{return n.apply(this,arguments)}finally{At(c,!1),l&&queueMicrotask(Rt)}}}function zr(n){Promise===at&&Ze.echoes===0?Yn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+lt).indexOf("[native code]")===-1&&(fn=Rt=ke);var Ne=ce.reject,Zt="",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",dn=[],Qn="__dbnames",Fr="readonly",Kr="readwrite";function $t(n,o){return n?o?function(){return n.apply(this,arguments)&&o.apply(this,arguments)}:n:o}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function er(n){return typeof n!="string"||/\./.test(n)?function(o){return o}:function(o){return o[n]===void 0&&n in o&&delete(o=ue(o))[n],o}}function Ki(){throw Y.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ae(n,o){try{var s=Ni(n),l=Ni(o);if(s!==l)return s==="Array"?1:l==="Array"?-1:s==="binary"?1:l==="binary"?-1:s==="string"?1:l==="string"?-1:s==="Date"?1:l!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return o<n?1:n<o?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,E=g<v?g:v,S=0;S<E;++S)if(c[S]!==d[S])return c[S]<d[S]?-1:1;return g===v?0:g<v?-1:1})(qi(n),qi(o));case"Array":return(function(c,d){for(var g=c.length,v=d.length,E=g<v?g:v,S=0;S<E;++S){var O=Ae(c[S],d[S]);if(O!==0)return O}return g===v?0:g<v?-1:1})(n,o)}}catch{}return NaN}function Ni(n){var o=typeof n;return o!="object"?o:ArrayBuffer.isView(n)?"binary":(n=fe(n),n==="ArrayBuffer"?"binary":n)}function qi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function tr(n,o,s){var l=n.schema.yProps;return l?(o&&0<s.numFailures&&(o=o.filter(function(c,d){return!s.failures[d]})),Promise.all(l.map(function(c){return c=c.updatesTable,o?n.db.table(c).where("k").anyOf(o).delete():n.db.table(c).clear()})).then(function(){return s})):s}var Mn=(Wi.prototype.execute=function(n){var o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(h(s))return a(a([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var l=o.remove;if(h(l))return h(n)?n.filter(function(c){return!l.includes(c)}).sort():[];if(typeof l=="number")return Number(n)-l;if(typeof l=="bigint")try{return BigInt(n)-l}catch{return BigInt(0)-l}throw new TypeError("Invalid subtrahend ".concat(l))}return s=(s=o.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?o.replacePrefix[1]+n.substring(s.length):n},Wi);function Wi(n){this["@@propmod"]=n}function Zi(n,o){for(var s=p(o),l=s.length,c=!1,d=0;d<l;++d){var g=s[d],v=o[g],E=z(n,g);v instanceof Mn?(W(n,g,v.execute(E)),c=!0):E!==v&&(W(n,g,v),c=!0)}return c}var $i=(Fe.prototype._trans=function(n,o,s){var l=this._tx||he.trans,c=this.name,d=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(S,O,L){if(!L.schema[c])throw new Y.NotFound("Table "+c+" not part of transaction");return o(L.idbtrans,L)}var v=St();try{var E=l&&l.db._novip===this.db._novip?l===he.trans?l._promise(n,g,s):jt(function(){return l._promise(n,g,s)},{trans:l,transless:he.transless||he}):(function S(O,L,I,M){if(O.idbdb&&(O._state.openComplete||he.letThrough||O._vip)){var k=O._createTransaction(L,I,O._dbSchema);try{k.create(),O._state.PR1398_maxLoop=3}catch(P){return P.name===ze.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return S(O,L,I,M)})):Ne(P)}return k._promise(L,function(P,D){return jt(function(){return he.trans=k,M(P,D,k)})}).then(function(P){if(L==="readwrite")try{k.idbtrans.commit()}catch{}return L==="readonly"?P:k._completion.then(function(){return P})})}if(O._state.openComplete)return Ne(new Y.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return Ne(new Y.DatabaseClosed);O.open().catch(ke)}return O._state.dbReadyPromise.then(function(){return S(O,L,I,M)})})(this.db,n,[this.name],g);return d&&(E._consoleTask=d,E=E.catch(function(S){return console.trace(S),Ne(S)})),E}finally{v&&It()}},Fe.prototype.get=function(n,o){var s=this;return n&&n.constructor===Object?this.where(n).first(o):n==null?Ne(new Y.Type("Invalid argument to Table.get()")):this._trans("readonly",function(l){return s.core.get({trans:l,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(o)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var o=p(n);if(o.length===1)return this.where(o[0]).equals(n[o[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&o.every(function(S){return 0<=v.keyPath.indexOf(S)})){for(var E=0;E<o.length;++E)if(o.indexOf(v.keyPath[E])===-1)return!1;return!0}return!1}).sort(function(v,E){return v.keyPath.length-E.keyPath.length})[0];if(s&&this.db._maxKey!==Zt){var d=s.keyPath.slice(0,o.length);return this.where(d).equals(d.map(function(E){return n[E]}))}!s&&Je&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var l=this.schema.idxByName;function c(v,E){return Ae(v,E)===0}var g=o.reduce(function(L,E){var S=L[0],O=L[1],L=l[E],I=n[E];return[S||L,S||!L?$t(O,L&&L.multi?function(M){return M=z(M,E),h(M)&&M.some(function(k){return c(I,k)})}:function(M){return c(I,z(M,E))}):O]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(o).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var o,s=this.db,l=this.name;function c(){return o!==null&&o.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ki&&((function(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");function O(){this.constructor=E}r(E,S),E.prototype=S===null?Object.create(S):(O.prototype=S.prototype,new O)})(c,o=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return l},n=c);for(var d=new Set,g=n.prototype;g;g=b(g))Object.getOwnPropertyNames(g).forEach(function(E){return d.add(E)});function v(E){if(!E)return E;var S,O=Object.create(n.prototype);for(S in E)if(!d.has(S))try{O[S]=E[S]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,o){var s=this,l=this.schema.primKey,c=l.auto,d=l.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:o!=null?[o]:null,values:[g]})}).then(function(v){return v.numFailures?ce.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{W(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,o){var s=this,l=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return Zi(g,o),l&&W(g,l,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[o]}}).then(function(v){return v.numFailures?ce.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,o){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(o):(n=z(n,this.schema.primKey.keyPath),n===void 0?Ne(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(o))},Fe.prototype.put=function(n,o){var s=this,l=this.schema.primKey,c=l.auto,d=l.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:o!=null?[o]:null})}).then(function(v){return v.numFailures?ce.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{W(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(l){return tr(o,[n],l)}).then(function(l){return l.numFailures?ce.reject(l.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"deleteRange",range:Fi}).then(function(s){return tr(n,null,s)})}).then(function(o){return o.numFailures?ce.reject(o.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var o=this;return this._trans("readonly",function(s){return o.core.getMany({keys:n,trans:s}).then(function(l){return l.map(function(c){return o.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,o,s){var l=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var S=l.schema.primKey,v=S.auto,S=S.keyPath;if(S&&c)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var E=n.length,S=S&&v?n.map(er(S)):n;return l.core.mutate({trans:g,type:"add",keys:c,values:S,wantResults:d}).then(function(k){var L=k.numFailures,I=k.results,M=k.lastResult,k=k.failures;if(L===0)return d?I:M;throw new Te("".concat(l.name,".bulkAdd(): ").concat(L," of ").concat(E," operations failed"),k)})})},Fe.prototype.bulkPut=function(n,o,s){var l=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var S=l.schema.primKey,v=S.auto,S=S.keyPath;if(S&&c)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var E=n.length,S=S&&v?n.map(er(S)):n;return l.core.mutate({trans:g,type:"put",keys:c,values:S,wantResults:d}).then(function(k){var L=k.numFailures,I=k.results,M=k.lastResult,k=k.failures;if(L===0)return d?I:M;throw new Te("".concat(l.name,".bulkPut(): ").concat(L," of ").concat(E," operations failed"),k)})})},Fe.prototype.bulkUpdate=function(n){var o=this,s=this.core,l=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:l,cache:"clone"}).then(function(v){var E=[],S=[];n.forEach(function(L,I){var M=L.key,k=L.changes,P=v[I];if(P){for(var D=0,j=Object.keys(k);D<j.length;D++){var T=j[D],N=k[T];if(T===o.schema.primKey.keyPath){if(Ae(N,M)!==0)throw new Y.Constraint("Cannot update primary key in bulkUpdate()")}else W(P,T,N)}d.push(I),E.push(M),S.push(P)}});var O=E.length;return s.mutate({trans:g,type:"put",keys:E,values:S,updates:{keys:l,changeSpecs:c}}).then(function(L){var I=L.numFailures,M=L.failures;if(I===0)return O;for(var k=0,P=Object.keys(M);k<P.length;k++){var D,j=P[k],T=d[Number(j)];T!=null&&(D=M[j],delete M[j],M[T]=D)}throw new Te("".concat(o.name,".bulkUpdate(): ").concat(I," of ").concat(O," operations failed"),M)})})})},Fe.prototype.bulkDelete=function(n){var o=this,s=n.length;return this._trans("readwrite",function(l){return o.core.mutate({trans:l,type:"delete",keys:n}).then(function(c){return tr(o,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Te("".concat(o.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function kn(n){function o(g,v){if(v){for(var E=arguments.length,S=new Array(E-1);--E;)S[E-1]=arguments[E];return s[g].subscribe.apply(null,S),n}if(typeof g=="string")return s[g]}var s={};o.addEventType=d;for(var l=1,c=arguments.length;l<c;++l)d(arguments[l]);return o;function d(g,v,E){if(typeof g!="object"){var S;v=v||rn;var O={subscribers:[],fire:E=E||ke,subscribe:function(L){O.subscribers.indexOf(L)===-1&&(O.subscribers.push(L),O.fire=v(O.fire,L))},unsubscribe:function(L){O.subscribers=O.subscribers.filter(function(I){return I!==L}),O.fire=O.subscribers.reduce(v,E)}};return s[g]=o[g]=O}p(S=g).forEach(function(L){var I=S[L];if(h(I))d(L,S[L][0],S[L][1]);else{if(I!=="asap")throw new Y.InvalidArgument("Invalid event config");var M=d(L,Xe,function(){for(var k=arguments.length,P=new Array(k);k--;)P[k]=arguments[k];M.subscribers.forEach(function(D){R(function(){D.apply(null,P)})})})}})}}function Pn(n,o){return A(o).from({prototype:n}),o}function pn(n,o){return!(n.filter||n.algorithm||n.or)&&(o?n.justLimit:!n.replayFilter)}function Nr(n,o){n.filter=$t(n.filter,o)}function qr(n,o,s){var l=n.replayFilter;n.replayFilter=l?function(){return $t(l(),o())}:o,n.justLimit=s&&!l}function nr(n,o){if(n.isPrimKey)return o.primaryKey;var s=o.getIndexByKeyPath(n.index);if(!s)throw new Y.Schema("KeyPath "+n.index+" on object store "+o.name+" is not indexed");return s}function Vi(n,o,s){var l=nr(n,o.schema);return o.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:l,range:n.range}})}function rr(n,o,s,l){var c=n.replayFilter?$t(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,E,S){var O,L;c&&!c(E,S,function(I){return E.stop(I)},function(I){return E.fail(I)})||((L=""+(O=E.primaryKey))=="[object ArrayBuffer]"&&(L=""+new Uint8Array(O)),w(d,L)||(d[L]=!0,o(v,E,S)))};return Promise.all([n.or._iterate(g,s),Hi(Vi(n,l,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Hi(Vi(n,l,s),$t(n.algorithm,c),o,!n.keysOnly&&n.valueMapper)}function Hi(n,o,s,l){var c=Ke(l?function(d,g,v){return s(l(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};o&&!o(d,function(v){return g=v},function(v){d.stop(v),g=ke},function(v){d.fail(v),g=ke})||c(d.value,d,function(v){return g=v}),g()})})}var ga=(Be.prototype._read=function(n,o){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(o)},Be.prototype._write=function(n){var o=this._ctx;return o.error?o.table._trans(null,Ne.bind(null,o.error)):o.table._trans("readwrite",n,"locked")},Be.prototype._addAlgorithm=function(n){var o=this._ctx;o.algorithm=$t(o.algorithm,n)},Be.prototype._iterate=function(n,o){return rr(this._ctx,n,o,this._ctx.table.core)},Be.prototype.clone=function(n){var o=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),o._ctx=s,o},Be.prototype.raw=function(){return this._ctx.valueMapper=null,this},Be.prototype.each=function(n){var o=this._ctx;return this._read(function(s){return rr(o,n,s,o.table.core)})},Be.prototype.count=function(n){var o=this;return this._read(function(s){var l=o._ctx,c=l.table.core;if(pn(l,!0))return c.count({trans:s,query:{index:nr(l,c.schema),range:l.range}}).then(function(g){return Math.min(g,l.limit)});var d=0;return rr(l,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},Be.prototype.sortBy=function(n,o){var s=n.split(".").reverse(),l=s[0],c=s.length-1;function d(E,S){return S?d(E[s[S]],S-1):E[l]}var g=this._ctx.dir==="next"?1:-1;function v(E,S){return Ae(d(E,c),d(S,c))*g}return this.toArray(function(E){return E.sort(v)}).then(o)},Be.prototype.toArray=function(n){var o=this;return this._read(function(s){var l=o._ctx;if(l.dir==="next"&&pn(l,!0)&&0<l.limit){var c=l.valueMapper,d=nr(l,l.table.core.schema);return l.table.core.query({trans:s,limit:l.limit,values:!0,query:{index:d,range:l.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return rr(l,function(v){return g.push(v)},s,l.table.core).then(function(){return g})},n)},Be.prototype.offset=function(n){var o=this._ctx;return n<=0||(o.offset+=n,pn(o)?qr(o,function(){var s=n;return function(l,c){return s===0||(s===1?--s:c(function(){l.advance(s),s=0}),!1)}}):qr(o,function(){var s=n;return function(){return--s<0}})),this},Be.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),qr(this._ctx,function(){var o=n;return function(s,l,c){return--o<=0&&l(c),0<=o}},!0),this},Be.prototype.until=function(n,o){return Nr(this._ctx,function(s,l,c){return!n(s.value)||(l(c),o)}),this},Be.prototype.first=function(n){return this.limit(1).toArray(function(o){return o[0]}).then(n)},Be.prototype.last=function(n){return this.reverse().first(n)},Be.prototype.filter=function(n){var o;return Nr(this._ctx,function(s){return n(s.value)}),(o=this._ctx).isMatch=$t(o.isMatch,n),this},Be.prototype.and=function(n){return this.filter(n)},Be.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Be.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Be.prototype.desc=function(){return this.reverse()},Be.prototype.eachKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,l){n(l.key,l)})},Be.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Be.prototype.eachPrimaryKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,l){n(l.primaryKey,l)})},Be.prototype.keys=function(n){var o=this._ctx;o.keysOnly=!o.isMatch;var s=[];return this.each(function(l,c){s.push(c.key)}).then(function(){return s}).then(n)},Be.prototype.primaryKeys=function(n){var o=this._ctx;if(o.dir==="next"&&pn(o,!0)&&0<o.limit)return this._read(function(l){var c=nr(o,o.table.core.schema);return o.table.core.query({trans:l,values:!1,limit:o.limit,query:{index:c,range:o.range}})}).then(function(l){return l.result}).then(n);o.keysOnly=!o.isMatch;var s=[];return this.each(function(l,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},Be.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Be.prototype.firstKey=function(n){return this.limit(1).keys(function(o){return o[0]}).then(n)},Be.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Be.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var o={};return Nr(this._ctx,function(c){var l=c.primaryKey.toString(),c=w(o,l);return o[l]=!0,!c}),this},Be.prototype.modify=function(n){var o=this,s=this._ctx;return this._write(function(l){var c=typeof n=="function"?n:function(P){return Zi(P,n)},d=s.table.core,S=d.schema.primaryKey,g=S.outbound,v=S.extractKey,E=200,S=o.db._options.modifyChunkSize;S&&(E=typeof S=="object"?S[d.name]||S["*"]||200:S);function O(P,T){var j=T.failures,T=T.numFailures;I+=P-T;for(var N=0,V=p(j);N<V.length;N++){var Q=V[N];L.push(j[Q])}}var L=[],I=0,M=[],k=n===Gi;return o.clone().primaryKeys().then(function(P){function D(T){var N=Math.min(E,P.length-T),V=P.slice(T,T+N);return(k?Promise.resolve([]):d.getMany({trans:l,keys:V,cache:"immutable"})).then(function(Q){var ae=[],J=[],te=g?[]:null,le=k?V:[];if(!k)for(var re=0;re<N;++re){var pe=Q[re],Ee={value:ue(pe),primKey:P[T+re]};c.call(Ee,Ee.value,Ee)!==!1&&(Ee.value==null?le.push(P[T+re]):g||Ae(v(pe),v(Ee.value))===0?(J.push(Ee.value),g&&te.push(P[T+re])):(le.push(P[T+re]),ae.push(Ee.value)))}return Promise.resolve(0<ae.length&&d.mutate({trans:l,type:"add",values:ae}).then(function(Pe){for(var Oe in Pe.failures)le.splice(parseInt(Oe),1);O(ae.length,Pe)})).then(function(){return(0<J.length||j&&typeof n=="object")&&d.mutate({trans:l,type:"put",keys:te,values:J,criteria:j,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<T}).then(function(Pe){return O(J.length,Pe)})}).then(function(){return(0<le.length||j&&k)&&d.mutate({trans:l,type:"delete",keys:le,criteria:j,isAdditionalChunk:0<T}).then(function(Pe){return tr(s.table,le,Pe)}).then(function(Pe){return O(le.length,Pe)})}).then(function(){return P.length>T+N&&D(T+E)})})}var j=pn(s)&&s.limit===1/0&&(typeof n!="function"||k)&&{index:s.index,range:s.range};return D(0).then(function(){if(0<L.length)throw new $("Error modifying one or more objects",L,I,M);return P.length})})})},Be.prototype.delete=function(){var n=this._ctx,o=n.range;return!pn(n)||n.table.schema.yProps||!n.isPrimKey&&o.type!==3?this.modify(Gi):this._write(function(s){var l=n.table.core.schema.primaryKey,c=o;return n.table.core.count({trans:s,query:{index:l,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(E){var v=E.failures,E=E.numFailures;if(E)throw new $("Could not delete some values",Object.keys(v).map(function(S){return v[S]}),d-E);return d-E})})})},Be);function Be(){}var Gi=function(n,o){return o.value=null};function ma(n,o){return n<o?-1:n===o?0:1}function va(n,o){return o<n?-1:n===o?0:1}function tt(n,o,s){return n=n instanceof Xi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(o),n}function hn(n){return new n.Collection(n,function(){return Yi("")}).limit(0)}function ir(n,o,s,l){var c,d,g,v,E,S,O,L=s.length;if(!s.every(function(k){return typeof k=="string"}))return tt(n,zi);function I(k){c=k==="next"?function(D){return D.toUpperCase()}:function(D){return D.toLowerCase()},d=k==="next"?function(D){return D.toLowerCase()}:function(D){return D.toUpperCase()},g=k==="next"?ma:va;var P=s.map(function(D){return{lower:d(D),upper:c(D)}}).sort(function(D,j){return g(D.lower,j.lower)});v=P.map(function(D){return D.upper}),E=P.map(function(D){return D.lower}),O=(S=k)==="next"?"":l}I("next"),n=new n.Collection(n,function(){return Tt(v[0],E[L-1]+l)}),n._ondirectionchange=function(k){I(k)};var M=0;return n._addAlgorithm(function(k,P,D){var j=k.key;if(typeof j!="string")return!1;var T=d(j);if(o(T,E,M))return!0;for(var N=null,V=M;V<L;++V){var Q=(function(ae,J,te,le,re,pe){for(var Ee=Math.min(ae.length,le.length),Pe=-1,Oe=0;Oe<Ee;++Oe){var nt=J[Oe];if(nt!==le[Oe])return re(ae[Oe],te[Oe])<0?ae.substr(0,Oe)+te[Oe]+te.substr(Oe+1):re(ae[Oe],le[Oe])<0?ae.substr(0,Oe)+le[Oe]+te.substr(Oe+1):0<=Pe?ae.substr(0,Pe)+J[Pe]+te.substr(Pe+1):null;re(ae[Oe],nt)<0&&(Pe=Oe)}return Ee<le.length&&pe==="next"?ae+te.substr(ae.length):Ee<ae.length&&pe==="prev"?ae.substr(0,te.length):Pe<0?null:ae.substr(0,Pe)+le[Pe]+te.substr(Pe+1)})(j,T,v[V],E[V],g,S);Q===null&&N===null?M=V+1:(N===null||0<g(N,Q))&&(N=Q)}return P(N!==null?function(){k.continue(N+O)}:D),!1}),n}function Tt(n,o,s,l){return{type:2,lower:n,upper:o,lowerOpen:s,upperOpen:l}}function Yi(n){return{type:1,lower:n,upper:n}}var Xi=(Object.defineProperty($e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$e.prototype.between=function(n,o,s,l){s=s!==!1,l=l===!0;try{return 0<this._cmp(n,o)||this._cmp(n,o)===0&&(s||l)&&(!s||!l)?hn(this):new this.Collection(this,function(){return Tt(n,o,!s,!l)})}catch{return tt(this,kt)}},$e.prototype.equals=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Yi(n)})},$e.prototype.above=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!0)})},$e.prototype.aboveOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!1)})},$e.prototype.below=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n,!1,!0)})},$e.prototype.belowOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n)})},$e.prototype.startsWith=function(n){return typeof n!="string"?tt(this,zi):this.between(n,n+Zt,!0,!0)},$e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):ir(this,function(o,s){return o.indexOf(s[0])===0},[n],Zt)},$e.prototype.equalsIgnoreCase=function(n){return ir(this,function(o,s){return o===s[0]},[n],"")},$e.prototype.anyOfIgnoreCase=function(){var n=ve.apply(we,arguments);return n.length===0?hn(this):ir(this,function(o,s){return s.indexOf(o)!==-1},n,"")},$e.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(we,arguments);return n.length===0?hn(this):ir(this,function(o,s){return s.some(function(l){return o.indexOf(l)===0})},n,Zt)},$e.prototype.anyOf=function(){var n=this,o=ve.apply(we,arguments),s=this._cmp;try{o.sort(s)}catch{return tt(this,kt)}if(o.length===0)return hn(this);var l=new this.Collection(this,function(){return Tt(o[0],o[o.length-1])});l._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,o.sort(s)};var c=0;return l._addAlgorithm(function(d,g,v){for(var E=d.key;0<s(E,o[c]);)if(++c===o.length)return g(v),!1;return s(E,o[c])===0||(g(function(){d.continue(o[c])}),!1)}),l},$e.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$e.prototype.noneOf=function(){var n=ve.apply(we,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return tt(this,kt)}var o=n.reduce(function(s,l){return s?s.concat([[s[s.length-1][1],l]]):[[-1/0,l]]},null);return o.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},$e.prototype.inAnyRange=function(j,o){var s=this,l=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(j.length===0)return hn(this);if(!j.every(function(T){return T[0]!==void 0&&T[1]!==void 0&&c(T[0],T[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var E=!o||o.includeLowers!==!1,S=o&&o.includeUppers===!0,O,L=c;function I(T,N){return L(T[0],N[0])}try{(O=j.reduce(function(T,N){for(var V=0,Q=T.length;V<Q;++V){var ae=T[V];if(l(N[0],ae[1])<0&&0<l(N[1],ae[0])){ae[0]=g(ae[0],N[0]),ae[1]=v(ae[1],N[1]);break}}return V===Q&&T.push(N),T},[])).sort(I)}catch{return tt(this,kt)}var M=0,k=S?function(T){return 0<c(T,O[M][1])}:function(T){return 0<=c(T,O[M][1])},P=E?function(T){return 0<d(T,O[M][0])}:function(T){return 0<=d(T,O[M][0])},D=k,j=new this.Collection(this,function(){return Tt(O[0][0],O[O.length-1][1],!E,!S)});return j._ondirectionchange=function(T){L=T==="next"?(D=k,c):(D=P,d),O.sort(I)},j._addAlgorithm(function(T,N,V){for(var Q,ae=T.key;D(ae);)if(++M===O.length)return N(V),!1;return!k(Q=ae)&&!P(Q)||(s._cmp(ae,O[M][1])===0||s._cmp(ae,O[M][0])===0||N(function(){L===c?T.continue(O[M][0]):T.continue(O[M][1])}),!1)}),j},$e.prototype.startsWithAnyOf=function(){var n=ve.apply(we,arguments);return n.every(function(o){return typeof o=="string"})?n.length===0?hn(this):this.inAnyRange(n.map(function(o){return[o,o+Zt]})):tt(this,"startsWithAnyOf() only works with strings")},$e);function $e(){}function bt(n){return Ke(function(o){return On(o),n(o.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",Wr="x-storagemutated-1",Bt=kn(null,_n),ya=(wt.prototype._lock=function(){return F(!he.global),++this._reculock,this._reculock!==1||he.global||(he.lockOwnerFor=this),this},wt.prototype._unlock=function(){if(F(!he.global),--this._reculock==0)for(he.global||(he.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Wt(n[1],n[0])}catch{}}return this},wt.prototype._locked=function(){return this._reculock&&he.lockOwnerFor!==this},wt.prototype.create=function(n){var o=this;if(!this.mode)return this;var s=this.db.idbdb,l=this.db._state.dbOpenError;if(F(!this.idbtrans),!n&&!s)switch(l&&l.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(l);case"MissingAPIError":throw new Y.MissingAPI(l.message,l);default:throw new Y.OpenFailed(l)}if(!this.active)throw new Y.TransactionInactive;return F(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){On(c),o._reject(n.error)}),n.onabort=Ke(function(c){On(c),o.active&&o._reject(new Y.Abort(n.error)),o.active=!1,o.on("abort").fire(c)}),n.oncomplete=Ke(function(){o.active=!1,o._resolve(),"mutatedParts"in n&&Bt.storagemutated.fire(n.mutatedParts)}),this},wt.prototype._promise=function(n,o,s){var l=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new Y.TransactionInactive);if(this._locked())return new ce(function(d,g){l._blockedFuncs.push([function(){l._promise(n,o,s).then(d,g)},he])});if(s)return jt(function(){var d=new ce(function(g,v){l._lock();var E=o(g,v,l);E&&E.then&&E.then(g,v)});return d.finally(function(){return l._unlock()}),d._lib=!0,d});var c=new ce(function(d,g){var v=o(d,g,l);v&&v.then&&v.then(d,g)});return c._lib=!0,c},wt.prototype._root=function(){return this.parent?this.parent._root():this},wt.prototype.waitFor=function(n){var o,s=this._root(),l=ce.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return l}):(s._waitingFor=l,s._waitingQueue=[],o=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(o.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new ce(function(d,g){l.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},wt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Y.Abort))},wt.prototype.table=function(n){var o=this._memoizedTables||(this._memoizedTables={});if(w(o,n))return o[n];var s=this.schema[n];if(!s)throw new Y.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),o[n]=s},wt);function wt(){}function Zr(n,o,s,l,c,d,g,v){return{name:n,keyPath:o,unique:s,multi:l,auto:c,compound:d,src:(s&&!g?"&":"")+(l?"*":"")+(c?"++":"")+Ji(o),type:v}}function Ji(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function $r(n,o,s){return{name:n,primKey:o,indexes:s,mappedClass:null,idxByName:(l=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=l(d,g),g&&(c[g[0]]=g[1]),c},{}))};var l}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return Zt},Zt}};function Vr(n){return n==null?function(){}:typeof n=="string"?(o=n).split(".").length===1?function(s){return s[o]}:function(s){return z(s,o)}:function(s){return z(s,n)};var o}function Qi(n){return[].slice.call(n)}var ba=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function wa(n,o,E){function l(D){if(D.type===3)return null;if(D.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var M=D.lower,k=D.upper,P=D.lowerOpen,D=D.upperOpen;return M===void 0?k===void 0?null:o.upperBound(k,!!D):k===void 0?o.lowerBound(M,!!P):o.bound(M,k,!!P,!!D)}function c(I){var M,k=I.name;return{name:k,schema:I,mutate:function(P){var D=P.trans,j=P.type,T=P.keys,N=P.values,V=P.range;return new Promise(function(Q,ae){Q=Ke(Q);var J=D.objectStore(k),te=J.keyPath==null,le=j==="put"||j==="add";if(!le&&j!=="delete"&&j!=="deleteRange")throw new Error("Invalid operation type: "+j);var re,pe=(T||N||{length:1}).length;if(T&&N&&T.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(pe===0)return Q({numFailures:0,failures:{},results:[],lastResult:void 0});function Ee(Qe){++nt,On(Qe)}var Pe=[],Oe=[],nt=0;if(j==="deleteRange"){if(V.type===4)return Q({numFailures:nt,failures:Oe,results:[],lastResult:void 0});V.type===3?Pe.push(re=J.clear()):Pe.push(re=J.delete(l(V)))}else{var te=le?te?[N,T]:[N,null]:[T,null],Ce=te[0],He=te[1];if(le)for(var Ge=0;Ge<pe;++Ge)Pe.push(re=He&&He[Ge]!==void 0?J[j](Ce[Ge],He[Ge]):J[j](Ce[Ge])),re.onerror=Ee;else for(Ge=0;Ge<pe;++Ge)Pe.push(re=J[j](Ce[Ge])),re.onerror=Ee}function mr(Qe){Qe=Qe.target.result,Pe.forEach(function(Gt,fi){return Gt.error!=null&&(Oe[fi]=Gt.error)}),Q({numFailures:nt,failures:Oe,results:j==="delete"?T:Pe.map(function(Gt){return Gt.result}),lastResult:Qe})}re.onerror=function(Qe){Ee(Qe),mr(Qe)},re.onsuccess=mr})},getMany:function(P){var D=P.trans,j=P.keys;return new Promise(function(T,N){T=Ke(T);for(var V,Q=D.objectStore(k),ae=j.length,J=new Array(ae),te=0,le=0,re=function(Pe){Pe=Pe.target,J[Pe._pos]=Pe.result,++le===te&&T(J)},pe=bt(N),Ee=0;Ee<ae;++Ee)j[Ee]!=null&&((V=Q.get(j[Ee]))._pos=Ee,V.onsuccess=re,V.onerror=pe,++te);te===0&&T(J)})},get:function(P){var D=P.trans,j=P.key;return new Promise(function(T,N){T=Ke(T);var V=D.objectStore(k).get(j);V.onsuccess=function(Q){return T(Q.target.result)},V.onerror=bt(N)})},query:(M=S,function(P){return new Promise(function(D,j){D=Ke(D);var T,N,V,te=P.trans,Q=P.values,ae=P.limit,re=P.query,J=ae===1/0?void 0:ae,le=re.index,re=re.range,te=te.objectStore(k),le=le.isPrimaryKey?te:te.index(le.name),re=l(re);if(ae===0)return D({result:[]});M?((J=Q?le.getAll(re,J):le.getAllKeys(re,J)).onsuccess=function(pe){return D({result:pe.target.result})},J.onerror=bt(j)):(T=0,N=!Q&&"openKeyCursor"in le?le.openKeyCursor(re):le.openCursor(re),V=[],N.onsuccess=function(pe){var Ee=N.result;return Ee?(V.push(Q?Ee.value:Ee.primaryKey),++T===ae?D({result:V}):void Ee.continue()):D({result:V})},N.onerror=bt(j))})}),openCursor:function(P){var D=P.trans,j=P.values,T=P.query,N=P.reverse,V=P.unique;return new Promise(function(Q,ae){Q=Ke(Q);var le=T.index,J=T.range,te=D.objectStore(k),te=le.isPrimaryKey?te:te.index(le.name),le=N?V?"prevunique":"prev":V?"nextunique":"next",re=!j&&"openKeyCursor"in te?te.openKeyCursor(l(J),le):te.openCursor(l(J),le);re.onerror=bt(ae),re.onsuccess=Ke(function(pe){var Ee,Pe,Oe,nt,Ce=re.result;Ce?(Ce.___id=++ba,Ce.done=!1,Ee=Ce.continue.bind(Ce),Pe=(Pe=Ce.continuePrimaryKey)&&Pe.bind(Ce),Oe=Ce.advance.bind(Ce),nt=function(){throw new Error("Cursor not stopped")},Ce.trans=D,Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=function(){throw new Error("Cursor not started")},Ce.fail=Ke(ae),Ce.next=function(){var He=this,Ge=1;return this.start(function(){return Ge--?He.continue():He.stop()}).then(function(){return He})},Ce.start=function(He){function Ge(){if(re.result)try{He()}catch(Qe){Ce.fail(Qe)}else Ce.done=!0,Ce.start=function(){throw new Error("Cursor behind last entry")},Ce.stop()}var mr=new Promise(function(Qe,Gt){Qe=Ke(Qe),re.onerror=bt(Gt),Ce.fail=Gt,Ce.stop=function(fi){Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=nt,Qe(fi)}});return re.onsuccess=Ke(function(Qe){re.onsuccess=Ge,Ge()}),Ce.continue=Ee,Ce.continuePrimaryKey=Pe,Ce.advance=Oe,Ge(),mr},Q(Ce)):Q(null)},ae)})},count:function(P){var D=P.query,j=P.trans,T=D.index,N=D.range;return new Promise(function(V,Q){var ae=j.objectStore(k),J=T.isPrimaryKey?ae:ae.index(T.name),ae=l(N),J=ae?J.count(ae):J.count();J.onsuccess=Ke(function(te){return V(te.target.result)}),J.onerror=bt(Q)})}}}var d,g,v,O=(g=E,v=Qi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(I){return g.objectStore(I)}).map(function(I){var M=I.keyPath,D=I.autoIncrement,k=h(M),P={},D={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:M==null,compound:k,keyPath:M,autoIncrement:D,unique:!0,extractKey:Vr(M)},indexes:Qi(I.indexNames).map(function(j){return I.index(j)}).map(function(V){var T=V.name,N=V.unique,Q=V.multiEntry,V=V.keyPath,Q={name:T,compound:h(V),keyPath:V,unique:N,multiEntry:Q,extractKey:Vr(V)};return P[In(V)]=Q}),getIndexByKeyPath:function(j){return P[In(j)]}};return P[":id"]=D.primaryKey,M!=null&&(P[In(M)]=D.primaryKey),D})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),E=O.schema,S=O.hasGetAll,O=E.tables.map(c),L={};return O.forEach(function(I){return L[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(!L[I])throw new Error("Table '".concat(I,"' not found"));return L[I]},MIN_KEY:-1/0,MAX_KEY:Dn(o),schema:E}}function La(n,o,s,l){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(l=wa(o,c,l),n.dbcore.reduce(function(d,g){return g=g.create,i(i({},d),g(d))},l))}}function or(n,l){var s=l.db,l=La(n._middlewares,s,n._deps,l);n.core=l.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function sr(n,o,s,l){s.forEach(function(c){var d=l[c];o.forEach(function(g){var v=(function E(S,O){return B(S,O)||(S=b(S))&&E(S,O)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?x(g,c,{get:function(){return this.table(c)},set:function(E){_(this,c,{value:E,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function Hr(n,o){o.forEach(function(s){for(var l in s)s[l]instanceof n.Table&&delete s[l]})}function xa(n,o){return n._cfg.version-o._cfg.version}function Ca(n,o,s,l){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=$r("$meta",to("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(l);var g=d._reject.bind(d),v=he.transless||he;jt(function(){return he.trans=d,he.transless=v,o!==0?(or(n,s),S=o,((E=d).storeNames.includes("$meta")?E.table("$meta").get("version").then(function(O){return O??S}):ce.resolve(S)).then(function(O){return I=O,M=d,k=s,P=[],O=(L=n)._versions,D=L._dbSchema=lr(0,L.idbdb,k),(O=O.filter(function(j){return j._cfg.version>=I})).length!==0?(O.forEach(function(j){P.push(function(){var T=D,N=j._cfg.dbschema;ur(L,T,k),ur(L,N,k),D=L._dbSchema=N;var V=Gr(T,N);V.add.forEach(function(le){Yr(k,le[0],le[1].primKey,le[1].indexes)}),V.change.forEach(function(le){if(le.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var re=k.objectStore(le.name);le.add.forEach(function(pe){return ar(re,pe)}),le.change.forEach(function(pe){re.deleteIndex(pe.name),ar(re,pe)}),le.del.forEach(function(pe){return re.deleteIndex(pe)})});var Q=j._cfg.contentUpgrade;if(Q&&j._cfg.version>I){or(L,k),M._memoizedTables={};var ae=H(N);V.del.forEach(function(le){ae[le]=T[le]}),Hr(L,[L.Transaction.prototype]),sr(L,[L.Transaction.prototype],p(ae),ae),M.schema=ae;var J,te=Le(Q);return te&&fn(),V=ce.follow(function(){var le;(J=Q(M))&&te&&(le=Rt.bind(null,null),J.then(le,le))}),J&&typeof J.then=="function"?ce.resolve(J):V.then(function(){return J})}}),P.push(function(T){var N,V,Q=j._cfg.dbschema;N=Q,V=T,[].slice.call(V.db.objectStoreNames).forEach(function(ae){return N[ae]==null&&V.db.deleteObjectStore(ae)}),Hr(L,[L.Transaction.prototype]),sr(L,[L.Transaction.prototype],L._storeNames,L._dbSchema),M.schema=L._dbSchema}),P.push(function(T){L.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(L.idbdb.version/10)===j._cfg.version?(L.idbdb.deleteObjectStore("$meta"),delete L._dbSchema.$meta,L._storeNames=L._storeNames.filter(function(N){return N!=="$meta"})):T.objectStore("$meta").put(j._cfg.version,"version"))})}),(function j(){return P.length?ce.resolve(P.shift()(M.idbtrans)).then(j):ce.resolve()})().then(function(){eo(D,k)})):ce.resolve();var L,I,M,k,P,D}).catch(g)):(p(c).forEach(function(O){Yr(s,O,c[O].primKey,c[O].indexes)}),or(n,s),void ce.follow(function(){return n.on.populate.fire(d)}).catch(g));var E,S})}function Ea(n,o){eo(n._dbSchema,o),o.db.version%10!=0||o.objectStoreNames.contains("$meta")||o.db.createObjectStore("$meta").add(Math.ceil(o.db.version/10-1),"version");var s=lr(0,n.idbdb,o);ur(n,n._dbSchema,o);for(var l=0,c=Gr(s,n._dbSchema).change;l<c.length;l++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=o.objectStore(g.name);g.add.forEach(function(E){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(E.src)),ar(v,E)})})(c[l]);if(typeof d=="object")return d.value}}function Gr(n,o){var s,l={del:[],add:[],change:[]};for(s in n)o[s]||l.del.push(s);for(s in o){var c=n[s],d=o[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,l.change.push(g);else{var v=c.idxByName,E=d.idxByName,S=void 0;for(S in v)E[S]||g.del.push(S);for(S in E){var O=v[S],L=E[S];O?O.src!==L.src&&g.change.push(L):g.add.push(L)}(0<g.del.length||0<g.add.length||0<g.change.length)&&l.change.push(g)}}else l.add.push([s,d])}return l}function Yr(n,o,s,l){var c=n.db.createObjectStore(o,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return l.forEach(function(d){return ar(c,d)}),c}function eo(n,o){p(n).forEach(function(s){o.db.objectStoreNames.contains(s)||(Je&&console.debug("Dexie: Creating missing table",s),Yr(o,s,n[s].primKey,n[s].indexes))})}function ar(n,o){n.createIndex(o.name,o.keyPath,{unique:o.unique,multiEntry:o.multi})}function lr(n,o,s){var l={};return q(o.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Zr(Ji(S=d.keyPath),S||"",!0,!1,!!d.autoIncrement,S&&typeof S!="string",!0),v=[],E=0;E<d.indexNames.length;++E){var O=d.index(d.indexNames[E]),S=O.keyPath,O=Zr(O.name,S,!!O.unique,!!O.multiEntry,!1,S&&typeof S!="string",!1);v.push(O)}l[c]=$r(c,g,v)}),l}function ur(n,o,s){for(var l=s.db.objectStoreNames,c=0;c<l.length;++c){var d=l[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var E=g.indexNames[v],S=g.index(E).keyPath,O=typeof S=="string"?S:"["+q(S).join("+")+"]";!o[d]||(S=o[d].idxByName[O])&&(S.name=E,delete o[d].idxByName[O],o[d].idxByName[E]=S)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function to(n){return n.split(",").map(function(o,s){var d=o.split(":"),l=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(o=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Zr(c,d||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),h(d),s===0,l)})}var Sa=(gn.prototype._createTableSchema=$r,gn.prototype._parseIndexSyntax=to,gn.prototype._parseStoresSpec=function(n,o){var s=this;p(n).forEach(function(l){if(n[l]!==null){var c=s._parseIndexSyntax(n[l]),d=c.shift();if(!d)throw new Y.Schema("Invalid schema for table "+l+": "+n[l]);if(d.unique=!0,d.multi)throw new Y.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(l,d,c),o[l]=c}})},gn.prototype.stores=function(s){var o=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=o._versions,l={},c={};return s.forEach(function(d){m(l,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(l,c)}),o._dbSchema=c,Hr(o,[o._allTables,o,o.Transaction.prototype]),sr(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],p(c),c),o._storeNames=p(c),this},gn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=on(this._cfg.contentUpgrade||ke,n),this},gn);function gn(){}function Xr(n,o){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new Pt(Qn,{addons:[],indexedDB:n,IDBKeyRange:o})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Jr(n){return n&&typeof n.databases=="function"}function Qr(n){return jt(function(){return he.letThrough=!0,n()})}function ei(n){return!("from"in n)}var Ve=function(n,o){if(!this){var s=new Ve;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?o:n}:{d:0})};function jn(n,o,s){var l=Ae(o,s);if(!isNaN(l)){if(0<l)throw RangeError();if(ei(n))return m(n,{from:o,to:s,d:1});var c=n.l,l=n.r;if(Ae(s,n.from)<0)return c?jn(c,o,s):n.l={from:o,to:s,d:1,l:null,r:null},ro(n);if(0<Ae(o,n.to))return l?jn(l,o,s):n.r={from:o,to:s,d:1,l:null,r:null},ro(n);Ae(o,n.from)<0&&(n.from=o,n.l=null,n.d=l?l.d+1:1),0<Ae(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),l&&s&&Rn(n,l)}}function Rn(n,o){ei(o)||(function s(l,E){var d=E.from,g=E.to,v=E.l,E=E.r;jn(l,d,g),v&&s(l,v),E&&s(l,E)})(n,o)}function no(n,o){var s=cr(o),l=s.next();if(l.done)return!1;for(var c=l.value,d=cr(n),g=d.next(c.from),v=g.value;!l.done&&!g.done;){if(Ae(v.from,c.to)<=0&&0<=Ae(v.to,c.from))return!0;Ae(c.from,v.from)<0?c=(l=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function cr(n){var o=ei(n)?null:{s:0,n};return{next:function(s){for(var l=0<arguments.length;o;)switch(o.s){case 0:if(o.s=1,l)for(;o.n.l&&Ae(s,o.n.from)<0;)o={up:o,n:o.n.l,s:1};else for(;o.n.l;)o={up:o,n:o.n.l,s:1};case 1:if(o.s=2,!l||Ae(s,o.n.to)<=0)return{value:o.n,done:!1};case 2:if(o.n.r){o.s=3,o={up:o,n:o.n.r,s:0};continue}case 3:o=o.up}return{done:!0}}}}function ro(n){var o,s,l=(((o=n.r)===null||o===void 0?void 0:o.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<l?"r":l<-1?"l":"";c&&(o=c=="r"?"l":"r",s=i({},n),l=n[c],n.from=l.from,n.to=l.to,n[c]=l[c],s[c]=l[o],(n[o]=s).d=io(s)),n.d=io(n)}function io(s){var o=s.r,s=s.l;return(o?s?Math.max(o.d,s.d):o.d:s?s.d:0)+1}function fr(n,o){return p(o).forEach(function(s){n[s]?Rn(n[s],o[s]):n[s]=(function l(c){var d,g,v={};for(d in c)w(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||ee.has(g.constructor)?g:l(g));return v})(o[s])}),n}function ti(n,o){return n.all||o.all||Object.keys(n).some(function(s){return o[s]&&no(o[s],n[s])})}C(Ve.prototype,((lt={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var o=this;return n.forEach(function(s){return jn(o,s,s)}),this},hasKey:function(n){var o=cr(this).next(n).value;return o&&Ae(o.from,n)<=0&&0<=Ae(o.to,n)}})[me]=function(){return cr(this)},lt));var Vt={},ni={},ri=!1;function dr(n){fr(ni,n),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(n,o){o===void 0&&(o=!1);var s=new Set;if(n.all)for(var l=0,c=Object.values(Vt);l<c.length;l++)oo(g=c[l],n,s,o);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Vt["idb://".concat(d,"/").concat(v)])&&oo(g,n,s,o))}s.forEach(function(E){return E()})}function oo(n,o,s,l){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],E=v[0],S=[],O=0,L=v[1];O<L.length;O++){var I=L[O];ti(o,I.obsSet)?I.subscribers.forEach(function(D){return s.add(D)}):l&&S.push(I)}l&&c.push([E,S])}if(l)for(var M=0,k=c;M<k.length;M++){var P=k[M],E=P[0],S=P[1];n.queries.query[E]=S}}function Ma(n){var o=n._state,s=n._deps.indexedDB;if(o.isBeingOpened||n.idbdb)return o.dbReadyPromise.then(function(){return o.dbOpenError?Ne(o.dbOpenError):n});o.isBeingOpened=!0,o.dbOpenError=null,o.openComplete=!1;var l=o.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(o.openCanceller!==l)throw new Y.DatabaseClosed("db.open() was cancelled")}function v(){return new ce(function(I,M){if(g(),!s)throw new Y.MissingAPI;var k=n.name,P=o.autoSchema||!c?s.open(k):s.open(k,c);if(!P)throw new Y.MissingAPI;P.onerror=bt(M),P.onblocked=Ke(n._fireOnBlocked),P.onupgradeneeded=Ke(function(D){var j;O=P.transaction,o.autoSchema&&!n._options.allowEmptyDB?(P.onerror=On,O.abort(),P.result.close(),(j=s.deleteDatabase(k)).onsuccess=j.onerror=Ke(function(){M(new Y.NoSuchDatabase("Database ".concat(k," doesnt exist")))})):(O.onerror=bt(M),D=D.oldVersion>Math.pow(2,62)?0:D.oldVersion,L=D<1,n.idbdb=P.result,d&&Ea(n,O),Ca(n,D/10,O,M))},M),P.onsuccess=Ke(function(){O=null;var D,j,T,N,V,Q=n.idbdb=P.result,ae=q(Q.objectStoreNames);if(0<ae.length)try{var J=Q.transaction((N=ae).length===1?N[0]:N,"readonly");if(o.autoSchema)j=Q,T=J,(D=n).verno=j.version/10,T=D._dbSchema=lr(0,j,T),D._storeNames=q(j.objectStoreNames,0),sr(D,[D._allTables],p(T),T);else if(ur(n,n._dbSchema,J),((V=Gr(lr(0,(V=n).idbdb,J),V._dbSchema)).add.length||V.change.some(function(te){return te.add.length||te.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Q.close(),c=Q.version+1,d=!0,I(v());or(n,J)}catch{}dn.push(n),Q.onversionchange=Ke(function(te){o.vcFired=!0,n.on("versionchange").fire(te)}),Q.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),L&&(V=n._deps,J=k,Q=V.indexedDB,V=V.IDBKeyRange,Jr(Q)||J===Qn||Xr(Q,V).put({name:J}).catch(ke)),I()},M)}).catch(function(I){switch(I?.name){case"UnknownError":if(0<o.PR1398_maxLoop)return o.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return ce.reject(I)})}var E,S=o.dbReadyResolve,O=null,L=!1;return ce.race([l,(typeof navigator>"u"?ce.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function M(){return indexedDB.databases().finally(I)}E=setInterval(M,100),M()}).finally(function(){return clearInterval(E)}):Promise.resolve()).then(v)]).then(function(){return g(),o.onReadyBeingFired=[],ce.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function I(){if(0<o.onReadyBeingFired.length){var M=o.onReadyBeingFired.reduce(on,ke);return o.onReadyBeingFired=[],ce.resolve(Qr(function(){return M(n.vip)})).then(I)}})}).finally(function(){o.openCanceller===l&&(o.onReadyBeingFired=null,o.isBeingOpened=!1)}).catch(function(I){o.dbOpenError=I;try{O&&O.abort()}catch{}return l===o.openCanceller&&n._close(),Ne(I)}).finally(function(){o.openComplete=!0,S()}).then(function(){var I;return L&&(I={},n.tables.forEach(function(M){M.schema.indexes.forEach(function(k){k.name&&(I["idb://".concat(n.name,"/").concat(M.name,"/").concat(k.name)]=new Ve(-1/0,[[[]]]))}),I["idb://".concat(n.name,"/").concat(M.name,"/")]=I["idb://".concat(n.name,"/").concat(M.name,"/:dels")]=new Ve(-1/0,[[[]]])}),Bt(_n).fire(I),ii(I,!0)),n})}function oi(n){function o(d){return n.next(d)}var s=c(o),l=c(function(d){return n.throw(d)});function c(d){return function(E){var v=d(E),E=v.value;return v.done?E:E&&typeof E.then=="function"?E.then(s,l):h(E)?Promise.all(E).then(s,l):s(E)}}return c(o)()}function pr(n,o,s){for(var l=h(n)?n.slice():[n],c=0;c<s;++c)l.push(o);return l}var ka={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),l=s.schema,c={},d=[];function g(L,I,M){var k=In(L),P=c[k]=c[k]||[],D=L==null?0:typeof L=="string"?1:L.length,j=0<I,j=i(i({},M),{name:j?"".concat(k,"(virtual-from:").concat(M.name,")"):M.name,lowLevelIndex:M,isVirtual:j,keyTail:I,keyLength:D,extractKey:Vr(L),unique:!j&&M.unique});return P.push(j),j.isPrimaryKey||d.push(j),1<D&&g(D===2?L[0]:L.slice(0,D-1),I+1,M),P.sort(function(T,N){return T.keyTail-N.keyTail}),j}o=g(l.primaryKey.keyPath,0,l.primaryKey),c[":id"]=[o];for(var v=0,E=l.indexes;v<E.length;v++){var S=E[v];g(S.keyPath,0,S)}function O(L){var I,M=L.query.index;return M.isVirtual?i(i({},L),{query:{index:M.lowLevelIndex,range:(I=L.query.range,M=M.keyTail,{type:I.type===1?2:I.type,lower:pr(I.lower,I.lowerOpen?n.MAX_KEY:n.MIN_KEY,M),lowerOpen:!0,upper:pr(I.upper,I.upperOpen?n.MIN_KEY:n.MAX_KEY,M),upperOpen:!0})}}):L}return i(i({},s),{schema:i(i({},l),{primaryKey:o,indexes:d,getIndexByKeyPath:function(L){return(L=c[In(L)])&&L[0]}}),count:function(L){return s.count(O(L))},query:function(L){return s.query(O(L))},openCursor:function(L){var I=L.query.index,M=I.keyTail,k=I.isVirtual,P=I.keyLength;return k?s.openCursor(O(L)).then(function(j){return j&&D(j)}):s.openCursor(L);function D(j){return Object.create(j,{continue:{value:function(T){T!=null?j.continue(pr(T,L.reverse?n.MAX_KEY:n.MIN_KEY,M)):L.unique?j.continue(j.key.slice(0,P).concat(L.reverse?n.MIN_KEY:n.MAX_KEY,M)):j.continue()}},continuePrimaryKey:{value:function(T,N){j.continuePrimaryKey(pr(T,n.MAX_KEY,M),N)}},primaryKey:{get:function(){return j.primaryKey}},key:{get:function(){var T=j.key;return P===1?T[0]:T.slice(0,P)}},value:{get:function(){return j.value}}})}}})}})}};function si(n,o,s,l){return s=s||{},l=l||"",p(n).forEach(function(c){var d,g,v;w(o,c)?(d=n[c],g=o[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=fe(d))!==fe(g)?s[l+c]=o[c]:v==="Object"?si(d,g,s,l+c+"."):d!==g&&(s[l+c]=o[c]):d!==g&&(s[l+c]=o[c])):s[l+c]=void 0}),p(o).forEach(function(c){w(n,c)||(s[l+c]=o[c])}),s}function ai(n,o){return o.type==="delete"?o.keys:o.keys||o.values.map(n.extractKey)}var Pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),l=s.schema.primaryKey;return i(i({},s),{mutate:function(c){var d=he.trans,g=d.table(o).hook,v=g.deleting,E=g.creating,S=g.updating;switch(c.type){case"add":if(E.fire===ke)break;return d._promise("readwrite",function(){return O(c)},!0);case"put":if(E.fire===ke&&S.fire===ke)break;return d._promise("readwrite",function(){return O(c)},!0);case"delete":if(v.fire===ke)break;return d._promise("readwrite",function(){return O(c)},!0);case"deleteRange":if(v.fire===ke)break;return d._promise("readwrite",function(){return(function L(I,M,k){return s.query({trans:I,values:!1,query:{index:l,range:M},limit:k}).then(function(P){var D=P.result;return O({type:"delete",keys:D,trans:I}).then(function(j){return 0<j.numFailures?Promise.reject(j.failures[0]):D.length<k?{failures:[],numFailures:0,lastResult:void 0}:L(I,i(i({},M),{lower:D[D.length-1],lowerOpen:!0}),k)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function O(L){var I,M,k,P=he.trans,D=L.keys||ai(l,L);if(!D)throw new Error("Keys missing");return(L=L.type==="add"||L.type==="put"?i(i({},L),{keys:D}):i({},L)).type!=="delete"&&(L.values=a([],L.values)),L.keys&&(L.keys=a([],L.keys)),I=s,k=D,((M=L).type==="add"?Promise.resolve([]):I.getMany({trans:M.trans,keys:k,cache:"immutable"})).then(function(j){var T=D.map(function(N,V){var Q,ae,J,te=j[V],le={onerror:null,onsuccess:null};return L.type==="delete"?v.fire.call(le,N,te,P):L.type==="add"||te===void 0?(Q=E.fire.call(le,N,L.values[V],P),N==null&&Q!=null&&(L.keys[V]=N=Q,l.outbound||W(L.values[V],l.keyPath,N))):(Q=si(te,L.values[V]),(ae=S.fire.call(le,Q,N,te,P))&&(J=L.values[V],Object.keys(ae).forEach(function(re){w(J,re)?J[re]=ae[re]:W(J,re,ae[re])}))),le});return s.mutate(L).then(function(N){for(var V=N.failures,Q=N.results,ae=N.numFailures,N=N.lastResult,J=0;J<D.length;++J){var te=(Q||D)[J],le=T[J];te==null?le.onerror&&le.onerror(V[J]):le.onsuccess&&le.onsuccess(L.type==="put"&&j[J]?L.values[J]:te)}return{failures:V,results:Q,numFailures:ae,lastResult:N}}).catch(function(N){return T.forEach(function(V){return V.onerror&&V.onerror(N)}),Promise.reject(N)})})}}})}})}};function so(n,o,s){try{if(!o||o.keys.length<n.length)return null;for(var l=[],c=0,d=0;c<o.keys.length&&d<n.length;++c)Ae(o.keys[c],n[d])===0&&(l.push(s?ue(o.values[c]):o.values[c]),++d);return l.length===n.length?l:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(n){return{table:function(o){var s=n.table(o);return i(i({},s),{getMany:function(l){if(!l.cache)return s.getMany(l);var c=so(l.keys,l.trans._cache,l.cache==="clone");return c?ce.resolve(c):s.getMany(l).then(function(d){return l.trans._cache={keys:l.keys,values:l.cache==="clone"?ue(d):d},d})},mutate:function(l){return l.type!=="add"&&(l.trans._cache=null),s.mutate(l)}})}}}};function ao(n,o){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!o.schema.primaryKey.outbound}function lo(n,o){switch(n){case"query":return o.values&&!o.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var o=n.schema.name,s=new Ve(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(l,c,d){if(he.subscr&&c!=="readonly")throw new Y.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(he.querier));return n.transaction(l,c,d)},table:function(l){var c=n.table(l),d=c.schema,g=d.primaryKey,L=d.indexes,v=g.extractKey,E=g.outbound,S=g.autoIncrement&&L.filter(function(M){return M.compound&&M.keyPath.includes(g.keyPath)}),O=i(i({},c),{mutate:function(M){function k(re){return re="idb://".concat(o,"/").concat(l,"/").concat(re),N[re]||(N[re]=new Ve)}var P,D,j,T=M.trans,N=M.mutatedParts||(M.mutatedParts={}),V=k(""),Q=k(":dels"),ae=M.type,le=M.type==="deleteRange"?[M.range]:M.type==="delete"?[M.keys]:M.values.length<50?[ai(g,M).filter(function(re){return re}),M.values]:[],J=le[0],te=le[1],le=M.trans._cache;return h(J)?(V.addKeys(J),(le=ae==="delete"||J.length===te.length?so(J,le):null)||Q.addKeys(J),(le||te)&&(P=k,D=le,j=te,d.indexes.forEach(function(re){var pe=P(re.name||"");function Ee(Oe){return Oe!=null?re.extractKey(Oe):null}function Pe(Oe){return re.multiEntry&&h(Oe)?Oe.forEach(function(nt){return pe.addKey(nt)}):pe.addKey(Oe)}(D||j).forEach(function(Oe,He){var Ce=D&&Ee(D[He]),He=j&&Ee(j[He]);Ae(Ce,He)!==0&&(Ce!=null&&Pe(Ce),He!=null&&Pe(He))})}))):J?(te={from:(te=J.lower)!==null&&te!==void 0?te:n.MIN_KEY,to:(te=J.upper)!==null&&te!==void 0?te:n.MAX_KEY},Q.add(te),V.add(te)):(V.add(s),Q.add(s),d.indexes.forEach(function(re){return k(re.name).add(s)})),c.mutate(M).then(function(re){return!J||M.type!=="add"&&M.type!=="put"||(V.addKeys(re.results),S&&S.forEach(function(pe){for(var Ee=M.values.map(function(Ce){return pe.extractKey(Ce)}),Pe=pe.keyPath.findIndex(function(Ce){return Ce===g.keyPath}),Oe=0,nt=re.results.length;Oe<nt;++Oe)Ee[Oe][Pe]=re.results[Oe];k(pe.name).addKeys(Ee)})),T.mutatedParts=fr(T.mutatedParts||{},N),re})}}),L=function(k){var P=k.query,k=P.index,P=P.range;return[k,new Ve((k=P.lower)!==null&&k!==void 0?k:n.MIN_KEY,(P=P.upper)!==null&&P!==void 0?P:n.MAX_KEY)]},I={get:function(M){return[g,new Ve(M.key)]},getMany:function(M){return[g,new Ve().addKeys(M.keys)]},count:L,query:L,openCursor:L};return p(I).forEach(function(M){O[M]=function(k){var P=he.subscr,D=!!P,j=ao(he,c)&&lo(M,k)?k.obsSet={}:P;if(D){var T=function(te){return te="idb://".concat(o,"/").concat(l,"/").concat(te),j[te]||(j[te]=new Ve)},N=T(""),V=T(":dels"),P=I[M](k),D=P[0],P=P[1];if((M==="query"&&D.isPrimaryKey&&!k.values?V:T(D.name||"")).add(P),!D.isPrimaryKey){if(M!=="count"){var Q=M==="query"&&E&&k.values&&c.query(i(i({},k),{values:!1}));return c[M].apply(this,arguments).then(function(te){if(M==="query"){if(E&&k.values)return Q.then(function(Ee){return Ee=Ee.result,N.addKeys(Ee),te});var le=k.values?te.result.map(v):te.result;(k.values?N:V).addKeys(le)}else if(M==="openCursor"){var re=te,pe=k.values;return re&&Object.create(re,{key:{get:function(){return V.addKey(re.primaryKey),re.key}},primaryKey:{get:function(){var Ee=re.primaryKey;return V.addKey(Ee),Ee}},value:{get:function(){return pe&&N.addKey(re.primaryKey),re.value}}})}return te})}V.add(s)}}return c[M].apply(this,arguments)}}),O}})}};function uo(n,o,s){if(s.numFailures===0)return o;if(o.type==="deleteRange")return null;var l=o.keys?o.keys.length:"values"in o&&o.values?o.values.length:1;return s.numFailures===l?null:(o=i({},o),h(o.keys)&&(o.keys=o.keys.filter(function(c,d){return!(d in s.failures)})),"values"in o&&h(o.values)&&(o.values=o.values.filter(function(c,d){return!(d in s.failures)})),o)}function li(n,o){return s=n,((l=o).lower===void 0||(l.lowerOpen?0<Ae(s,l.lower):0<=Ae(s,l.lower)))&&(n=n,(o=o).upper===void 0||(o.upperOpen?Ae(n,o.upper)<0:Ae(n,o.upper)<=0));var s,l}function co(n,o,I,l,c,d){if(!I||I.length===0)return n;var g=o.query.index,v=g.multiEntry,E=o.query.range,S=l.schema.primaryKey.extractKey,O=g.extractKey,L=(g.lowLevelIndex||g).extractKey,I=I.reduce(function(M,k){var P=M,D=[];if(k.type==="add"||k.type==="put")for(var j=new Ve,T=k.values.length-1;0<=T;--T){var N,V=k.values[T],Q=S(V);j.hasKey(Q)||(N=O(V),(v&&h(N)?N.some(function(re){return li(re,E)}):li(N,E))&&(j.addKey(Q),D.push(V)))}switch(k.type){case"add":var ae=new Ve().addKeys(o.values?M.map(function(pe){return S(pe)}):M),P=M.concat(o.values?D.filter(function(pe){return pe=S(pe),!ae.hasKey(pe)&&(ae.addKey(pe),!0)}):D.map(function(pe){return S(pe)}).filter(function(pe){return!ae.hasKey(pe)&&(ae.addKey(pe),!0)}));break;case"put":var J=new Ve().addKeys(k.values.map(function(pe){return S(pe)}));P=M.filter(function(pe){return!J.hasKey(o.values?S(pe):pe)}).concat(o.values?D:D.map(function(pe){return S(pe)}));break;case"delete":var te=new Ve().addKeys(k.keys);P=M.filter(function(pe){return!te.hasKey(o.values?S(pe):pe)});break;case"deleteRange":var le=k.range;P=M.filter(function(pe){return!li(S(pe),le)})}return P},n);return I===n?n:(I.sort(function(M,k){return Ae(L(M),L(k))||Ae(S(M),S(k))}),o.limit&&o.limit<1/0&&(I.length>o.limit?I.length=o.limit:n.length===o.limit&&I.length<o.limit&&(c.dirty=!0)),d?Object.freeze(I):I)}function fo(n,o){return Ae(n.lower,o.lower)===0&&Ae(n.upper,o.upper)===0&&!!n.lowerOpen==!!o.lowerOpen&&!!n.upperOpen==!!o.upperOpen}function Da(n,o){return(function(s,l,c,d){if(s===void 0)return l!==void 0?-1:0;if(l===void 0)return 1;if((l=Ae(s,l))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return l})(n.lower,o.lower,n.lowerOpen,o.lowerOpen)<=0&&0<=(function(s,l,c,d){if(s===void 0)return l!==void 0?1:0;if(l===void 0)return-1;if((l=Ae(s,l))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return l})(n.upper,o.upper,n.upperOpen,o.upperOpen)}function Ia(n,o,s,l){n.subscribers.add(s),l.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=o,setTimeout(function(){c.subscribers.size===0&&de(d,c)},3e3))})}var ja={stack:"dbcore",level:0,name:"Cache",create:function(n){var o=n.schema.name;return i(i({},n),{transaction:function(s,l,c){var d,g,v=n.transaction(s,l,c);return l==="readwrite"&&(g=(d=new AbortController).signal,c=function(E){return function(){if(d.abort(),l==="readwrite"){for(var S=new Set,O=0,L=s;O<L.length;O++){var I=L[O],M=Vt["idb://".concat(o,"/").concat(I)];if(M){var k=n.table(I),P=M.optimisticOps.filter(function(pe){return pe.trans===v});if(v._explicit&&E&&v.mutatedParts)for(var D=0,j=Object.values(M.queries.query);D<j.length;D++)for(var T=0,N=(ae=j[D]).slice();T<N.length;T++)ti((J=N[T]).obsSet,v.mutatedParts)&&(de(ae,J),J.subscribers.forEach(function(pe){return S.add(pe)}));else if(0<P.length){M.optimisticOps=M.optimisticOps.filter(function(pe){return pe.trans!==v});for(var V=0,Q=Object.values(M.queries.query);V<Q.length;V++)for(var ae,J,te,le=0,re=(ae=Q[V]).slice();le<re.length;le++)(J=re[le]).res!=null&&v.mutatedParts&&(E&&!J.dirty?(te=Object.isFrozen(J.res),te=co(J.res,J.req,P,k,J,te),J.dirty?(de(ae,J),J.subscribers.forEach(function(pe){return S.add(pe)})):te!==J.res&&(J.res=te,J.promise=ce.resolve({result:te}))):(J.dirty&&de(ae,J),J.subscribers.forEach(function(pe){return S.add(pe)})))}}}S.forEach(function(pe){return pe()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var l=n.table(s),c=l.schema.primaryKey;return i(i({},l),{mutate:function(d){var g=he.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return l.mutate(d);var v=Vt["idb://".concat(o,"/").concat(s)];return v?(g=l.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ai(c,d).some(function(E){return E==null}))?(v.optimisticOps.push(d),d.mutatedParts&&dr(d.mutatedParts),g.then(function(E){0<E.numFailures&&(de(v.optimisticOps,d),(E=uo(0,d,E))&&v.optimisticOps.push(E),d.mutatedParts&&dr(d.mutatedParts))}),g.catch(function(){de(v.optimisticOps,d),d.mutatedParts&&dr(d.mutatedParts)})):g.then(function(E){var S=uo(0,i(i({},d),{values:d.values.map(function(O,L){var I;return E.failures[L]?O:(O=(I=c.keyPath)!==null&&I!==void 0&&I.includes(".")?ue(O):i({},O),W(O,c.keyPath,E.results[L]),O)})}),E);v.optimisticOps.push(S),queueMicrotask(function(){return d.mutatedParts&&dr(d.mutatedParts)})}),g):l.mutate(d)},query:function(d){if(!ao(he,l)||!lo("query",d))return l.query(d);var g=((S=he.trans)===null||S===void 0?void 0:S.db._options.cache)==="immutable",L=he,v=L.requery,E=L.signal,S=(function(k,P,D,j){var T=Vt["idb://".concat(k,"/").concat(P)];if(!T)return[];if(!(P=T.queries[D]))return[null,!1,T,null];var N=P[(j.query?j.query.index.name:null)||""];if(!N)return[null,!1,T,null];switch(D){case"query":var V=N.find(function(Q){return Q.req.limit===j.limit&&Q.req.values===j.values&&fo(Q.req.query.range,j.query.range)});return V?[V,!0,T,N]:[N.find(function(Q){return("limit"in Q.req?Q.req.limit:1/0)>=j.limit&&(!j.values||Q.req.values)&&Da(Q.req.query.range,j.query.range)}),!1,T,N];case"count":return V=N.find(function(Q){return fo(Q.req.query.range,j.query.range)}),[V,!!V,T,N]}})(o,s,"query",d),O=S[0],L=S[1],I=S[2],M=S[3];return O&&L?O.obsSet=d.obsSet:(L=l.query(d).then(function(k){var P=k.result;if(O&&(O.res=P),g){for(var D=0,j=P.length;D<j;++D)Object.freeze(P[D]);Object.freeze(P)}else k.result=ue(P);return k}).catch(function(k){return M&&O&&de(M,O),Promise.reject(k)}),O={obsSet:d.obsSet,promise:L,subscribers:new Set,type:"query",req:d,dirty:!1},M?M.push(O):(M=[O],(I=I||(Vt["idb://".concat(o,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=M)),Ia(O,M,v,E),O.promise.then(function(k){return{result:co(k.result,d,I?.optimisticOps,l,O,g)}})}})}})}};function hr(n,o){return new Proxy(n,{get:function(s,l,c){return l==="db"?o:Reflect.get(s,l,c)}})}var Pt=(qe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new Y.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var o=this._versions,s=o.filter(function(l){return l._cfg.version===n})[0];return s||(s=new this.Version(n),o.push(s),o.sort(xa),s.stores({}),this._state.autoSchema=!1,s)},qe.prototype._whenReady=function(n){var o=this;return this.idbdb&&(this._state.openComplete||he.letThrough||this._vip)?n():new ce(function(s,l){if(o._state.openComplete)return l(new Y.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return void l(new Y.DatabaseClosed);o.open().catch(ke)}o._state.dbReadyPromise.then(s,l)}).then(n)},qe.prototype.use=function(n){var o=n.stack,s=n.create,l=n.level,c=n.name;return c&&this.unuse({stack:o,name:c}),n=this._middlewares[o]||(this._middlewares[o]=[]),n.push({stack:o,create:s,level:l??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},qe.prototype.unuse=function(n){var o=n.stack,s=n.name,l=n.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(c){return l?c.create!==l:!!s&&c.name!==s})),this},qe.prototype.open=function(){var n=this;return Wt(et,function(){return Ma(n)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,o=dn.indexOf(this);if(0<=o&&dn.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new ce(function(s){n.dbReadyResolve=s}),n.openCanceller=new ce(function(s,l){n.cancelOpen=l}))},qe.prototype.close=function(s){var o=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new Y.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Y.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},qe.prototype.delete=function(n){var o=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",l=this._state;return new ce(function(c,d){function g(){o.close(n);var v=o._deps.indexedDB.deleteDatabase(o.name);v.onsuccess=Ke(function(){var E,S,O;E=o._deps,S=o.name,O=E.indexedDB,E=E.IDBKeyRange,Jr(O)||S===Qn||Xr(O,E).delete(S).catch(ke),c()}),v.onerror=bt(d),v.onblocked=o._fireOnBlocked}if(s)throw new Y.InvalidArgument("Invalid closeOptions argument to db.delete()");l.isBeingOpened?l.dbReadyPromise.then(g):g()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(o){return n._allTables[o]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var n=(function(o,s,l){var c=arguments.length;if(c<2)throw new Y.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return l=d.pop(),[o,oe(d),l]}).apply(this,arguments);return this._transaction.apply(this,n)},qe.prototype._transaction=function(n,o,s){var l=this,c=he.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=o.map(function(S){if(S=S instanceof l.Table?S.name:S,typeof S!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return S}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Kr)throw new Y.InvalidArgument("Invalid transaction mode: "+n);d=Kr}if(c){if(c.mode===Fr&&d===Kr){if(!v)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(S){if(c&&c.storeNames.indexOf(S)===-1){if(!v)throw new Y.SubTransaction("Table "+S+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(S){return c?c._promise(null,function(O,L){L(S)}):Ne(S)}var E=(function S(O,L,I,M,k){return ce.resolve().then(function(){var P=he.transless||he,D=O._createTransaction(L,I,O._dbSchema,M);if(D.explicit=!0,P={trans:D,transless:P},M)D.idbtrans=M.idbtrans;else try{D.create(),D.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(N){return N.name===ze.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return S(O,L,I,null,k)})):Ne(N)}var j,T=Le(k);return T&&fn(),P=ce.follow(function(){var N;(j=k.call(D,D))&&(T?(N=Rt.bind(null,null),j.then(N,N)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=oi(j)))},P),(j&&typeof j.then=="function"?ce.resolve(j).then(function(N){return D.active?N:Ne(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):P.then(function(){return j})).then(function(N){return M&&D._resolve(),D._completion.then(function(){return N})}).catch(function(N){return D._reject(N),Ne(N)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,E,"lock"):he.trans?Wt(he.transless,function(){return l._whenReady(E)}):this._whenReady(E)},qe.prototype.table=function(n){if(!w(this._allTables,n))throw new Y.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},qe);function qe(n,o){var s=this;this._middlewares={},this.verno=0;var l=qe.dependencies;this._options=o=i({addons:qe.addons,autoOpen:!0,indexedDB:l.indexedDB,IDBKeyRange:l.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},l=o.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,E,S={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen};S.dbReadyPromise=new ce(function(L){S.dbReadyResolve=L}),S.openCanceller=new ce(function(L,I){S.cancelOpen=I}),this._state=S,this.name=n,this.on=kn(this,"populate","blocked","versionchange","close",{ready:[on,ke]}),this.once=function(L,I){var M=function(){for(var k=[],P=0;P<arguments.length;P++)k[P]=arguments[P];s.on(L).unsubscribe(M),I.apply(s,k)};return s.on(L,M)},this.on.ready.subscribe=X(this.on.ready.subscribe,function(L){return function(I,M){qe.vip(function(){var k,P=s._state;P.openComplete?(P.dbOpenError||ce.resolve().then(I),M&&L(I)):P.onReadyBeingFired?(P.onReadyBeingFired.push(I),M&&L(I)):(L(I),k=s,M||L(function D(){k.on.ready.unsubscribe(I),k.on.ready.unsubscribe(D)}))})}}),this.Collection=(c=this,Pn(ga.prototype,function(j,D){this.db=c;var M=Fi,k=null;if(D)try{M=D()}catch(T){k=T}var P=j._ctx,D=P.table,j=D.hook.reading.fire;this._ctx={table:D,index:P.index,isPrimKey:!P.index||D.schema.primKey.keyPath&&P.index===D.schema.primKey.name,range:M,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:k,or:P.or,valueMapper:j!==Xe?j:null}})),this.Table=(d=this,Pn($i.prototype,function(L,I,M){this.db=d,this._tx=M,this.name=L,this.schema=I,this.hook=d._allTables[L]?d._allTables[L].hook:kn(null,{creating:[$n,ke],reading:[qt,Xe],updating:[Vn,ke],deleting:[nn,ke]})})),this.Transaction=(g=this,Pn(ya.prototype,function(L,I,M,k,P){var D=this;L!=="readonly"&&I.forEach(function(j){j=(j=M[j])===null||j===void 0?void 0:j.yProps,j&&(I=I.concat(j.map(function(T){return T.updatesTable})))}),this.db=g,this.mode=L,this.storeNames=I,this.schema=M,this.chromeTransactionDurability=k,this.idbtrans=null,this.on=kn(this,"complete","error","abort"),this.parent=P||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ce(function(j,T){D._resolve=j,D._reject=T}),this._completion.then(function(){D.active=!1,D.on.complete.fire()},function(j){var T=D.active;return D.active=!1,D.on.error.fire(j),D.parent?D.parent._reject(j):T&&D.idbtrans&&D.idbtrans.abort(),Ne(j)})})),this.Version=(v=this,Pn(Sa.prototype,function(L){this.db=v,this._cfg={version:L,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(E=this,Pn(Xi.prototype,function(L,I,M){if(this.db=E,this._ctx={table:L,index:I===":id"?null:I,or:M},this._cmp=this._ascending=Ae,this._descending=function(k,P){return Ae(P,k)},this._max=function(k,P){return 0<Ae(k,P)?k:P},this._min=function(k,P){return Ae(k,P)<0?k:P},this._IDBKeyRange=E._deps.IDBKeyRange,!this._IDBKeyRange)throw new Y.MissingAPI})),this.on("versionchange",function(L){0<L.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(L){!L.newVersion||L.newVersion<L.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(L.oldVersion/10))}),this._maxKey=Dn(o.IDBKeyRange),this._createTransaction=function(L,I,M,k){return new s.Transaction(L,I,M,s._options.chromeTransactionDurability,k)},this._fireOnBlocked=function(L){s.on("blocked").fire(L),dn.filter(function(I){return I.name===s.name&&I!==s&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(L)})},this.use(Oa),this.use(ja),this.use(_a),this.use(ka),this.use(Pa);var O=new Proxy(this,{get:function(L,I,M){if(I==="_vip")return!0;if(I==="table")return function(P){return hr(s.table(P),O)};var k=Reflect.get(L,I,M);return k instanceof $i?hr(k,O):I==="tables"?k.map(function(P){return hr(P,O)}):I==="_createTransaction"?function(){return hr(k.apply(this,arguments),O)}:k}});this.vip=O,l.forEach(function(L){return L(s)})}var gr,lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ra=(ui.prototype.subscribe=function(n,o,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:o,complete:s})},ui.prototype[lt]=function(){return this},ui);function ui(n){this._subscribe=n}try{gr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{gr={indexedDB:null,IDBKeyRange:null}}function po(n){var o,s=!1,l=new Ra(function(c){var d=Le(n),g,v=!1,E={},S={},O={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),L&&Bt.storagemutated.unsubscribe(M))}};c.start&&c.start(O);var L=!1,I=function(){return zr(k)},M=function(P){fr(E,P),ti(S,E)&&I()},k=function(){var P,D,j;!v&&gr.indexedDB&&(E={},P={},g&&g.abort(),g=new AbortController,j=(function(T){var N=St();try{d&&fn();var V=jt(n,T);return V=d?V.finally(Rt):V}finally{N&&It()}})(D={subscr:P,signal:g.signal,requery:I,querier:n,trans:null}),Promise.resolve(j).then(function(T){s=!0,o=T,v||D.signal.aborted||(E={},(function(N){for(var V in N)if(w(N,V))return;return 1})(S=P)||L||(Bt(_n,M),L=!0),zr(function(){return!v&&c.next&&c.next(T)}))},function(T){s=!1,["DatabaseClosedError","AbortError"].includes(T?.name)||v||zr(function(){v||c.error&&c.error(T)})}))};return setTimeout(I,0),O});return l.hasValue=function(){return s},l.getValue=function(){return o},l}var Ht=Pt;function ci(n){var o=Ut;try{Ut=!0,Bt.storagemutated.fire(n),ii(n,!0)}finally{Ut=o}}C(Ht,i(i({},Ie),{delete:function(n){return new Ht(n,{addons:[]}).delete()},exists:function(n){return new Ht(n,{addons:[]}).open().then(function(o){return o.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return o=Ht.dependencies,s=o.indexedDB,o=o.IDBKeyRange,(Jr(s)?Promise.resolve(s.databases()).then(function(l){return l.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Xr(s,o).toCollection().primaryKeys()).then(n)}catch{return Ne(new Y.MissingAPI)}var o,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return he.trans?Wt(he.transless,n):n()},vip:Qr,async:function(n){return function(){try{var o=oi(n.apply(this,arguments));return o&&typeof o.then=="function"?o:ce.resolve(o)}catch(s){return Ne(s)}}},spawn:function(n,o,s){try{var l=oi(n.apply(s,o||[]));return l&&typeof l.then=="function"?l:ce.resolve(l)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return he.trans||null}},waitFor:function(n,o){return o=ce.resolve(typeof n=="function"?Ht.ignoreTransaction(n):n).timeout(o||6e4),he.trans?he.trans.waitFor(o):o},Promise:ce,debug:{get:function(){return Je},set:function(n){xn(n)}},derive:A,extend:m,props:C,override:X,Events:kn,on:Bt,liveQuery:po,extendObservabilitySet:fr,getByKeyPath:z,setByKeyPath:W,delByKeyPath:function(n,o){typeof o=="string"?W(n,o,void 0):"length"in o&&[].map.call(o,function(s){W(n,s,void 0)})},shallowClone:H,deepClone:ue,getObjectDiff:si,cmp:Ae,asap:R,minKey:-1/0,addons:[],connections:dn,errnames:ze,dependencies:gr,cache:Vt,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,o,s){return n+o/Math.pow(10,2*s)})})),Ht.maxKey=Dn(Ht.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Bt(_n,function(n){Ut||(n=new CustomEvent(Wr,{detail:n}),Ut=!0,dispatchEvent(n),Ut=!1)}),addEventListener(Wr,function(n){n=n.detail,Ut||ci(n)}));var mn,Ut=!1,ho=function(){};return typeof BroadcastChannel<"u"&&((ho=function(){(mn=new BroadcastChannel(Wr)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof mn.unref=="function"&&mn.unref(),Bt(_n,function(n){Ut||mn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Pt.disableBfCache&&n.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),mn?.close();for(var o=0,s=dn;o<s.length;o++)s[o].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Pt.disableBfCache&&n.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),ho(),ci({all:new Ve(-1/0,[[]])}))})),ce.rejectionMapper=function(n,o){return!n||n instanceof ge||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ye[n.name]?n:(o=new ye[n.name](o||n.message,n),"stack"in n&&x(o,"stack",{get:function(){return this.inner.stack}}),o)},xn(Je),i(Pt,Object.freeze({__proto__:null,Dexie:Pt,liveQuery:po,Entity:Ki,cmp:Ae,PropModification:Mn,replacePrefix:function(n,o){return new Mn({replacePrefix:[n,o]})},add:function(n){return new Mn({add:n})},remove:function(n){return new Mn({remove:n})},default:Pt,RangeSet:Ve,mergeRanges:Rn,rangesOverlap:no}),{default:Pt}),Pt})})(xr)),xr.exports}var vc=mc();const Oi=Ta(vc),Ns=Symbol.for("Dexie"),Ar=globalThis[Ns]||(globalThis[Ns]=Oi);if(Oi.semVer!==Ar.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Oi.semVer} and ${Ar.semVer}`);const{liveQuery:jc,mergeRanges:Rc,rangesOverlap:Ac,RangeSet:Tc,cmp:Bc,Entity:Uc,PropModification:zc,replacePrefix:Fc,add:Kc,remove:Nc,DexieYProvider:qc}=Ar,it=new Ar("ChillGameDB");it.version(1).stores({exploredCells:"id, [iy+ix]",claimedCells:"id, [iy+ix]",gameState:"key"});it.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const qs=5e-4,Ye=ec(hc((t,e)=>({clouds:10,claimedCells:[],exploredCells:[],selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,i,a,f]=await Promise.all([it.exploredCells.toArray(),it.claimedCells.toArray(),it.gameState.get("clouds"),it.gameState.get("lastCloudIncrease")]);t(p=>{p.exploredCells=r,p.claimedCells=i,p.clouds=a?a.value:10,p.lastCloudIncrease=f?f.value:Date.now(),p.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(i=>{i.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(i=>{i.clouds<10&&(i.clouds+=1,i.lastCloudIncrease=r)}),it.gameState.put({key:"clouds",value:e().clouds}),it.gameState.put({key:"lastCloudIncrease",value:r})},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:i,longitude:a}=r.coords,f=new Set(e().exploredCells.map(p=>p.id));t(p=>{p.userLocation={lat:i,lng:a};const h=Math.floor(i/qs),m=Math.floor(a/qs),b=[],y=2;for(let w=-y;w<=y;w++)for(let C=-y;C<=y;C++)if(w*w+C*C<=y*y){const _=`${h+w}_${m+C}`;if(!f.has(_)){const x={id:_,iy:h+w,ix:m+C};p.exploredCells.push(x),b.push(x),f.add(_)}}b.length>0&&it.exploredCells.bulkAdd(b).catch(w=>console.error("Failed to bulkAdd explored cells:",w))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const i=e().selectedCell,a=e().claimedCells,f=r?.key;console.log(`[selectCell] Checking cell with key: ${f}`);const p=a.some(h=>h.id===f);if(console.log(`[selectCell] Is this cell claimed? ${p}`),p){console.log("[selectCell] Reason: Cell is already in the claimedCells list.");const h=a.find(m=>m.id===f);console.log("[selectCell] Problematic cell data:",h)}r?i&&i.key===f?(console.log("[selectCell] Decision: Deselecting (clicking the same cell again)."),t({selectedCell:null})):p?(console.log("[selectCell] Decision: Deselecting (cell is already claimed)."),t({selectedCell:null})):(console.log("[selectCell] Decision: Selecting cell."),t({selectedCell:r})):(console.log("[selectCell] Decision: Deselecting (cell is null)."),t({selectedCell:null}))},updateSelectedCellInfo:r=>{t(i=>{i.selectedCell&&(i.selectedCell={...i.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:i}=e();if(!r)return"no-cell";if(i<=0)return"no-clouds";const{key:a}=r,[f,p]=a.split("_").map(Number),m={id:a,iy:f,ix:p,data:{owner:"user",color:"#3B82F6"}},b=new Set(e().exploredCells.map(C=>C.id)),y=[],w=1;for(let C=-w;C<=w;C++)for(let _=-w;_<=w;_++){const x=f+C,A=p+_,B=`${x}_${A}`;b.has(B)||y.push({id:B,iy:x,ix:A})}return t(C=>{C.clouds-=1,C.claimedCells.push(m),C.exploredCells.push(...y),C.selectedCell=null}),it.claimedCells.put(m),it.gameState.put({key:"clouds",value:e().clouds}),y.length>0&&it.exploredCells.bulkAdd(y),"claimed"},register:()=>{t({clouds:10}),it.gameState.put({key:"clouds",value:10})}}))),yc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},bc={fontSize:"24px"};function wc(){const t=Ye(e=>e.clouds);return ie.jsxs("div",{style:yc,children:[ie.jsx("span",{style:bc,children:""}),ie.jsx("span",{children:t})]})}const Lc=Qt.memo(wc),xc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},Cc={fontSize:"28px"};function Ec({onClick:t}){const[e,r]=u.useState(!1),i={...xc,transform:e?"scale(1.1)":"scale(1)"};return ie.jsx("button",{onClick:t,title:"Reset View",style:i,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:ie.jsx("span",{style:Cc,children:""})})}const Sc=u.memo(Ec),wr={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},Mc=()=>{const t=Ye(f=>f.clouds),e=Ye(f=>f.lastCloudIncrease),r=Ye(f=>f.increaseCloud),[i,a]=u.useState(0);return u.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const m=6e4-(Date.now()-e);m<=0?(r(),a(60)):a(Math.ceil(m/1e3))},1e3):(clearInterval(f),a(0)),()=>clearInterval(f)},[t,e,r]),ie.jsxs("div",{style:wr.container,children:[ie.jsx("span",{style:wr.icon,children:""}),t<10?ie.jsxs("span",{style:wr.timer,children:[i,"s"]}):ie.jsx("span",{style:wr.timer,children:""})]})},kc=u.memo(Mc),Lr=new Map,Ws=.5;function Pc(t){const e=Ye(r=>r.updateSelectedCellInfo);u.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,i=`${Math.floor(r.lat/Ws)}_${Math.floor(r.lng/Ws)}`;(async()=>{if(Lr.has(i)){e(Lr.get(i));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,b=m.find(A=>A.types.includes("country")),y=m.find(A=>A.types.includes("administrative_area_level_1")),w=b?b.long_name:"",C=b?b.short_name.toLowerCase():null,_=y?y.long_name:"",x=C?`https://flagcdn.com/w40/${C}.png`:null;h={countryName:w,regionName:_,flagUrl:x}}else h={countryName:"",regionName:"",flagUrl:null};Lr.set(i,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"",regionName:"",flagUrl:null};Lr.set(i,p),e(p)}})()},[t,e])}const Oc=u.lazy(()=>_i(()=>import("./Leaderboard-CeJL5m5-.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),_c=u.lazy(()=>_i(()=>import("./RegistrationModal-D7NH75kU.js"),__vite__mapDeps([4,1,2]))),Dc=u.lazy(()=>_i(()=>import("./InfoModal-nL5Y5zy1.js"),__vite__mapDeps([5,1,2]))),ft={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"calc(env(safe-area-inset-top, 0px) + 16px)",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"calc(env(safe-area-inset-top, 0px) + 16px)",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"calc(env(safe-area-inset-top, 0px) + 16px)",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"120px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"120px",left:"8px",zIndex:50}};function Wc(){const{lat:t,lng:e}=Ba(),r=Ua(),[i,a]=u.useState(()=>{if(t&&e)return{lat:parseFloat(t),lng:parseFloat(e)};try{const G=localStorage.getItem("lastKnownLocation");if(G)return JSON.parse(G)}catch(G){console.error("Could not read from localStorage:",G)}return null}),[f,p]=u.useState(!1),h=u.useRef(null),m=Ye(G=>G.claimedCells),b=Ye(G=>G.exploredCells),y=Ye(G=>G.selectedCell),w=Ye(G=>G.userLocation),C=Ye(G=>G.clouds),_=Ye(G=>G.initializeGeolocation),x=Ye(G=>G.selectCell),A=Ye(G=>G.claimSelectedCell),B=Ye(G=>G.register),Z=Ye(G=>G.isHydrated),q=Ye(G=>G.hydrate);Pc(y);const{isLoaded:X}=ll({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});u.useEffect(()=>{_()},[_]),u.useEffect(()=>{q()},[q]),u.useEffect(()=>{i||navigator.geolocation.getCurrentPosition(G=>{a({lat:G.coords.latitude,lng:G.coords.longitude})},()=>{a({lat:25.033,lng:121.5654})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},[i]);const[F,R]=u.useState(!1),[z,W]=u.useState(!1),[H,U]=u.useState(!1),[oe,ee]=u.useState(!1),[ne,ue]=u.useState([]),se=u.useCallback(G=>{h.current=G},[]),fe=u.useCallback((G,Y)=>{xi(),x(G?{key:G,position:Y,isLoading:!0}:null)},[x]),me=u.useCallback(()=>{if(!y)return;const G={id:Date.now()+Math.random(),position:y.position,startTime:Date.now(),particleDuration:2500,revealDuration:1e3,onComplete:()=>{A()==="no-clouds"&&R(!0)}};ue(Y=>[...Y,G]),setTimeout(()=>{ue(Y=>Y.filter(ye=>ye.id!==G.id))},2500)},[A,y]),be=u.useCallback(()=>{x(null)},[x]),de=u.useCallback(()=>{B(),R(!1)},[B]),we=u.useCallback(async()=>{if(!h.current)return;const G=h.current.getCenter(),Y=G.lat(),ye=G.lng();p(!0),await Kt(h.current,{lat:Y,lng:ye},1500,2,ee),r("/")},[r,ee]),ve=u.useCallback(async()=>{if(w&&h.current){const G=h.current,Y=G.getCenter(),ye={lat:Y.lat(),lng:Y.lng()};await Kt(G,ye,1e3,5,ee),await Kt(G,w,1500,5,ee),await Kt(G,w,1e3,15,ee)}else alert("")},[w,ee]),Le=u.useCallback(G=>{try{G&&typeof G.lat=="number"&&isFinite(G.lat)&&typeof G.lng=="number"&&isFinite(G.lng)&&localStorage.setItem("lastKnownLocation",JSON.stringify(G))}catch(Y){console.error("Could not write to localStorage:",Y)}},[]),Se=u.useCallback(async()=>{if(h.current){const G=h.current.getZoom(),Y=Math.min(20,G+1);Y!==G&&await Kt(h.current,h.current.getCenter().toJSON(),300,Y,ee)}},[ee]),ge=u.useCallback(async()=>{if(h.current){const G=h.current.getZoom(),Y=Math.max(2,G-1);Y!==G&&await Kt(h.current,h.current.getCenter().toJSON(),300,Y,ee)}},[ee]),De=u.useCallback(()=>U(!0),[]),$=u.useCallback(()=>R(!1),[]),Te=u.useCallback(()=>W(!1),[]),ze=u.useCallback(()=>U(!1),[]);return!X||!i||!Z?ie.jsx(go,{}):ie.jsxs("div",{style:ft.app,className:f?"map-container-fade-out":"",children:[ie.jsx(Yu,{center:i,onSelectCell:fe,claimedCells:m,exploredCells:b,setMapRef:se,onZoomChanged:()=>{},onCenterChanged:Le,selectedCell:y,userLocation:w,isAnimating:oe,effects:ne}),y&&ie.jsx(oa,{cellInfo:y,onClaim:me,onClose:be,isClaimDisabled:C<=0&&F}),ie.jsxs("div",{style:ft.topLeftControls,children:[ie.jsx("button",{style:ft.controlButton,onClick:Se,children:"+"}),ie.jsx("button",{style:ft.controlButton,onClick:ge,children:"-"}),ie.jsx("button",{style:ft.controlButton,onClick:De,children:"i"})]}),ie.jsx("div",{style:ft.topCenterContainer,children:ie.jsx(Lc,{})}),ie.jsxs("div",{style:ft.topRightContainer,children:[ie.jsx("button",{style:ft.controlButton,onClick:()=>W(!0),children:""}),ie.jsx("button",{style:ft.controlButton,onClick:we,title:"Return to Globe",children:""})]}),ie.jsx("div",{style:ft.bottomLeftContainer,children:ie.jsx(kc,{})}),ie.jsx("div",{style:ft.bottomRightContainer,children:ie.jsx(Sc,{onClick:ve})}),ie.jsxs(u.Suspense,{fallback:ie.jsx(go,{}),children:[F&&ie.jsx(_c,{onClose:$,onRegister:de}),z&&ie.jsx(Oc,{onClose:Te}),H&&ie.jsx(Dc,{onClose:ze})]})]})}export{Wc as default};
