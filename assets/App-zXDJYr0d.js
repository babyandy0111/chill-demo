const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-BgtrTq5E.js","assets/index-BdoIdt7c.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-yGVuAns2.js","assets/InfoModal-CXuQ0Dcp.js"])))=>i.map(i=>d[i]);
import{r as l,j as oe,b as Ln,R as en,c as Ta,g as Aa,d as Ba,a as Ua,L as go,_ as _i}from"./index-BdoIdt7c.js";function Fn(t){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(t)}function za(t,e){if(Fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Fn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=za(t,"string");return Fn(e)=="symbol"?e:e+""}function N(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var di,mo;function Ka(){if(mo)return di;mo=1;var t=function(r,i,a,f,p,h,m,L){if(!r){var w;if(i===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var b=[a,f,p,h,m,L],x=0;w=new Error(i.replace(/%s/g,function(){return b[x++]})),w.name="Invariant Violation"}throw w.framesToPop=1,w}};return di=t,di}var Na=Ka(),We=Zs(Na),Me=l.createContext(null);function qa(){We(!!l.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=l.useContext(Me);return We(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function Wa(t,e,r){return Object.keys(t).reduce(function(a,f){return e(a,t[f],f)},r)}function Za(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function $a(t,e,r,i){var a={},f=(p,h)=>{var m=r[h];m!==e[h]&&(a[h]=m,p(i,m))};return Za(t,f),a}function Va(t,e,r){var i=Wa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return i}function Ha(t){google.maps.event.removeListener(t)}function Ie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Ha)}function _e(t){var{updaterMap:e,eventMap:r,prevProps:i,nextProps:a,instance:f}=t,p=Va(a,f,r);return $a(e,i,a,f),p}var vo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},yo={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ga(t){var{children:e,options:r,id:i,mapContainerStyle:a,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:L,onDragEnd:w,onDragStart:b,onMouseMove:x,onMouseOut:j,onMouseOver:k,onMouseDown:R,onMouseUp:U,onRightClick:V,onCenterChanged:W,onLoad:ee,onUnmount:K}=t,[A,S]=l.useState(null),z=l.useRef(null),[H,F]=l.useState(null),[X,G]=l.useState(null),[re,de]=l.useState(null),[pe,ue]=l.useState(null),[ge,ce]=l.useState(null),[he,we]=l.useState(null),[me,xe]=l.useState(null),[Pe,ye]=l.useState(null),[Re,Z]=l.useState(null),[Ae,ze]=l.useState(null),[J,Y]=l.useState(null),[be,De]=l.useState(null);return l.useEffect(()=>{r&&A!==null&&A.setOptions(r)},[A,r]),l.useEffect(()=>{A!==null&&typeof p<"u"&&A.setCenter(p)},[A,p]),l.useEffect(()=>{A&&m&&(X!==null&&google.maps.event.removeListener(X),G(google.maps.event.addListener(A,"dblclick",m)))},[m]),l.useEffect(()=>{A&&w&&(re!==null&&google.maps.event.removeListener(re),de(google.maps.event.addListener(A,"dragend",w)))},[w]),l.useEffect(()=>{A&&b&&(pe!==null&&google.maps.event.removeListener(pe),ue(google.maps.event.addListener(A,"dragstart",b)))},[b]),l.useEffect(()=>{A&&R&&(ge!==null&&google.maps.event.removeListener(ge),ce(google.maps.event.addListener(A,"mousedown",R)))},[R]),l.useEffect(()=>{A&&x&&(he!==null&&google.maps.event.removeListener(he),we(google.maps.event.addListener(A,"mousemove",x)))},[x]),l.useEffect(()=>{A&&j&&(me!==null&&google.maps.event.removeListener(me),xe(google.maps.event.addListener(A,"mouseout",j)))},[j]),l.useEffect(()=>{A&&k&&(Pe!==null&&google.maps.event.removeListener(Pe),ye(google.maps.event.addListener(A,"mouseover",k)))},[k]),l.useEffect(()=>{A&&U&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(A,"mouseup",U)))},[U]),l.useEffect(()=>{A&&V&&(Ae!==null&&google.maps.event.removeListener(Ae),ze(google.maps.event.addListener(A,"rightclick",V)))},[V]),l.useEffect(()=>{A&&h&&(J!==null&&google.maps.event.removeListener(J),Y(google.maps.event.addListener(A,"click",h)))},[h]),l.useEffect(()=>{A&&L&&(be!==null&&google.maps.event.removeListener(be),De(google.maps.event.addListener(A,"drag",L)))},[L]),l.useEffect(()=>{A&&W&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(A,"center_changed",W)))},[h]),l.useEffect(()=>{var ke=z.current===null?null:new google.maps.Map(z.current,r);return S(ke),ke!==null&&ee&&ee(ke),()=>{ke!==null&&K&&K(ke)}},[]),oe.jsx("div",{id:i,ref:z,style:a,className:f,children:oe.jsx(Me.Provider,{value:A,children:A!==null?e:null})})}l.memo(Ga);class Ya extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{map:null}),N(this,"registeredEvents",[]),N(this,"mapRef",null),N(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),N(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),N(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),N(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),Ie(this.registeredEvents))}render(){return oe.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:oe.jsx(Me.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bo(t,e,r,i,a,f,p){try{var h=t[f](p),m=h.value}catch(L){return void r(L)}h.done?e(m):Promise.resolve(m).then(i,a)}function $s(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var f=t.apply(e,r);function p(m){bo(f,i,a,p,h,"next",m)}function h(m){bo(f,i,a,p,h,"throw",m)}p(void 0)})}}function Vs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:i="weekly",language:a,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:L,apiUrl:w="https://maps.googleapis.com"}=t,b=[];return We(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?b.push("key=".concat(e)):r&&b.push("client=".concat(r)),i&&b.push("v=".concat(i)),a&&b.push("language=".concat(a)),f&&b.push("region=".concat(f)),p&&p.length&&b.push("libraries=".concat(p.sort().join(","))),h&&b.push("channel=".concat(h)),m&&m.length&&b.push("map_ids=".concat(m.join(","))),L&&b.push("auth_referrer_policy=".concat(L)),b.push("loading=async"),b.push("callback=initMap"),"".concat(w,"/maps/api/js?").concat(b.join("&"))}var qt=typeof document<"u";function Hs(t){var{url:e,id:r,nonce:i}=t;return qt?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var L=h.getAttribute("data-state");if(h.src===e&&L!=="error"){if(L==="ready")return f(r);var w=m.initMap,b=h.onerror;m.initMap=function(){w&&w(),f(r)},h.onerror=function(j){b&&b(j),p(j)};return}else h.remove()}var x=document.createElement("script");x.type="text/javascript",x.src=e,x.id=r,x.async=!0,x.nonce=i||"",x.onerror=function(k){x.setAttribute("data-state","error"),p(k)},m.initMap=function(){x.setAttribute("data-state","ready"),f(r)},document.head.appendChild(x)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function wo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function Di(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,f){return wo(a)||Reflect.apply(e,t,[a,f]),a};var r=t.appendChild.bind(t);t.appendChild=function(a){return wo(a)||Reflect.apply(r,t,[a]),a}}}var Tn=!1;function Gs(){return oe.jsx("div",{children:"Loading..."})}var Kn={id:"script-loader",version:"weekly"};class Xa extends l.PureComponent{constructor(){super(...arguments),N(this,"check",null),N(this,"state",{loaded:!1}),N(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),N(this,"isCleaningUp",$s(function*(){function e(r){if(!Tn)r();else if(qt)var i=window.setInterval(function(){Tn||(window.clearInterval(i),r())},1)}return new Promise(e)})),N(this,"cleanup",()=>{Tn=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),N(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Di(),We(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Vs(this.props)};Hs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),N(this,"getRef",e=>{this.check=e})}componentDidMount(){if(qt){if(window.google&&window.google.maps&&!Tn){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),qt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(qt){this.cleanup();var e=()=>{this.check||(delete window.google,Tn=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return oe.jsxs(oe.Fragment,{children:[oe.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||oe.jsx(Gs,{})]})}}N(Xa,"defaultProps",Kn);function Ja(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function Ii(t,e){if(t==null)return{};var r,i,a=Ja(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(i=0;i<f.length;i++)r=f[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var Lo;function Qa(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:L,channel:w,mapIds:b,authReferrerPolicy:x,apiUrl:j="https://maps.googleapis.com"}=t,k=l.useRef(!1),[R,U]=l.useState(!1),[V,W]=l.useState(void 0);l.useEffect(function(){return k.current=!0,()=>{k.current=!1}},[]),l.useEffect(function(){qt&&L&&Di()},[L]),l.useEffect(function(){R&&We(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[R]);var ee=Vs({version:r,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,channel:w,mapIds:b,authReferrerPolicy:x,apiUrl:j});l.useEffect(function(){if(!qt)return;function S(){k.current&&(U(!0),Lo=ee)}if(window.google&&window.google.maps&&Lo===ee){S();return}Hs({id:e,url:ee,nonce:i}).then(S).catch(function(H){k.current&&W(H),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(H)})},[e,ee,i]);var K=l.useRef(void 0);return l.useEffect(function(){K.current&&m!==K.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),K.current=m},[m]),{isLoaded:R,loadError:V,url:ee}}var el=["loadingElement","onLoad","onError","onUnmount","children"],tl=oe.jsx(Gs,{});function nl(t){var{loadingElement:e,onLoad:r,onError:i,onUnmount:a,children:f}=t,p=Ii(t,el),{isLoaded:h,loadError:m}=Qa(p);return l.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),l.useEffect(function(){m&&typeof i=="function"&&i(m)},[m,i]),l.useEffect(function(){return()=>{a&&a()}},[a]),h?f:e||tl}l.memo(nl);function rl(t,e,r,i){function a(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(w){try{L(i.next(w))}catch(b){p(b)}}function m(w){try{L(i.throw(w))}catch(b){p(b)}}function L(w){w.done?f(w.value):a(w.value).then(h,m)}L((i=i.apply(t,[])).next())})}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ol=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},sl=il(ol),xo="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Qt{constructor(e){var{apiKey:r,authReferrerPolicy:i,channel:a,client:f,id:p=xo,language:h,libraries:m=[],mapIds:L,nonce:w,region:b,retries:x=3,url:j="https://maps.googleapis.com/maps/api/js",version:k}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=i,this.channel=a,this.client=f,this.id=p||xo,this.language=h,this.libraries=m,this.mapIds=L,this.nonce=w,this.region=b,this.retries=x,this.url=j,this.version=k,Qt.instance){if(!sl(this.options,Qt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Qt.instance.options)));return Qt.instance}Qt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(i=>{i?r(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(f=>!i[f]&&delete i[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,L="The Google Maps JavaScript API",w="google",b="importLibrary",x="__ib__",j=document,k=window;k=k[w]||(k[w]={});var R=k.maps||(k.maps={}),U=new Set,V=new URLSearchParams,W=()=>p||(p=new Promise((ee,K)=>rl(this,void 0,void 0,function*(){var A;yield h=j.createElement("script"),h.id=this.id,V.set("libraries",[...U]+"");for(m in f)V.set(m.replace(/[A-Z]/g,S=>"_"+S[0].toLowerCase()),f[m]);V.set("callback",w+".maps."+x),h.src=this.url+"?"+V,R[x]=ee,h.onerror=()=>p=K(Error(L+" could not load.")),h.nonce=this.nonce||((A=j.querySelector("script[nonce]"))===null||A===void 0?void 0:A.nonce)||"",j.head.append(h)})));R[b]?console.warn(L+" only loads once. Ignoring:",f):R[b]=function(ee){for(var K=arguments.length,A=new Array(K>1?K-1:0),S=1;S<K;S++)A[S-1]=arguments[S];return U.add(ee)&&W().then(()=>R[b](ee,...A))}})(i);var a=this.libraries.map(f=>this.importLibrary(f));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var al=["maps"];function ll(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,language:f,region:p,libraries:h=al,preventGoogleFontsLoading:m,mapIds:L,authReferrerPolicy:w}=t,b=l.useRef(!1),[x,j]=l.useState(!1),[k,R]=l.useState(void 0);l.useEffect(function(){return b.current=!0,()=>{b.current=!1}},[]);var U=l.useMemo(()=>new Qt({id:e,apiKey:a,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:L||[],nonce:i||"",authReferrerPolicy:w||"origin"}),[e,a,r,h,f,p,L,i,w]);l.useEffect(function(){x||U.load().then(()=>{b.current&&j(!0)}).catch(ee=>{R(ee)})},[]),l.useEffect(()=>{qt&&m&&Di()},[m]);var V=l.useRef();return l.useEffect(()=>{V.current&&h!==V.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),V.current=h},[h]),{isLoaded:x,loadError:k}}function Co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Co(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Eo={},Mo={options(t,e){t.setOptions(e)}};function ul(t){var{options:e,onLoad:r,onUnmount:i}=t,a=l.useContext(Me),[f,p]=l.useState(null);return l.useEffect(()=>{f!==null&&f.setMap(a)},[a]),l.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),l.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:a}));return p(h),r&&r(h),()=>{f!==null&&(i&&i(f),f.setMap(null))}},[]),null}l.memo(ul);class cl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{trafficLayer:null}),N(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),N(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Mo,eventMap:Eo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Mo,eventMap:Eo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),Ie(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}N(cl,"contextType",Me);function fl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(Me),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(i),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}l.memo(fl);class dl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{bicyclingLayer:null}),N(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}N(dl,"contextType",Me);function pl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(Me),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(i),e&&e(p),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}l.memo(pl);class hl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{transitLayer:null}),N(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}N(hl,"contextType",Me);function ko(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ko(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ko(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var So={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Po={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function gl(t){var{options:e,drawingMode:r,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:L,onUnmount:w}=t,b=l.useContext(Me),[x,j]=l.useState(null),[k,R]=l.useState(null),[U,V]=l.useState(null),[W,ee]=l.useState(null),[K,A]=l.useState(null),[S,z]=l.useState(null),[H,F]=l.useState(null);return l.useEffect(()=>{x!==null&&x.setMap(b)},[b]),l.useEffect(()=>{e&&x!==null&&x.setOptions(e)},[x,e]),l.useEffect(()=>{x!==null&&x.setDrawingMode(r??null)},[x,r]),l.useEffect(()=>{x&&i&&(k!==null&&google.maps.event.removeListener(k),R(google.maps.event.addListener(x,"circlecomplete",i)))},[x,i]),l.useEffect(()=>{x&&a&&(U!==null&&google.maps.event.removeListener(U),V(google.maps.event.addListener(x,"markercomplete",a)))},[x,a]),l.useEffect(()=>{x&&f&&(W!==null&&google.maps.event.removeListener(W),ee(google.maps.event.addListener(x,"overlaycomplete",f)))},[x,f]),l.useEffect(()=>{x&&p&&(K!==null&&google.maps.event.removeListener(K),A(google.maps.event.addListener(x,"polygoncomplete",p)))},[x,p]),l.useEffect(()=>{x&&h&&(S!==null&&google.maps.event.removeListener(S),z(google.maps.event.addListener(x,"polylinecomplete",h)))},[x,h]),l.useEffect(()=>{x&&m&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(x,"rectanglecomplete",m)))},[x,m]),l.useEffect(()=>{We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var X=new google.maps.drawing.DrawingManager(Er(Er({},e),{},{map:b}));return r&&X.setDrawingMode(r),i&&R(google.maps.event.addListener(X,"circlecomplete",i)),a&&V(google.maps.event.addListener(X,"markercomplete",a)),f&&ee(google.maps.event.addListener(X,"overlaycomplete",f)),p&&A(google.maps.event.addListener(X,"polygoncomplete",p)),h&&z(google.maps.event.addListener(X,"polylinecomplete",h)),m&&F(google.maps.event.addListener(X,"rectanglecomplete",m)),j(X),L&&L(X),()=>{x!==null&&(k&&google.maps.event.removeListener(k),U&&google.maps.event.removeListener(U),W&&google.maps.event.removeListener(W),K&&google.maps.event.removeListener(K),S&&google.maps.event.removeListener(S),H&&google.maps.event.removeListener(H),w&&w(x),x.setMap(null))}},[]),null}l.memo(gl);class ml extends l.PureComponent{constructor(e){super(e),N(this,"registeredEvents",[]),N(this,"state",{drawingManager:null}),N(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Er(Er({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Po,eventMap:So,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Po,eventMap:So,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),Ie(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}N(ml,"contextType",Me);function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var _o={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Do={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Mr={};function vl(t){var{position:e,options:r,clusterer:i,noClustererRedraw:a,children:f,draggable:p,visible:h,animation:m,clickable:L,cursor:w,icon:b,label:x,opacity:j,shape:k,title:R,zIndex:U,onClick:V,onDblClick:W,onDrag:ee,onDragEnd:K,onDragStart:A,onMouseOut:S,onMouseOver:z,onMouseUp:H,onMouseDown:F,onRightClick:X,onClickableChanged:G,onCursorChanged:re,onAnimationChanged:de,onDraggableChanged:pe,onFlatChanged:ue,onIconChanged:ge,onPositionChanged:ce,onShapeChanged:he,onTitleChanged:we,onVisibleChanged:me,onZindexChanged:xe,onLoad:Pe,onUnmount:ye}=t,Re=l.useContext(Me),[Z,Ae]=l.useState(null),[ze,J]=l.useState(null),[Y,be]=l.useState(null),[De,ke]=l.useState(null),[Xe,Wt]=l.useState(null),[je,$n]=l.useState(null),[rn,Vn]=l.useState(null),[on,sn]=l.useState(null),[Je,xn]=l.useState(null),[dt,Cn]=l.useState(null),[Pt,pt]=l.useState(null),[at,an]=l.useState(null),[ht,ln]=l.useState(null),[Lt,gt]=l.useState(null),[xt,un]=l.useState(null),[et,ve]=l.useState(null),[mt,vt]=l.useState(null),[Ct,le]=l.useState(null),[cn,En]=l.useState(null),[Ot,Mn]=l.useState(null),[_t,Hn]=l.useState(null),[fn,Et]=l.useState(null);l.useEffect(()=>{Z!==null&&Z.setMap(Re)},[Re]),l.useEffect(()=>{typeof r<"u"&&Z!==null&&Z.setOptions(r)},[Z,r]),l.useEffect(()=>{typeof p<"u"&&Z!==null&&Z.setDraggable(p)},[Z,p]),l.useEffect(()=>{e&&Z!==null&&Z.setPosition(e)},[Z,e]),l.useEffect(()=>{typeof h<"u"&&Z!==null&&Z.setVisible(h)},[Z,h]),l.useEffect(()=>{Z?.setAnimation(m)},[Z,m]),l.useEffect(()=>{Z&&L!==void 0&&Z.setClickable(L)},[Z,L]),l.useEffect(()=>{Z&&w!==void 0&&Z.setCursor(w)},[Z,w]),l.useEffect(()=>{Z&&b!==void 0&&Z.setIcon(b)},[Z,b]),l.useEffect(()=>{Z&&x!==void 0&&Z.setLabel(x)},[Z,x]),l.useEffect(()=>{Z&&j!==void 0&&Z.setOpacity(j)},[Z,j]),l.useEffect(()=>{Z&&k!==void 0&&Z.setShape(k)},[Z,k]),l.useEffect(()=>{Z&&R!==void 0&&Z.setTitle(R)},[Z,R]),l.useEffect(()=>{Z&&U!==void 0&&Z.setZIndex(U)},[Z,U]),l.useEffect(()=>{Z&&W&&(ze!==null&&google.maps.event.removeListener(ze),J(google.maps.event.addListener(Z,"dblclick",W)))},[W]),l.useEffect(()=>{Z&&K&&(Y!==null&&google.maps.event.removeListener(Y),be(google.maps.event.addListener(Z,"dragend",K)))},[K]),l.useEffect(()=>{Z&&A&&(De!==null&&google.maps.event.removeListener(De),ke(google.maps.event.addListener(Z,"dragstart",A)))},[A]),l.useEffect(()=>{Z&&F&&(Xe!==null&&google.maps.event.removeListener(Xe),Wt(google.maps.event.addListener(Z,"mousedown",F)))},[F]),l.useEffect(()=>{Z&&S&&(je!==null&&google.maps.event.removeListener(je),$n(google.maps.event.addListener(Z,"mouseout",S)))},[S]),l.useEffect(()=>{Z&&z&&(rn!==null&&google.maps.event.removeListener(rn),Vn(google.maps.event.addListener(Z,"mouseover",z)))},[z]),l.useEffect(()=>{Z&&H&&(on!==null&&google.maps.event.removeListener(on),sn(google.maps.event.addListener(Z,"mouseup",H)))},[H]),l.useEffect(()=>{Z&&X&&(Je!==null&&google.maps.event.removeListener(Je),xn(google.maps.event.addListener(Z,"rightclick",X)))},[X]),l.useEffect(()=>{Z&&V&&(dt!==null&&google.maps.event.removeListener(dt),Cn(google.maps.event.addListener(Z,"click",V)))},[V]),l.useEffect(()=>{Z&&ee&&(Pt!==null&&google.maps.event.removeListener(Pt),pt(google.maps.event.addListener(Z,"drag",ee)))},[ee]),l.useEffect(()=>{Z&&G&&(at!==null&&google.maps.event.removeListener(at),an(google.maps.event.addListener(Z,"clickable_changed",G)))},[G]),l.useEffect(()=>{Z&&re&&(ht!==null&&google.maps.event.removeListener(ht),ln(google.maps.event.addListener(Z,"cursor_changed",re)))},[re]),l.useEffect(()=>{Z&&de&&(Lt!==null&&google.maps.event.removeListener(Lt),gt(google.maps.event.addListener(Z,"animation_changed",de)))},[de]),l.useEffect(()=>{Z&&pe&&(xt!==null&&google.maps.event.removeListener(xt),un(google.maps.event.addListener(Z,"draggable_changed",pe)))},[pe]),l.useEffect(()=>{Z&&ue&&(et!==null&&google.maps.event.removeListener(et),ve(google.maps.event.addListener(Z,"flat_changed",ue)))},[ue]),l.useEffect(()=>{Z&&ge&&(mt!==null&&google.maps.event.removeListener(mt),vt(google.maps.event.addListener(Z,"icon_changed",ge)))},[ge]),l.useEffect(()=>{Z&&ce&&(Ct!==null&&google.maps.event.removeListener(Ct),le(google.maps.event.addListener(Z,"position_changed",ce)))},[ce]),l.useEffect(()=>{Z&&he&&(cn!==null&&google.maps.event.removeListener(cn),En(google.maps.event.addListener(Z,"shape_changed",he)))},[he]),l.useEffect(()=>{Z&&we&&(Ot!==null&&google.maps.event.removeListener(Ot),Mn(google.maps.event.addListener(Z,"title_changed",we)))},[we]),l.useEffect(()=>{Z&&me&&(_t!==null&&google.maps.event.removeListener(_t),Hn(google.maps.event.addListener(Z,"visible_changed",me)))},[me]),l.useEffect(()=>{Z&&xe&&(fn!==null&&google.maps.event.removeListener(fn),Et(google.maps.event.addListener(Z,"zindex_changed",xe)))},[xe]),l.useEffect(()=>{var Mt=bn(bn(bn({},r||Mr),i?Mr:{map:Re}),{},{position:e}),Le=new google.maps.Marker(Mt);return i?i.addMarker(Le,!!a):Le.setMap(Re),e&&Le.setPosition(e),typeof h<"u"&&Le.setVisible(h),typeof p<"u"&&Le.setDraggable(p),typeof L<"u"&&Le.setClickable(L),typeof w=="string"&&Le.setCursor(w),b&&Le.setIcon(b),typeof x<"u"&&Le.setLabel(x),typeof j<"u"&&Le.setOpacity(j),k&&Le.setShape(k),typeof R=="string"&&Le.setTitle(R),typeof U=="number"&&Le.setZIndex(U),W&&J(google.maps.event.addListener(Le,"dblclick",W)),K&&be(google.maps.event.addListener(Le,"dragend",K)),A&&ke(google.maps.event.addListener(Le,"dragstart",A)),F&&Wt(google.maps.event.addListener(Le,"mousedown",F)),S&&$n(google.maps.event.addListener(Le,"mouseout",S)),z&&Vn(google.maps.event.addListener(Le,"mouseover",z)),H&&sn(google.maps.event.addListener(Le,"mouseup",H)),X&&xn(google.maps.event.addListener(Le,"rightclick",X)),V&&Cn(google.maps.event.addListener(Le,"click",V)),ee&&pt(google.maps.event.addListener(Le,"drag",ee)),G&&an(google.maps.event.addListener(Le,"clickable_changed",G)),re&&ln(google.maps.event.addListener(Le,"cursor_changed",re)),de&&gt(google.maps.event.addListener(Le,"animation_changed",de)),pe&&un(google.maps.event.addListener(Le,"draggable_changed",pe)),ue&&ve(google.maps.event.addListener(Le,"flat_changed",ue)),ge&&vt(google.maps.event.addListener(Le,"icon_changed",ge)),ce&&le(google.maps.event.addListener(Le,"position_changed",ce)),he&&En(google.maps.event.addListener(Le,"shape_changed",he)),we&&Mn(google.maps.event.addListener(Le,"title_changed",we)),me&&Hn(google.maps.event.addListener(Le,"visible_changed",me)),xe&&Et(google.maps.event.addListener(Le,"zindex_changed",xe)),Ae(Le),Pe&&Pe(Le),()=>{ze!==null&&google.maps.event.removeListener(ze),Y!==null&&google.maps.event.removeListener(Y),De!==null&&google.maps.event.removeListener(De),Xe!==null&&google.maps.event.removeListener(Xe),je!==null&&google.maps.event.removeListener(je),rn!==null&&google.maps.event.removeListener(rn),on!==null&&google.maps.event.removeListener(on),Je!==null&&google.maps.event.removeListener(Je),dt!==null&&google.maps.event.removeListener(dt),at!==null&&google.maps.event.removeListener(at),ht!==null&&google.maps.event.removeListener(ht),Lt!==null&&google.maps.event.removeListener(Lt),xt!==null&&google.maps.event.removeListener(xt),et!==null&&google.maps.event.removeListener(et),mt!==null&&google.maps.event.removeListener(mt),Ct!==null&&google.maps.event.removeListener(Ct),Ot!==null&&google.maps.event.removeListener(Ot),_t!==null&&google.maps.event.removeListener(_t),fn!==null&&google.maps.event.removeListener(fn),ye&&ye(Le),i?i.removeMarker(Le,!!a):Le&&Le.setMap(null)}},[]);var Dt=l.useMemo(()=>f?l.Children.map(f,Mt=>{if(!l.isValidElement(Mt))return Mt;var Le=Mt;return l.cloneElement(Le,{anchor:Z})}):null,[f,Z]);return oe.jsx(oe.Fragment,{children:Dt})||null}l.memo(vl);class yl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this;return $s(function*(){var r=bn(bn(bn({},e.props.options||Mr),e.props.clusterer?Mr:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),Ie(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?l.Children.map(this.props.children,r=>{if(!l.isValidElement(r))return r;var i=r;return l.cloneElement(i,{anchor:this.marker})}):null;return e||null}}N(yl,"contextType",Me);var bl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var i=r.getMaxZoom(),a=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(a),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(a);var h=p.getZoom()||0;i!==null&&h>i&&p.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,i,a,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),L=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),w=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),b=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(b!==null?"".concat(b.y,"px"):"0","; left: ").concat(b!==null?"".concat(b.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var x=document.createElement("img");x.alt=h,x.src=this.url,x.width=this.width,x.height=this.height,x.setAttribute("style","position: absolute; top: ".concat(w,"px; left: ").concat(L,"px")),this.cluster.getClusterer().enableRetinaIcons||(x.style.clip="rect(-".concat(w,"px, -").concat(L+this.width,"px, -").concat(w+this.height,", -").concat(L,")"));var j=document.createElement("div");j.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(j.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(j.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(x),this.div.appendChild(j),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),i=r[Math.min(r.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),wl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new bl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),i=0,a=r;i<a.length;i++){var f=a[i],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,L=this.markers;m<L.length;m++){var w=L[m];w.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function Ll(t,e){var r=t.length,i=r.toString().length,a=Math.min(i,e);return{text:r.toString(),index:a,title:""}}var xl=2e3,Cl=500,El="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",Ml="png",kl=[53,56,66,78,90],Sl="cluster",Ys=(function(){function t(e,r,i){r===void 0&&(r=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||El,this.imageExtension=i.imageExtension||Ml,this.imageSizes=i.imageSizes||kl,this.calculator=i.calculator||Ll,this.batchSize=i.batchSize||xl,this.batchSizeIE=i.batchSizeIE||Cl,this.clusterClass=i.clusterClass||Sl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var i=r[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,f=this.clusters;a<f.length;a++){var p=f[a];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var L=m[h];google.maps.event.removeListener(L)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var f=a[i],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){r=i;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var i=this.removeMarker_(e);return!r&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,r){for(var i=!1,a=0,f=e;a<f.length;a++){var p=f[a];i=i||this.removeMarker_(p)}return!r&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var f=a[i];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var f=r.fromDivPixelToLatLng(i);f!==null&&e.extend(f)}if(a!==null){var p=r.fromDivPixelToLatLng(a);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,i=this.clusters;r<i.length;r++){var a=i[r];a.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var i=6371,a=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return i*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var i=e.getPosition();return i?r.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var r,i=4e4,a=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),L=e.getPosition();if(m&&L){var w=this.distanceBetweenPoints(m,L);w<i&&(i=w,a=r)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(r=new wl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,f=i?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),L=e;L<m;L++){var w=this.markers[L];w&&!w.isAdded&&this.isMarkerInBounds(w,h)&&(!this.ignoreHidden||this.ignoreHidden&&w.getVisible())&&this.addToClosestCluster(w)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var b=0,x=this.clusters;b<x.length;b++){var j=x[b];j.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype){var p=f;this.prototype[p]=a.prototype[p]}return this}).apply(e,[r])},t})();function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ut={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Ue={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Ol={};function _l(t){var{children:e,options:r,averageCenter:i,batchSizeIE:a,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:L,imageExtension:w,imagePath:b,imageSizes:x,maxZoom:j,minimumClusterSize:k,styles:R,title:U,zoomOnClick:V,onClick:W,onClusteringBegin:ee,onClusteringEnd:K,onMouseOver:A,onMouseOut:S,onLoad:z,onUnmount:H}=t,[F,X]=l.useState(null),G=l.useContext(Me),[re,de]=l.useState(null),[pe,ue]=l.useState(null),[ge,ce]=l.useState(null),[he,we]=l.useState(null),[me,xe]=l.useState(null);return l.useEffect(()=>{F&&S&&(he!==null&&google.maps.event.removeListener(he),we(google.maps.event.addListener(F,ut.onMouseOut,S)))},[S]),l.useEffect(()=>{F&&A&&(me!==null&&google.maps.event.removeListener(me),xe(google.maps.event.addListener(F,ut.onMouseOver,A)))},[A]),l.useEffect(()=>{F&&W&&(re!==null&&google.maps.event.removeListener(re),de(google.maps.event.addListener(F,ut.onClick,W)))},[W]),l.useEffect(()=>{F&&ee&&(pe!==null&&google.maps.event.removeListener(pe),ue(google.maps.event.addListener(F,ut.onClusteringBegin,ee)))},[ee]),l.useEffect(()=>{F&&K&&(ge!==null&&google.maps.event.removeListener(ge),ue(google.maps.event.addListener(F,ut.onClusteringEnd,K)))},[K]),l.useEffect(()=>{typeof i<"u"&&F!==null&&Ue.averageCenter(F,i)},[F,i]),l.useEffect(()=>{typeof a<"u"&&F!==null&&Ue.batchSizeIE(F,a)},[F,a]),l.useEffect(()=>{typeof f<"u"&&F!==null&&Ue.calculator(F,f)},[F,f]),l.useEffect(()=>{typeof p<"u"&&F!==null&&Ue.clusterClass(F,p)},[F,p]),l.useEffect(()=>{typeof h<"u"&&F!==null&&Ue.enableRetinaIcons(F,h)},[F,h]),l.useEffect(()=>{typeof m<"u"&&F!==null&&Ue.gridSize(F,m)},[F,m]),l.useEffect(()=>{typeof L<"u"&&F!==null&&Ue.ignoreHidden(F,L)},[F,L]),l.useEffect(()=>{typeof w<"u"&&F!==null&&Ue.imageExtension(F,w)},[F,w]),l.useEffect(()=>{typeof b<"u"&&F!==null&&Ue.imagePath(F,b)},[F,b]),l.useEffect(()=>{typeof x<"u"&&F!==null&&Ue.imageSizes(F,x)},[F,x]),l.useEffect(()=>{typeof j<"u"&&F!==null&&Ue.maxZoom(F,j)},[F,j]),l.useEffect(()=>{typeof k<"u"&&F!==null&&Ue.minimumClusterSize(F,k)},[F,k]),l.useEffect(()=>{typeof R<"u"&&F!==null&&Ue.styles(F,R)},[F,R]),l.useEffect(()=>{typeof U<"u"&&F!==null&&Ue.title(F,U)},[F,U]),l.useEffect(()=>{typeof V<"u"&&F!==null&&Ue.zoomOnClick(F,V)},[F,V]),l.useEffect(()=>{if(G){var Pe=Pl({},r||Ol),ye=new Ys(G,[],Pe);return i&&Ue.averageCenter(ye,i),a&&Ue.batchSizeIE(ye,a),f&&Ue.calculator(ye,f),p&&Ue.clusterClass(ye,p),h&&Ue.enableRetinaIcons(ye,h),m&&Ue.gridSize(ye,m),L&&Ue.ignoreHidden(ye,L),w&&Ue.imageExtension(ye,w),b&&Ue.imagePath(ye,b),x&&Ue.imageSizes(ye,x),j&&Ue.maxZoom(ye,j),k&&Ue.minimumClusterSize(ye,k),R&&Ue.styles(ye,R),U&&Ue.title(ye,U),V&&Ue.zoomOnClick(ye,V),S&&we(google.maps.event.addListener(ye,ut.onMouseOut,S)),A&&xe(google.maps.event.addListener(ye,ut.onMouseOver,A)),W&&de(google.maps.event.addListener(ye,ut.onClick,W)),ee&&ue(google.maps.event.addListener(ye,ut.onClusteringBegin,ee)),K&&ce(google.maps.event.addListener(ye,ut.onClusteringEnd,K)),X(ye),z&&z(ye),()=>{he!==null&&google.maps.event.removeListener(he),me!==null&&google.maps.event.removeListener(me),re!==null&&google.maps.event.removeListener(re),pe!==null&&google.maps.event.removeListener(pe),ge!==null&&google.maps.event.removeListener(ge),H&&H(ye)}}},[]),F!==null&&e(F)||null}l.memo(_l);class Dl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{markerClusterer:null}),N(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ys(this.context,[],this.props.options);this.registeredEvents=_e({updaterMap:Ue,eventMap:ut,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ue,eventMap:ut,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),Ie(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}N(Dl,"contextType",Me);function jo(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Xs=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(w){w.returnValue=!1,w.preventDefault&&w.preventDefault(),e.enableEventPropagation||jo(w)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,jo))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var i=0,a=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,L=this.pixelOffset.width,w=this.pixelOffset.height,b=this.div.offsetWidth,x=this.div.offsetHeight,j=this.infoBoxClearance.width,k=this.infoBoxClearance.height,R=this.getProjection(),U=R.fromLatLngToContainerPixel(this.position);U!==null&&(U.x<-L+j?i=U.x+L-j:U.x+b+L+j>h&&(i=U.x+b+L+j-h),this.alignBottom?U.y<-w+k+x?a=U.y+w-k-x:U.y+w+k>m&&(a=U.y+w+k-m):U.y<-w+k?a=U.y+w-k:U.y+x+w+k>m&&(a=U.y+x+w+k-m)),i===0&&a===0||r.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,i=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var i=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){i.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var i=r[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=a.prototype[f]);return this}).apply(e,[r])},t})(),Il=["position"],jl=["position"];function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ro(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var To={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Ao={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Rl={};function Tl(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:L,onZindexChanged:w,onLoad:b,onUnmount:x}=t,j=l.useContext(Me),[k,R]=l.useState(null),[U,V]=l.useState(null),[W,ee]=l.useState(null),[K,A]=l.useState(null),[S,z]=l.useState(null),[H,F]=l.useState(null),X=l.useRef(null);return l.useEffect(()=>{j&&k!==null&&(k.close(),r?k.open(j,r):k.getPosition()&&k.open(j))},[j,k,r]),l.useEffect(()=>{i&&k!==null&&k.setOptions(i)},[k,i]),l.useEffect(()=>{if(a&&k!==null){var G=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);k.setPosition(G)}},[a]),l.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),l.useEffect(()=>{k&&p&&(U!==null&&google.maps.event.removeListener(U),V(google.maps.event.addListener(k,"closeclick",p)))},[p]),l.useEffect(()=>{k&&h&&(W!==null&&google.maps.event.removeListener(W),ee(google.maps.event.addListener(k,"domready",h)))},[h]),l.useEffect(()=>{k&&m&&(K!==null&&google.maps.event.removeListener(K),A(google.maps.event.addListener(k,"content_changed",m)))},[m]),l.useEffect(()=>{k&&L&&(S!==null&&google.maps.event.removeListener(S),z(google.maps.event.addListener(k,"position_changed",L)))},[L]),l.useEffect(()=>{k&&w&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(k,"zindex_changed",w)))},[w]),l.useEffect(()=>{if(j){var G=i||Rl,{position:re}=G,de=Ii(G,Il),pe;re&&!(re instanceof google.maps.LatLng)&&(pe=new google.maps.LatLng(re.lat,re.lng));var ue=new Xs(kr(kr({},de),pe?{position:pe}:{}));X.current=document.createElement("div"),R(ue),p&&V(google.maps.event.addListener(ue,"closeclick",p)),h&&ee(google.maps.event.addListener(ue,"domready",h)),m&&A(google.maps.event.addListener(ue,"content_changed",m)),L&&z(google.maps.event.addListener(ue,"position_changed",L)),w&&F(google.maps.event.addListener(ue,"zindex_changed",w)),ue.setContent(X.current),r?ue.open(j,r):ue.getPosition()?ue.open(j):We(!1,"You must provide either an anchor or a position prop for <InfoBox>."),b&&b(ue)}return()=>{k!==null&&(U&&google.maps.event.removeListener(U),K&&google.maps.event.removeListener(K),W&&google.maps.event.removeListener(W),S&&google.maps.event.removeListener(S),H&&google.maps.event.removeListener(H),x&&x(k),k.close())}},[]),X.current?Ln.createPortal(l.Children.only(e),X.current):null}l.memo(Tl);class Al extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoBox:null}),N(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):We(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),N(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,i=Ii(e,jl),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var f=new Xs(kr(kr({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:Ao,eventMap:To,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ao,eventMap:To,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),Ie(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(Al,"contextType",Me);var pi,Bo;function Bl(){return Bo||(Bo=1,pi=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),pi}var Ul=Bl(),Uo=Zs(Ul),zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],hi=1,An=8;class ji{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==hi)throw new Error("Got v".concat(a," data when expected v").concat(hi,"."));var f=zo[i&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new ji(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=zo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(An+p+h+m),this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(hi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return wi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],L=[];m.length;){var w=m.pop()||0,b=m.pop()||0,x=m.pop()||0;if(b-x<=h){for(var j=x;j<=b;j++){var k=p[2*j],R=p[2*j+1];k>=e&&k<=i&&R>=r&&R<=a&&L.push(f[j])}continue}var U=x+b>>1,V=p[2*U],W=p[2*U+1];V>=e&&V<=i&&W>=r&&W<=a&&L.push(f[U]),(w===0?e<=V:r<=W)&&(m.push(x),m.push(U-1),m.push(1-w)),(w===0?i>=V:a>=W)&&(m.push(U+1),m.push(b),m.push(1-w))}return L}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:f,nodeSize:p}=this,h=[0,a.length-1,0],m=[],L=i*i;h.length;){var w=h.pop()||0,b=h.pop()||0,x=h.pop()||0;if(b-x<=p){for(var j=x;j<=b;j++)Fo(f[2*j],f[2*j+1],e,r)<=L&&m.push(a[j]);continue}var k=x+b>>1,R=f[2*k],U=f[2*k+1];Fo(R,U,e,r)<=L&&m.push(a[k]),(w===0?e-i<=R:r-i<=U)&&(h.push(x),h.push(k-1),h.push(1-w)),(w===0?e+i>=R:r+i>=U)&&(h.push(k+1),h.push(b),h.push(1-w))}return m}}function wi(t,e,r,i,a,f){if(!(a-i<=r)){var p=i+a>>1;Js(t,e,p,i,a,f),wi(t,e,r,i,p-1,1-f),wi(t,e,r,p+1,a,1-f)}}function Js(t,e,r,i,a,f){for(;a>i;){if(a-i>600){var p=a-i+1,h=r-i+1,m=Math.log(p),L=.5*Math.exp(2*m/3),w=.5*Math.sqrt(m*L*(p-L)/p)*(h-p/2<0?-1:1),b=Math.max(i,Math.floor(r-h*L/p+w)),x=Math.min(a,Math.floor(r+(p-h)*L/p+w));Js(t,e,r,b,x,f)}var j=e[2*r+f],k=i,R=a;for(Bn(t,e,i,r),e[2*a+f]>j&&Bn(t,e,i,a);k<R;){for(Bn(t,e,k,R),k++,R--;e[2*k+f]<j;)k++;for(;e[2*R+f]>j;)R--}e[2*i+f]===j?Bn(t,e,i,R):(R++,Bn(t,e,R,a)),R<=r&&(i=R+1),r<=R&&(a=R-1)}}function Bn(t,e,r,i){gi(t,r,i),gi(e,2*r,2*i),gi(e,2*r+1,2*i+1)}function gi(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Fo(t,e,r,i){var a=t-r,f=e-i;return a*a+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ko=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Xt=2,Kt=3,mi=4,Ft=5,Qs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:i,maxZoom:a}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[L,w]=m.geometry.coordinates,b=Ko(vr(L)),x=Ko(yr(w));p.push(b,x,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var j=this.trees[a+1]=this._createTree(p);r&&console.timeEnd(f);for(var k=a;k>=i;k--){var R=+Date.now();j=this.trees[k]=this._createTree(this._cluster(j,k)),r&&console.log("z%d: %d clusters in %dms",k,j.numItems,+Date.now()-R)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,f=180;else if(i>f){var h=this.getClusters([i,a,180,p],r),m=this.getClusters([-180,a,f,p],r);return h.concat(m)}var L=this.trees[this._limitZoom(r)],w=L.range(vr(i),yr(p),vr(f),yr(a)),b=L.data,x=[];for(var j of w){var k=this.stride*j;x.push(b[k+Ft]>1?No(b,k,this.clusterProps):this.points[b[k+Kt]])}return x}getChildren(e){var r=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",f=this.trees[i];if(!f)throw new Error(a);var p=f.data;if(r*this.stride>=p.length)throw new Error(a);var h=this.options.radius/(this.options.extent*Math.pow(2,i-1)),m=p[r*this.stride],L=p[r*this.stride+1],w=f.within(m,L,h),b=[];for(var x of w){var j=x*this.stride;p[j+mi]===e&&b.push(p[j+Ft]>1?No(p,j,this.clusterProps):this.points[p[j+Kt]])}if(b.length===0)throw new Error(a);return b}getLeaves(e,r,i){r=r||10,i=i||0;var a=[];return this._appendLeaves(a,e,r,i,0),a}getTile(e,r,i){var a=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,L=(i-m)/f,w=(i+1+m)/f,b={features:[]};return this._addTileFeatures(a.range((r-m)/f,L,(r+1+m)/f,w),a.data,r,i,f,b),r===0&&this._addTileFeatures(a.range(1-m/f,L,1,w),a.data,f,i,f,b),r===f-1&&this._addTileFeatures(a.range(0,L,m/f,w),a.data,-1,i,f,b),b.features.length?b:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var i=this.getChildren(e);if(r++,i.length!==1)break;e=i[0].properties.cluster_id}return r}_appendLeaves(e,r,i,a,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=a?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,i,a,f):f<a?f++:e.push(h),e.length===i)break}return f}_createTree(e){for(var r=new ji(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)r.add(e[i],e[i+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,i,a,f,p){for(var h of e){var m=h*this.stride,L=r[m+Ft]>1,w=void 0,b=void 0,x=void 0;if(L)w=ea(r,m,this.clusterProps),b=r[m],x=r[m+1];else{var j=this.points[r[m+Kt]];w=j.properties;var[k,R]=j.geometry.coordinates;b=vr(k),x=yr(R)}var U={type:1,geometry:[[Math.round(this.options.extent*(b*f-i)),Math.round(this.options.extent*(x*f-a))]],tags:w},V=void 0;L||this.options.generateId?V=r[m+Kt]:V=this.points[r[m+Kt]].id,V!==void 0&&(U.id=V),p.features.push(U)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:i,extent:a,reduce:f,minPoints:p}=this.options,h=i/(a*Math.pow(2,r)),m=e.data,L=[],w=this.stride,b=0;b<m.length;b+=w)if(!(m[b+Xt]<=r)){m[b+Xt]=r;var x=m[b],j=m[b+1],k=e.within(m[b],m[b+1],h),R=m[b+Ft],U=R;for(var V of k){var W=V*w;m[W+Xt]>r&&(U+=m[W+Ft])}if(U>R&&U>=p){var ee=x*R,K=j*R,A=void 0,S=-1,z=((b/w|0)<<5)+(r+1)+this.points.length;for(var H of k){var F=H*w;if(!(m[F+Xt]<=r)){m[F+Xt]=r;var X=m[F+Ft];ee+=m[F]*X,K+=m[F+1]*X,m[F+mi]=z,f&&(A||(A=this._map(m,b,!0),S=this.clusterProps.length,this.clusterProps.push(A)),f(A,this._map(m,F)))}}m[b+mi]=z,L.push(ee/U,K/U,1/0,z,-1,U),f&&L.push(S)}else{for(var G=0;G<w;G++)L.push(m[b+G]);if(U>1)for(var re of k){var de=re*w;if(!(m[de+Xt]<=r)){m[de+Xt]=r;for(var pe=0;pe<w;pe++)L.push(m[de+pe])}}}}return L}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,i){if(e[r+Ft]>1){var a=this.clusterProps[e[r+Qs]];return i?Object.assign({},a):a}var f=this.points[e[r+Kt]].properties,p=this.options.map(f);return i&&p===f?Object.assign({},p):p}}function No(t,e,r){return{type:"Feature",id:t[e+Kt],properties:ea(t,e,r),geometry:{type:"Point",coordinates:[Kl(t[e]),Nl(t[e+1])]}}}function ea(t,e,r){var i=t[e+Ft],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,f=t[e+Qs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Kt],point_count:i,point_count_abbreviated:a})}function vr(t){return t/360+.5}function yr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Kl(t){return(t-.5)*360}function Nl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ql(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(r[i[a]]=t[i[a]]);return r}class ot{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Li{constructor(e){var{markers:r,position:i}=e;this.markers=r,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(ot.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ot.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ot.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Wl{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Zl(r)}}var Zl=t=>{var e=t.map(r=>new Li({position:ot.getPosition(r),markers:[r]}));return e};class $l extends Wl{constructor(e){var{maxZoom:r,radius:i=60}=e,a=ql(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var r=!1,i={zoom:e.map.getZoom()};if(!Uo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var a=this.markers.map(f=>{var p=ot.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(r=!Uo(this.state,i)),this.state=i,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[r,i]},properties:a}=e;if(a.cluster)return new Li({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:i,lng:r}});var f=a.marker;return new Li({markers:[f],position:ot.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var i=r.map(f=>f.count),a=i.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class Hl{render(e,r,i){var{count:a,position:f}=e,p=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),m="Cluster of ".concat(a," markers"),L=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ot.isAdvancedMarkerAvailable(i)){var w=new DOMParser,b=w.parseFromString(h,"image/svg+xml").documentElement;b.setAttribute("transform","translate(0 25)");var x={map:i,position:f,zIndex:L,title:m,content:b};return new google.maps.marker.AdvancedMarkerElement(x)}var j={position:f,zIndex:L,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(j)}}function Gl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ri{constructor(){Gl(Ri,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Yl=(t,e,r)=>{r.fitBounds(e.bounds)};class Xl extends Ri{constructor(e){var{map:r,markers:i=[],algorithmOptions:a={},algorithm:f=new $l(a),renderer:p=new Hl,onClusterClick:h=Yl}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(i=>{this.addMarker(i,!0)}),r||this.render()}removeMarker(e,r){var i=this.markers.indexOf(e);return i===-1?!1:(ot.setMap(e,null),this.markers.splice(i,1),r||this.render(),!0)}removeMarkers(e,r){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!r&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var f of r)f.markers.length==1&&a.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?a.has(h.marker)||ot.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>ot.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ot.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,r),i.markers.forEach(a=>ot.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,i),this.onClusterClick(a,i,r)})),ot.setMap(i.marker,r)})}}function qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Wo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Jl(t){var e=qa(),[r,i]=l.useState(null);return l.useEffect(()=>{if(e&&r===null){var a=new Xl(Wo(Wo({},t),{},{map:e}));i(a)}},[e]),r}function Ql(t){var{children:e,options:r}=t,i=Jl(r);return i!==null?e(i):null}l.memo(Ql);var Zo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},$o={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function eu(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:L,onZindexChanged:w,onLoad:b,onUnmount:x}=t,j=l.useContext(Me),[k,R]=l.useState(null),[U,V]=l.useState(null),[W,ee]=l.useState(null),[K,A]=l.useState(null),[S,z]=l.useState(null),[H,F]=l.useState(null),X=l.useRef(null);return l.useEffect(()=>{k!==null&&(k.close(),r?k.open(j,r):k.getPosition()&&k.open(j))},[j,k,r]),l.useEffect(()=>{i&&k!==null&&k.setOptions(i)},[k,i]),l.useEffect(()=>{a&&k!==null&&k.setPosition(a)},[a]),l.useEffect(()=>{typeof f=="number"&&k!==null&&k.setZIndex(f)},[f]),l.useEffect(()=>{k&&p&&(U!==null&&google.maps.event.removeListener(U),V(google.maps.event.addListener(k,"closeclick",p)))},[p]),l.useEffect(()=>{k&&h&&(W!==null&&google.maps.event.removeListener(W),ee(google.maps.event.addListener(k,"domready",h)))},[h]),l.useEffect(()=>{k&&m&&(K!==null&&google.maps.event.removeListener(K),A(google.maps.event.addListener(k,"content_changed",m)))},[m]),l.useEffect(()=>{k&&L&&(S!==null&&google.maps.event.removeListener(S),z(google.maps.event.addListener(k,"position_changed",L)))},[L]),l.useEffect(()=>{k&&w&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(k,"zindex_changed",w)))},[w]),l.useEffect(()=>{var G=new google.maps.InfoWindow(i);return R(G),X.current=document.createElement("div"),p&&V(google.maps.event.addListener(G,"closeclick",p)),h&&ee(google.maps.event.addListener(G,"domready",h)),m&&A(google.maps.event.addListener(G,"content_changed",m)),L&&z(google.maps.event.addListener(G,"position_changed",L)),w&&F(google.maps.event.addListener(G,"zindex_changed",w)),G.setContent(X.current),a&&G.setPosition(a),f&&G.setZIndex(f),r?G.open(j,r):G.getPosition()?G.open(j):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),b&&b(G),()=>{U&&google.maps.event.removeListener(U),K&&google.maps.event.removeListener(K),W&&google.maps.event.removeListener(W),S&&google.maps.event.removeListener(S),H&&google.maps.event.removeListener(H),x&&x(G),G.close()}},[]),X.current?Ln.createPortal(l.Children.only(e),X.current):null}l.memo(eu);class tu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoWindow:null}),N(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),N(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(Ie(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(tu,"contextType",Me);function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ho={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Go={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},nu={};function ru(t){var{options:e,draggable:r,editable:i,visible:a,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:L,onMouseMove:w,onMouseOut:b,onMouseOver:x,onMouseUp:j,onRightClick:k,onClick:R,onDrag:U,onLoad:V,onUnmount:W}=t,ee=l.useContext(Me),[K,A]=l.useState(null),[S,z]=l.useState(null),[H,F]=l.useState(null),[X,G]=l.useState(null),[re,de]=l.useState(null),[pe,ue]=l.useState(null),[ge,ce]=l.useState(null),[he,we]=l.useState(null),[me,xe]=l.useState(null),[Pe,ye]=l.useState(null),[Re,Z]=l.useState(null),[Ae,ze]=l.useState(null);return l.useEffect(()=>{K!==null&&K.setMap(ee)},[ee]),l.useEffect(()=>{typeof e<"u"&&K!==null&&K.setOptions(e)},[K,e]),l.useEffect(()=>{typeof r<"u"&&K!==null&&K.setDraggable(r)},[K,r]),l.useEffect(()=>{typeof i<"u"&&K!==null&&K.setEditable(i)},[K,i]),l.useEffect(()=>{typeof a<"u"&&K!==null&&K.setVisible(a)},[K,a]),l.useEffect(()=>{typeof f<"u"&&K!==null&&K.setPath(f)},[K,f]),l.useEffect(()=>{K&&p&&(S!==null&&google.maps.event.removeListener(S),z(google.maps.event.addListener(K,"dblclick",p)))},[p]),l.useEffect(()=>{K&&h&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(K,"dragend",h)))},[h]),l.useEffect(()=>{K&&m&&(X!==null&&google.maps.event.removeListener(X),G(google.maps.event.addListener(K,"dragstart",m)))},[m]),l.useEffect(()=>{K&&L&&(re!==null&&google.maps.event.removeListener(re),de(google.maps.event.addListener(K,"mousedown",L)))},[L]),l.useEffect(()=>{K&&w&&(pe!==null&&google.maps.event.removeListener(pe),ue(google.maps.event.addListener(K,"mousemove",w)))},[w]),l.useEffect(()=>{K&&b&&(ge!==null&&google.maps.event.removeListener(ge),ce(google.maps.event.addListener(K,"mouseout",b)))},[b]),l.useEffect(()=>{K&&x&&(he!==null&&google.maps.event.removeListener(he),we(google.maps.event.addListener(K,"mouseover",x)))},[x]),l.useEffect(()=>{K&&j&&(me!==null&&google.maps.event.removeListener(me),xe(google.maps.event.addListener(K,"mouseup",j)))},[j]),l.useEffect(()=>{K&&k&&(Pe!==null&&google.maps.event.removeListener(Pe),ye(google.maps.event.addListener(K,"rightclick",k)))},[k]),l.useEffect(()=>{K&&R&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(K,"click",R)))},[R]),l.useEffect(()=>{K&&U&&(Ae!==null&&google.maps.event.removeListener(Ae),ze(google.maps.event.addListener(K,"drag",U)))},[U]),l.useEffect(()=>{var J=new google.maps.Polyline(Sr(Sr({},e||nu),{},{map:ee}));return f&&J.setPath(f),typeof a<"u"&&J.setVisible(a),typeof i<"u"&&J.setEditable(i),typeof r<"u"&&J.setDraggable(r),p&&z(google.maps.event.addListener(J,"dblclick",p)),h&&F(google.maps.event.addListener(J,"dragend",h)),m&&G(google.maps.event.addListener(J,"dragstart",m)),L&&de(google.maps.event.addListener(J,"mousedown",L)),w&&ue(google.maps.event.addListener(J,"mousemove",w)),b&&ce(google.maps.event.addListener(J,"mouseout",b)),x&&we(google.maps.event.addListener(J,"mouseover",x)),j&&xe(google.maps.event.addListener(J,"mouseup",j)),k&&ye(google.maps.event.addListener(J,"rightclick",k)),R&&Z(google.maps.event.addListener(J,"click",R)),U&&ze(google.maps.event.addListener(J,"drag",U)),A(J),V&&V(J),()=>{S!==null&&google.maps.event.removeListener(S),H!==null&&google.maps.event.removeListener(H),X!==null&&google.maps.event.removeListener(X),re!==null&&google.maps.event.removeListener(re),pe!==null&&google.maps.event.removeListener(pe),ge!==null&&google.maps.event.removeListener(ge),he!==null&&google.maps.event.removeListener(he),me!==null&&google.maps.event.removeListener(me),Pe!==null&&google.maps.event.removeListener(Pe),Re!==null&&google.maps.event.removeListener(Re),W&&W(J),J.setMap(null)}},[]),null}l.memo(ru);class iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{polyline:null}),N(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Sr(Sr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),Ie(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}N(iu,"contextType",Me);function Yo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Xo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Jo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Qo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function ou(t){var{options:e,draggable:r,editable:i,visible:a,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:L,onMouseDown:w,onMouseMove:b,onMouseOut:x,onMouseOver:j,onMouseUp:k,onRightClick:R,onClick:U,onDrag:V,onLoad:W,onUnmount:ee,onEdit:K}=t,A=l.useContext(Me),[S,z]=l.useState(null),[H,F]=l.useState(null),[X,G]=l.useState(null),[re,de]=l.useState(null),[pe,ue]=l.useState(null),[ge,ce]=l.useState(null),[he,we]=l.useState(null),[me,xe]=l.useState(null),[Pe,ye]=l.useState(null),[Re,Z]=l.useState(null),[Ae,ze]=l.useState(null),[J,Y]=l.useState(null);return l.useEffect(()=>{S!==null&&S.setMap(A)},[A]),l.useEffect(()=>{typeof e<"u"&&S!==null&&S.setOptions(e)},[S,e]),l.useEffect(()=>{typeof r<"u"&&S!==null&&S.setDraggable(r)},[S,r]),l.useEffect(()=>{typeof i<"u"&&S!==null&&S.setEditable(i)},[S,i]),l.useEffect(()=>{typeof a<"u"&&S!==null&&S.setVisible(a)},[S,a]),l.useEffect(()=>{typeof f<"u"&&S!==null&&S.setPath(f)},[S,f]),l.useEffect(()=>{typeof p<"u"&&S!==null&&S.setPaths(p)},[S,p]),l.useEffect(()=>{S&&typeof h=="function"&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(S,"dblclick",h)))},[h]),l.useEffect(()=>{S&&(google.maps.event.addListener(S.getPath(),"insert_at",()=>{K?.(S)}),google.maps.event.addListener(S.getPath(),"set_at",()=>{K?.(S)}),google.maps.event.addListener(S.getPath(),"remove_at",()=>{K?.(S)}))},[S,K]),l.useEffect(()=>{S&&typeof m=="function"&&(X!==null&&google.maps.event.removeListener(X),G(google.maps.event.addListener(S,"dragend",m)))},[m]),l.useEffect(()=>{S&&typeof L=="function"&&(re!==null&&google.maps.event.removeListener(re),de(google.maps.event.addListener(S,"dragstart",L)))},[L]),l.useEffect(()=>{S&&typeof w=="function"&&(pe!==null&&google.maps.event.removeListener(pe),ue(google.maps.event.addListener(S,"mousedown",w)))},[w]),l.useEffect(()=>{S&&typeof b=="function"&&(ge!==null&&google.maps.event.removeListener(ge),ce(google.maps.event.addListener(S,"mousemove",b)))},[b]),l.useEffect(()=>{S&&typeof x=="function"&&(he!==null&&google.maps.event.removeListener(he),we(google.maps.event.addListener(S,"mouseout",x)))},[x]),l.useEffect(()=>{S&&typeof j=="function"&&(me!==null&&google.maps.event.removeListener(me),xe(google.maps.event.addListener(S,"mouseover",j)))},[j]),l.useEffect(()=>{S&&typeof k=="function"&&(Pe!==null&&google.maps.event.removeListener(Pe),ye(google.maps.event.addListener(S,"mouseup",k)))},[k]),l.useEffect(()=>{S&&typeof R=="function"&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(S,"rightclick",R)))},[R]),l.useEffect(()=>{S&&typeof U=="function"&&(Ae!==null&&google.maps.event.removeListener(Ae),ze(google.maps.event.addListener(S,"click",U)))},[U]),l.useEffect(()=>{S&&typeof V=="function"&&(J!==null&&google.maps.event.removeListener(J),Y(google.maps.event.addListener(S,"drag",V)))},[V]),l.useEffect(()=>{var be=new google.maps.Polygon(Xo(Xo({},e),{},{map:A}));return f&&be.setPath(f),p&&be.setPaths(p),typeof a<"u"&&be.setVisible(a),typeof i<"u"&&be.setEditable(i),typeof r<"u"&&be.setDraggable(r),h&&F(google.maps.event.addListener(be,"dblclick",h)),m&&G(google.maps.event.addListener(be,"dragend",m)),L&&de(google.maps.event.addListener(be,"dragstart",L)),w&&ue(google.maps.event.addListener(be,"mousedown",w)),b&&ce(google.maps.event.addListener(be,"mousemove",b)),x&&we(google.maps.event.addListener(be,"mouseout",x)),j&&xe(google.maps.event.addListener(be,"mouseover",j)),k&&ye(google.maps.event.addListener(be,"mouseup",k)),R&&Z(google.maps.event.addListener(be,"rightclick",R)),U&&ze(google.maps.event.addListener(be,"click",U)),V&&Y(google.maps.event.addListener(be,"drag",V)),z(be),W&&W(be),()=>{H!==null&&google.maps.event.removeListener(H),X!==null&&google.maps.event.removeListener(X),re!==null&&google.maps.event.removeListener(re),pe!==null&&google.maps.event.removeListener(pe),ge!==null&&google.maps.event.removeListener(ge),he!==null&&google.maps.event.removeListener(he),me!==null&&google.maps.event.removeListener(me),Pe!==null&&google.maps.event.removeListener(Pe),Re!==null&&google.maps.event.removeListener(Re),Ae!==null&&google.maps.event.removeListener(Ae),ee&&ee(be),be.setMap(null)}},[]),null}l.memo(ou);class su extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),Ie(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}N(su,"contextType",Me);function es(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?es(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ts={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ns={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function au(t){var{options:e,bounds:r,draggable:i,editable:a,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:L,onMouseMove:w,onMouseOut:b,onMouseOver:x,onMouseUp:j,onRightClick:k,onClick:R,onDrag:U,onBoundsChanged:V,onLoad:W,onUnmount:ee}=t,K=l.useContext(Me),[A,S]=l.useState(null),[z,H]=l.useState(null),[F,X]=l.useState(null),[G,re]=l.useState(null),[de,pe]=l.useState(null),[ue,ge]=l.useState(null),[ce,he]=l.useState(null),[we,me]=l.useState(null),[xe,Pe]=l.useState(null),[ye,Re]=l.useState(null),[Z,Ae]=l.useState(null),[ze,J]=l.useState(null),[Y,be]=l.useState(null);return l.useEffect(()=>{A!==null&&A.setMap(K)},[K]),l.useEffect(()=>{typeof e<"u"&&A!==null&&A.setOptions(e)},[A,e]),l.useEffect(()=>{typeof i<"u"&&A!==null&&A.setDraggable(i)},[A,i]),l.useEffect(()=>{typeof a<"u"&&A!==null&&A.setEditable(a)},[A,a]),l.useEffect(()=>{typeof f<"u"&&A!==null&&A.setVisible(f)},[A,f]),l.useEffect(()=>{typeof r<"u"&&A!==null&&A.setBounds(r)},[A,r]),l.useEffect(()=>{A&&p&&(z!==null&&google.maps.event.removeListener(z),H(google.maps.event.addListener(A,"dblclick",p)))},[p]),l.useEffect(()=>{A&&h&&(F!==null&&google.maps.event.removeListener(F),X(google.maps.event.addListener(A,"dragend",h)))},[h]),l.useEffect(()=>{A&&m&&(G!==null&&google.maps.event.removeListener(G),re(google.maps.event.addListener(A,"dragstart",m)))},[m]),l.useEffect(()=>{A&&L&&(de!==null&&google.maps.event.removeListener(de),pe(google.maps.event.addListener(A,"mousedown",L)))},[L]),l.useEffect(()=>{A&&w&&(ue!==null&&google.maps.event.removeListener(ue),ge(google.maps.event.addListener(A,"mousemove",w)))},[w]),l.useEffect(()=>{A&&b&&(ce!==null&&google.maps.event.removeListener(ce),he(google.maps.event.addListener(A,"mouseout",b)))},[b]),l.useEffect(()=>{A&&x&&(we!==null&&google.maps.event.removeListener(we),me(google.maps.event.addListener(A,"mouseover",x)))},[x]),l.useEffect(()=>{A&&j&&(xe!==null&&google.maps.event.removeListener(xe),Pe(google.maps.event.addListener(A,"mouseup",j)))},[j]),l.useEffect(()=>{A&&k&&(ye!==null&&google.maps.event.removeListener(ye),Re(google.maps.event.addListener(A,"rightclick",k)))},[k]),l.useEffect(()=>{A&&R&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(A,"click",R)))},[R]),l.useEffect(()=>{A&&U&&(ze!==null&&google.maps.event.removeListener(ze),J(google.maps.event.addListener(A,"drag",U)))},[U]),l.useEffect(()=>{A&&V&&(Y!==null&&google.maps.event.removeListener(Y),be(google.maps.event.addListener(A,"bounds_changed",V)))},[V]),l.useEffect(()=>{var De=new google.maps.Rectangle(Pr(Pr({},e),{},{map:K}));return typeof f<"u"&&De.setVisible(f),typeof a<"u"&&De.setEditable(a),typeof i<"u"&&De.setDraggable(i),typeof r<"u"&&De.setBounds(r),p&&H(google.maps.event.addListener(De,"dblclick",p)),h&&X(google.maps.event.addListener(De,"dragend",h)),m&&re(google.maps.event.addListener(De,"dragstart",m)),L&&pe(google.maps.event.addListener(De,"mousedown",L)),w&&ge(google.maps.event.addListener(De,"mousemove",w)),b&&he(google.maps.event.addListener(De,"mouseout",b)),x&&me(google.maps.event.addListener(De,"mouseover",x)),j&&Pe(google.maps.event.addListener(De,"mouseup",j)),k&&Re(google.maps.event.addListener(De,"rightclick",k)),R&&Ae(google.maps.event.addListener(De,"click",R)),U&&J(google.maps.event.addListener(De,"drag",U)),V&&be(google.maps.event.addListener(De,"bounds_changed",V)),S(De),W&&W(De),()=>{z!==null&&google.maps.event.removeListener(z),F!==null&&google.maps.event.removeListener(F),G!==null&&google.maps.event.removeListener(G),de!==null&&google.maps.event.removeListener(de),ue!==null&&google.maps.event.removeListener(ue),ce!==null&&google.maps.event.removeListener(ce),we!==null&&google.maps.event.removeListener(we),xe!==null&&google.maps.event.removeListener(xe),ye!==null&&google.maps.event.removeListener(ye),Z!==null&&google.maps.event.removeListener(Z),ze!==null&&google.maps.event.removeListener(ze),Y!==null&&google.maps.event.removeListener(Y),ee&&ee(De),De.setMap(null)}},[]),null}l.memo(au);class lu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{rectangle:null}),N(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),Ie(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}N(lu,"contextType",Me);function rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var is={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},os={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},uu={};function cu(t){var{options:e,center:r,radius:i,draggable:a,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:L,onMouseDown:w,onMouseMove:b,onMouseOut:x,onMouseOver:j,onMouseUp:k,onRightClick:R,onClick:U,onDrag:V,onCenterChanged:W,onRadiusChanged:ee,onLoad:K,onUnmount:A}=t,S=l.useContext(Me),[z,H]=l.useState(null),[F,X]=l.useState(null),[G,re]=l.useState(null),[de,pe]=l.useState(null),[ue,ge]=l.useState(null),[ce,he]=l.useState(null),[we,me]=l.useState(null),[xe,Pe]=l.useState(null),[ye,Re]=l.useState(null),[Z,Ae]=l.useState(null),[ze,J]=l.useState(null),[Y,be]=l.useState(null),[De,ke]=l.useState(null),[Xe,Wt]=l.useState(null);return l.useEffect(()=>{z!==null&&z.setMap(S)},[S]),l.useEffect(()=>{typeof e<"u"&&z!==null&&z.setOptions(e)},[z,e]),l.useEffect(()=>{typeof a<"u"&&z!==null&&z.setDraggable(a)},[z,a]),l.useEffect(()=>{typeof f<"u"&&z!==null&&z.setEditable(f)},[z,f]),l.useEffect(()=>{typeof p<"u"&&z!==null&&z.setVisible(p)},[z,p]),l.useEffect(()=>{typeof i=="number"&&z!==null&&z.setRadius(i)},[z,i]),l.useEffect(()=>{typeof r<"u"&&z!==null&&z.setCenter(r)},[z,r]),l.useEffect(()=>{z&&h&&(F!==null&&google.maps.event.removeListener(F),X(google.maps.event.addListener(z,"dblclick",h)))},[h]),l.useEffect(()=>{z&&m&&(G!==null&&google.maps.event.removeListener(G),re(google.maps.event.addListener(z,"dragend",m)))},[m]),l.useEffect(()=>{z&&L&&(de!==null&&google.maps.event.removeListener(de),pe(google.maps.event.addListener(z,"dragstart",L)))},[L]),l.useEffect(()=>{z&&w&&(ue!==null&&google.maps.event.removeListener(ue),ge(google.maps.event.addListener(z,"mousedown",w)))},[w]),l.useEffect(()=>{z&&b&&(ce!==null&&google.maps.event.removeListener(ce),he(google.maps.event.addListener(z,"mousemove",b)))},[b]),l.useEffect(()=>{z&&x&&(we!==null&&google.maps.event.removeListener(we),me(google.maps.event.addListener(z,"mouseout",x)))},[x]),l.useEffect(()=>{z&&j&&(xe!==null&&google.maps.event.removeListener(xe),Pe(google.maps.event.addListener(z,"mouseover",j)))},[j]),l.useEffect(()=>{z&&k&&(ye!==null&&google.maps.event.removeListener(ye),Re(google.maps.event.addListener(z,"mouseup",k)))},[k]),l.useEffect(()=>{z&&R&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(z,"rightclick",R)))},[R]),l.useEffect(()=>{z&&U&&(ze!==null&&google.maps.event.removeListener(ze),J(google.maps.event.addListener(z,"click",U)))},[U]),l.useEffect(()=>{z&&V&&(Y!==null&&google.maps.event.removeListener(Y),be(google.maps.event.addListener(z,"drag",V)))},[V]),l.useEffect(()=>{z&&W&&(De!==null&&google.maps.event.removeListener(De),ke(google.maps.event.addListener(z,"center_changed",W)))},[U]),l.useEffect(()=>{z&&ee&&(Xe!==null&&google.maps.event.removeListener(Xe),Wt(google.maps.event.addListener(z,"radius_changed",ee)))},[ee]),l.useEffect(()=>{var je=new google.maps.Circle(Or(Or({},e||uu),{},{map:S}));return typeof i=="number"&&je.setRadius(i),typeof r<"u"&&je.setCenter(r),typeof i=="number"&&je.setRadius(i),typeof p<"u"&&je.setVisible(p),typeof f<"u"&&je.setEditable(f),typeof a<"u"&&je.setDraggable(a),h&&X(google.maps.event.addListener(je,"dblclick",h)),m&&re(google.maps.event.addListener(je,"dragend",m)),L&&pe(google.maps.event.addListener(je,"dragstart",L)),w&&ge(google.maps.event.addListener(je,"mousedown",w)),b&&he(google.maps.event.addListener(je,"mousemove",b)),x&&me(google.maps.event.addListener(je,"mouseout",x)),j&&Pe(google.maps.event.addListener(je,"mouseover",j)),k&&Re(google.maps.event.addListener(je,"mouseup",k)),R&&Ae(google.maps.event.addListener(je,"rightclick",R)),U&&J(google.maps.event.addListener(je,"click",U)),V&&be(google.maps.event.addListener(je,"drag",V)),W&&ke(google.maps.event.addListener(je,"center_changed",W)),ee&&Wt(google.maps.event.addListener(je,"radius_changed",ee)),H(je),K&&K(je),()=>{F!==null&&google.maps.event.removeListener(F),G!==null&&google.maps.event.removeListener(G),de!==null&&google.maps.event.removeListener(de),ue!==null&&google.maps.event.removeListener(ue),ce!==null&&google.maps.event.removeListener(ce),we!==null&&google.maps.event.removeListener(we),xe!==null&&google.maps.event.removeListener(xe),ye!==null&&google.maps.event.removeListener(ye),Z!==null&&google.maps.event.removeListener(Z),ze!==null&&google.maps.event.removeListener(ze),De!==null&&google.maps.event.removeListener(De),Xe!==null&&google.maps.event.removeListener(Xe),A&&A(je),je.setMap(null)}},[]),null}l.memo(cu);class fu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{circle:null}),N(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),Ie(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}N(fu,"contextType",Me);function ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var as={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ls={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,i){t.loadGeoJson(e,r,i)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function du(t){var{options:e,onClick:r,onDblClick:i,onMouseDown:a,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:L,onAddFeature:w,onRemoveFeature:b,onRemoveProperty:x,onSetGeometry:j,onSetProperty:k,onLoad:R,onUnmount:U}=t,V=l.useContext(Me),[W,ee]=l.useState(null),[K,A]=l.useState(null),[S,z]=l.useState(null),[H,F]=l.useState(null),[X,G]=l.useState(null),[re,de]=l.useState(null),[pe,ue]=l.useState(null),[ge,ce]=l.useState(null),[he,we]=l.useState(null),[me,xe]=l.useState(null),[Pe,ye]=l.useState(null),[Re,Z]=l.useState(null),[Ae,ze]=l.useState(null),[J,Y]=l.useState(null);return l.useEffect(()=>{W!==null&&W.setMap(V)},[V]),l.useEffect(()=>{W&&i&&(K!==null&&google.maps.event.removeListener(K),A(google.maps.event.addListener(W,"dblclick",i)))},[i]),l.useEffect(()=>{W&&a&&(S!==null&&google.maps.event.removeListener(S),z(google.maps.event.addListener(W,"mousedown",a)))},[a]),l.useEffect(()=>{W&&f&&(H!==null&&google.maps.event.removeListener(H),F(google.maps.event.addListener(W,"mousemove",f)))},[f]),l.useEffect(()=>{W&&p&&(X!==null&&google.maps.event.removeListener(X),G(google.maps.event.addListener(W,"mouseout",p)))},[p]),l.useEffect(()=>{W&&h&&(re!==null&&google.maps.event.removeListener(re),de(google.maps.event.addListener(W,"mouseover",h)))},[h]),l.useEffect(()=>{W&&m&&(pe!==null&&google.maps.event.removeListener(pe),ue(google.maps.event.addListener(W,"mouseup",m)))},[m]),l.useEffect(()=>{W&&L&&(ge!==null&&google.maps.event.removeListener(ge),ce(google.maps.event.addListener(W,"rightclick",L)))},[L]),l.useEffect(()=>{W&&r&&(he!==null&&google.maps.event.removeListener(he),we(google.maps.event.addListener(W,"click",r)))},[r]),l.useEffect(()=>{W&&w&&(me!==null&&google.maps.event.removeListener(me),xe(google.maps.event.addListener(W,"addfeature",w)))},[w]),l.useEffect(()=>{W&&b&&(Pe!==null&&google.maps.event.removeListener(Pe),ye(google.maps.event.addListener(W,"removefeature",b)))},[b]),l.useEffect(()=>{W&&x&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(W,"removeproperty",x)))},[x]),l.useEffect(()=>{W&&j&&(Ae!==null&&google.maps.event.removeListener(Ae),ze(google.maps.event.addListener(W,"setgeometry",j)))},[j]),l.useEffect(()=>{W&&k&&(J!==null&&google.maps.event.removeListener(J),Y(google.maps.event.addListener(W,"setproperty",k)))},[k]),l.useEffect(()=>{if(V!==null){var be=new google.maps.Data(_r(_r({},e),{},{map:V}));i&&A(google.maps.event.addListener(be,"dblclick",i)),a&&z(google.maps.event.addListener(be,"mousedown",a)),f&&F(google.maps.event.addListener(be,"mousemove",f)),p&&G(google.maps.event.addListener(be,"mouseout",p)),h&&de(google.maps.event.addListener(be,"mouseover",h)),m&&ue(google.maps.event.addListener(be,"mouseup",m)),L&&ce(google.maps.event.addListener(be,"rightclick",L)),r&&we(google.maps.event.addListener(be,"click",r)),w&&xe(google.maps.event.addListener(be,"addfeature",w)),b&&ye(google.maps.event.addListener(be,"removefeature",b)),x&&Z(google.maps.event.addListener(be,"removeproperty",x)),j&&ze(google.maps.event.addListener(be,"setgeometry",j)),k&&Y(google.maps.event.addListener(be,"setproperty",k)),ee(be),R&&R(be)}return()=>{W&&(K!==null&&google.maps.event.removeListener(K),S!==null&&google.maps.event.removeListener(S),H!==null&&google.maps.event.removeListener(H),X!==null&&google.maps.event.removeListener(X),re!==null&&google.maps.event.removeListener(re),pe!==null&&google.maps.event.removeListener(pe),ge!==null&&google.maps.event.removeListener(ge),he!==null&&google.maps.event.removeListener(he),me!==null&&google.maps.event.removeListener(me),Pe!==null&&google.maps.event.removeListener(Pe),Re!==null&&google.maps.event.removeListener(Re),Ae!==null&&google.maps.event.removeListener(Ae),J!==null&&google.maps.event.removeListener(J),U&&U(W),W.setMap(null))}},[]),null}l.memo(du);class pu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{data:null}),N(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),Ie(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}N(pu,"contextType",Me);function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function cs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var fs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},ds={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class hu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{kmlLayer:null}),N(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(cs(cs({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),Ie(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}N(hu,"contextType",Me);function ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function gu(t,e){return new e(t.lat,t.lng)}function mu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){return t instanceof e?t:r(t,e)}function bu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r.getNorthEast()),a=t&&t.fromLatLngToDivPixel(r.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function wu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r);if(i){var{x:a,y:f}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function na(t,e,r,i){return r!==void 0?bu(t,e,yu(r,google.maps.LatLngBounds,mu)):wu(t,e,vu(i,google.maps.LatLng,gu))}function Lu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Cu(t,e,r,i,a){class f extends google.maps.OverlayView{constructor(h,m,L,w){super(),this.container=h,this.pane=m,this.position=L,this.bounds=w}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=xu({},this.container?ta(this.container,a):{x:0,y:0}),L=na(h,m,this.bounds,this.position);for(var[w,b]of Object.entries(L))this.container.style[w]=b}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,i)}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Eu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function ms(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Mu(t){var{position:e,bounds:r,mapPaneName:i,zIndex:a,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,L=l.useContext(Me),w=l.useMemo(()=>{var x=document.createElement("div");return x.style.position="absolute",x},[]),b=l.useMemo(()=>Cu(w,i,e,r,h),[w,i,e,r]);return l.useEffect(()=>(f?.(b),b?.setMap(L),()=>{p?.(b),b?.setMap(null)}),[L,b]),l.useEffect(()=>{w.style.zIndex="".concat(a)},[a,w]),Ln.createPortal(m,w)}l.memo(Mu);class wt extends l.PureComponent{constructor(e){super(e),N(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),N(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();We(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),N(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),N(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=Eu({x:0,y:0},this.containerRef.current?ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=na(i,a,this.props.bounds,this.props.position);if(!Lu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,L;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(L=f.height)!==null&&L!==void 0?L:0,position:"absolute"}})}}),N(this,"draw",()=>{this.onPositionElement()}),N(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=l.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=gs(e.position),i=gs(this.props.position),a=ms(e.bounds),f=ms(this.props.bounds);(r!==i||a!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(oe.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:l.Children.only(this.props.children)}),e):null}}N(wt,"FLOAT_PANE","floatPane");N(wt,"MAP_PANE","mapPane");N(wt,"MARKER_LAYER","markerLayer");N(wt,"OVERLAY_LAYER","overlayLayer");N(wt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");N(wt,"contextType",Me);function ku(){}function vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var bs={onDblClick:"dblclick",onClick:"click"},ws={opacity(t,e){t.setOpacity(e)}};function Su(t){var{url:e,bounds:r,options:i,visible:a}=t,f=l.useContext(Me),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=l.useMemo(()=>new google.maps.GroundOverlay(e,p,i),[]);return l.useEffect(()=>{h!==null&&h.setMap(f)},[f]),l.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),l.useEffect(()=>{typeof a<"u"&&h!==null&&h.setOpacity(a?1:0)},[h,a]),l.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}l.memo(Su);class ra extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{groundOverlay:null}),N(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){We(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ys(ys({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}N(ra,"defaultProps",{onLoad:ku});N(ra,"contextType",Me);function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var xs={},Cs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Pu(t){var{data:e,onLoad:r,onUnmount:i,options:a}=t,f=l.useContext(Me),[p,h]=l.useState(null);return l.useEffect(()=>{google.maps.visualization||We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),l.useEffect(()=>{We(!!e,"data property is required in HeatmapLayer %s",e)},[e]),l.useEffect(()=>{p!==null&&p.setMap(f)},[f]),l.useEffect(()=>{a&&p!==null&&p.setOptions(a)},[p,a]),l.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Dr(Dr({},a),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(i&&i(p),p.setMap(null))}},[]),null}l.memo(Pu);class Ou extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{heatmapLayer:null}),N(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),We(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Dr(Dr({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),Ie(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}N(Ou,"contextType",Me);var Es={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Ms={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{streetViewPanorama:null}),N(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,i=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=_e({updaterMap:Ms,eventMap:Es,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ms,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),Ie(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}N(_u,"contextType",Me);class Du extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{streetViewService:null}),N(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}N(Du,"contextType",Me);var ks={onDirectionsChanged:"directions_changed"},Ss={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{directionsRenderer:null}),N(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=_e({updaterMap:Ss,eventMap:ks,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ss,eventMap:ks,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),Ie(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}N(Iu,"contextType",Me);var Ps={onPlacesChanged:"places_changed"},Os={bounds(t,e){t.setBounds(e)}};class ju extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{searchBox:null}),N(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),Ie(this.registeredEvents))}render(){return oe.jsx("div",{ref:this.containerElement,children:l.Children.only(this.props.children)})}}N(ju,"contextType",Me);var _s={onPlaceChanged:"place_changed"},Ds={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ia extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{autocomplete:null}),N(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var i=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&Ie(this.registeredEvents)}render(){return oe.jsx("div",{ref:this.containerElement,className:this.props.className,children:l.Children.only(this.props.children)})}}N(ia,"defaultProps",{className:""});N(ia,"contextType",Me);const Ut=5e-4,Ru=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const i=e.createImageData(r,r),a=i.data;for(let f=0;f<a.length;f+=4){const p=Math.random()*100;a[f]=p,a[f+1]=p,a[f+2]=p,a[f+3]=5}return e.putImageData(i,0,0),e.createPattern(t,"repeat")},Tu=({map:t,zoom:e,claimedCells:r,exploredCells:i,hoveredCell:a,isAnimating:f,selectedCell:p,effects:h})=>{const m=l.useRef(null),L=l.useRef(null),[w,b]=l.useState({claimed:[],explored:[]}),x=l.useRef(),j=l.useRef(null),k=l.useRef(r),R=l.useRef(i);return l.useEffect(()=>{k.current=r,R.current=i},[r,i]),l.useEffect(()=>{if(!t)return;class U extends window.google.maps.OverlayView{constructor(S){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.noisePattern=S,this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.effectsCanvas=document.createElement("canvas"),this.effectsCtx=this.effectsCanvas.getContext("2d"),this.effectsCanvas.style.position="absolute",this.effectsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none"}setProps(S){this.props={...this.props,...S}}setDrawableCells(S,z){this.drawableClaimed=S,this.drawableExplored=z}onAdd(){const S=this.getPanes();S.overlayLayer.appendChild(this.fogCanvas),S.overlayMouseTarget.appendChild(this.effectsCanvas),S.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(S=>{S.parentElement&&S.parentElement.removeChild(S)})}draw(){const S=this.getProjection();if(!S)return;const z=.5,H=this.getMap().getBounds(),F=H.getSouthWest(),X=H.getNorthEast(),G=S.fromLatLngToDivPixel(F),re=S.fromLatLngToDivPixel(X);if(!G||!re)return;const de=re.x-G.x,pe=G.y-re.y,ue=Math.round(de*z),ge=Math.round(pe*z),ce=de+2*ue,he=pe+2*ge;this.swPixel={x:G.x-ue,y:G.y+ge},this.nePixel={x:re.x+ue,y:re.y-ge},[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(we=>{we.style.left=`${G.x-ue}px`,we.style.top=`${re.y-ge}px`,we.width=ce,we.height=he}),this.drawFog(),this.drawDynamic()}drawFog(){this.swPixel&&(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.noisePattern&&(this.fogCtx.fillStyle=this.noisePattern,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(S=>this.drawStaticReveal(S)),this.fogCtx.globalCompositeOperation="source-over")}drawStaticReveal(S){const z=this.getProjection();if(!z||!this.swPixel)return;const{south:H,west:F}=S,X=new window.google.maps.LatLng(H,F),G=new window.google.maps.LatLng(H+Ut,F+Ut),re=z.fromLatLngToDivPixel(X),de=z.fromLatLngToDivPixel(G);if(!re||!de)return;const pe=re.x-this.swPixel.x,ue=de.y-this.nePixel.y,ge=de.x-re.x,ce=re.y-de.y,he=pe+ge/2,we=ue+ce/2,me=ge*2.5,xe=ce*2.5,Pe=this.fogCtx.createRadialGradient(he,we,0,he,we,Math.max(me,xe));Pe.addColorStop(0,"rgba(0, 0, 0, 1)"),Pe.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=Pe,this.fogCtx.beginPath(),this.fogCtx.ellipse(he,we,me,xe,0,0,2*Math.PI),this.fogCtx.fill()}drawRevealEffect(S,z,H){const F=new window.google.maps.LatLng(S.position.lat,S.position.lng),X=H.fromLatLngToDivPixel(F);if(!X||!this.swPixel)return;const G=X.x-this.swPixel.x,re=X.y-this.nePixel.y,de=new window.google.maps.LatLng(S.position.lat,S.position.lng),pe=new window.google.maps.LatLng(S.position.lat+Ut,S.position.lng+Ut),ue=H.fromLatLngToDivPixel(de),ge=H.fromLatLngToDivPixel(pe);if(!ue||!ge)return;const we=(ge.x-ue.x)*2.5*z,me=this.fogCtx.createRadialGradient(G,re,0,G,re,we);me.addColorStop(0,"rgba(0, 0, 0, 1)"),me.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.globalCompositeOperation="destination-out",this.fogCtx.fillStyle=me,this.fogCtx.beginPath(),this.fogCtx.arc(G,re,we,0,2*Math.PI),this.fogCtx.fill(),this.fogCtx.globalCompositeOperation="source-over"}drawParticleEffect(S,z,H){const F=new window.google.maps.LatLng(S.position.lat,S.position.lng),X=H.fromLatLngToDivPixel(F);if(!X||!this.swPixel)return;const G=X.x-this.swPixel.x,re=X.y-this.nePixel.y,pe=80*(.1+1.4*z),ue=.6*(1-z),ge=this.effectsCtx.createRadialGradient(G,re,0,G,re,pe);ge.addColorStop(0,`rgba(255, 255, 255, ${ue*.5})`),ge.addColorStop(.5,`rgba(255, 255, 255, ${ue*.5})`),ge.addColorStop(1,"rgba(255, 255, 255, 0)"),this.effectsCtx.fillStyle=ge,this.effectsCtx.filter="blur(20px)",this.effectsCtx.beginPath(),this.effectsCtx.arc(G,re,pe,0,2*Math.PI),this.effectsCtx.fill(),this.effectsCtx.filter="none"}clearEffects(){this.effectsCtx&&this.effectsCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)}drawDynamic(){const S=this.getProjection();if(!S||!this.swPixel)return;const{hoveredCell:z,selectedCell:H}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height);const F=H?H.key:z;if(!F)return;const[X,G]=F.split("_").map(Number),re=X*Ut,de=G*Ut,pe=new window.google.maps.LatLng(re,de),ue=new window.google.maps.LatLng(re+Ut,de+Ut),ge=S.fromLatLngToDivPixel(pe),ce=S.fromLatLngToDivPixel(ue);if(!ge||!ce)return;const he=ge.x-this.swPixel.x,we=ce.y-this.nePixel.y,me=ce.x-ge.x,xe=ge.y-ce.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(he,we,me,xe)}}j.current=Ru();const V=new U(j.current);V.setMap(t),m.current=V;const W=new Worker(new URL("/chill-demo/assets/grid.worker-B6yfyZNM.js",import.meta.url),{type:"module"});L.current=W,W.onmessage=A=>{const{claimedCellsToDraw:S,exploredCellsToDraw:z}=A.data;b({claimed:S,explored:z})};const ee=()=>{if(L.current){const A=t.getBounds();A&&L.current.postMessage({bounds:{southwest:{lat:A.getSouthWest().lat(),lng:A.getSouthWest().lng()},northeast:{lat:A.getNorthEast().lat(),lng:A.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:k.current,exploredCells:R.current})}},K=t.addListener("idle",ee);return()=>{W.terminate(),V.setMap(null),window.google.maps.event.removeListener(K),x.current&&cancelAnimationFrame(x.current)}},[t]),l.useEffect(()=>{m.current&&(m.current.setDrawableCells(w.claimed,w.explored),m.current.drawFog())},[w]),l.useEffect(()=>{m.current&&(m.current.setProps({zoom:e,hoveredCell:a,isAnimating:f,selectedCell:p}),m.current.drawDynamic())},[e,a,f,p]),l.useEffect(()=>{const U=m.current;if(!U||h.length===0)return;const V=new Map,W=()=>{const ee=U.getProjection();if(!ee||!U.swPixel){x.current=requestAnimationFrame(W);return}U.effectsCtx.clearRect(0,0,U.effectsCanvas.width,U.effectsCanvas.height),U.drawFog();let K=!1;const A=Date.now();h.forEach(S=>{const z=A-S.startTime;z<S.particleDuration&&(K=!0,U.drawParticleEffect(S,z/S.particleDuration,ee)),z<S.revealDuration&&(K=!0,U.drawRevealEffect(S,z/S.revealDuration,ee)),z>=S.revealDuration&&!V.has(S.id)&&(S.onComplete?.(),V.set(S.id,!0))}),K?x.current=requestAnimationFrame(W):U.drawFog()};return x.current=requestAnimationFrame(W),()=>{x.current&&cancelAnimationFrame(x.current),U&&(U.clearEffects(),U.drawFog())}},[h]),null},Au="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Is=new Audio(Au),xi=()=>{Is.currentTime=0,Is.play().catch(t=>{console.error("Audio playback failed:",t)})},rt={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},Bu=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:i})=>{const{countryName:a,regionName:f,flagUrl:p,isLoading:h}=t,m=w=>{w.stopPropagation(),xi(),e()},L=w=>{w.stopPropagation(),xi(),r()};return oe.jsxs("div",{style:rt.container,onClick:w=>w.stopPropagation(),children:[oe.jsx("button",{style:rt.closeButton,onClick:L,children:"×"}),oe.jsx("div",{style:rt.header,children:h?oe.jsx("div",{style:rt.loader}):oe.jsxs(oe.Fragment,{children:[p&&oe.jsx("img",{src:p,alt:"Flag",style:rt.flag}),oe.jsxs("div",{style:rt.location,children:[oe.jsx("span",{style:rt.country,children:a}),oe.jsx("span",{style:rt.region,children:f}),oe.jsxs("span",{style:rt.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),oe.jsxs("div",{style:rt.body,children:[oe.jsx("p",{style:rt.text,children:"Do you want to claim this area?"}),oe.jsxs("button",{style:rt.claimButton,onClick:m,disabled:i,children:[oe.jsx("span",{style:rt.cloudIcon,children:"☁️"}),"Claim"]})]})]})},oa=l.memo(Bu),vi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},Uu=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,zu=()=>(en.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=Uu,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),Fu=({position:t})=>oe.jsxs(oe.Fragment,{children:[oe.jsx(zu,{}),oe.jsx(wt,{position:t,mapPaneName:wt.MARKER_LAYER,children:oe.jsxs("div",{style:vi.pulseContainer,children:[oe.jsx("div",{style:vi.pulse}),oe.jsx("div",{style:vi.dot})]})})]}),Ku=l.memo(Fu),Nt=(t,e,r,i=null,a=null)=>new Promise(f=>{a&&a(!0);const p=t.getCenter(),h=t.getZoom(),m=Date.now(),L=()=>{const w=Date.now(),b=Math.min((w-m)/r,1),x=b*b*(3-2*b),j={lat:p.lat()+(e.lat-p.lat())*x,lng:p.lng()+(e.lng-p.lng())*x},k=i!==null?h+(i-h)*x:h;t.moveCamera({center:j,zoom:k}),b<1?requestAnimationFrame(L):(a&&a(!1),f())};L()});let Un=null;function Nu(){return Un||(Un=new Promise((t,e)=>{const r=new Worker(new URL("/chill-demo/assets/data.worker-CHrZMG89.js",import.meta.url),{type:"module"});r.onmessage=i=>{i.data.success?t(i.data.users):(console.error("Error message from worker:",i.data.error),e(new Error(i.data.error))),r.terminate()},r.onerror=i=>{console.error("Error with worker:",i),e(new Error(`Worker error: ${i.message}`)),r.terminate(),Un=null},r.postMessage({csvPath:"/chill-demo/user_location.csv"})}),Un)}const qu=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=64;t.width=r,t.height=r,e.fillStyle="#E0E0E0",e.beginPath(),e.arc(r/2,r/2,r/2,0,Math.PI*2),e.fill(),e.fillStyle="#A0A0A0",e.beginPath(),e.arc(r/2,r/2-8,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(r/2,r/2+15,15,Math.PI,Math.PI*2,!1),e.fill();const i=new Image;return i.src=t.toDataURL(),i},Wu=({user:t,onClose:e})=>{const r=(i,a)=>!i||!a?{x:0,y:0}:{x:-(i/2),y:-(a+40)};return oe.jsx(wt,{position:{lat:t.lat,lng:t.lng},mapPaneName:wt.FLOAT_PANE,getPixelPositionOffset:r,children:oe.jsxs("div",{onMouseDown:i=>i.stopPropagation(),style:{background:"white",padding:"10px 15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",width:"150px"},children:[oe.jsx("img",{src:t.avatarUrl,alt:t.name,style:{width:"50px",height:"50px",borderRadius:"50%"}}),oe.jsx("strong",{style:{fontSize:"14px"},children:t.name||"Anonymous"}),oe.jsx("button",{onClick:e,style:{position:"absolute",top:"8px",right:"8px",background:"#F0F0F0",border:"none",fontSize:"14px",cursor:"pointer",color:"#888",zIndex:10,width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]})})},Zu=({map:t,users:e,isVisible:r})=>{const i=l.useRef(null),a=l.useRef(new Map).current,f=l.useRef(new Map).current,p=l.useRef(null),[h,m]=l.useState(null),[L,w]=l.useState(null),b=l.useCallback((x,j,k,R)=>{const U=document.createElement("canvas"),V=U.getContext("2d");return U.width=j,U.height=j,V.beginPath(),V.arc(j/2,j/2,j/2-R/2,0,Math.PI*2,!0),V.clip(),V.drawImage(x,0,0,j,j),V.beginPath(),V.arc(j/2,j/2,j/2-R/2,0,Math.PI*2,!0),V.strokeStyle=k,V.lineWidth=R,V.stroke(),U},[]);return p.current||(p.current=qu()),l.useEffect(()=>{if(!e||e.length===0)return;const x="/chill-demo/vite.svg";if(!a.has(x)){const j=new Image;j.crossOrigin="Anonymous",j.src=x;const k={image:j,loaded:!1};a.set(x,k),j.onload=()=>{k.loaded=!0;const R=b(j,128,"red",4);f.set(x,R)},j.onerror=()=>{k.loaded="error",k.image=p.current;const R=b(p.current,128,"red",4);f.set("default",R)}}},[e,a,f,b]),l.useEffect(()=>{if(!t)return;class x extends window.google.maps.OverlayView{constructor(){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="5",this.props={},this.mapDiv=null,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this)}setProps(R){this.props={...this.props,...R},this.draw()}onAdd(){this.getPanes().overlayLayer.appendChild(this.canvas),this.mapDiv=this.getMap().getDiv(),this.mapDiv.addEventListener("mousemove",this.handleMouseMove),this.mapDiv.addEventListener("click",this.handleClick)}onRemove(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.mapDiv&&(this.mapDiv.removeEventListener("mousemove",this.handleMouseMove),this.mapDiv.removeEventListener("click",this.handleClick),this.mapDiv=null)}findUserAtPixel(R,U){const V=this.getProjection();if(!V||!this.props.users)return null;const W=this.props.users.filter(A=>{const S=V.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!S)return!1;const z=Math.sqrt(Math.pow(R-S.x,2)+Math.pow(U-S.y,2)),H=this.getMap().getZoom(),F=Math.max(16,Math.min(80,(H-12)*8));return z<=F/2});let ee=null,K=1/0;for(const A of W){const S=V.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!S)continue;const z=Math.sqrt(Math.pow(R-S.x,2)+Math.pow(U-S.y,2));z<K&&(K=z,ee=A)}return ee}handleMouseMove(R){const U=this.findUserAtPixel(R.offsetX,R.offsetY);this.props.onSetHoveredUser(U),this.getMap().getDiv().style.cursor=U?"pointer":""}handleClick(R){const U=this.findUserAtPixel(R.offsetX,R.offsetY);U&&this.props.onSetClickedUser(U)}draw(){const R=this.getProjection();if(!R)return;const U=this.getMap().getBounds();if(!U)return;const V=this.getMap().getZoom(),W=.1,ee=U.getSouthWest(),K=U.getNorthEast(),A=(K.lng()-ee.lng())*W,S=(K.lat()-ee.lat())*W,z=new window.google.maps.LatLngBounds(new window.google.maps.LatLng(ee.lat()-S,ee.lng()-A),new window.google.maps.LatLng(K.lat()+S,K.lng()+A)),H=R.fromLatLngToDivPixel(ee),F=R.fromLatLngToDivPixel(K),X=F.x-H.x,G=H.y-F.y;if(this.canvas.style.left=`${H.x}px`,this.canvas.style.top=`${F.y}px`,(this.canvas.width!==X||this.canvas.height!==G)&&(this.canvas.width=X,this.canvas.height=G,this.canvas.style.width=`${X}px`,this.canvas.style.height=`${G}px`),this.ctx.clearRect(0,0,X,G),!this.props.isVisible)return;V<12?this.drawClusters(R,H,F,z):this.drawIndividualMarkers(R,H,F,z)}drawSingleMarker(R,U,V,W){const{renderedImageCache:ee,hoveredUser:K}=this.props,A=U.fromLatLngToDivPixel(new window.google.maps.LatLng(R.lat,R.lng));if(!A)return;const S=A.x-V.x,z=A.y-W.y,H=this.getMap().getZoom(),F=Math.max(16,Math.min(80,(H-12)*8)),X=K&&K.seq===R.seq;let re=ee.get("/chill-demo/vite.svg")||ee.get("default");re?this.ctx.drawImage(re,S-F/2,z-F/2,F,F):(this.ctx.beginPath(),this.ctx.arc(S,z,F/2,0,Math.PI*2,!0),this.ctx.fillStyle=X?"#007BFF":"#E0E0E0",this.ctx.fill()),this.ctx.beginPath(),this.ctx.arc(S,z,F/2,0,Math.PI*2,!0),this.ctx.strokeStyle=X?"#007BFF":"red",this.ctx.lineWidth=X?6:2,this.ctx.stroke()}drawClusters(R,U,V,W){const{users:ee}=this.props,K=this.getMap().getZoom(),A=1/Math.pow(2,K-5),S=new Map,z=ee.filter(H=>W.contains({lat:H.lat,lng:H.lng}));for(const H of z){const F=`${Math.floor(H.lat/A)}|${Math.floor(H.lng/A)}`;S.has(F)||S.set(F,{points:[],sumLat:0,sumLng:0});const X=S.get(F);X.points.push(H),X.sumLat+=H.lat,X.sumLng+=H.lng}for(const H of S.values()){const F=H.points.length;if(F>1){const X=H.sumLat/F,G=H.sumLng/F,re=R.fromLatLngToDivPixel(new window.google.maps.LatLng(X,G));if(!re)continue;const de=re.x-U.x,pe=re.y-V.y,ue=18+Math.log2(F)*2;this.ctx.beginPath(),this.ctx.arc(de,pe,ue,0,Math.PI*2),this.ctx.fillStyle="rgba(0, 123, 255, 0.7)",this.ctx.fill(),this.ctx.strokeStyle="rgba(0, 123, 255, 1)",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 18px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(F,de,pe)}else this.drawSingleMarker(H.points[0],R,U,V)}}drawIndividualMarkers(R,U,V,W){const{users:ee}=this.props;for(const K of ee)W.contains({lat:K.lat,lng:K.lng})&&this.drawSingleMarker(K,R,U,V)}}const j=new x;return j.setMap(t),i.current=j,()=>{i.current&&i.current.setMap(null)}},[t,b]),l.useEffect(()=>{i.current&&i.current.setProps({users:e,renderedImageCache:f,imageCache:a,isVisible:r,defaultAvatarRef:p.current,hoveredUser:h,clickedUser:L,onSetHoveredUser:m,onSetClickedUser:w})},[e,f,r,h,L,a]),oe.jsx(oe.Fragment,{children:L&&oe.jsx(Wu,{user:L,onClose:()=>w(null)})})},zt=5e-4,$u={width:"100%",height:"100%"},Vu={position:"absolute",inset:"0px",width:"100%",height:"100%"},Hu=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],Gu=({center:t,onSelectCell:e,claimedCells:r,exploredCells:i,setMapRef:a,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m,onZoomOutLimit:L,effects:w})=>{const[b,x]=l.useState(null),[j,k]=l.useState(15),[R,U]=l.useState(null),V=l.useRef(null),W=l.useRef(!1),ee=l.useRef(null),K=150,[A,S]=l.useState(!1),[z,H]=l.useState([]);l.useEffect(()=>{Nu().then(H)},[]);const F=l.useCallback(ce=>{U(ce),a(ce)},[a]),X=l.useCallback(()=>{if(!R||!W.current)return;const ce=R.getZoom(),he=R.getCenter();ce<=5&&L(),f(ce),p({lat:he.lat(),lng:he.lng()}),k(ce)},[R,f,p,L]);l.useEffect(()=>{(async()=>{R&&t&&!W.current&&(await Nt(R,t,2e3,16,S),W.current=!0,X())})()},[R,t,X,S]);const G=l.useCallback(ce=>{V.current||(V.current=setTimeout(()=>{if(V.current=null,j<15){b&&x(null);return}const he=`${Math.floor(ce.latLng.lat()/zt)}_${Math.floor(ce.latLng.lng()/zt)}`;he!==b&&x(he)},50))},[j,b,x]),re=l.useCallback(()=>{x(null)},[x]),de=l.useCallback(ce=>{const he=ce.latLng.lat(),we=ce.latLng.lng(),me=Math.floor(he/zt),xe=Math.floor(we/zt),Pe=`${me}_${xe}`,ye=me*zt,Re=xe*zt,Z=ye+zt/2,Ae=Re+zt/2;e(Pe,{lat:Z,lng:Ae})},[e]),pe=l.useCallback(async ce=>{ce.preventDefault(),!ee.current&&(ee.current=setTimeout(async()=>{if(ee.current=null,!R)return;const he=R.getZoom(),we=ce.deltaY<0?he+1:he-1,me=Math.max(2,Math.min(20,we));me!==he&&await Nt(R,R.getCenter().toJSON(),300,me,S)},K))},[R,S]),ue=l.useCallback(()=>{if(!R)return;const ce=R.getCenter();p({lat:ce.lat(),lng:ce.lng()})},[R,p]),ge=l.useRef(null);return l.useEffect(()=>{const ce=ge.current;if(ce)return ce.addEventListener("wheel",pe,{passive:!1}),()=>{ce.removeEventListener("wheel",pe)}},[pe]),oe.jsx("div",{ref:ge,className:"view-container fade-in",style:Vu,children:oe.jsxs(Ya,{mapContainerStyle:$u,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:Hu,minZoom:2,maxZoom:20,scrollwheel:!1},onLoad:F,onIdle:X,onDragEnd:ue,onMouseMove:G,onMouseOut:re,onClick:de,children:[oe.jsx(Tu,{map:R,zoom:j,claimedCells:r,exploredCells:i,hoveredCell:b,isAnimating:A,selectedCell:h,effects:w}),R&&z.length>0&&oe.jsx(Zu,{map:R,users:z,isVisible:!0}),h&&oe.jsx(oa,{cellInfo:h}),m&&oe.jsx(Ku,{position:m})]})})},Yu=en.memo(Gu),js=t=>{let e;const r=new Set,i=(L,w)=>{const b=typeof L=="function"?L(e):L;if(!Object.is(b,e)){const x=e;e=w??(typeof b!="object"||b===null)?b:Object.assign({},e,b),r.forEach(j=>j(e,x))}},a=()=>e,h={setState:i,getState:a,getInitialState:()=>m,subscribe:L=>(r.add(L),()=>r.delete(L))},m=e=t(i,a,h);return h},Xu=(t=>t?js(t):js),Ju=t=>t;function Qu(t,e=Ju){const r=en.useSyncExternalStore(t.subscribe,en.useCallback(()=>e(t.getState()),[t,e]),en.useCallback(()=>e(t.getInitialState()),[t,e]));return en.useDebugValue(r),r}const Rs=t=>{const e=Xu(t),r=i=>Qu(e,i);return Object.assign(r,e),r},ec=(t=>t?Rs(t):Rs);var sa=Symbol.for("immer-nothing"),Ts=Symbol.for("immer-draftable"),st=Symbol.for("immer-state");function ft(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Nn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[st]}function tn(t){return t?aa(t)||Array.isArray(t)||!!t[Ts]||!!t.constructor?.[Ts]||Zn(t)||Br(t):!1}var tc=Object.prototype.constructor.toString(),As=new WeakMap;function aa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let i=As.get(r);return i===void 0&&(i=Function.toString.call(r),As.set(r,i)),i===tc}function Ir(t,e,r=!0){Ar(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((i,a)=>e(a,i,t))}function Ar(t){const e=t[st];return e?e.type_:Array.isArray(t)?1:Zn(t)?2:Br(t)?3:0}function Ci(t,e){return Ar(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function la(t,e,r){const i=Ar(t);i===2?t.set(e,r):i===3?t.add(r):t[e]=r}function nc(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Zn(t){return t instanceof Map}function Br(t){return t instanceof Set}function Jt(t){return t.copy_||t.base_}function Ei(t,e){if(Zn(t))return new Map(t);if(Br(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=aa(t);if(e===!0||e==="class_only"&&!r){const i=Object.getOwnPropertyDescriptors(t);delete i[st];let a=Reflect.ownKeys(i);for(let f=0;f<a.length;f++){const p=a[f],h=i[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(i[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Nn(t),i)}else{const i=Nn(t);if(i!==null&&r)return{...t};const a=Object.create(i);return Object.assign(a,t)}}function Ti(t,e=!1){return Ur(t)||wn(t)||!tn(t)||(Ar(t)>1&&Object.defineProperties(t,{set:br,add:br,clear:br,delete:br}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ti(r,!0))),t}function rc(){ft(2)}var br={value:rc};function Ur(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var ic={};function nn(t){const e=ic[t];return e||ft(0,t),e}var qn;function ua(){return qn}function oc(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Bs(t,e){e&&(nn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Mi(t){ki(t),t.drafts_.forEach(sc),t.drafts_=null}function ki(t){t===qn&&(qn=t.parent_)}function Us(t){return qn=oc(qn,t)}function sc(t){const e=t[st];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[st].modified_&&(Mi(e),ft(4)),tn(t)&&(t=jr(e,t),e.parent_||Rr(e,t)),e.patches_&&nn("Patches").generateReplacementPatches_(r[st].base_,t,e.patches_,e.inversePatches_)):t=jr(e,r,[]),Mi(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==sa?t:void 0}function jr(t,e,r){if(Ur(e))return e;const i=t.immer_.shouldUseStrictIteration(),a=e[st];if(!a)return Ir(e,(f,p)=>Fs(t,a,e,f,p,r),i),e;if(a.scope_!==t)return e;if(!a.modified_)return Rr(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const f=a.copy_;let p=f,h=!1;a.type_===3&&(p=new Set(f),f.clear(),h=!0),Ir(p,(m,L)=>Fs(t,a,f,m,L,r,h),i),Rr(t,f,!1),r&&t.patches_&&nn("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function Fs(t,e,r,i,a,f,p){if(a==null||typeof a!="object"&&!p)return;const h=Ur(a);if(!(h&&!p)){if(wn(a)){const m=f&&e&&e.type_!==3&&!Ci(e.assigned_,i)?f.concat(i):void 0,L=jr(t,a,m);if(la(r,i,L),wn(L))t.canAutoFreeze_=!1;else return}else p&&r.add(a);if(tn(a)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===a&&h)return;jr(t,a),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Zn(r)?r.has(i):Object.prototype.propertyIsEnumerable.call(r,i))&&Rr(t,a)}}}function Rr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ti(e,r)}function ac(t,e){const r=Array.isArray(t),i={type_:r?1:0,scope_:e?e.scope_:ua(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,f=Ai;r&&(a=[i],f=Wn);const{revoke:p,proxy:h}=Proxy.revocable(a,f);return i.draft_=h,i.revoke_=p,h}var Ai={get(t,e){if(e===st)return t;const r=Jt(t);if(!Ci(r,e))return lc(t,r,e);const i=r[e];return t.finalized_||!tn(i)?i:i===yi(t.base_,e)?(bi(t),t.copy_[e]=Pi(i,t)):i},has(t,e){return e in Jt(t)},ownKeys(t){return Reflect.ownKeys(Jt(t))},set(t,e,r){const i=ca(Jt(t),e);if(i?.set)return i.set.call(t.draft_,r),!0;if(!t.modified_){const a=yi(Jt(t),e),f=a?.[st];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(nc(r,a)&&(r!==void 0||Ci(t.base_,e)))return!0;bi(t),Si(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return yi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bi(t),Si(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Jt(t),i=Reflect.getOwnPropertyDescriptor(r,e);return i&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:i.enumerable,value:r[e]}},defineProperty(){ft(11)},getPrototypeOf(t){return Nn(t.base_)},setPrototypeOf(){ft(12)}},Wn={};Ir(Ai,(t,e)=>{Wn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wn.deleteProperty=function(t,e){return Wn.set.call(this,t,e,void 0)};Wn.set=function(t,e,r){return Ai.set.call(this,t[0],e,r,t[0])};function yi(t,e){const r=t[st];return(r?Jt(r):t)[e]}function lc(t,e,r){const i=ca(e,r);return i?"value"in i?i.value:i.get?.call(t.draft_):void 0}function ca(t,e){if(!(e in t))return;let r=Nn(t);for(;r;){const i=Object.getOwnPropertyDescriptor(r,e);if(i)return i;r=Nn(r)}}function Si(t){t.modified_||(t.modified_=!0,t.parent_&&Si(t.parent_))}function bi(t){t.copy_||(t.copy_=Ei(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var uc=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,i)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...L){return p.produce(m,w=>r.call(this,w,...L))}}typeof r!="function"&&ft(6),i!==void 0&&typeof i!="function"&&ft(7);let a;if(tn(e)){const f=Us(this),p=Pi(e,void 0);let h=!0;try{a=r(p),h=!1}finally{h?Mi(f):ki(f)}return Bs(f,i),zs(a,f)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===sa&&(a=void 0),this.autoFreeze_&&Ti(a,!0),i){const f=[],p=[];nn("Patches").generateReplacementPatches_(e,a,f,p),i(f,p)}return a}else ft(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let i,a;return[this.produce(e,r,(p,h)=>{i=p,a=h}),i,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){tn(t)||ft(8),wn(t)&&(t=cc(t));const e=Us(this),r=Pi(t,void 0);return r[st].isManual_=!0,ki(e),r}finishDraft(t,e){const r=t&&t[st];(!r||!r.isManual_)&&ft(9);const{scope_:i}=r;return Bs(i,e),zs(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const i=nn("Patches").applyPatches_;return wn(t)?i(t,e):this.produce(t,a=>i(a,e))}};function Pi(t,e){const r=Zn(t)?nn("MapSet").proxyMap_(t,e):Br(t)?nn("MapSet").proxySet_(t,e):ac(t,e);return(e?e.scope_:ua()).drafts_.push(r),r}function cc(t){return wn(t)||ft(10,t),fa(t)}function fa(t){if(!tn(t)||Ur(t))return t;const e=t[st];let r,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ei(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else r=Ei(t,!0);return Ir(r,(a,f)=>{la(r,a,fa(f))},i),e&&(e.finalized_=!1),r}var fc=new uc,dc=fc.produce;const pc=t=>(e,r,i)=>(i.setState=(a,f,...p)=>{const h=typeof a=="function"?dc(a):a;return e(h,f,...p)},t(i.setState,r,i)),hc=pc;var xr={exports:{}},gc=xr.exports,Ks;function mc(){return Ks||(Ks=1,(function(t,e){(function(r,i){t.exports=i()})(gc,function(){var r=function(n,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(s[c]=u[c])})(n,o)},i=function(){return(i=Object.assign||function(n){for(var o,s=1,u=arguments.length;s<u;s++)for(var c in o=arguments[s])Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c]);return n}).apply(this,arguments)};function a(n,o,s){for(var u,c=0,d=o.length;c<d;c++)!u&&c in o||((u=u||Array.prototype.slice.call(o,0,c))[c]=o[c]);return n.concat(u||Array.prototype.slice.call(o))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ta,p=Object.keys,h=Array.isArray;function m(n,o){return typeof o!="object"||p(o).forEach(function(s){n[s]=o[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var L=Object.getPrototypeOf,w={}.hasOwnProperty;function b(n,o){return w.call(n,o)}function x(n,o){typeof o=="function"&&(o=o(L(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(o).forEach(function(s){k(n,s,o[s])})}var j=Object.defineProperty;function k(n,o,s,u){j(n,o,m(s&&b(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},u))}function R(n){return{from:function(o){return n.prototype=Object.create(o.prototype),k(n.prototype,"constructor",n),{extend:x.bind(null,n.prototype)}}}}var U=Object.getOwnPropertyDescriptor,V=[].slice;function W(n,o,s){return V.call(n,o,s)}function ee(n,o){return o(n)}function K(n){if(!n)throw new Error("Assertion Failed")}function A(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function S(n,o){if(typeof o=="string"&&b(n,o))return n[o];if(!o)return n;if(typeof o!="string"){for(var s=[],u=0,c=o.length;u<c;++u){var d=S(n,o[u]);s.push(d)}return s}var g=o.indexOf(".");if(g!==-1){var v=n[o.substr(0,g)];return v==null?void 0:S(v,o.substr(g+1))}}function z(n,o,s){if(n&&o!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof o!="string"&&"length"in o){K(typeof s!="string"&&"length"in s);for(var u=0,c=o.length;u<c;++u)z(n,o[u],s[u])}else{var d,g,v=o.indexOf(".");v!==-1?(d=o.substr(0,v),(g=o.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:z(v=!(v=n[d])||!b(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=s}}function H(n){var o,s={};for(o in n)b(n,o)&&(s[o]=n[o]);return s}var F=[].concat;function X(n){return F.apply([],n)}var pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(X([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(o){return o+n+"Array"})}))).filter(function(n){return f[n]}),G=new Set(pt.map(function(n){return f[n]})),re=null;function de(n){return re=new WeakMap,n=(function o(s){if(!s||typeof s!="object")return s;var u=re.get(s);if(u)return u;if(h(s)){u=[],re.set(s,u);for(var c=0,d=s.length;c<d;++c)u.push(o(s[c]))}else if(G.has(s.constructor))u=s;else{var g,v=L(s);for(g in u=v===Object.prototype?{}:Object.create(v),re.set(s,u),s)b(s,g)&&(u[g]=o(s[g]))}return u})(n),re=null,n}var pe={}.toString;function ue(n){return pe.call(n).slice(8,-1)}var ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ce=typeof ge=="symbol"?function(n){var o;return n!=null&&(o=n[ge])&&o.apply(n)}:function(){return null};function he(n,o){return o=n.indexOf(o),0<=o&&n.splice(o,1),0<=o}var we={};function me(n){var o,s,u,c;if(arguments.length===1){if(h(n))return n.slice();if(this===we&&typeof n=="string")return[n];if(c=ce(n)){for(s=[];!(u=c.next()).done;)s.push(u.value);return s}if(n==null)return[n];if(typeof(o=n.length)!="number")return[n];for(s=new Array(o);o--;)s[o]=n[o];return s}for(o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return s}var xe=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Pt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Pt),Pe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ye(n,o){this.name=n,this.message=o}function Re(n,o){return n+". Errors: "+Object.keys(o).map(function(s){return o[s].toString()}).filter(function(s,u,c){return c.indexOf(s)===u}).join(`
`)}function Z(n,o,s,u){this.failures=o,this.failedKeys=u,this.successCount=s,this.message=Re(n,o)}function Ae(n,o){this.name="BulkError",this.failures=Object.keys(o).map(function(s){return o[s]}),this.failuresByPos=o,this.message=Re(n,this.failures)}R(ye).from(Error).extend({toString:function(){return this.name+": "+this.message}}),R(Z).from(ye),R(Ae).from(ye);var ze=lt.reduce(function(n,o){return n[o]=o+"Error",n},{}),J=ye,Y=lt.reduce(function(n,o){var s=o+"Error";function u(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=Pe[o]||s,this.inner=null)}return R(u).from(J),n[o]=u,n},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var be=Pt.reduce(function(n,o){return n[o+"Error"]=Y[o],n},{}),De=lt.reduce(function(n,o){return["Syntax","Type","Range"].indexOf(o)===-1&&(n[o+"Error"]=Y[o]),n},{});function ke(){}function Xe(n){return n}function Wt(n,o){return n==null||n===Xe?o:function(s){return o(n(s))}}function je(n,o){return function(){n.apply(this,arguments),o.apply(this,arguments)}}function $n(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var u=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=o.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?je(u,this.onsuccess):u),c&&(this.onerror=this.onerror?je(c,this.onerror):c),d!==void 0?d:s}}function rn(n,o){return n===ke?o:function(){n.apply(this,arguments);var s=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,o.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?je(s,this.onsuccess):s),u&&(this.onerror=this.onerror?je(u,this.onerror):u)}}function Vn(n,o){return n===ke?o:function(s){var u=n.apply(this,arguments);m(s,u);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=o.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?je(c,this.onsuccess):c),d&&(this.onerror=this.onerror?je(d,this.onerror):d),u===void 0?s===void 0?void 0:s:m(u,s)}}function on(n,o){return n===ke?o:function(){return o.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function sn(n,o){return n===ke?o:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var u=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return o.apply(u,d)})}return o.apply(this,arguments)}}De.ModifyError=Z,De.DexieError=ye,De.BulkError=Ae;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xn(n){Je=n}var dt={},Cn=100,pt=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,L(n),n];var o=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[o,L(o),n]})(),Pt=pt[0],lt=pt[1],pt=pt[2],lt=lt&&lt.then,at=Pt&&Pt.constructor,an=!!pt,ht=function(n,o){mt.push([n,o]),Lt&&(queueMicrotask(fn),Lt=!1)},ln=!0,Lt=!0,gt=[],xt=[],un=Xe,et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},ve=et,mt=[],vt=0,Ct=[];function le(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var o=this._PSD=ve;if(typeof n!="function"){if(n!==dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ot(this,this._value))}this._state=null,this._value=null,++o.ref,(function s(u,c){try{c(function(d){if(u._state===null){if(d===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&Et();d&&typeof d.then=="function"?s(u,function(v,C){d instanceof le?d._then(v,C):d.then(v,C)}):(u._state=!0,u._value=d,Mn(u)),g&&Dt()}},Ot.bind(null,u))}catch(d){Ot(u,d)}})(this,n)}var cn={get:function(){var n=ve,o=Xn;function s(u,c){var d=this,g=!n.global&&(n!==ve||o!==Xn),v=g&&!jt(),C=new le(function(E,_){_t(d,new En(Ui(u,n,g,v),Ui(c,n,g,v),E,_,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return s.prototype=dt,s},set:function(n){k(this,"then",n&&n.prototype===dt?cn:{get:function(){return n},set:cn.set})}};function En(n,o,s,u,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof o=="function"?o:null,this.resolve=s,this.reject=u,this.psd=c}function Ot(n,o){var s,u;xt.push(o),n._state===null&&(s=n._lib&&Et(),o=un(o),n._state=!1,n._value=o,u=n,gt.some(function(c){return c._value===u._value})||gt.push(u),Mn(n),s&&Dt())}function Mn(n){var o=n._listeners;n._listeners=[];for(var s=0,u=o.length;s<u;++s)_t(n,o[s]);var c=n._PSD;--c.ref||c.finalize(),vt===0&&(++vt,ht(function(){--vt==0&&Mt()},[]))}function _t(n,o){if(n._state!==null){var s=n._state?o.onFulfilled:o.onRejected;if(s===null)return(n._state?o.resolve:o.reject)(n._value);++o.psd.ref,++vt,ht(Hn,[s,n,o])}else n._listeners.push(o)}function Hn(n,o,s){try{var u,c=o._value;!o._state&&xt.length&&(xt=[]),u=Je&&o._consoleTask?o._consoleTask.run(function(){return n(c)}):n(c),o._state||xt.indexOf(c)!==-1||(function(d){for(var g=gt.length;g;)if(gt[--g]._value===d._value)return gt.splice(g,1)})(o),s.resolve(u)}catch(d){s.reject(d)}finally{--vt==0&&Mt(),--s.psd.ref||s.psd.finalize()}}function fn(){Zt(et,function(){Et()&&Dt()})}function Et(){var n=ln;return Lt=ln=!1,n}function Dt(){var n,o,s;do for(;0<mt.length;)for(n=mt,mt=[],s=n.length,o=0;o<s;++o){var u=n[o];u[0].apply(null,u[1])}while(0<mt.length);Lt=ln=!0}function Mt(){var n=gt;gt=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var o=Ct.slice(0),s=o.length;s;)o[--s]()}function Le(n){return new le(dt,!1,n)}function Ke(n,o){var s=ve;return function(){var u=Et(),c=ve;try{return Rt(s,!0),n.apply(this,arguments)}catch(d){o&&o(d)}finally{Rt(c,!1),u&&Dt()}}}x(le.prototype,{then:cn,_then:function(n,o){_t(this,new En(null,null,n,o,ve))},catch:function(n){if(arguments.length===1)return this.then(null,n);var o=n,s=arguments[1];return typeof o=="function"?this.then(null,function(u){return(u instanceof o?s:Le)(u)}):this.then(null,function(u){return(u&&u.name===o?s:Le)(u)})},finally:function(n){return this.then(function(o){return le.resolve(n()).then(function(){return o})},function(o){return le.resolve(n()).then(function(){return Le(o)})})},timeout:function(n,o){var s=this;return n<1/0?new le(function(u,c){var d=setTimeout(function(){return c(new Y.Timeout(o))},n);s.then(u,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(le.prototype,Symbol.toStringTag,"Dexie.Promise"),et.env=Bi(),x(le,{all:function(){var n=me.apply(null,arguments).map(Jn);return new le(function(o,s){n.length===0&&o([]);var u=n.length;n.forEach(function(c,d){return le.resolve(c).then(function(g){n[d]=g,--u||o(n)},s)})})},resolve:function(n){return n instanceof le?n:n&&typeof n.then=="function"?new le(function(o,s){n.then(o,s)}):new le(dt,!0,n)},reject:Le,race:function(){var n=me.apply(null,arguments).map(Jn);return new le(function(o,s){n.map(function(u){return le.resolve(u).then(o,s)})})},PSD:{get:function(){return ve},set:function(n){return ve=n}},totalEchoes:{get:function(){return Xn}},newPSD:It,usePSD:Zt,scheduler:{get:function(){return ht},set:function(n){ht=n}},rejectionMapper:{get:function(){return un},set:function(n){un=n}},follow:function(n,o){return new le(function(s,u){return It(function(c,d){var g=ve;g.unhandleds=[],g.onunhandled=d,g.finalize=je(function(){var v,C=this;v=function(){C.unhandleds.length===0?c():d(C.unhandleds[0])},Ct.push(function E(){v(),Ct.splice(Ct.indexOf(E),1)}),++vt,ht(function(){--vt==0&&Mt()},[])},g.finalize),n()},o,s,u)})}}),at&&(at.allSettled&&k(le,"allSettled",function(){var n=me.apply(null,arguments).map(Jn);return new le(function(o){n.length===0&&o([]);var s=n.length,u=new Array(s);n.forEach(function(c,d){return le.resolve(c).then(function(g){return u[d]={status:"fulfilled",value:g}},function(g){return u[d]={status:"rejected",reason:g}}).then(function(){return--s||o(u)})})})}),at.any&&typeof AggregateError<"u"&&k(le,"any",function(){var n=me.apply(null,arguments).map(Jn);return new le(function(o,s){n.length===0&&s(new AggregateError([]));var u=n.length,c=new Array(u);n.forEach(function(d,g){return le.resolve(d).then(function(v){return o(v)},function(v){c[g]=v,--u||s(new AggregateError(c))})})})}),at.withResolvers&&(le.withResolvers=at.withResolvers));var Ze={awaits:0,echoes:0,id:0},da=0,Gn=[],Yn=0,Xn=0,pa=0;function It(n,o,s,u){var c=ve,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++pa,et.env,d.env=an?{Promise:le,PromiseProp:{value:le,configurable:!0,writable:!0},all:le.all,race:le.race,allSettled:le.allSettled,any:le.any,resolve:le.resolve,reject:le.reject}:{},o&&m(d,o),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},u=Zt(d,n,s,u),d.ref===0&&d.finalize(),u}function dn(){return Ze.id||(Ze.id=++da),++Ze.awaits,Ze.echoes+=Cn,Ze.id}function jt(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*Cn,!0)}function Jn(n){return Ze.echoes&&n&&n.constructor===at?(dn(),n.then(function(o){return jt(),o},function(o){return jt(),Ne(o)})):n}function ha(){var n=Gn[Gn.length-1];Gn.pop(),Rt(n,!1)}function Rt(n,o){var s,u=ve;(o?!Ze.echoes||Yn++&&n===ve:!Yn||--Yn&&n===ve)||queueMicrotask(o?(function(c){++Xn,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Gn.push(ve),Rt(c,!0)}).bind(null,n):ha),n!==ve&&(ve=n,u===et&&(et.env=Bi()),an&&(s=et.env.Promise,o=n.env,(u.global||n.global)&&(Object.defineProperty(f,"Promise",o.PromiseProp),s.all=o.all,s.race=o.race,s.resolve=o.resolve,s.reject=o.reject,o.allSettled&&(s.allSettled=o.allSettled),o.any&&(s.any=o.any))))}function Bi(){var n=f.Promise;return an?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Zt(n,o,s,u,c){var d=ve;try{return Rt(n,!0),o(s,u,c)}finally{Rt(d,!1)}}function Ui(n,o,s,u){return typeof n!="function"?n:function(){var c=ve;s&&dn(),Rt(o,!0);try{return n.apply(this,arguments)}finally{Rt(c,!1),u&&queueMicrotask(jt)}}}function zr(n){Promise===at&&Ze.echoes===0?Yn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+lt).indexOf("[native code]")===-1&&(dn=jt=ke);var Ne=le.reject,$t="￿",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",pn=[],Qn="__dbnames",Fr="readonly",Kr="readwrite";function Vt(n,o){return n?o?function(){return n.apply(this,arguments)&&o.apply(this,arguments)}:n:o}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function er(n){return typeof n!="string"||/\./.test(n)?function(o){return o}:function(o){return o[n]===void 0&&n in o&&delete(o=de(o))[n],o}}function Ki(){throw Y.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Te(n,o){try{var s=Ni(n),u=Ni(o);if(s!==u)return s==="Array"?1:u==="Array"?-1:s==="binary"?1:u==="binary"?-1:s==="string"?1:u==="string"?-1:s==="Date"?1:u!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return o<n?1:n<o?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,C=g<v?g:v,E=0;E<C;++E)if(c[E]!==d[E])return c[E]<d[E]?-1:1;return g===v?0:g<v?-1:1})(qi(n),qi(o));case"Array":return(function(c,d){for(var g=c.length,v=d.length,C=g<v?g:v,E=0;E<C;++E){var _=Te(c[E],d[E]);if(_!==0)return _}return g===v?0:g<v?-1:1})(n,o)}}catch{}return NaN}function Ni(n){var o=typeof n;return o!="object"?o:ArrayBuffer.isView(n)?"binary":(n=ue(n),n==="ArrayBuffer"?"binary":n)}function qi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function tr(n,o,s){var u=n.schema.yProps;return u?(o&&0<s.numFailures&&(o=o.filter(function(c,d){return!s.failures[d]})),Promise.all(u.map(function(c){return c=c.updatesTable,o?n.db.table(c).where("k").anyOf(o).delete():n.db.table(c).clear()})).then(function(){return s})):s}var kn=(Wi.prototype.execute=function(n){var o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(h(s))return a(a([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var u=o.remove;if(h(u))return h(n)?n.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return s=(s=o.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?o.replacePrefix[1]+n.substring(s.length):n},Wi);function Wi(n){this["@@propmod"]=n}function Zi(n,o){for(var s=p(o),u=s.length,c=!1,d=0;d<u;++d){var g=s[d],v=o[g],C=S(n,g);v instanceof kn?(z(n,g,v.execute(C)),c=!0):C!==v&&(z(n,g,v),c=!0)}return c}var $i=(Fe.prototype._trans=function(n,o,s){var u=this._tx||ve.trans,c=this.name,d=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(E,_,y){if(!y.schema[c])throw new Y.NotFound("Table "+c+" not part of transaction");return o(y.idbtrans,y)}var v=Et();try{var C=u&&u.db._novip===this.db._novip?u===ve.trans?u._promise(n,g,s):It(function(){return u._promise(n,g,s)},{trans:u,transless:ve.transless||ve}):(function E(_,y,I,M){if(_.idbdb&&(_._state.openComplete||ve.letThrough||_._vip)){var P=_._createTransaction(y,I,_._dbSchema);try{P.create(),_._state.PR1398_maxLoop=3}catch(O){return O.name===ze.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return E(_,y,I,M)})):Ne(O)}return P._promise(y,function(O,D){return It(function(){return ve.trans=P,M(O,D,P)})}).then(function(O){if(y==="readwrite")try{P.idbtrans.commit()}catch{}return y==="readonly"?O:P._completion.then(function(){return O})})}if(_._state.openComplete)return Ne(new Y.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return Ne(new Y.DatabaseClosed);_.open().catch(ke)}return _._state.dbReadyPromise.then(function(){return E(_,y,I,M)})})(this.db,n,[this.name],g);return d&&(C._consoleTask=d,C=C.catch(function(E){return console.trace(E),Ne(E)})),C}finally{v&&Dt()}},Fe.prototype.get=function(n,o){var s=this;return n&&n.constructor===Object?this.where(n).first(o):n==null?Ne(new Y.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return s.core.get({trans:u,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(o)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var o=p(n);if(o.length===1)return this.where(o[0]).equals(n[o[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&o.every(function(E){return 0<=v.keyPath.indexOf(E)})){for(var C=0;C<o.length;++C)if(o.indexOf(v.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(v,C){return v.keyPath.length-C.keyPath.length})[0];if(s&&this.db._maxKey!==$t){var d=s.keyPath.slice(0,o.length);return this.where(d).equals(d.map(function(C){return n[C]}))}!s&&Je&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var u=this.schema.idxByName;function c(v,C){return Te(v,C)===0}var g=o.reduce(function(y,C){var E=y[0],_=y[1],y=u[C],I=n[C];return[E||y,E||!y?Vt(_,y&&y.multi?function(M){return M=S(M,C),h(M)&&M.some(function(P){return c(I,P)})}:function(M){return c(I,S(M,C))}):_]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(o).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var o,s=this.db,u=this.name;function c(){return o!==null&&o.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ki&&((function(C,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function _(){this.constructor=C}r(C,E),C.prototype=E===null?Object.create(E):(_.prototype=E.prototype,new _)})(c,o=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return u},n=c);for(var d=new Set,g=n.prototype;g;g=L(g))Object.getOwnPropertyNames(g).forEach(function(C){return d.add(C)});function v(C){if(!C)return C;var E,_=Object.create(n.prototype);for(E in C)if(!d.has(E))try{_[E]=C[E]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:o!=null?[o]:null,values:[g]})}).then(function(v){return v.numFailures?le.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{z(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,o){var s=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return Zi(g,o),u&&z(g,u,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[o]}}).then(function(v){return v.numFailures?le.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,o){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(o):(n=S(n,this.schema.primKey.keyPath),n===void 0?Ne(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(o))},Fe.prototype.put=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:o!=null?[o]:null})}).then(function(v){return v.numFailures?le.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{z(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(u){return tr(o,[n],u)}).then(function(u){return u.numFailures?le.reject(u.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"deleteRange",range:Fi}).then(function(s){return tr(n,null,s)})}).then(function(o){return o.numFailures?le.reject(o.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var o=this;return this._trans("readonly",function(s){return o.core.getMany({keys:n,trans:s}).then(function(u){return u.map(function(c){return o.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var E=u.schema.primKey,v=E.auto,E=E.keyPath;if(E&&c)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,E=E&&v?n.map(er(E)):n;return u.core.mutate({trans:g,type:"add",keys:c,values:E,wantResults:d}).then(function(P){var y=P.numFailures,I=P.results,M=P.lastResult,P=P.failures;if(y===0)return d?I:M;throw new Ae("".concat(u.name,".bulkAdd(): ").concat(y," of ").concat(C," operations failed"),P)})})},Fe.prototype.bulkPut=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var E=u.schema.primKey,v=E.auto,E=E.keyPath;if(E&&c)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,E=E&&v?n.map(er(E)):n;return u.core.mutate({trans:g,type:"put",keys:c,values:E,wantResults:d}).then(function(P){var y=P.numFailures,I=P.results,M=P.lastResult,P=P.failures;if(y===0)return d?I:M;throw new Ae("".concat(u.name,".bulkPut(): ").concat(y," of ").concat(C," operations failed"),P)})})},Fe.prototype.bulkUpdate=function(n){var o=this,s=this.core,u=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:u,cache:"clone"}).then(function(v){var C=[],E=[];n.forEach(function(y,I){var M=y.key,P=y.changes,O=v[I];if(O){for(var D=0,T=Object.keys(P);D<T.length;D++){var B=T[D],q=P[B];if(B===o.schema.primKey.keyPath){if(Te(q,M)!==0)throw new Y.Constraint("Cannot update primary key in bulkUpdate()")}else z(O,B,q)}d.push(I),C.push(M),E.push(O)}});var _=C.length;return s.mutate({trans:g,type:"put",keys:C,values:E,updates:{keys:u,changeSpecs:c}}).then(function(y){var I=y.numFailures,M=y.failures;if(I===0)return _;for(var P=0,O=Object.keys(M);P<O.length;P++){var D,T=O[P],B=d[Number(T)];B!=null&&(D=M[T],delete M[T],M[B]=D)}throw new Ae("".concat(o.name,".bulkUpdate(): ").concat(I," of ").concat(_," operations failed"),M)})})})},Fe.prototype.bulkDelete=function(n){var o=this,s=n.length;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"delete",keys:n}).then(function(c){return tr(o,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Ae("".concat(o.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function Sn(n){function o(g,v){if(v){for(var C=arguments.length,E=new Array(C-1);--C;)E[C-1]=arguments[C];return s[g].subscribe.apply(null,E),n}if(typeof g=="string")return s[g]}var s={};o.addEventType=d;for(var u=1,c=arguments.length;u<c;++u)d(arguments[u]);return o;function d(g,v,C){if(typeof g!="object"){var E;v=v||on;var _={subscribers:[],fire:C=C||ke,subscribe:function(y){_.subscribers.indexOf(y)===-1&&(_.subscribers.push(y),_.fire=v(_.fire,y))},unsubscribe:function(y){_.subscribers=_.subscribers.filter(function(I){return I!==y}),_.fire=_.subscribers.reduce(v,C)}};return s[g]=o[g]=_}p(E=g).forEach(function(y){var I=E[y];if(h(I))d(y,E[y][0],E[y][1]);else{if(I!=="asap")throw new Y.InvalidArgument("Invalid event config");var M=d(y,Xe,function(){for(var P=arguments.length,O=new Array(P);P--;)O[P]=arguments[P];M.subscribers.forEach(function(D){A(function(){D.apply(null,O)})})})}})}}function Pn(n,o){return R(o).from({prototype:n}),o}function hn(n,o){return!(n.filter||n.algorithm||n.or)&&(o?n.justLimit:!n.replayFilter)}function Nr(n,o){n.filter=Vt(n.filter,o)}function qr(n,o,s){var u=n.replayFilter;n.replayFilter=u?function(){return Vt(u(),o())}:o,n.justLimit=s&&!u}function nr(n,o){if(n.isPrimKey)return o.primaryKey;var s=o.getIndexByKeyPath(n.index);if(!s)throw new Y.Schema("KeyPath "+n.index+" on object store "+o.name+" is not indexed");return s}function Vi(n,o,s){var u=nr(n,o.schema);return o.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function rr(n,o,s,u){var c=n.replayFilter?Vt(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,C,E){var _,y;c&&!c(C,E,function(I){return C.stop(I)},function(I){return C.fail(I)})||((y=""+(_=C.primaryKey))=="[object ArrayBuffer]"&&(y=""+new Uint8Array(_)),b(d,y)||(d[y]=!0,o(v,C,E)))};return Promise.all([n.or._iterate(g,s),Hi(Vi(n,u,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Hi(Vi(n,u,s),Vt(n.algorithm,c),o,!n.keysOnly&&n.valueMapper)}function Hi(n,o,s,u){var c=Ke(u?function(d,g,v){return s(u(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};o&&!o(d,function(v){return g=v},function(v){d.stop(v),g=ke},function(v){d.fail(v),g=ke})||c(d.value,d,function(v){return g=v}),g()})})}var ga=(Be.prototype._read=function(n,o){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(o)},Be.prototype._write=function(n){var o=this._ctx;return o.error?o.table._trans(null,Ne.bind(null,o.error)):o.table._trans("readwrite",n,"locked")},Be.prototype._addAlgorithm=function(n){var o=this._ctx;o.algorithm=Vt(o.algorithm,n)},Be.prototype._iterate=function(n,o){return rr(this._ctx,n,o,this._ctx.table.core)},Be.prototype.clone=function(n){var o=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),o._ctx=s,o},Be.prototype.raw=function(){return this._ctx.valueMapper=null,this},Be.prototype.each=function(n){var o=this._ctx;return this._read(function(s){return rr(o,n,s,o.table.core)})},Be.prototype.count=function(n){var o=this;return this._read(function(s){var u=o._ctx,c=u.table.core;if(hn(u,!0))return c.count({trans:s,query:{index:nr(u,c.schema),range:u.range}}).then(function(g){return Math.min(g,u.limit)});var d=0;return rr(u,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},Be.prototype.sortBy=function(n,o){var s=n.split(".").reverse(),u=s[0],c=s.length-1;function d(C,E){return E?d(C[s[E]],E-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function v(C,E){return Te(d(C,c),d(E,c))*g}return this.toArray(function(C){return C.sort(v)}).then(o)},Be.prototype.toArray=function(n){var o=this;return this._read(function(s){var u=o._ctx;if(u.dir==="next"&&hn(u,!0)&&0<u.limit){var c=u.valueMapper,d=nr(u,u.table.core.schema);return u.table.core.query({trans:s,limit:u.limit,values:!0,query:{index:d,range:u.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return rr(u,function(v){return g.push(v)},s,u.table.core).then(function(){return g})},n)},Be.prototype.offset=function(n){var o=this._ctx;return n<=0||(o.offset+=n,hn(o)?qr(o,function(){var s=n;return function(u,c){return s===0||(s===1?--s:c(function(){u.advance(s),s=0}),!1)}}):qr(o,function(){var s=n;return function(){return--s<0}})),this},Be.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),qr(this._ctx,function(){var o=n;return function(s,u,c){return--o<=0&&u(c),0<=o}},!0),this},Be.prototype.until=function(n,o){return Nr(this._ctx,function(s,u,c){return!n(s.value)||(u(c),o)}),this},Be.prototype.first=function(n){return this.limit(1).toArray(function(o){return o[0]}).then(n)},Be.prototype.last=function(n){return this.reverse().first(n)},Be.prototype.filter=function(n){var o;return Nr(this._ctx,function(s){return n(s.value)}),(o=this._ctx).isMatch=Vt(o.isMatch,n),this},Be.prototype.and=function(n){return this.filter(n)},Be.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Be.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Be.prototype.desc=function(){return this.reverse()},Be.prototype.eachKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.key,u)})},Be.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Be.prototype.eachPrimaryKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.primaryKey,u)})},Be.prototype.keys=function(n){var o=this._ctx;o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.key)}).then(function(){return s}).then(n)},Be.prototype.primaryKeys=function(n){var o=this._ctx;if(o.dir==="next"&&hn(o,!0)&&0<o.limit)return this._read(function(u){var c=nr(o,o.table.core.schema);return o.table.core.query({trans:u,values:!1,limit:o.limit,query:{index:c,range:o.range}})}).then(function(u){return u.result}).then(n);o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},Be.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Be.prototype.firstKey=function(n){return this.limit(1).keys(function(o){return o[0]}).then(n)},Be.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Be.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var o={};return Nr(this._ctx,function(c){var u=c.primaryKey.toString(),c=b(o,u);return o[u]=!0,!c}),this},Be.prototype.modify=function(n){var o=this,s=this._ctx;return this._write(function(u){var c=typeof n=="function"?n:function(O){return Zi(O,n)},d=s.table.core,E=d.schema.primaryKey,g=E.outbound,v=E.extractKey,C=200,E=o.db._options.modifyChunkSize;E&&(C=typeof E=="object"?E[d.name]||E["*"]||200:E);function _(O,B){var T=B.failures,B=B.numFailures;I+=O-B;for(var q=0,$=p(T);q<$.length;q++){var te=$[q];y.push(T[te])}}var y=[],I=0,M=[],P=n===Gi;return o.clone().primaryKeys().then(function(O){function D(B){var q=Math.min(C,O.length-B),$=O.slice(B,B+q);return(P?Promise.resolve([]):d.getMany({trans:u,keys:$,cache:"immutable"})).then(function(te){var se=[],Q=[],ne=g?[]:null,ae=P?$:[];if(!P)for(var ie=0;ie<q;++ie){var fe=te[ie],Ee={value:de(fe),primKey:O[B+ie]};c.call(Ee,Ee.value,Ee)!==!1&&(Ee.value==null?ae.push(O[B+ie]):g||Te(v(fe),v(Ee.value))===0?(Q.push(Ee.value),g&&ne.push(O[B+ie])):(ae.push(O[B+ie]),se.push(Ee.value)))}return Promise.resolve(0<se.length&&d.mutate({trans:u,type:"add",values:se}).then(function(Se){for(var Oe in Se.failures)ae.splice(parseInt(Oe),1);_(se.length,Se)})).then(function(){return(0<Q.length||T&&typeof n=="object")&&d.mutate({trans:u,type:"put",keys:ne,values:Q,criteria:T,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<B}).then(function(Se){return _(Q.length,Se)})}).then(function(){return(0<ae.length||T&&P)&&d.mutate({trans:u,type:"delete",keys:ae,criteria:T,isAdditionalChunk:0<B}).then(function(Se){return tr(s.table,ae,Se)}).then(function(Se){return _(ae.length,Se)})}).then(function(){return O.length>B+q&&D(B+C)})})}var T=hn(s)&&s.limit===1/0&&(typeof n!="function"||P)&&{index:s.index,range:s.range};return D(0).then(function(){if(0<y.length)throw new Z("Error modifying one or more objects",y,I,M);return O.length})})})},Be.prototype.delete=function(){var n=this._ctx,o=n.range;return!hn(n)||n.table.schema.yProps||!n.isPrimKey&&o.type!==3?this.modify(Gi):this._write(function(s){var u=n.table.core.schema.primaryKey,c=o;return n.table.core.count({trans:s,query:{index:u,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(C){var v=C.failures,C=C.numFailures;if(C)throw new Z("Could not delete some values",Object.keys(v).map(function(E){return v[E]}),d-C);return d-C})})})},Be);function Be(){}var Gi=function(n,o){return o.value=null};function ma(n,o){return n<o?-1:n===o?0:1}function va(n,o){return o<n?-1:n===o?0:1}function tt(n,o,s){return n=n instanceof Xi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(o),n}function gn(n){return new n.Collection(n,function(){return Yi("")}).limit(0)}function ir(n,o,s,u){var c,d,g,v,C,E,_,y=s.length;if(!s.every(function(P){return typeof P=="string"}))return tt(n,zi);function I(P){c=P==="next"?function(D){return D.toUpperCase()}:function(D){return D.toLowerCase()},d=P==="next"?function(D){return D.toLowerCase()}:function(D){return D.toUpperCase()},g=P==="next"?ma:va;var O=s.map(function(D){return{lower:d(D),upper:c(D)}}).sort(function(D,T){return g(D.lower,T.lower)});v=O.map(function(D){return D.upper}),C=O.map(function(D){return D.lower}),_=(E=P)==="next"?"":u}I("next"),n=new n.Collection(n,function(){return Tt(v[0],C[y-1]+u)}),n._ondirectionchange=function(P){I(P)};var M=0;return n._addAlgorithm(function(P,O,D){var T=P.key;if(typeof T!="string")return!1;var B=d(T);if(o(B,C,M))return!0;for(var q=null,$=M;$<y;++$){var te=(function(se,Q,ne,ae,ie,fe){for(var Ee=Math.min(se.length,ae.length),Se=-1,Oe=0;Oe<Ee;++Oe){var nt=Q[Oe];if(nt!==ae[Oe])return ie(se[Oe],ne[Oe])<0?se.substr(0,Oe)+ne[Oe]+ne.substr(Oe+1):ie(se[Oe],ae[Oe])<0?se.substr(0,Oe)+ae[Oe]+ne.substr(Oe+1):0<=Se?se.substr(0,Se)+Q[Se]+ne.substr(Se+1):null;ie(se[Oe],nt)<0&&(Se=Oe)}return Ee<ae.length&&fe==="next"?se+ne.substr(se.length):Ee<se.length&&fe==="prev"?se.substr(0,ne.length):Se<0?null:se.substr(0,Se)+ae[Se]+ne.substr(Se+1)})(T,B,v[$],C[$],g,E);te===null&&q===null?M=$+1:(q===null||0<g(q,te))&&(q=te)}return O(q!==null?function(){P.continue(q+_)}:D),!1}),n}function Tt(n,o,s,u){return{type:2,lower:n,upper:o,lowerOpen:s,upperOpen:u}}function Yi(n){return{type:1,lower:n,upper:n}}var Xi=(Object.defineProperty($e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$e.prototype.between=function(n,o,s,u){s=s!==!1,u=u===!0;try{return 0<this._cmp(n,o)||this._cmp(n,o)===0&&(s||u)&&(!s||!u)?gn(this):new this.Collection(this,function(){return Tt(n,o,!s,!u)})}catch{return tt(this,kt)}},$e.prototype.equals=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Yi(n)})},$e.prototype.above=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!0)})},$e.prototype.aboveOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!1)})},$e.prototype.below=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n,!1,!0)})},$e.prototype.belowOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n)})},$e.prototype.startsWith=function(n){return typeof n!="string"?tt(this,zi):this.between(n,n+$t,!0,!0)},$e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):ir(this,function(o,s){return o.indexOf(s[0])===0},[n],$t)},$e.prototype.equalsIgnoreCase=function(n){return ir(this,function(o,s){return o===s[0]},[n],"")},$e.prototype.anyOfIgnoreCase=function(){var n=me.apply(we,arguments);return n.length===0?gn(this):ir(this,function(o,s){return s.indexOf(o)!==-1},n,"")},$e.prototype.startsWithAnyOfIgnoreCase=function(){var n=me.apply(we,arguments);return n.length===0?gn(this):ir(this,function(o,s){return s.some(function(u){return o.indexOf(u)===0})},n,$t)},$e.prototype.anyOf=function(){var n=this,o=me.apply(we,arguments),s=this._cmp;try{o.sort(s)}catch{return tt(this,kt)}if(o.length===0)return gn(this);var u=new this.Collection(this,function(){return Tt(o[0],o[o.length-1])});u._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,o.sort(s)};var c=0;return u._addAlgorithm(function(d,g,v){for(var C=d.key;0<s(C,o[c]);)if(++c===o.length)return g(v),!1;return s(C,o[c])===0||(g(function(){d.continue(o[c])}),!1)}),u},$e.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$e.prototype.noneOf=function(){var n=me.apply(we,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return tt(this,kt)}var o=n.reduce(function(s,u){return s?s.concat([[s[s.length-1][1],u]]):[[-1/0,u]]},null);return o.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},$e.prototype.inAnyRange=function(T,o){var s=this,u=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(T.length===0)return gn(this);if(!T.every(function(B){return B[0]!==void 0&&B[1]!==void 0&&c(B[0],B[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var C=!o||o.includeLowers!==!1,E=o&&o.includeUppers===!0,_,y=c;function I(B,q){return y(B[0],q[0])}try{(_=T.reduce(function(B,q){for(var $=0,te=B.length;$<te;++$){var se=B[$];if(u(q[0],se[1])<0&&0<u(q[1],se[0])){se[0]=g(se[0],q[0]),se[1]=v(se[1],q[1]);break}}return $===te&&B.push(q),B},[])).sort(I)}catch{return tt(this,kt)}var M=0,P=E?function(B){return 0<c(B,_[M][1])}:function(B){return 0<=c(B,_[M][1])},O=C?function(B){return 0<d(B,_[M][0])}:function(B){return 0<=d(B,_[M][0])},D=P,T=new this.Collection(this,function(){return Tt(_[0][0],_[_.length-1][1],!C,!E)});return T._ondirectionchange=function(B){y=B==="next"?(D=P,c):(D=O,d),_.sort(I)},T._addAlgorithm(function(B,q,$){for(var te,se=B.key;D(se);)if(++M===_.length)return q($),!1;return!P(te=se)&&!O(te)||(s._cmp(se,_[M][1])===0||s._cmp(se,_[M][0])===0||q(function(){y===c?B.continue(_[M][0]):B.continue(_[M][1])}),!1)}),T},$e.prototype.startsWithAnyOf=function(){var n=me.apply(we,arguments);return n.every(function(o){return typeof o=="string"})?n.length===0?gn(this):this.inAnyRange(n.map(function(o){return[o,o+$t]})):tt(this,"startsWithAnyOf() only works with strings")},$e);function $e(){}function yt(n){return Ke(function(o){return On(o),n(o.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",Wr="x-storagemutated-1",At=Sn(null,_n),ya=(bt.prototype._lock=function(){return K(!ve.global),++this._reculock,this._reculock!==1||ve.global||(ve.lockOwnerFor=this),this},bt.prototype._unlock=function(){if(K(!ve.global),--this._reculock==0)for(ve.global||(ve.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Zt(n[1],n[0])}catch{}}return this},bt.prototype._locked=function(){return this._reculock&&ve.lockOwnerFor!==this},bt.prototype.create=function(n){var o=this;if(!this.mode)return this;var s=this.db.idbdb,u=this.db._state.dbOpenError;if(K(!this.idbtrans),!n&&!s)switch(u&&u.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(u);case"MissingAPIError":throw new Y.MissingAPI(u.message,u);default:throw new Y.OpenFailed(u)}if(!this.active)throw new Y.TransactionInactive;return K(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){On(c),o._reject(n.error)}),n.onabort=Ke(function(c){On(c),o.active&&o._reject(new Y.Abort(n.error)),o.active=!1,o.on("abort").fire(c)}),n.oncomplete=Ke(function(){o.active=!1,o._resolve(),"mutatedParts"in n&&At.storagemutated.fire(n.mutatedParts)}),this},bt.prototype._promise=function(n,o,s){var u=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new Y.TransactionInactive);if(this._locked())return new le(function(d,g){u._blockedFuncs.push([function(){u._promise(n,o,s).then(d,g)},ve])});if(s)return It(function(){var d=new le(function(g,v){u._lock();var C=o(g,v,u);C&&C.then&&C.then(g,v)});return d.finally(function(){return u._unlock()}),d._lib=!0,d});var c=new le(function(d,g){var v=o(d,g,u);v&&v.then&&v.then(d,g)});return c._lib=!0,c},bt.prototype._root=function(){return this.parent?this.parent._root():this},bt.prototype.waitFor=function(n){var o,s=this._root(),u=le.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return u}):(s._waitingFor=u,s._waitingQueue=[],o=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(o.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new le(function(d,g){u.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},bt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Y.Abort))},bt.prototype.table=function(n){var o=this._memoizedTables||(this._memoizedTables={});if(b(o,n))return o[n];var s=this.schema[n];if(!s)throw new Y.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),o[n]=s},bt);function bt(){}function Zr(n,o,s,u,c,d,g,v){return{name:n,keyPath:o,unique:s,multi:u,auto:c,compound:d,src:(s&&!g?"&":"")+(u?"*":"")+(c?"++":"")+Ji(o),type:v}}function Ji(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function $r(n,o,s){return{name:n,primKey:o,indexes:s,mappedClass:null,idxByName:(u=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=u(d,g),g&&(c[g[0]]=g[1]),c},{}))};var u}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return $t},$t}};function Vr(n){return n==null?function(){}:typeof n=="string"?(o=n).split(".").length===1?function(s){return s[o]}:function(s){return S(s,o)}:function(s){return S(s,n)};var o}function Qi(n){return[].slice.call(n)}var ba=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function wa(n,o,C){function u(D){if(D.type===3)return null;if(D.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var M=D.lower,P=D.upper,O=D.lowerOpen,D=D.upperOpen;return M===void 0?P===void 0?null:o.upperBound(P,!!D):P===void 0?o.lowerBound(M,!!O):o.bound(M,P,!!O,!!D)}function c(I){var M,P=I.name;return{name:P,schema:I,mutate:function(O){var D=O.trans,T=O.type,B=O.keys,q=O.values,$=O.range;return new Promise(function(te,se){te=Ke(te);var Q=D.objectStore(P),ne=Q.keyPath==null,ae=T==="put"||T==="add";if(!ae&&T!=="delete"&&T!=="deleteRange")throw new Error("Invalid operation type: "+T);var ie,fe=(B||q||{length:1}).length;if(B&&q&&B.length!==q.length)throw new Error("Given keys array must have same length as given values array.");if(fe===0)return te({numFailures:0,failures:{},results:[],lastResult:void 0});function Ee(Qe){++nt,On(Qe)}var Se=[],Oe=[],nt=0;if(T==="deleteRange"){if($.type===4)return te({numFailures:nt,failures:Oe,results:[],lastResult:void 0});$.type===3?Se.push(ie=Q.clear()):Se.push(ie=Q.delete(u($)))}else{var ne=ae?ne?[q,B]:[q,null]:[B,null],Ce=ne[0],He=ne[1];if(ae)for(var Ge=0;Ge<fe;++Ge)Se.push(ie=He&&He[Ge]!==void 0?Q[T](Ce[Ge],He[Ge]):Q[T](Ce[Ge])),ie.onerror=Ee;else for(Ge=0;Ge<fe;++Ge)Se.push(ie=Q[T](Ce[Ge])),ie.onerror=Ee}function mr(Qe){Qe=Qe.target.result,Se.forEach(function(Yt,fi){return Yt.error!=null&&(Oe[fi]=Yt.error)}),te({numFailures:nt,failures:Oe,results:T==="delete"?B:Se.map(function(Yt){return Yt.result}),lastResult:Qe})}ie.onerror=function(Qe){Ee(Qe),mr(Qe)},ie.onsuccess=mr})},getMany:function(O){var D=O.trans,T=O.keys;return new Promise(function(B,q){B=Ke(B);for(var $,te=D.objectStore(P),se=T.length,Q=new Array(se),ne=0,ae=0,ie=function(Se){Se=Se.target,Q[Se._pos]=Se.result,++ae===ne&&B(Q)},fe=yt(q),Ee=0;Ee<se;++Ee)T[Ee]!=null&&(($=te.get(T[Ee]))._pos=Ee,$.onsuccess=ie,$.onerror=fe,++ne);ne===0&&B(Q)})},get:function(O){var D=O.trans,T=O.key;return new Promise(function(B,q){B=Ke(B);var $=D.objectStore(P).get(T);$.onsuccess=function(te){return B(te.target.result)},$.onerror=yt(q)})},query:(M=E,function(O){return new Promise(function(D,T){D=Ke(D);var B,q,$,ne=O.trans,te=O.values,se=O.limit,ie=O.query,Q=se===1/0?void 0:se,ae=ie.index,ie=ie.range,ne=ne.objectStore(P),ae=ae.isPrimaryKey?ne:ne.index(ae.name),ie=u(ie);if(se===0)return D({result:[]});M?((Q=te?ae.getAll(ie,Q):ae.getAllKeys(ie,Q)).onsuccess=function(fe){return D({result:fe.target.result})},Q.onerror=yt(T)):(B=0,q=!te&&"openKeyCursor"in ae?ae.openKeyCursor(ie):ae.openCursor(ie),$=[],q.onsuccess=function(fe){var Ee=q.result;return Ee?($.push(te?Ee.value:Ee.primaryKey),++B===se?D({result:$}):void Ee.continue()):D({result:$})},q.onerror=yt(T))})}),openCursor:function(O){var D=O.trans,T=O.values,B=O.query,q=O.reverse,$=O.unique;return new Promise(function(te,se){te=Ke(te);var ae=B.index,Q=B.range,ne=D.objectStore(P),ne=ae.isPrimaryKey?ne:ne.index(ae.name),ae=q?$?"prevunique":"prev":$?"nextunique":"next",ie=!T&&"openKeyCursor"in ne?ne.openKeyCursor(u(Q),ae):ne.openCursor(u(Q),ae);ie.onerror=yt(se),ie.onsuccess=Ke(function(fe){var Ee,Se,Oe,nt,Ce=ie.result;Ce?(Ce.___id=++ba,Ce.done=!1,Ee=Ce.continue.bind(Ce),Se=(Se=Ce.continuePrimaryKey)&&Se.bind(Ce),Oe=Ce.advance.bind(Ce),nt=function(){throw new Error("Cursor not stopped")},Ce.trans=D,Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=function(){throw new Error("Cursor not started")},Ce.fail=Ke(se),Ce.next=function(){var He=this,Ge=1;return this.start(function(){return Ge--?He.continue():He.stop()}).then(function(){return He})},Ce.start=function(He){function Ge(){if(ie.result)try{He()}catch(Qe){Ce.fail(Qe)}else Ce.done=!0,Ce.start=function(){throw new Error("Cursor behind last entry")},Ce.stop()}var mr=new Promise(function(Qe,Yt){Qe=Ke(Qe),ie.onerror=yt(Yt),Ce.fail=Yt,Ce.stop=function(fi){Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=nt,Qe(fi)}});return ie.onsuccess=Ke(function(Qe){ie.onsuccess=Ge,Ge()}),Ce.continue=Ee,Ce.continuePrimaryKey=Se,Ce.advance=Oe,Ge(),mr},te(Ce)):te(null)},se)})},count:function(O){var D=O.query,T=O.trans,B=D.index,q=D.range;return new Promise(function($,te){var se=T.objectStore(P),Q=B.isPrimaryKey?se:se.index(B.name),se=u(q),Q=se?Q.count(se):Q.count();Q.onsuccess=Ke(function(ne){return $(ne.target.result)}),Q.onerror=yt(te)})}}}var d,g,v,_=(g=C,v=Qi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(I){return g.objectStore(I)}).map(function(I){var M=I.keyPath,D=I.autoIncrement,P=h(M),O={},D={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:M==null,compound:P,keyPath:M,autoIncrement:D,unique:!0,extractKey:Vr(M)},indexes:Qi(I.indexNames).map(function(T){return I.index(T)}).map(function($){var B=$.name,q=$.unique,te=$.multiEntry,$=$.keyPath,te={name:B,compound:h($),keyPath:$,unique:q,multiEntry:te,extractKey:Vr($)};return O[In($)]=te}),getIndexByKeyPath:function(T){return O[In(T)]}};return O[":id"]=D.primaryKey,M!=null&&(O[In(M)]=D.primaryKey),D})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),C=_.schema,E=_.hasGetAll,_=C.tables.map(c),y={};return _.forEach(function(I){return y[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(!y[I])throw new Error("Table '".concat(I,"' not found"));return y[I]},MIN_KEY:-1/0,MAX_KEY:Dn(o),schema:C}}function La(n,o,s,u){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(u=wa(o,c,u),n.dbcore.reduce(function(d,g){return g=g.create,i(i({},d),g(d))},u))}}function or(n,u){var s=u.db,u=La(n._middlewares,s,n._deps,u);n.core=u.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function sr(n,o,s,u){s.forEach(function(c){var d=u[c];o.forEach(function(g){var v=(function C(E,_){return U(E,_)||(E=L(E))&&C(E,_)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?k(g,c,{get:function(){return this.table(c)},set:function(C){j(this,c,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function Hr(n,o){o.forEach(function(s){for(var u in s)s[u]instanceof n.Table&&delete s[u]})}function xa(n,o){return n._cfg.version-o._cfg.version}function Ca(n,o,s,u){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=$r("$meta",to("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(u);var g=d._reject.bind(d),v=ve.transless||ve;It(function(){return ve.trans=d,ve.transless=v,o!==0?(or(n,s),E=o,((C=d).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(_){return _??E}):le.resolve(E)).then(function(_){return I=_,M=d,P=s,O=[],_=(y=n)._versions,D=y._dbSchema=lr(0,y.idbdb,P),(_=_.filter(function(T){return T._cfg.version>=I})).length!==0?(_.forEach(function(T){O.push(function(){var B=D,q=T._cfg.dbschema;ur(y,B,P),ur(y,q,P),D=y._dbSchema=q;var $=Gr(B,q);$.add.forEach(function(ae){Yr(P,ae[0],ae[1].primKey,ae[1].indexes)}),$.change.forEach(function(ae){if(ae.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var ie=P.objectStore(ae.name);ae.add.forEach(function(fe){return ar(ie,fe)}),ae.change.forEach(function(fe){ie.deleteIndex(fe.name),ar(ie,fe)}),ae.del.forEach(function(fe){return ie.deleteIndex(fe)})});var te=T._cfg.contentUpgrade;if(te&&T._cfg.version>I){or(y,P),M._memoizedTables={};var se=H(q);$.del.forEach(function(ae){se[ae]=B[ae]}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],p(se),se),M.schema=se;var Q,ne=xe(te);return ne&&dn(),$=le.follow(function(){var ae;(Q=te(M))&&ne&&(ae=jt.bind(null,null),Q.then(ae,ae))}),Q&&typeof Q.then=="function"?le.resolve(Q):$.then(function(){return Q})}}),O.push(function(B){var q,$,te=T._cfg.dbschema;q=te,$=B,[].slice.call($.db.objectStoreNames).forEach(function(se){return q[se]==null&&$.db.deleteObjectStore(se)}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],y._storeNames,y._dbSchema),M.schema=y._dbSchema}),O.push(function(B){y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(y.idbdb.version/10)===T._cfg.version?(y.idbdb.deleteObjectStore("$meta"),delete y._dbSchema.$meta,y._storeNames=y._storeNames.filter(function(q){return q!=="$meta"})):B.objectStore("$meta").put(T._cfg.version,"version"))})}),(function T(){return O.length?le.resolve(O.shift()(M.idbtrans)).then(T):le.resolve()})().then(function(){eo(D,P)})):le.resolve();var y,I,M,P,O,D}).catch(g)):(p(c).forEach(function(_){Yr(s,_,c[_].primKey,c[_].indexes)}),or(n,s),void le.follow(function(){return n.on.populate.fire(d)}).catch(g));var C,E})}function Ea(n,o){eo(n._dbSchema,o),o.db.version%10!=0||o.objectStoreNames.contains("$meta")||o.db.createObjectStore("$meta").add(Math.ceil(o.db.version/10-1),"version");var s=lr(0,n.idbdb,o);ur(n,n._dbSchema,o);for(var u=0,c=Gr(s,n._dbSchema).change;u<c.length;u++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=o.objectStore(g.name);g.add.forEach(function(C){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),ar(v,C)})})(c[u]);if(typeof d=="object")return d.value}}function Gr(n,o){var s,u={del:[],add:[],change:[]};for(s in n)o[s]||u.del.push(s);for(s in o){var c=n[s],d=o[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,u.change.push(g);else{var v=c.idxByName,C=d.idxByName,E=void 0;for(E in v)C[E]||g.del.push(E);for(E in C){var _=v[E],y=C[E];_?_.src!==y.src&&g.change.push(y):g.add.push(y)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([s,d])}return u}function Yr(n,o,s,u){var c=n.db.createObjectStore(o,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return u.forEach(function(d){return ar(c,d)}),c}function eo(n,o){p(n).forEach(function(s){o.db.objectStoreNames.contains(s)||(Je&&console.debug("Dexie: Creating missing table",s),Yr(o,s,n[s].primKey,n[s].indexes))})}function ar(n,o){n.createIndex(o.name,o.keyPath,{unique:o.unique,multiEntry:o.multi})}function lr(n,o,s){var u={};return W(o.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Zr(Ji(E=d.keyPath),E||"",!0,!1,!!d.autoIncrement,E&&typeof E!="string",!0),v=[],C=0;C<d.indexNames.length;++C){var _=d.index(d.indexNames[C]),E=_.keyPath,_=Zr(_.name,E,!!_.unique,!!_.multiEntry,!1,E&&typeof E!="string",!1);v.push(_)}u[c]=$r(c,g,v)}),u}function ur(n,o,s){for(var u=s.db.objectStoreNames,c=0;c<u.length;++c){var d=u[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var C=g.indexNames[v],E=g.index(C).keyPath,_=typeof E=="string"?E:"["+W(E).join("+")+"]";!o[d]||(E=o[d].idxByName[_])&&(E.name=C,delete o[d].idxByName[_],o[d].idxByName[C]=E)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function to(n){return n.split(",").map(function(o,s){var d=o.split(":"),u=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(o=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Zr(c,d||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),h(d),s===0,u)})}var Ma=(mn.prototype._createTableSchema=$r,mn.prototype._parseIndexSyntax=to,mn.prototype._parseStoresSpec=function(n,o){var s=this;p(n).forEach(function(u){if(n[u]!==null){var c=s._parseIndexSyntax(n[u]),d=c.shift();if(!d)throw new Y.Schema("Invalid schema for table "+u+": "+n[u]);if(d.unique=!0,d.multi)throw new Y.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(u,d,c),o[u]=c}})},mn.prototype.stores=function(s){var o=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=o._versions,u={},c={};return s.forEach(function(d){m(u,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(u,c)}),o._dbSchema=c,Hr(o,[o._allTables,o,o.Transaction.prototype]),sr(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],p(c),c),o._storeNames=p(c),this},mn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=sn(this._cfg.contentUpgrade||ke,n),this},mn);function mn(){}function Xr(n,o){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new St(Qn,{addons:[],indexedDB:n,IDBKeyRange:o})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Jr(n){return n&&typeof n.databases=="function"}function Qr(n){return It(function(){return ve.letThrough=!0,n()})}function ei(n){return!("from"in n)}var Ve=function(n,o){if(!this){var s=new Ve;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?o:n}:{d:0})};function jn(n,o,s){var u=Te(o,s);if(!isNaN(u)){if(0<u)throw RangeError();if(ei(n))return m(n,{from:o,to:s,d:1});var c=n.l,u=n.r;if(Te(s,n.from)<0)return c?jn(c,o,s):n.l={from:o,to:s,d:1,l:null,r:null},ro(n);if(0<Te(o,n.to))return u?jn(u,o,s):n.r={from:o,to:s,d:1,l:null,r:null},ro(n);Te(o,n.from)<0&&(n.from=o,n.l=null,n.d=u?u.d+1:1),0<Te(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),u&&s&&Rn(n,u)}}function Rn(n,o){ei(o)||(function s(u,C){var d=C.from,g=C.to,v=C.l,C=C.r;jn(u,d,g),v&&s(u,v),C&&s(u,C)})(n,o)}function no(n,o){var s=cr(o),u=s.next();if(u.done)return!1;for(var c=u.value,d=cr(n),g=d.next(c.from),v=g.value;!u.done&&!g.done;){if(Te(v.from,c.to)<=0&&0<=Te(v.to,c.from))return!0;Te(c.from,v.from)<0?c=(u=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function cr(n){var o=ei(n)?null:{s:0,n};return{next:function(s){for(var u=0<arguments.length;o;)switch(o.s){case 0:if(o.s=1,u)for(;o.n.l&&Te(s,o.n.from)<0;)o={up:o,n:o.n.l,s:1};else for(;o.n.l;)o={up:o,n:o.n.l,s:1};case 1:if(o.s=2,!u||Te(s,o.n.to)<=0)return{value:o.n,done:!1};case 2:if(o.n.r){o.s=3,o={up:o,n:o.n.r,s:0};continue}case 3:o=o.up}return{done:!0}}}}function ro(n){var o,s,u=(((o=n.r)===null||o===void 0?void 0:o.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<u?"r":u<-1?"l":"";c&&(o=c=="r"?"l":"r",s=i({},n),u=n[c],n.from=u.from,n.to=u.to,n[c]=u[c],s[c]=u[o],(n[o]=s).d=io(s)),n.d=io(n)}function io(s){var o=s.r,s=s.l;return(o?s?Math.max(o.d,s.d):o.d:s?s.d:0)+1}function fr(n,o){return p(o).forEach(function(s){n[s]?Rn(n[s],o[s]):n[s]=(function u(c){var d,g,v={};for(d in c)b(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||G.has(g.constructor)?g:u(g));return v})(o[s])}),n}function ti(n,o){return n.all||o.all||Object.keys(n).some(function(s){return o[s]&&no(o[s],n[s])})}x(Ve.prototype,((lt={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var o=this;return n.forEach(function(s){return jn(o,s,s)}),this},hasKey:function(n){var o=cr(this).next(n).value;return o&&Te(o.from,n)<=0&&0<=Te(o.to,n)}})[ge]=function(){return cr(this)},lt));var Ht={},ni={},ri=!1;function dr(n){fr(ni,n),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(n,o){o===void 0&&(o=!1);var s=new Set;if(n.all)for(var u=0,c=Object.values(Ht);u<c.length;u++)oo(g=c[u],n,s,o);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Ht["idb://".concat(d,"/").concat(v)])&&oo(g,n,s,o))}s.forEach(function(C){return C()})}function oo(n,o,s,u){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],C=v[0],E=[],_=0,y=v[1];_<y.length;_++){var I=y[_];ti(o,I.obsSet)?I.subscribers.forEach(function(D){return s.add(D)}):u&&E.push(I)}u&&c.push([C,E])}if(u)for(var M=0,P=c;M<P.length;M++){var O=P[M],C=O[0],E=O[1];n.queries.query[C]=E}}function ka(n){var o=n._state,s=n._deps.indexedDB;if(o.isBeingOpened||n.idbdb)return o.dbReadyPromise.then(function(){return o.dbOpenError?Ne(o.dbOpenError):n});o.isBeingOpened=!0,o.dbOpenError=null,o.openComplete=!1;var u=o.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(o.openCanceller!==u)throw new Y.DatabaseClosed("db.open() was cancelled")}function v(){return new le(function(I,M){if(g(),!s)throw new Y.MissingAPI;var P=n.name,O=o.autoSchema||!c?s.open(P):s.open(P,c);if(!O)throw new Y.MissingAPI;O.onerror=yt(M),O.onblocked=Ke(n._fireOnBlocked),O.onupgradeneeded=Ke(function(D){var T;_=O.transaction,o.autoSchema&&!n._options.allowEmptyDB?(O.onerror=On,_.abort(),O.result.close(),(T=s.deleteDatabase(P)).onsuccess=T.onerror=Ke(function(){M(new Y.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(_.onerror=yt(M),D=D.oldVersion>Math.pow(2,62)?0:D.oldVersion,y=D<1,n.idbdb=O.result,d&&Ea(n,_),Ca(n,D/10,_,M))},M),O.onsuccess=Ke(function(){_=null;var D,T,B,q,$,te=n.idbdb=O.result,se=W(te.objectStoreNames);if(0<se.length)try{var Q=te.transaction((q=se).length===1?q[0]:q,"readonly");if(o.autoSchema)T=te,B=Q,(D=n).verno=T.version/10,B=D._dbSchema=lr(0,T,B),D._storeNames=W(T.objectStoreNames,0),sr(D,[D._allTables],p(B),B);else if(ur(n,n._dbSchema,Q),(($=Gr(lr(0,($=n).idbdb,Q),$._dbSchema)).add.length||$.change.some(function(ne){return ne.add.length||ne.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),te.close(),c=te.version+1,d=!0,I(v());or(n,Q)}catch{}pn.push(n),te.onversionchange=Ke(function(ne){o.vcFired=!0,n.on("versionchange").fire(ne)}),te.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),y&&($=n._deps,Q=P,te=$.indexedDB,$=$.IDBKeyRange,Jr(te)||Q===Qn||Xr(te,$).put({name:Q}).catch(ke)),I()},M)}).catch(function(I){switch(I?.name){case"UnknownError":if(0<o.PR1398_maxLoop)return o.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return le.reject(I)})}var C,E=o.dbReadyResolve,_=null,y=!1;return le.race([u,(typeof navigator>"u"?le.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function M(){return indexedDB.databases().finally(I)}C=setInterval(M,100),M()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(v)]).then(function(){return g(),o.onReadyBeingFired=[],le.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function I(){if(0<o.onReadyBeingFired.length){var M=o.onReadyBeingFired.reduce(sn,ke);return o.onReadyBeingFired=[],le.resolve(Qr(function(){return M(n.vip)})).then(I)}})}).finally(function(){o.openCanceller===u&&(o.onReadyBeingFired=null,o.isBeingOpened=!1)}).catch(function(I){o.dbOpenError=I;try{_&&_.abort()}catch{}return u===o.openCanceller&&n._close(),Ne(I)}).finally(function(){o.openComplete=!0,E()}).then(function(){var I;return y&&(I={},n.tables.forEach(function(M){M.schema.indexes.forEach(function(P){P.name&&(I["idb://".concat(n.name,"/").concat(M.name,"/").concat(P.name)]=new Ve(-1/0,[[[]]]))}),I["idb://".concat(n.name,"/").concat(M.name,"/")]=I["idb://".concat(n.name,"/").concat(M.name,"/:dels")]=new Ve(-1/0,[[[]]])}),At(_n).fire(I),ii(I,!0)),n})}function oi(n){function o(d){return n.next(d)}var s=c(o),u=c(function(d){return n.throw(d)});function c(d){return function(C){var v=d(C),C=v.value;return v.done?C:C&&typeof C.then=="function"?C.then(s,u):h(C)?Promise.all(C).then(s,u):s(C)}}return c(o)()}function pr(n,o,s){for(var u=h(n)?n.slice():[n],c=0;c<s;++c)u.push(o);return u}var Sa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema,c={},d=[];function g(y,I,M){var P=In(y),O=c[P]=c[P]||[],D=y==null?0:typeof y=="string"?1:y.length,T=0<I,T=i(i({},M),{name:T?"".concat(P,"(virtual-from:").concat(M.name,")"):M.name,lowLevelIndex:M,isVirtual:T,keyTail:I,keyLength:D,extractKey:Vr(y),unique:!T&&M.unique});return O.push(T),T.isPrimaryKey||d.push(T),1<D&&g(D===2?y[0]:y.slice(0,D-1),I+1,M),O.sort(function(B,q){return B.keyTail-q.keyTail}),T}o=g(u.primaryKey.keyPath,0,u.primaryKey),c[":id"]=[o];for(var v=0,C=u.indexes;v<C.length;v++){var E=C[v];g(E.keyPath,0,E)}function _(y){var I,M=y.query.index;return M.isVirtual?i(i({},y),{query:{index:M.lowLevelIndex,range:(I=y.query.range,M=M.keyTail,{type:I.type===1?2:I.type,lower:pr(I.lower,I.lowerOpen?n.MAX_KEY:n.MIN_KEY,M),lowerOpen:!0,upper:pr(I.upper,I.upperOpen?n.MIN_KEY:n.MAX_KEY,M),upperOpen:!0})}}):y}return i(i({},s),{schema:i(i({},u),{primaryKey:o,indexes:d,getIndexByKeyPath:function(y){return(y=c[In(y)])&&y[0]}}),count:function(y){return s.count(_(y))},query:function(y){return s.query(_(y))},openCursor:function(y){var I=y.query.index,M=I.keyTail,P=I.isVirtual,O=I.keyLength;return P?s.openCursor(_(y)).then(function(T){return T&&D(T)}):s.openCursor(y);function D(T){return Object.create(T,{continue:{value:function(B){B!=null?T.continue(pr(B,y.reverse?n.MAX_KEY:n.MIN_KEY,M)):y.unique?T.continue(T.key.slice(0,O).concat(y.reverse?n.MIN_KEY:n.MAX_KEY,M)):T.continue()}},continuePrimaryKey:{value:function(B,q){T.continuePrimaryKey(pr(B,n.MAX_KEY,M),q)}},primaryKey:{get:function(){return T.primaryKey}},key:{get:function(){var B=T.key;return O===1?B[0]:B.slice(0,O)}},value:{get:function(){return T.value}}})}}})}})}};function si(n,o,s,u){return s=s||{},u=u||"",p(n).forEach(function(c){var d,g,v;b(o,c)?(d=n[c],g=o[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=ue(d))!==ue(g)?s[u+c]=o[c]:v==="Object"?si(d,g,s,u+c+"."):d!==g&&(s[u+c]=o[c]):d!==g&&(s[u+c]=o[c])):s[u+c]=void 0}),p(o).forEach(function(c){b(n,c)||(s[u+c]=o[c])}),s}function ai(n,o){return o.type==="delete"?o.keys:o.keys||o.values.map(n.extractKey)}var Pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema.primaryKey;return i(i({},s),{mutate:function(c){var d=ve.trans,g=d.table(o).hook,v=g.deleting,C=g.creating,E=g.updating;switch(c.type){case"add":if(C.fire===ke)break;return d._promise("readwrite",function(){return _(c)},!0);case"put":if(C.fire===ke&&E.fire===ke)break;return d._promise("readwrite",function(){return _(c)},!0);case"delete":if(v.fire===ke)break;return d._promise("readwrite",function(){return _(c)},!0);case"deleteRange":if(v.fire===ke)break;return d._promise("readwrite",function(){return(function y(I,M,P){return s.query({trans:I,values:!1,query:{index:u,range:M},limit:P}).then(function(O){var D=O.result;return _({type:"delete",keys:D,trans:I}).then(function(T){return 0<T.numFailures?Promise.reject(T.failures[0]):D.length<P?{failures:[],numFailures:0,lastResult:void 0}:y(I,i(i({},M),{lower:D[D.length-1],lowerOpen:!0}),P)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function _(y){var I,M,P,O=ve.trans,D=y.keys||ai(u,y);if(!D)throw new Error("Keys missing");return(y=y.type==="add"||y.type==="put"?i(i({},y),{keys:D}):i({},y)).type!=="delete"&&(y.values=a([],y.values)),y.keys&&(y.keys=a([],y.keys)),I=s,P=D,((M=y).type==="add"?Promise.resolve([]):I.getMany({trans:M.trans,keys:P,cache:"immutable"})).then(function(T){var B=D.map(function(q,$){var te,se,Q,ne=T[$],ae={onerror:null,onsuccess:null};return y.type==="delete"?v.fire.call(ae,q,ne,O):y.type==="add"||ne===void 0?(te=C.fire.call(ae,q,y.values[$],O),q==null&&te!=null&&(y.keys[$]=q=te,u.outbound||z(y.values[$],u.keyPath,q))):(te=si(ne,y.values[$]),(se=E.fire.call(ae,te,q,ne,O))&&(Q=y.values[$],Object.keys(se).forEach(function(ie){b(Q,ie)?Q[ie]=se[ie]:z(Q,ie,se[ie])}))),ae});return s.mutate(y).then(function(q){for(var $=q.failures,te=q.results,se=q.numFailures,q=q.lastResult,Q=0;Q<D.length;++Q){var ne=(te||D)[Q],ae=B[Q];ne==null?ae.onerror&&ae.onerror($[Q]):ae.onsuccess&&ae.onsuccess(y.type==="put"&&T[Q]?y.values[Q]:ne)}return{failures:$,results:te,numFailures:se,lastResult:q}}).catch(function(q){return B.forEach(function($){return $.onerror&&$.onerror(q)}),Promise.reject(q)})})}}})}})}};function so(n,o,s){try{if(!o||o.keys.length<n.length)return null;for(var u=[],c=0,d=0;c<o.keys.length&&d<n.length;++c)Te(o.keys[c],n[d])===0&&(u.push(s?de(o.values[c]):o.values[c]),++d);return u.length===n.length?u:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(n){return{table:function(o){var s=n.table(o);return i(i({},s),{getMany:function(u){if(!u.cache)return s.getMany(u);var c=so(u.keys,u.trans._cache,u.cache==="clone");return c?le.resolve(c):s.getMany(u).then(function(d){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?de(d):d},d})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),s.mutate(u)}})}}}};function ao(n,o){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!o.schema.primaryKey.outbound}function lo(n,o){switch(n){case"query":return o.values&&!o.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var o=n.schema.name,s=new Ve(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(u,c,d){if(ve.subscr&&c!=="readonly")throw new Y.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ve.querier));return n.transaction(u,c,d)},table:function(u){var c=n.table(u),d=c.schema,g=d.primaryKey,y=d.indexes,v=g.extractKey,C=g.outbound,E=g.autoIncrement&&y.filter(function(M){return M.compound&&M.keyPath.includes(g.keyPath)}),_=i(i({},c),{mutate:function(M){function P(ie){return ie="idb://".concat(o,"/").concat(u,"/").concat(ie),q[ie]||(q[ie]=new Ve)}var O,D,T,B=M.trans,q=M.mutatedParts||(M.mutatedParts={}),$=P(""),te=P(":dels"),se=M.type,ae=M.type==="deleteRange"?[M.range]:M.type==="delete"?[M.keys]:M.values.length<50?[ai(g,M).filter(function(ie){return ie}),M.values]:[],Q=ae[0],ne=ae[1],ae=M.trans._cache;return h(Q)?($.addKeys(Q),(ae=se==="delete"||Q.length===ne.length?so(Q,ae):null)||te.addKeys(Q),(ae||ne)&&(O=P,D=ae,T=ne,d.indexes.forEach(function(ie){var fe=O(ie.name||"");function Ee(Oe){return Oe!=null?ie.extractKey(Oe):null}function Se(Oe){return ie.multiEntry&&h(Oe)?Oe.forEach(function(nt){return fe.addKey(nt)}):fe.addKey(Oe)}(D||T).forEach(function(Oe,He){var Ce=D&&Ee(D[He]),He=T&&Ee(T[He]);Te(Ce,He)!==0&&(Ce!=null&&Se(Ce),He!=null&&Se(He))})}))):Q?(ne={from:(ne=Q.lower)!==null&&ne!==void 0?ne:n.MIN_KEY,to:(ne=Q.upper)!==null&&ne!==void 0?ne:n.MAX_KEY},te.add(ne),$.add(ne)):($.add(s),te.add(s),d.indexes.forEach(function(ie){return P(ie.name).add(s)})),c.mutate(M).then(function(ie){return!Q||M.type!=="add"&&M.type!=="put"||($.addKeys(ie.results),E&&E.forEach(function(fe){for(var Ee=M.values.map(function(Ce){return fe.extractKey(Ce)}),Se=fe.keyPath.findIndex(function(Ce){return Ce===g.keyPath}),Oe=0,nt=ie.results.length;Oe<nt;++Oe)Ee[Oe][Se]=ie.results[Oe];P(fe.name).addKeys(Ee)})),B.mutatedParts=fr(B.mutatedParts||{},q),ie})}}),y=function(P){var O=P.query,P=O.index,O=O.range;return[P,new Ve((P=O.lower)!==null&&P!==void 0?P:n.MIN_KEY,(O=O.upper)!==null&&O!==void 0?O:n.MAX_KEY)]},I={get:function(M){return[g,new Ve(M.key)]},getMany:function(M){return[g,new Ve().addKeys(M.keys)]},count:y,query:y,openCursor:y};return p(I).forEach(function(M){_[M]=function(P){var O=ve.subscr,D=!!O,T=ao(ve,c)&&lo(M,P)?P.obsSet={}:O;if(D){var B=function(ne){return ne="idb://".concat(o,"/").concat(u,"/").concat(ne),T[ne]||(T[ne]=new Ve)},q=B(""),$=B(":dels"),O=I[M](P),D=O[0],O=O[1];if((M==="query"&&D.isPrimaryKey&&!P.values?$:B(D.name||"")).add(O),!D.isPrimaryKey){if(M!=="count"){var te=M==="query"&&C&&P.values&&c.query(i(i({},P),{values:!1}));return c[M].apply(this,arguments).then(function(ne){if(M==="query"){if(C&&P.values)return te.then(function(Ee){return Ee=Ee.result,q.addKeys(Ee),ne});var ae=P.values?ne.result.map(v):ne.result;(P.values?q:$).addKeys(ae)}else if(M==="openCursor"){var ie=ne,fe=P.values;return ie&&Object.create(ie,{key:{get:function(){return $.addKey(ie.primaryKey),ie.key}},primaryKey:{get:function(){var Ee=ie.primaryKey;return $.addKey(Ee),Ee}},value:{get:function(){return fe&&q.addKey(ie.primaryKey),ie.value}}})}return ne})}$.add(s)}}return c[M].apply(this,arguments)}}),_}})}};function uo(n,o,s){if(s.numFailures===0)return o;if(o.type==="deleteRange")return null;var u=o.keys?o.keys.length:"values"in o&&o.values?o.values.length:1;return s.numFailures===u?null:(o=i({},o),h(o.keys)&&(o.keys=o.keys.filter(function(c,d){return!(d in s.failures)})),"values"in o&&h(o.values)&&(o.values=o.values.filter(function(c,d){return!(d in s.failures)})),o)}function li(n,o){return s=n,((u=o).lower===void 0||(u.lowerOpen?0<Te(s,u.lower):0<=Te(s,u.lower)))&&(n=n,(o=o).upper===void 0||(o.upperOpen?Te(n,o.upper)<0:Te(n,o.upper)<=0));var s,u}function co(n,o,I,u,c,d){if(!I||I.length===0)return n;var g=o.query.index,v=g.multiEntry,C=o.query.range,E=u.schema.primaryKey.extractKey,_=g.extractKey,y=(g.lowLevelIndex||g).extractKey,I=I.reduce(function(M,P){var O=M,D=[];if(P.type==="add"||P.type==="put")for(var T=new Ve,B=P.values.length-1;0<=B;--B){var q,$=P.values[B],te=E($);T.hasKey(te)||(q=_($),(v&&h(q)?q.some(function(ie){return li(ie,C)}):li(q,C))&&(T.addKey(te),D.push($)))}switch(P.type){case"add":var se=new Ve().addKeys(o.values?M.map(function(fe){return E(fe)}):M),O=M.concat(o.values?D.filter(function(fe){return fe=E(fe),!se.hasKey(fe)&&(se.addKey(fe),!0)}):D.map(function(fe){return E(fe)}).filter(function(fe){return!se.hasKey(fe)&&(se.addKey(fe),!0)}));break;case"put":var Q=new Ve().addKeys(P.values.map(function(fe){return E(fe)}));O=M.filter(function(fe){return!Q.hasKey(o.values?E(fe):fe)}).concat(o.values?D:D.map(function(fe){return E(fe)}));break;case"delete":var ne=new Ve().addKeys(P.keys);O=M.filter(function(fe){return!ne.hasKey(o.values?E(fe):fe)});break;case"deleteRange":var ae=P.range;O=M.filter(function(fe){return!li(E(fe),ae)})}return O},n);return I===n?n:(I.sort(function(M,P){return Te(y(M),y(P))||Te(E(M),E(P))}),o.limit&&o.limit<1/0&&(I.length>o.limit?I.length=o.limit:n.length===o.limit&&I.length<o.limit&&(c.dirty=!0)),d?Object.freeze(I):I)}function fo(n,o){return Te(n.lower,o.lower)===0&&Te(n.upper,o.upper)===0&&!!n.lowerOpen==!!o.lowerOpen&&!!n.upperOpen==!!o.upperOpen}function Da(n,o){return(function(s,u,c,d){if(s===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((u=Te(s,u))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return u})(n.lower,o.lower,n.lowerOpen,o.lowerOpen)<=0&&0<=(function(s,u,c,d){if(s===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((u=Te(s,u))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return u})(n.upper,o.upper,n.upperOpen,o.upperOpen)}function Ia(n,o,s,u){n.subscribers.add(s),u.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=o,setTimeout(function(){c.subscribers.size===0&&he(d,c)},3e3))})}var ja={stack:"dbcore",level:0,name:"Cache",create:function(n){var o=n.schema.name;return i(i({},n),{transaction:function(s,u,c){var d,g,v=n.transaction(s,u,c);return u==="readwrite"&&(g=(d=new AbortController).signal,c=function(C){return function(){if(d.abort(),u==="readwrite"){for(var E=new Set,_=0,y=s;_<y.length;_++){var I=y[_],M=Ht["idb://".concat(o,"/").concat(I)];if(M){var P=n.table(I),O=M.optimisticOps.filter(function(fe){return fe.trans===v});if(v._explicit&&C&&v.mutatedParts)for(var D=0,T=Object.values(M.queries.query);D<T.length;D++)for(var B=0,q=(se=T[D]).slice();B<q.length;B++)ti((Q=q[B]).obsSet,v.mutatedParts)&&(he(se,Q),Q.subscribers.forEach(function(fe){return E.add(fe)}));else if(0<O.length){M.optimisticOps=M.optimisticOps.filter(function(fe){return fe.trans!==v});for(var $=0,te=Object.values(M.queries.query);$<te.length;$++)for(var se,Q,ne,ae=0,ie=(se=te[$]).slice();ae<ie.length;ae++)(Q=ie[ae]).res!=null&&v.mutatedParts&&(C&&!Q.dirty?(ne=Object.isFrozen(Q.res),ne=co(Q.res,Q.req,O,P,Q,ne),Q.dirty?(he(se,Q),Q.subscribers.forEach(function(fe){return E.add(fe)})):ne!==Q.res&&(Q.res=ne,Q.promise=le.resolve({result:ne}))):(Q.dirty&&he(se,Q),Q.subscribers.forEach(function(fe){return E.add(fe)})))}}}E.forEach(function(fe){return fe()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var u=n.table(s),c=u.schema.primaryKey;return i(i({},u),{mutate:function(d){var g=ve.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return u.mutate(d);var v=Ht["idb://".concat(o,"/").concat(s)];return v?(g=u.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ai(c,d).some(function(C){return C==null}))?(v.optimisticOps.push(d),d.mutatedParts&&dr(d.mutatedParts),g.then(function(C){0<C.numFailures&&(he(v.optimisticOps,d),(C=uo(0,d,C))&&v.optimisticOps.push(C),d.mutatedParts&&dr(d.mutatedParts))}),g.catch(function(){he(v.optimisticOps,d),d.mutatedParts&&dr(d.mutatedParts)})):g.then(function(C){var E=uo(0,i(i({},d),{values:d.values.map(function(_,y){var I;return C.failures[y]?_:(_=(I=c.keyPath)!==null&&I!==void 0&&I.includes(".")?de(_):i({},_),z(_,c.keyPath,C.results[y]),_)})}),C);v.optimisticOps.push(E),queueMicrotask(function(){return d.mutatedParts&&dr(d.mutatedParts)})}),g):u.mutate(d)},query:function(d){if(!ao(ve,u)||!lo("query",d))return u.query(d);var g=((E=ve.trans)===null||E===void 0?void 0:E.db._options.cache)==="immutable",y=ve,v=y.requery,C=y.signal,E=(function(P,O,D,T){var B=Ht["idb://".concat(P,"/").concat(O)];if(!B)return[];if(!(O=B.queries[D]))return[null,!1,B,null];var q=O[(T.query?T.query.index.name:null)||""];if(!q)return[null,!1,B,null];switch(D){case"query":var $=q.find(function(te){return te.req.limit===T.limit&&te.req.values===T.values&&fo(te.req.query.range,T.query.range)});return $?[$,!0,B,q]:[q.find(function(te){return("limit"in te.req?te.req.limit:1/0)>=T.limit&&(!T.values||te.req.values)&&Da(te.req.query.range,T.query.range)}),!1,B,q];case"count":return $=q.find(function(te){return fo(te.req.query.range,T.query.range)}),[$,!!$,B,q]}})(o,s,"query",d),_=E[0],y=E[1],I=E[2],M=E[3];return _&&y?_.obsSet=d.obsSet:(y=u.query(d).then(function(P){var O=P.result;if(_&&(_.res=O),g){for(var D=0,T=O.length;D<T;++D)Object.freeze(O[D]);Object.freeze(O)}else P.result=de(O);return P}).catch(function(P){return M&&_&&he(M,_),Promise.reject(P)}),_={obsSet:d.obsSet,promise:y,subscribers:new Set,type:"query",req:d,dirty:!1},M?M.push(_):(M=[_],(I=I||(Ht["idb://".concat(o,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=M)),Ia(_,M,v,C),_.promise.then(function(P){return{result:co(P.result,d,I?.optimisticOps,u,_,g)}})}})}})}};function hr(n,o){return new Proxy(n,{get:function(s,u,c){return u==="db"?o:Reflect.get(s,u,c)}})}var St=(qe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new Y.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var o=this._versions,s=o.filter(function(u){return u._cfg.version===n})[0];return s||(s=new this.Version(n),o.push(s),o.sort(xa),s.stores({}),this._state.autoSchema=!1,s)},qe.prototype._whenReady=function(n){var o=this;return this.idbdb&&(this._state.openComplete||ve.letThrough||this._vip)?n():new le(function(s,u){if(o._state.openComplete)return u(new Y.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return void u(new Y.DatabaseClosed);o.open().catch(ke)}o._state.dbReadyPromise.then(s,u)}).then(n)},qe.prototype.use=function(n){var o=n.stack,s=n.create,u=n.level,c=n.name;return c&&this.unuse({stack:o,name:c}),n=this._middlewares[o]||(this._middlewares[o]=[]),n.push({stack:o,create:s,level:u??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},qe.prototype.unuse=function(n){var o=n.stack,s=n.name,u=n.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(c){return u?c.create!==u:!!s&&c.name!==s})),this},qe.prototype.open=function(){var n=this;return Zt(et,function(){return ka(n)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,o=pn.indexOf(this);if(0<=o&&pn.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new le(function(s){n.dbReadyResolve=s}),n.openCanceller=new le(function(s,u){n.cancelOpen=u}))},qe.prototype.close=function(s){var o=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new Y.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Y.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},qe.prototype.delete=function(n){var o=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",u=this._state;return new le(function(c,d){function g(){o.close(n);var v=o._deps.indexedDB.deleteDatabase(o.name);v.onsuccess=Ke(function(){var C,E,_;C=o._deps,E=o.name,_=C.indexedDB,C=C.IDBKeyRange,Jr(_)||E===Qn||Xr(_,C).delete(E).catch(ke),c()}),v.onerror=yt(d),v.onblocked=o._fireOnBlocked}if(s)throw new Y.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(o){return n._allTables[o]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var n=(function(o,s,u){var c=arguments.length;if(c<2)throw new Y.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return u=d.pop(),[o,X(d),u]}).apply(this,arguments);return this._transaction.apply(this,n)},qe.prototype._transaction=function(n,o,s){var u=this,c=ve.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=o.map(function(E){if(E=E instanceof u.Table?E.name:E,typeof E!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return E}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Kr)throw new Y.InvalidArgument("Invalid transaction mode: "+n);d=Kr}if(c){if(c.mode===Fr&&d===Kr){if(!v)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(E){if(c&&c.storeNames.indexOf(E)===-1){if(!v)throw new Y.SubTransaction("Table "+E+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(E){return c?c._promise(null,function(_,y){y(E)}):Ne(E)}var C=(function E(_,y,I,M,P){return le.resolve().then(function(){var O=ve.transless||ve,D=_._createTransaction(y,I,_._dbSchema,M);if(D.explicit=!0,O={trans:D,transless:O},M)D.idbtrans=M.idbtrans;else try{D.create(),D.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(q){return q.name===ze.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return E(_,y,I,null,P)})):Ne(q)}var T,B=xe(P);return B&&dn(),O=le.follow(function(){var q;(T=P.call(D,D))&&(B?(q=jt.bind(null,null),T.then(q,q)):typeof T.next=="function"&&typeof T.throw=="function"&&(T=oi(T)))},O),(T&&typeof T.then=="function"?le.resolve(T).then(function(q){return D.active?q:Ne(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return T})).then(function(q){return M&&D._resolve(),D._completion.then(function(){return q})}).catch(function(q){return D._reject(q),Ne(q)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,C,"lock"):ve.trans?Zt(ve.transless,function(){return u._whenReady(C)}):this._whenReady(C)},qe.prototype.table=function(n){if(!b(this._allTables,n))throw new Y.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},qe);function qe(n,o){var s=this;this._middlewares={},this.verno=0;var u=qe.dependencies;this._options=o=i({addons:qe.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},u=o.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,C,E={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen};E.dbReadyPromise=new le(function(y){E.dbReadyResolve=y}),E.openCanceller=new le(function(y,I){E.cancelOpen=I}),this._state=E,this.name=n,this.on=Sn(this,"populate","blocked","versionchange","close",{ready:[sn,ke]}),this.once=function(y,I){var M=function(){for(var P=[],O=0;O<arguments.length;O++)P[O]=arguments[O];s.on(y).unsubscribe(M),I.apply(s,P)};return s.on(y,M)},this.on.ready.subscribe=ee(this.on.ready.subscribe,function(y){return function(I,M){qe.vip(function(){var P,O=s._state;O.openComplete?(O.dbOpenError||le.resolve().then(I),M&&y(I)):O.onReadyBeingFired?(O.onReadyBeingFired.push(I),M&&y(I)):(y(I),P=s,M||y(function D(){P.on.ready.unsubscribe(I),P.on.ready.unsubscribe(D)}))})}}),this.Collection=(c=this,Pn(ga.prototype,function(T,D){this.db=c;var M=Fi,P=null;if(D)try{M=D()}catch(B){P=B}var O=T._ctx,D=O.table,T=D.hook.reading.fire;this._ctx={table:D,index:O.index,isPrimKey:!O.index||D.schema.primKey.keyPath&&O.index===D.schema.primKey.name,range:M,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:O.or,valueMapper:T!==Xe?T:null}})),this.Table=(d=this,Pn($i.prototype,function(y,I,M){this.db=d,this._tx=M,this.name=y,this.schema=I,this.hook=d._allTables[y]?d._allTables[y].hook:Sn(null,{creating:[$n,ke],reading:[Wt,Xe],updating:[Vn,ke],deleting:[rn,ke]})})),this.Transaction=(g=this,Pn(ya.prototype,function(y,I,M,P,O){var D=this;y!=="readonly"&&I.forEach(function(T){T=(T=M[T])===null||T===void 0?void 0:T.yProps,T&&(I=I.concat(T.map(function(B){return B.updatesTable})))}),this.db=g,this.mode=y,this.storeNames=I,this.schema=M,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=Sn(this,"complete","error","abort"),this.parent=O||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new le(function(T,B){D._resolve=T,D._reject=B}),this._completion.then(function(){D.active=!1,D.on.complete.fire()},function(T){var B=D.active;return D.active=!1,D.on.error.fire(T),D.parent?D.parent._reject(T):B&&D.idbtrans&&D.idbtrans.abort(),Ne(T)})})),this.Version=(v=this,Pn(Ma.prototype,function(y){this.db=v,this._cfg={version:y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(C=this,Pn(Xi.prototype,function(y,I,M){if(this.db=C,this._ctx={table:y,index:I===":id"?null:I,or:M},this._cmp=this._ascending=Te,this._descending=function(P,O){return Te(O,P)},this._max=function(P,O){return 0<Te(P,O)?P:O},this._min=function(P,O){return Te(P,O)<0?P:O},this._IDBKeyRange=C._deps.IDBKeyRange,!this._IDBKeyRange)throw new Y.MissingAPI})),this.on("versionchange",function(y){0<y.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(y){!y.newVersion||y.newVersion<y.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(y.oldVersion/10))}),this._maxKey=Dn(o.IDBKeyRange),this._createTransaction=function(y,I,M,P){return new s.Transaction(y,I,M,s._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(y){s.on("blocked").fire(y),pn.filter(function(I){return I.name===s.name&&I!==s&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(y)})},this.use(Oa),this.use(ja),this.use(_a),this.use(Sa),this.use(Pa);var _=new Proxy(this,{get:function(y,I,M){if(I==="_vip")return!0;if(I==="table")return function(O){return hr(s.table(O),_)};var P=Reflect.get(y,I,M);return P instanceof $i?hr(P,_):I==="tables"?P.map(function(O){return hr(O,_)}):I==="_createTransaction"?function(){return hr(P.apply(this,arguments),_)}:P}});this.vip=_,u.forEach(function(y){return y(s)})}var gr,lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ra=(ui.prototype.subscribe=function(n,o,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:o,complete:s})},ui.prototype[lt]=function(){return this},ui);function ui(n){this._subscribe=n}try{gr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{gr={indexedDB:null,IDBKeyRange:null}}function po(n){var o,s=!1,u=new Ra(function(c){var d=xe(n),g,v=!1,C={},E={},_={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),y&&At.storagemutated.unsubscribe(M))}};c.start&&c.start(_);var y=!1,I=function(){return zr(P)},M=function(O){fr(C,O),ti(E,C)&&I()},P=function(){var O,D,T;!v&&gr.indexedDB&&(C={},O={},g&&g.abort(),g=new AbortController,T=(function(B){var q=Et();try{d&&dn();var $=It(n,B);return $=d?$.finally(jt):$}finally{q&&Dt()}})(D={subscr:O,signal:g.signal,requery:I,querier:n,trans:null}),Promise.resolve(T).then(function(B){s=!0,o=B,v||D.signal.aborted||(C={},(function(q){for(var $ in q)if(b(q,$))return;return 1})(E=O)||y||(At(_n,M),y=!0),zr(function(){return!v&&c.next&&c.next(B)}))},function(B){s=!1,["DatabaseClosedError","AbortError"].includes(B?.name)||v||zr(function(){v||c.error&&c.error(B)})}))};return setTimeout(I,0),_});return u.hasValue=function(){return s},u.getValue=function(){return o},u}var Gt=St;function ci(n){var o=Bt;try{Bt=!0,At.storagemutated.fire(n),ii(n,!0)}finally{Bt=o}}x(Gt,i(i({},De),{delete:function(n){return new Gt(n,{addons:[]}).delete()},exists:function(n){return new Gt(n,{addons:[]}).open().then(function(o){return o.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return o=Gt.dependencies,s=o.indexedDB,o=o.IDBKeyRange,(Jr(s)?Promise.resolve(s.databases()).then(function(u){return u.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Xr(s,o).toCollection().primaryKeys()).then(n)}catch{return Ne(new Y.MissingAPI)}var o,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return ve.trans?Zt(ve.transless,n):n()},vip:Qr,async:function(n){return function(){try{var o=oi(n.apply(this,arguments));return o&&typeof o.then=="function"?o:le.resolve(o)}catch(s){return Ne(s)}}},spawn:function(n,o,s){try{var u=oi(n.apply(s,o||[]));return u&&typeof u.then=="function"?u:le.resolve(u)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return ve.trans||null}},waitFor:function(n,o){return o=le.resolve(typeof n=="function"?Gt.ignoreTransaction(n):n).timeout(o||6e4),ve.trans?ve.trans.waitFor(o):o},Promise:le,debug:{get:function(){return Je},set:function(n){xn(n)}},derive:R,extend:m,props:x,override:ee,Events:Sn,on:At,liveQuery:po,extendObservabilitySet:fr,getByKeyPath:S,setByKeyPath:z,delByKeyPath:function(n,o){typeof o=="string"?z(n,o,void 0):"length"in o&&[].map.call(o,function(s){z(n,s,void 0)})},shallowClone:H,deepClone:de,getObjectDiff:si,cmp:Te,asap:A,minKey:-1/0,addons:[],connections:pn,errnames:ze,dependencies:gr,cache:Ht,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,o,s){return n+o/Math.pow(10,2*s)})})),Gt.maxKey=Dn(Gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(At(_n,function(n){Bt||(n=new CustomEvent(Wr,{detail:n}),Bt=!0,dispatchEvent(n),Bt=!1)}),addEventListener(Wr,function(n){n=n.detail,Bt||ci(n)}));var vn,Bt=!1,ho=function(){};return typeof BroadcastChannel<"u"&&((ho=function(){(vn=new BroadcastChannel(Wr)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof vn.unref=="function"&&vn.unref(),At(_n,function(n){Bt||vn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!St.disableBfCache&&n.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),vn?.close();for(var o=0,s=pn;o<s.length;o++)s[o].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!St.disableBfCache&&n.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),ho(),ci({all:new Ve(-1/0,[[]])}))})),le.rejectionMapper=function(n,o){return!n||n instanceof ye||n instanceof TypeError||n instanceof SyntaxError||!n.name||!be[n.name]?n:(o=new be[n.name](o||n.message,n),"stack"in n&&k(o,"stack",{get:function(){return this.inner.stack}}),o)},xn(Je),i(St,Object.freeze({__proto__:null,Dexie:St,liveQuery:po,Entity:Ki,cmp:Te,PropModification:kn,replacePrefix:function(n,o){return new kn({replacePrefix:[n,o]})},add:function(n){return new kn({add:n})},remove:function(n){return new kn({remove:n})},default:St,RangeSet:Ve,mergeRanges:Rn,rangesOverlap:no}),{default:St}),St})})(xr)),xr.exports}var vc=mc();const Oi=Aa(vc),Ns=Symbol.for("Dexie"),Tr=globalThis[Ns]||(globalThis[Ns]=Oi);if(Oi.semVer!==Tr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Oi.semVer} and ${Tr.semVer}`);const{liveQuery:jc,mergeRanges:Rc,rangesOverlap:Tc,RangeSet:Ac,cmp:Bc,Entity:Uc,PropModification:zc,replacePrefix:Fc,add:Kc,remove:Nc,DexieYProvider:qc}=Tr,it=new Tr("ChillGameDB");it.version(1).stores({exploredCells:"id",claimedCells:"id",gameState:"key"});it.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const qs=5e-4,Ye=ec(hc((t,e)=>({clouds:10,claimedCells:[],exploredCells:[],selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,i,a,f]=await Promise.all([it.exploredCells.toArray(),it.claimedCells.toArray(),it.gameState.get("clouds"),it.gameState.get("lastCloudIncrease")]);t(p=>{p.exploredCells=r,p.claimedCells=i,p.clouds=a?a.value:10,p.lastCloudIncrease=f?f.value:Date.now(),p.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(i=>{i.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(i=>{i.clouds<10&&(i.clouds+=1,i.lastCloudIncrease=r)}),it.gameState.put({key:"clouds",value:e().clouds}),it.gameState.put({key:"lastCloudIncrease",value:r})},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:i,longitude:a}=r.coords,f=new Set(e().exploredCells.map(p=>p.id));t(p=>{p.userLocation={lat:i,lng:a};const h=Math.floor(i/qs),m=Math.floor(a/qs),L=[],w=2;for(let b=-w;b<=w;b++)for(let x=-w;x<=w;x++)if(b*b+x*x<=w*w){const j=`${h+b}_${m+x}`;if(!f.has(j)){const k={id:j};p.exploredCells.push(k),L.push(k),f.add(j)}}L.length>0&&it.exploredCells.bulkAdd(L).catch(b=>console.error("Failed to bulkAdd explored cells:",b))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const i=e().selectedCell,a=e().claimedCells.some(f=>f.id===r?.key);!r||i&&i.key===r.key||a?t({selectedCell:null}):t({selectedCell:r})},updateSelectedCellInfo:r=>{t(i=>{i.selectedCell&&(i.selectedCell={...i.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:i}=e();if(!r)return"no-cell";if(i<=0)return"no-clouds";const{key:a}=r,p={id:a,data:{owner:"user",color:"#3B82F6"}},h=new Set(e().exploredCells.map(x=>x.id)),[m,L]=a.split("_").map(Number),w=[],b=1;for(let x=-b;x<=b;x++)for(let j=-b;j<=b;j++){const k=`${m+x}_${L+j}`;h.has(k)||w.push({id:k})}return t(x=>{x.clouds-=1,x.claimedCells.push(p),x.exploredCells.push(...w),x.selectedCell=null}),it.claimedCells.put(p),it.gameState.put({key:"clouds",value:e().clouds}),w.length>0&&it.exploredCells.bulkAdd(w),"claimed"},register:()=>{t({clouds:10}),it.gameState.put({key:"clouds",value:10})}}))),yc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},bc={fontSize:"24px"};function wc(){const t=Ye(e=>e.clouds);return oe.jsxs("div",{style:yc,children:[oe.jsx("span",{style:bc,children:"☁️"}),oe.jsx("span",{children:t})]})}const Lc=en.memo(wc),xc={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},Cc={fontSize:"28px"};function Ec({onClick:t}){const[e,r]=l.useState(!1),i={...xc,transform:e?"scale(1.1)":"scale(1)"};return oe.jsx("button",{onClick:t,title:"Reset View",style:i,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:oe.jsx("span",{style:Cc,children:"🧭"})})}const Mc=l.memo(Ec),wr={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},kc=()=>{const t=Ye(f=>f.clouds),e=Ye(f=>f.lastCloudIncrease),r=Ye(f=>f.increaseCloud),[i,a]=l.useState(0);return l.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const m=6e4-(Date.now()-e);m<=0?(r(),a(60)):a(Math.ceil(m/1e3))},1e3):(clearInterval(f),a(0)),()=>clearInterval(f)},[t,e,r]),oe.jsxs("div",{style:wr.container,children:[oe.jsx("span",{style:wr.icon,children:"☁️"}),t<10?oe.jsxs("span",{style:wr.timer,children:[i,"s"]}):oe.jsx("span",{style:wr.timer,children:"⏰"})]})},Sc=l.memo(kc),Lr=new Map,Ws=.5;function Pc(t){const e=Ye(r=>r.updateSelectedCellInfo);l.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,i=`${Math.floor(r.lat/Ws)}_${Math.floor(r.lng/Ws)}`;(async()=>{if(Lr.has(i)){e(Lr.get(i));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,L=m.find(R=>R.types.includes("country")),w=m.find(R=>R.types.includes("administrative_area_level_1")),b=L?L.long_name:"未知領域",x=L?L.short_name.toLowerCase():null,j=w?w.long_name:"",k=x?`https://flagcdn.com/w40/${x}.png`:null;h={countryName:b,regionName:j,flagUrl:k}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};Lr.set(i,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};Lr.set(i,p),e(p)}})()},[t,e])}const Oc=l.lazy(()=>_i(()=>import("./Leaderboard-BgtrTq5E.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),_c=l.lazy(()=>_i(()=>import("./RegistrationModal-yGVuAns2.js"),__vite__mapDeps([4,1,2]))),Dc=l.lazy(()=>_i(()=>import("./InfoModal-CXuQ0Dcp.js"),__vite__mapDeps([5,1,2]))),ct={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"4px",left:"8px",zIndex:50}};function Wc(){const{lat:t,lng:e}=Ba(),r=Ua(),[i,a]=l.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=l.useState(!1),h=l.useRef(null),m=Ye(J=>J.claimedCells),L=Ye(J=>J.exploredCells),w=Ye(J=>J.selectedCell),b=Ye(J=>J.userLocation),x=Ye(J=>J.clouds),j=Ye(J=>J.initializeGeolocation),k=Ye(J=>J.selectCell),R=Ye(J=>J.claimSelectedCell),U=Ye(J=>J.register),V=Ye(J=>J.isHydrated),W=Ye(J=>J.hydrate);Pc(w);const{isLoaded:ee}=ll({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});l.useEffect(()=>{j()},[j]),l.useEffect(()=>{W()},[W]),l.useEffect(()=>{i||navigator.geolocation.getCurrentPosition(J=>{a({lat:J.coords.latitude,lng:J.coords.longitude})},()=>{a({lat:25.033,lng:121.5654})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},[i]);const[K,A]=l.useState(!1),[S,z]=l.useState(!1),[H,F]=l.useState(!1),[X,G]=l.useState(!1),[re,de]=l.useState([]),pe=l.useCallback(J=>{h.current=J},[]),ue=l.useCallback((J,Y)=>{xi(),k(J?{key:J,position:Y,isLoading:!0}:null)},[k]),ge=l.useCallback(()=>{if(!w)return;const J={id:Date.now()+Math.random(),position:w.position,startTime:Date.now(),particleDuration:2500,revealDuration:1e3,onComplete:()=>{R()==="no-clouds"&&A(!0)}};de(Y=>[...Y,J]),setTimeout(()=>{de(Y=>Y.filter(be=>be.id!==J.id))},2500)},[R,w]),ce=l.useCallback(()=>{k(null)},[k]),he=l.useCallback(()=>{U(),A(!1)},[U]),we=l.useCallback(async()=>{if(!h.current)return;const J=h.current.getCenter(),Y=J.lat(),be=J.lng();p(!0),await Nt(h.current,{lat:Y,lng:be},1500,2,G),r("/",{state:{lat:Y,lng:be}})},[r,G]),me=l.useCallback(async()=>{if(b&&h.current){const J=h.current,Y=J.getCenter(),be={lat:Y.lat(),lng:Y.lng()};await Nt(J,be,1e3,5,G),await Nt(J,b,1500,5,G),await Nt(J,b,1e3,15,G)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[b,G]),xe=l.useCallback(J=>{r(`/map/${J.lat.toFixed(7)}/${J.lng.toFixed(7)}`,{replace:!0})},[r]),Pe=l.useCallback(async()=>{if(h.current){const J=h.current.getZoom(),Y=Math.min(20,J+1);Y!==J&&await Nt(h.current,h.current.getCenter().toJSON(),300,Y,G)}},[G]),ye=l.useCallback(async()=>{if(h.current){const J=h.current.getZoom(),Y=Math.max(2,J-1);Y!==J&&await Nt(h.current,h.current.getCenter().toJSON(),300,Y,G)}},[G]),Re=l.useCallback(()=>F(!0),[]),Z=l.useCallback(()=>A(!1),[]),Ae=l.useCallback(()=>z(!1),[]),ze=l.useCallback(()=>F(!1),[]);return!ee||!i||!V?oe.jsx(go,{}):oe.jsxs("div",{style:ct.app,className:f?"map-container-fade-out":"",children:[oe.jsx(Yu,{center:i,onSelectCell:ue,claimedCells:m,exploredCells:L,setMapRef:pe,onZoomChanged:()=>{},onCenterChanged:xe,selectedCell:w,userLocation:b,isAnimating:X,effects:re}),w&&oe.jsx(oa,{cellInfo:w,onClaim:ge,onClose:ce,isClaimDisabled:x<=0&&K}),oe.jsxs("div",{style:ct.topLeftControls,children:[oe.jsx("button",{style:ct.controlButton,onClick:Pe,children:"+"}),oe.jsx("button",{style:ct.controlButton,onClick:ye,children:"-"}),oe.jsx("button",{style:ct.controlButton,onClick:Re,children:"i"})]}),oe.jsx("div",{style:ct.topCenterContainer,children:oe.jsx(Lc,{})}),oe.jsxs("div",{style:ct.topRightContainer,children:[oe.jsx("button",{style:ct.controlButton,onClick:()=>z(!0),children:"🏆"}),oe.jsx("button",{style:ct.controlButton,onClick:we,title:"Return to Globe",children:"🌍"})]}),oe.jsx("div",{style:ct.bottomLeftContainer,children:oe.jsx(Sc,{})}),oe.jsx("div",{style:ct.bottomRightContainer,children:oe.jsx(Mc,{onClick:me})}),oe.jsxs(l.Suspense,{fallback:oe.jsx(go,{}),children:[K&&oe.jsx(_c,{onClose:Z,onRegister:he}),S&&oe.jsx(Oc,{onClose:Ae}),H&&oe.jsx(Dc,{onClose:ze})]})]})}export{Wc as default};
