const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Leaderboard-B99Tzgs7.js","assets/index-DvIInK5b.js","assets/index-RHRxzSmQ.css","assets/Leaderboard-BIdqioXT.css","assets/RegistrationModal-BVvYDjvE.js","assets/InfoModal-CsiP-cMl.js"])))=>i.map(i=>d[i]);
import{r as l,j as Q,b as Ln,R as en,c as Ta,g as Aa,d as Ba,a as Ua,L as go,_ as _i}from"./index-DvIInK5b.js";function Fn(t){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(t)}function za(t,e){if(Fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Fn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t){var e=za(t,"string");return Fn(e)=="symbol"?e:e+""}function N(t,e,r){return(e=Fa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var di,mo;function Ka(){if(mo)return di;mo=1;var t=function(r,i,a,f,p,h,m,x){if(!r){var w;if(i===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var b=[a,f,p,h,m,x],C=0;w=new Error(i.replace(/%s/g,function(){return b[C++]})),w.name="Invariant Violation"}throw w.framesToPop=1,w}};return di=t,di}var Na=Ka(),We=Zs(Na),ke=l.createContext(null);function qa(){We(!!l.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=l.useContext(ke);return We(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function Wa(t,e,r){return Object.keys(t).reduce(function(a,f){return e(a,t[f],f)},r)}function Za(t,e){Object.keys(t).forEach(r=>e(t[r],r))}function $a(t,e,r,i){var a={},f=(p,h)=>{var m=r[h];m!==e[h]&&(a[h]=m,p(i,m))};return Za(t,f),a}function Va(t,e,r){var i=Wa(r,function(f,p,h){return typeof t[h]=="function"&&f.push(google.maps.event.addListener(e,p,t[h])),f},[]);return i}function Ha(t){google.maps.event.removeListener(t)}function Ie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Ha)}function _e(t){var{updaterMap:e,eventMap:r,prevProps:i,nextProps:a,instance:f}=t,p=Va(a,f,r);return $a(e,i,a,f),p}var vo={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},yo={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Ga(t){var{children:e,options:r,id:i,mapContainerStyle:a,mapContainerClassName:f,center:p,onClick:h,onDblClick:m,onDrag:x,onDragEnd:w,onDragStart:b,onMouseMove:C,onMouseOut:I,onMouseOver:L,onMouseDown:j,onMouseUp:K,onRightClick:$,onCenterChanged:W,onLoad:te,onUnmount:F}=t,[A,B]=l.useState(null),T=l.useRef(null),[H,U]=l.useState(null),[ee,X]=l.useState(null),[oe,ue]=l.useState(null),[pe,he]=l.useState(null),[ve,we]=l.useState(null),[ye,fe]=l.useState(null),[ce,Le]=l.useState(null),[Ce,ge]=l.useState(null),[Re,Z]=l.useState(null),[Ae,Be]=l.useState(null),[Y,G]=l.useState(null),[be,De]=l.useState(null);return l.useEffect(()=>{r&&A!==null&&A.setOptions(r)},[A,r]),l.useEffect(()=>{A!==null&&typeof p<"u"&&A.setCenter(p)},[A,p]),l.useEffect(()=>{A&&m&&(ee!==null&&google.maps.event.removeListener(ee),X(google.maps.event.addListener(A,"dblclick",m)))},[m]),l.useEffect(()=>{A&&w&&(oe!==null&&google.maps.event.removeListener(oe),ue(google.maps.event.addListener(A,"dragend",w)))},[w]),l.useEffect(()=>{A&&b&&(pe!==null&&google.maps.event.removeListener(pe),he(google.maps.event.addListener(A,"dragstart",b)))},[b]),l.useEffect(()=>{A&&j&&(ve!==null&&google.maps.event.removeListener(ve),we(google.maps.event.addListener(A,"mousedown",j)))},[j]),l.useEffect(()=>{A&&C&&(ye!==null&&google.maps.event.removeListener(ye),fe(google.maps.event.addListener(A,"mousemove",C)))},[C]),l.useEffect(()=>{A&&I&&(ce!==null&&google.maps.event.removeListener(ce),Le(google.maps.event.addListener(A,"mouseout",I)))},[I]),l.useEffect(()=>{A&&L&&(Ce!==null&&google.maps.event.removeListener(Ce),ge(google.maps.event.addListener(A,"mouseover",L)))},[L]),l.useEffect(()=>{A&&K&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(A,"mouseup",K)))},[K]),l.useEffect(()=>{A&&$&&(Ae!==null&&google.maps.event.removeListener(Ae),Be(google.maps.event.addListener(A,"rightclick",$)))},[$]),l.useEffect(()=>{A&&h&&(Y!==null&&google.maps.event.removeListener(Y),G(google.maps.event.addListener(A,"click",h)))},[h]),l.useEffect(()=>{A&&x&&(be!==null&&google.maps.event.removeListener(be),De(google.maps.event.addListener(A,"drag",x)))},[x]),l.useEffect(()=>{A&&W&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(A,"center_changed",W)))},[h]),l.useEffect(()=>{var Se=T.current===null?null:new google.maps.Map(T.current,r);return B(Se),Se!==null&&te&&te(Se),()=>{Se!==null&&F&&F(Se)}},[]),Q.jsx("div",{id:i,ref:T,style:a,className:f,children:Q.jsx(ke.Provider,{value:A,children:A!==null?e:null})})}l.memo(Ga);class Ya extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{map:null}),N(this,"registeredEvents",[]),N(this,"mapRef",null),N(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),N(this,"panTo",e=>{var r=this.getInstance();r&&r.panTo(e)}),N(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),N(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:yo,eventMap:vo,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),Ie(this.registeredEvents))}render(){return Q.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:Q.jsx(ke.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bo(t,e,r,i,a,f,p){try{var h=t[f](p),m=h.value}catch(x){return void r(x)}h.done?e(m):Promise.resolve(m).then(i,a)}function $s(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var f=t.apply(e,r);function p(m){bo(f,i,a,p,h,"next",m)}function h(m){bo(f,i,a,p,h,"throw",m)}p(void 0)})}}function Vs(t){var{googleMapsApiKey:e,googleMapsClientId:r,version:i="weekly",language:a,region:f,libraries:p,channel:h,mapIds:m,authReferrerPolicy:x,apiUrl:w="https://maps.googleapis.com"}=t,b=[];return We(e&&r||!(e&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?b.push("key=".concat(e)):r&&b.push("client=".concat(r)),i&&b.push("v=".concat(i)),a&&b.push("language=".concat(a)),f&&b.push("region=".concat(f)),p&&p.length&&b.push("libraries=".concat(p.sort().join(","))),h&&b.push("channel=".concat(h)),m&&m.length&&b.push("map_ids=".concat(m.join(","))),x&&b.push("auth_referrer_policy=".concat(x)),b.push("loading=async"),b.push("callback=initMap"),"".concat(w,"/maps/api/js?").concat(b.join("&"))}var qt=typeof document<"u";function Hs(t){var{url:e,id:r,nonce:i}=t;return qt?new Promise(function(f,p){var h=document.getElementById(r),m=window;if(h){var x=h.getAttribute("data-state");if(h.src===e&&x!=="error"){if(x==="ready")return f(r);var w=m.initMap,b=h.onerror;m.initMap=function(){w&&w(),f(r)},h.onerror=function(I){b&&b(I),p(I)};return}else h.remove()}var C=document.createElement("script");C.type="text/javascript",C.src=e,C.id=r,C.async=!0,C.nonce=i||"",C.onerror=function(L){C.setAttribute("data-state","error"),p(L)},m.initMap=function(){C.setAttribute("data-state","ready"),f(r)},document.head.appendChild(C)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function wo(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function Di(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,f){return wo(a)||Reflect.apply(e,t,[a,f]),a};var r=t.appendChild.bind(t);t.appendChild=function(a){return wo(a)||Reflect.apply(r,t,[a]),a}}}var Tn=!1;function Gs(){return Q.jsx("div",{children:"Loading..."})}var Kn={id:"script-loader",version:"weekly"};class Xa extends l.PureComponent{constructor(){super(...arguments),N(this,"check",null),N(this,"state",{loaded:!1}),N(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),N(this,"isCleaningUp",$s(function*(){function e(r){if(!Tn)r();else if(qt)var i=window.setInterval(function(){Tn||(window.clearInterval(i),r())},1)}return new Promise(e)})),N(this,"cleanup",()=>{Tn=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),N(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Di(),We(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Vs(this.props)};Hs(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),N(this,"getRef",e=>{this.check=e})}componentDidMount(){if(qt){if(window.google&&window.google.maps&&!Tn){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),qt&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(qt){this.cleanup();var e=()=>{this.check||(delete window.google,Tn=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||Q.jsx(Gs,{})]})}}N(Xa,"defaultProps",Kn);function Ja(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function Ii(t,e){if(t==null)return{};var r,i,a=Ja(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(i=0;i<f.length;i++)r=f[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var Lo;function Qa(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,preventGoogleFontsLoading:x,channel:w,mapIds:b,authReferrerPolicy:C,apiUrl:I="https://maps.googleapis.com"}=t,L=l.useRef(!1),[j,K]=l.useState(!1),[$,W]=l.useState(void 0);l.useEffect(function(){return L.current=!0,()=>{L.current=!1}},[]),l.useEffect(function(){qt&&x&&Di()},[x]),l.useEffect(function(){j&&We(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[j]);var te=Vs({version:r,googleMapsApiKey:a,googleMapsClientId:f,language:p,region:h,libraries:m,channel:w,mapIds:b,authReferrerPolicy:C,apiUrl:I});l.useEffect(function(){if(!qt)return;function B(){L.current&&(K(!0),Lo=te)}if(window.google&&window.google.maps&&Lo===te){B();return}Hs({id:e,url:te,nonce:i}).then(B).catch(function(H){L.current&&W(H),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(f||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(H)})},[e,te,i]);var F=l.useRef(void 0);return l.useEffect(function(){F.current&&m!==F.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),F.current=m},[m]),{isLoaded:j,loadError:$,url:te}}var el=["loadingElement","onLoad","onError","onUnmount","children"],tl=Q.jsx(Gs,{});function nl(t){var{loadingElement:e,onLoad:r,onError:i,onUnmount:a,children:f}=t,p=Ii(t,el),{isLoaded:h,loadError:m}=Qa(p);return l.useEffect(function(){h&&typeof r=="function"&&r()},[h,r]),l.useEffect(function(){m&&typeof i=="function"&&i(m)},[m,i]),l.useEffect(function(){return()=>{a&&a()}},[a]),h?f:e||tl}l.memo(nl);function rl(t,e,r,i){function a(f){return f instanceof r?f:new r(function(p){p(f)})}return new(r||(r=Promise))(function(f,p){function h(w){try{x(i.next(w))}catch(b){p(b)}}function m(w){try{x(i.throw(w))}catch(b){p(b)}}function x(w){w.done?f(w.value):a(w.value).then(h,m)}x((i=i.apply(t,[])).next())})}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ol=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r},sl=il(ol),xo="__googleMapsScriptId",yn;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(yn||(yn={}));class Qt{constructor(e){var{apiKey:r,authReferrerPolicy:i,channel:a,client:f,id:p=xo,language:h,libraries:m=[],mapIds:x,nonce:w,region:b,retries:C=3,url:I="https://maps.googleapis.com/maps/api/js",version:L}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=i,this.channel=a,this.client=f,this.id=p||xo,this.language=h,this.libraries=m,this.mapIds=x,this.nonce=w,this.region=b,this.retries=C,this.url=I,this.version=L,Qt.instance){if(!sl(this.options,Qt.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Qt.instance.options)));return Qt.instance}Qt.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?yn.FAILURE:this.done?yn.SUCCESS:this.loading?yn.LOADING:yn.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,r)=>{this.loadCallback(i=>{i?r(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,r;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(f=>!i[f]&&delete i[f]),!((r=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||r===void 0)&&r.importLibrary||(f=>{var p,h,m,x="The Google Maps JavaScript API",w="google",b="importLibrary",C="__ib__",I=document,L=window;L=L[w]||(L[w]={});var j=L.maps||(L.maps={}),K=new Set,$=new URLSearchParams,W=()=>p||(p=new Promise((te,F)=>rl(this,void 0,void 0,function*(){var A;yield h=I.createElement("script"),h.id=this.id,$.set("libraries",[...K]+"");for(m in f)$.set(m.replace(/[A-Z]/g,B=>"_"+B[0].toLowerCase()),f[m]);$.set("callback",w+".maps."+C),h.src=this.url+"?"+$,j[C]=te,h.onerror=()=>p=F(Error(x+" could not load.")),h.nonce=this.nonce||((A=I.querySelector("script[nonce]"))===null||A===void 0?void 0:A.nonce)||"",I.head.append(h)})));j[b]?console.warn(x+" only loads once. Ignoring:",f):j[b]=function(te){for(var F=arguments.length,A=new Array(F>1?F-1:0),B=1;B<F;B++)A[B-1]=arguments[B];return K.add(te)&&W().then(()=>j[b](te,...A))}})(i);var a=this.libraries.map(f=>this.importLibrary(f));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),f=>{var p=new ErrorEvent("error",{error:f});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var r=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(r," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var al=["maps"];function ll(t){var{id:e=Kn.id,version:r=Kn.version,nonce:i,googleMapsApiKey:a,language:f,region:p,libraries:h=al,preventGoogleFontsLoading:m,mapIds:x,authReferrerPolicy:w}=t,b=l.useRef(!1),[C,I]=l.useState(!1),[L,j]=l.useState(void 0);l.useEffect(function(){return b.current=!0,()=>{b.current=!1}},[]);var K=l.useMemo(()=>new Qt({id:e,apiKey:a,version:r,libraries:h,language:f||"en",region:p||"US",mapIds:x||[],nonce:i||"",authReferrerPolicy:w||"origin"}),[e,a,r,h,f,p,x,i,w]);l.useEffect(function(){C||K.load().then(()=>{b.current&&I(!0)}).catch(te=>{j(te)})},[]),l.useEffect(()=>{qt&&m&&Di()},[m]);var $=l.useRef();return l.useEffect(()=>{$.current&&h!==$.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),$.current=h},[h]),{isLoaded:C,loadError:L}}function Co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Co(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Eo={},Mo={options(t,e){t.setOptions(e)}};function ul(t){var{options:e,onLoad:r,onUnmount:i}=t,a=l.useContext(ke),[f,p]=l.useState(null);return l.useEffect(()=>{f!==null&&f.setMap(a)},[a]),l.useEffect(()=>{e&&f!==null&&f.setOptions(e)},[f,e]),l.useEffect(()=>{var h=new google.maps.TrafficLayer(Cr(Cr({},e),{},{map:a}));return p(h),r&&r(h),()=>{f!==null&&(i&&i(f),f.setMap(null))}},[]),null}l.memo(ul);class cl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{trafficLayer:null}),N(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),N(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Cr(Cr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Mo,eventMap:Eo,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Mo,eventMap:Eo,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),Ie(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}N(cl,"contextType",ke);function fl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(ke),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.BicyclingLayer;return f(p),p.setMap(i),e&&e(p),()=>{p!==null&&(r&&r(p),p.setMap(null))}},[]),null}l.memo(fl);class dl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{bicyclingLayer:null}),N(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}N(dl,"contextType",ke);function pl(t){var{onLoad:e,onUnmount:r}=t,i=l.useContext(ke),[a,f]=l.useState(null);return l.useEffect(()=>{a!==null&&a.setMap(i)},[i]),l.useEffect(()=>{var p=new google.maps.TransitLayer;return f(p),p.setMap(i),e&&e(p),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}l.memo(pl);class hl extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{transitLayer:null}),N(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}N(hl,"contextType",ke);function ko(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ko(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ko(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var So={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Po={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function gl(t){var{options:e,drawingMode:r,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:f,onPolygonComplete:p,onPolylineComplete:h,onRectangleComplete:m,onLoad:x,onUnmount:w}=t,b=l.useContext(ke),[C,I]=l.useState(null),[L,j]=l.useState(null),[K,$]=l.useState(null),[W,te]=l.useState(null),[F,A]=l.useState(null),[B,T]=l.useState(null),[H,U]=l.useState(null);return l.useEffect(()=>{C!==null&&C.setMap(b)},[b]),l.useEffect(()=>{e&&C!==null&&C.setOptions(e)},[C,e]),l.useEffect(()=>{C!==null&&C.setDrawingMode(r??null)},[C,r]),l.useEffect(()=>{C&&i&&(L!==null&&google.maps.event.removeListener(L),j(google.maps.event.addListener(C,"circlecomplete",i)))},[C,i]),l.useEffect(()=>{C&&a&&(K!==null&&google.maps.event.removeListener(K),$(google.maps.event.addListener(C,"markercomplete",a)))},[C,a]),l.useEffect(()=>{C&&f&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(C,"overlaycomplete",f)))},[C,f]),l.useEffect(()=>{C&&p&&(F!==null&&google.maps.event.removeListener(F),A(google.maps.event.addListener(C,"polygoncomplete",p)))},[C,p]),l.useEffect(()=>{C&&h&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(C,"polylinecomplete",h)))},[C,h]),l.useEffect(()=>{C&&m&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(C,"rectanglecomplete",m)))},[C,m]),l.useEffect(()=>{We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var ee=new google.maps.drawing.DrawingManager(Er(Er({},e),{},{map:b}));return r&&ee.setDrawingMode(r),i&&j(google.maps.event.addListener(ee,"circlecomplete",i)),a&&$(google.maps.event.addListener(ee,"markercomplete",a)),f&&te(google.maps.event.addListener(ee,"overlaycomplete",f)),p&&A(google.maps.event.addListener(ee,"polygoncomplete",p)),h&&T(google.maps.event.addListener(ee,"polylinecomplete",h)),m&&U(google.maps.event.addListener(ee,"rectanglecomplete",m)),I(ee),x&&x(ee),()=>{C!==null&&(L&&google.maps.event.removeListener(L),K&&google.maps.event.removeListener(K),W&&google.maps.event.removeListener(W),F&&google.maps.event.removeListener(F),B&&google.maps.event.removeListener(B),H&&google.maps.event.removeListener(H),w&&w(C),C.setMap(null))}},[]),null}l.memo(gl);class ml extends l.PureComponent{constructor(e){super(e),N(this,"registeredEvents",[]),N(this,"state",{drawingManager:null}),N(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),We(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Er(Er({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Po,eventMap:So,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Po,eventMap:So,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),Ie(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}N(ml,"contextType",ke);function Oo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var _o={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Do={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Mr={};function vl(t){var{position:e,options:r,clusterer:i,noClustererRedraw:a,children:f,draggable:p,visible:h,animation:m,clickable:x,cursor:w,icon:b,label:C,opacity:I,shape:L,title:j,zIndex:K,onClick:$,onDblClick:W,onDrag:te,onDragEnd:F,onDragStart:A,onMouseOut:B,onMouseOver:T,onMouseUp:H,onMouseDown:U,onRightClick:ee,onClickableChanged:X,onCursorChanged:oe,onAnimationChanged:ue,onDraggableChanged:pe,onFlatChanged:he,onIconChanged:ve,onPositionChanged:we,onShapeChanged:ye,onTitleChanged:fe,onVisibleChanged:ce,onZindexChanged:Le,onLoad:Ce,onUnmount:ge}=t,Re=l.useContext(ke),[Z,Ae]=l.useState(null),[Be,Y]=l.useState(null),[G,be]=l.useState(null),[De,Se]=l.useState(null),[Xe,Wt]=l.useState(null),[je,$n]=l.useState(null),[rn,Vn]=l.useState(null),[on,sn]=l.useState(null),[Je,xn]=l.useState(null),[dt,Cn]=l.useState(null),[Pt,pt]=l.useState(null),[at,an]=l.useState(null),[ht,ln]=l.useState(null),[Lt,gt]=l.useState(null),[xt,un]=l.useState(null),[et,me]=l.useState(null),[mt,vt]=l.useState(null),[Ct,le]=l.useState(null),[cn,En]=l.useState(null),[Ot,Mn]=l.useState(null),[_t,Hn]=l.useState(null),[fn,Et]=l.useState(null);l.useEffect(()=>{Z!==null&&Z.setMap(Re)},[Re]),l.useEffect(()=>{typeof r<"u"&&Z!==null&&Z.setOptions(r)},[Z,r]),l.useEffect(()=>{typeof p<"u"&&Z!==null&&Z.setDraggable(p)},[Z,p]),l.useEffect(()=>{e&&Z!==null&&Z.setPosition(e)},[Z,e]),l.useEffect(()=>{typeof h<"u"&&Z!==null&&Z.setVisible(h)},[Z,h]),l.useEffect(()=>{Z?.setAnimation(m)},[Z,m]),l.useEffect(()=>{Z&&x!==void 0&&Z.setClickable(x)},[Z,x]),l.useEffect(()=>{Z&&w!==void 0&&Z.setCursor(w)},[Z,w]),l.useEffect(()=>{Z&&b!==void 0&&Z.setIcon(b)},[Z,b]),l.useEffect(()=>{Z&&C!==void 0&&Z.setLabel(C)},[Z,C]),l.useEffect(()=>{Z&&I!==void 0&&Z.setOpacity(I)},[Z,I]),l.useEffect(()=>{Z&&L!==void 0&&Z.setShape(L)},[Z,L]),l.useEffect(()=>{Z&&j!==void 0&&Z.setTitle(j)},[Z,j]),l.useEffect(()=>{Z&&K!==void 0&&Z.setZIndex(K)},[Z,K]),l.useEffect(()=>{Z&&W&&(Be!==null&&google.maps.event.removeListener(Be),Y(google.maps.event.addListener(Z,"dblclick",W)))},[W]),l.useEffect(()=>{Z&&F&&(G!==null&&google.maps.event.removeListener(G),be(google.maps.event.addListener(Z,"dragend",F)))},[F]),l.useEffect(()=>{Z&&A&&(De!==null&&google.maps.event.removeListener(De),Se(google.maps.event.addListener(Z,"dragstart",A)))},[A]),l.useEffect(()=>{Z&&U&&(Xe!==null&&google.maps.event.removeListener(Xe),Wt(google.maps.event.addListener(Z,"mousedown",U)))},[U]),l.useEffect(()=>{Z&&B&&(je!==null&&google.maps.event.removeListener(je),$n(google.maps.event.addListener(Z,"mouseout",B)))},[B]),l.useEffect(()=>{Z&&T&&(rn!==null&&google.maps.event.removeListener(rn),Vn(google.maps.event.addListener(Z,"mouseover",T)))},[T]),l.useEffect(()=>{Z&&H&&(on!==null&&google.maps.event.removeListener(on),sn(google.maps.event.addListener(Z,"mouseup",H)))},[H]),l.useEffect(()=>{Z&&ee&&(Je!==null&&google.maps.event.removeListener(Je),xn(google.maps.event.addListener(Z,"rightclick",ee)))},[ee]),l.useEffect(()=>{Z&&$&&(dt!==null&&google.maps.event.removeListener(dt),Cn(google.maps.event.addListener(Z,"click",$)))},[$]),l.useEffect(()=>{Z&&te&&(Pt!==null&&google.maps.event.removeListener(Pt),pt(google.maps.event.addListener(Z,"drag",te)))},[te]),l.useEffect(()=>{Z&&X&&(at!==null&&google.maps.event.removeListener(at),an(google.maps.event.addListener(Z,"clickable_changed",X)))},[X]),l.useEffect(()=>{Z&&oe&&(ht!==null&&google.maps.event.removeListener(ht),ln(google.maps.event.addListener(Z,"cursor_changed",oe)))},[oe]),l.useEffect(()=>{Z&&ue&&(Lt!==null&&google.maps.event.removeListener(Lt),gt(google.maps.event.addListener(Z,"animation_changed",ue)))},[ue]),l.useEffect(()=>{Z&&pe&&(xt!==null&&google.maps.event.removeListener(xt),un(google.maps.event.addListener(Z,"draggable_changed",pe)))},[pe]),l.useEffect(()=>{Z&&he&&(et!==null&&google.maps.event.removeListener(et),me(google.maps.event.addListener(Z,"flat_changed",he)))},[he]),l.useEffect(()=>{Z&&ve&&(mt!==null&&google.maps.event.removeListener(mt),vt(google.maps.event.addListener(Z,"icon_changed",ve)))},[ve]),l.useEffect(()=>{Z&&we&&(Ct!==null&&google.maps.event.removeListener(Ct),le(google.maps.event.addListener(Z,"position_changed",we)))},[we]),l.useEffect(()=>{Z&&ye&&(cn!==null&&google.maps.event.removeListener(cn),En(google.maps.event.addListener(Z,"shape_changed",ye)))},[ye]),l.useEffect(()=>{Z&&fe&&(Ot!==null&&google.maps.event.removeListener(Ot),Mn(google.maps.event.addListener(Z,"title_changed",fe)))},[fe]),l.useEffect(()=>{Z&&ce&&(_t!==null&&google.maps.event.removeListener(_t),Hn(google.maps.event.addListener(Z,"visible_changed",ce)))},[ce]),l.useEffect(()=>{Z&&Le&&(fn!==null&&google.maps.event.removeListener(fn),Et(google.maps.event.addListener(Z,"zindex_changed",Le)))},[Le]),l.useEffect(()=>{var Mt=bn(bn(bn({},r||Mr),i?Mr:{map:Re}),{},{position:e}),xe=new google.maps.Marker(Mt);return i?i.addMarker(xe,!!a):xe.setMap(Re),e&&xe.setPosition(e),typeof h<"u"&&xe.setVisible(h),typeof p<"u"&&xe.setDraggable(p),typeof x<"u"&&xe.setClickable(x),typeof w=="string"&&xe.setCursor(w),b&&xe.setIcon(b),typeof C<"u"&&xe.setLabel(C),typeof I<"u"&&xe.setOpacity(I),L&&xe.setShape(L),typeof j=="string"&&xe.setTitle(j),typeof K=="number"&&xe.setZIndex(K),W&&Y(google.maps.event.addListener(xe,"dblclick",W)),F&&be(google.maps.event.addListener(xe,"dragend",F)),A&&Se(google.maps.event.addListener(xe,"dragstart",A)),U&&Wt(google.maps.event.addListener(xe,"mousedown",U)),B&&$n(google.maps.event.addListener(xe,"mouseout",B)),T&&Vn(google.maps.event.addListener(xe,"mouseover",T)),H&&sn(google.maps.event.addListener(xe,"mouseup",H)),ee&&xn(google.maps.event.addListener(xe,"rightclick",ee)),$&&Cn(google.maps.event.addListener(xe,"click",$)),te&&pt(google.maps.event.addListener(xe,"drag",te)),X&&an(google.maps.event.addListener(xe,"clickable_changed",X)),oe&&ln(google.maps.event.addListener(xe,"cursor_changed",oe)),ue&&gt(google.maps.event.addListener(xe,"animation_changed",ue)),pe&&un(google.maps.event.addListener(xe,"draggable_changed",pe)),he&&me(google.maps.event.addListener(xe,"flat_changed",he)),ve&&vt(google.maps.event.addListener(xe,"icon_changed",ve)),we&&le(google.maps.event.addListener(xe,"position_changed",we)),ye&&En(google.maps.event.addListener(xe,"shape_changed",ye)),fe&&Mn(google.maps.event.addListener(xe,"title_changed",fe)),ce&&Hn(google.maps.event.addListener(xe,"visible_changed",ce)),Le&&Et(google.maps.event.addListener(xe,"zindex_changed",Le)),Ae(xe),Ce&&Ce(xe),()=>{Be!==null&&google.maps.event.removeListener(Be),G!==null&&google.maps.event.removeListener(G),De!==null&&google.maps.event.removeListener(De),Xe!==null&&google.maps.event.removeListener(Xe),je!==null&&google.maps.event.removeListener(je),rn!==null&&google.maps.event.removeListener(rn),on!==null&&google.maps.event.removeListener(on),Je!==null&&google.maps.event.removeListener(Je),dt!==null&&google.maps.event.removeListener(dt),at!==null&&google.maps.event.removeListener(at),ht!==null&&google.maps.event.removeListener(ht),Lt!==null&&google.maps.event.removeListener(Lt),xt!==null&&google.maps.event.removeListener(xt),et!==null&&google.maps.event.removeListener(et),mt!==null&&google.maps.event.removeListener(mt),Ct!==null&&google.maps.event.removeListener(Ct),Ot!==null&&google.maps.event.removeListener(Ot),_t!==null&&google.maps.event.removeListener(_t),fn!==null&&google.maps.event.removeListener(fn),ge&&ge(xe),i?i.removeMarker(xe,!!a):xe&&xe.setMap(null)}},[]);var Dt=l.useMemo(()=>f?l.Children.map(f,Mt=>{if(!l.isValidElement(Mt))return Mt;var xe=Mt;return l.cloneElement(xe,{anchor:Z})}):null,[f,Z]);return Q.jsx(Q.Fragment,{children:Dt})||null}l.memo(vl);class yl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this;return $s(function*(){var r=bn(bn(bn({},e.props.options||Mr),e.props.clusterer?Mr:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(r),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Do,eventMap:_o,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),Ie(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?l.Children.map(this.props.children,r=>{if(!l.isValidElement(r))return r;var i=r;return l.cloneElement(i,{anchor:this.marker})}):null;return e||null}}N(yl,"contextType",ke);var bl=(function(){function t(e,r){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var i=r.getMaxZoom(),a=this.cluster.getBounds(),f=r.getMap();f!==null&&"fitBounds"in f&&f.fitBounds(a),this.timeOut=window.setTimeout(function(){var p=r.getMap();if(p!==null){"fitBounds"in p&&p.fitBounds(a);var h=p.getZoom()||0;i!==null&&h>i&&p.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,r,i,a,f,p;if(this.div&&this.center){var h=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,m=this.backgroundPosition.split(" "),x=parseInt(((e=m[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),w=parseInt(((r=m[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),b=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(b!==null?"".concat(b.y,"px"):"0","; left: ").concat(b!==null?"".concat(b.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var C=document.createElement("img");C.alt=h,C.src=this.url,C.width=this.width,C.height=this.height,C.setAttribute("style","position: absolute; top: ".concat(w,"px; left: ").concat(x,"px")),this.cluster.getClusterer().enableRetinaIcons||(C.style.clip="rect(-".concat(w,"px, -").concat(x+this.width,"px, -").concat(w+this.height,", -").concat(x,")"));var I=document.createElement("div");I.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(I.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((f=this.sums)===null||f===void 0)&&f.html&&(I.innerHTML="".concat((p=this.sums)===null||p===void 0?void 0:p.html)),this.div.innerHTML="",this.div.appendChild(C),this.div.appendChild(I),this.div.title=h,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var r=this.cluster.getClusterer().getStyles(),i=r[Math.min(r.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},t})(),wl=(function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new bl(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),i=0,a=r;i<a.length;i++){var f=a[i],p=f.getPosition();p&&e.extend(p)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var r;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var f=this.markers.length,p=this.markerClusterer.getMaxZoom(),h=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(p!==null&&typeof h<"u"&&h>p)e.getMap()!==this.map&&e.setMap(this.map);else if(f<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(f===this.minClusterSize)for(var m=0,x=this.markers;m<x.length;m++){var w=x[m];w.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var r=e.getPosition();if(r)return this.bounds.contains(r)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,r=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var r=0;r<this.markers.length;r++)if(e===this.markers[r])return!0;return!1},t})();function Ll(t,e){var r=t.length,i=r.toString().length,a=Math.min(i,e);return{text:r.toString(),index:a,title:""}}var xl=2e3,Cl=500,El="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",Ml="png",kl=[53,56,66,78,90],Sl="cluster",Ys=(function(){function t(e,r,i){r===void 0&&(r=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||El,this.imageExtension=i.imageExtension||Ml,this.imageSizes=i.imageSizes||kl,this.calculator=i.calculator||Ll,this.batchSize=i.batchSize||xl,this.batchSizeIE=i.batchSizeIE||Cl,this.clusterClass=i.clusterClass||Sl,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,r;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,r=this.markers;e<r.length;e++){var i=r[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,f=this.clusters;a<f.length;a++){var p=f[a];p.remove()}this.clusters=[];for(var h=0,m=this.listeners;h<m.length;h++){var x=m[h];google.maps.event.removeListener(x)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),r=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var f=a[i],p=f.getPosition();p&&r.extend(p)}var h=this.getMap();h!==null&&"fitBounds"in h&&h.fitBounds(r)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,r){this.pushMarkerTo(e),r||this.redraw()},t.prototype.addMarkers=function(e,r){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}r||this.redraw()},t.prototype.pushMarkerTo=function(e){var r=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){r.ready&&(e.isAdded=!1,r.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){r=i;break}return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),!0)},t.prototype.removeMarker=function(e,r){var i=this.removeMarker_(e);return!r&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,r){for(var i=!1,a=0,f=e;a<f.length;a++){var p=f[a];i=i||this.removeMarker_(p)}return!r&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var f=a[i];f.remove()}},0)},t.prototype.getExtendedBounds=function(e){var r=this.getProjection(),i=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var f=r.fromDivPixelToLatLng(i);f!==null&&e.extend(f)}if(a!==null){var p=r.fromDivPixelToLatLng(a);p!==null&&e.extend(p)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var r=0,i=this.clusters;r<i.length;r++){var a=i[r];a.remove()}this.clusters=[];for(var f=0,p=this.markers;f<p.length;f++){var h=p[f];h.isAdded=!1,e&&h.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,r){var i=6371,a=(r.lat()-e.lat())*Math.PI/180,f=(r.lng()-e.lng())*Math.PI/180,p=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return i*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},t.prototype.isMarkerInBounds=function(e,r){var i=e.getPosition();return i?r.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var r,i=4e4,a=null,f=0,p=this.clusters;f<p.length;f++){var h=p[f];r=h;var m=r.getCenter(),x=e.getPosition();if(m&&x){var w=this.distanceBetweenPoints(m,x);w<i&&(i=w,a=r)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(r=new wl(this),r.addMarker(e),this.clusters.push(r))},t.prototype.createClusters=function(e){var r=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,f=i?.getZoom()||0,p=f>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),h=this.getExtendedBounds(p),m=Math.min(e+this.batchSize,this.markers.length),x=e;x<m;x++){var w=this.markers[x];w&&!w.isAdded&&this.isMarkerInBounds(w,h)&&(!this.ignoreHidden||this.ignoreHidden&&w.getVisible())&&this.addToClosestCluster(w)}if(m<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(m)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var b=0,C=this.clusters;b<C.length;b++){var I=C[b];I.updateIcon()}}}},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype){var p=f;this.prototype[p]=a.prototype[p]}return this}).apply(e,[r])},t})();function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ut={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},ze={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},Ol={};function _l(t){var{children:e,options:r,averageCenter:i,batchSizeIE:a,calculator:f,clusterClass:p,enableRetinaIcons:h,gridSize:m,ignoreHidden:x,imageExtension:w,imagePath:b,imageSizes:C,maxZoom:I,minimumClusterSize:L,styles:j,title:K,zoomOnClick:$,onClick:W,onClusteringBegin:te,onClusteringEnd:F,onMouseOver:A,onMouseOut:B,onLoad:T,onUnmount:H}=t,[U,ee]=l.useState(null),X=l.useContext(ke),[oe,ue]=l.useState(null),[pe,he]=l.useState(null),[ve,we]=l.useState(null),[ye,fe]=l.useState(null),[ce,Le]=l.useState(null);return l.useEffect(()=>{U&&B&&(ye!==null&&google.maps.event.removeListener(ye),fe(google.maps.event.addListener(U,ut.onMouseOut,B)))},[B]),l.useEffect(()=>{U&&A&&(ce!==null&&google.maps.event.removeListener(ce),Le(google.maps.event.addListener(U,ut.onMouseOver,A)))},[A]),l.useEffect(()=>{U&&W&&(oe!==null&&google.maps.event.removeListener(oe),ue(google.maps.event.addListener(U,ut.onClick,W)))},[W]),l.useEffect(()=>{U&&te&&(pe!==null&&google.maps.event.removeListener(pe),he(google.maps.event.addListener(U,ut.onClusteringBegin,te)))},[te]),l.useEffect(()=>{U&&F&&(ve!==null&&google.maps.event.removeListener(ve),he(google.maps.event.addListener(U,ut.onClusteringEnd,F)))},[F]),l.useEffect(()=>{typeof i<"u"&&U!==null&&ze.averageCenter(U,i)},[U,i]),l.useEffect(()=>{typeof a<"u"&&U!==null&&ze.batchSizeIE(U,a)},[U,a]),l.useEffect(()=>{typeof f<"u"&&U!==null&&ze.calculator(U,f)},[U,f]),l.useEffect(()=>{typeof p<"u"&&U!==null&&ze.clusterClass(U,p)},[U,p]),l.useEffect(()=>{typeof h<"u"&&U!==null&&ze.enableRetinaIcons(U,h)},[U,h]),l.useEffect(()=>{typeof m<"u"&&U!==null&&ze.gridSize(U,m)},[U,m]),l.useEffect(()=>{typeof x<"u"&&U!==null&&ze.ignoreHidden(U,x)},[U,x]),l.useEffect(()=>{typeof w<"u"&&U!==null&&ze.imageExtension(U,w)},[U,w]),l.useEffect(()=>{typeof b<"u"&&U!==null&&ze.imagePath(U,b)},[U,b]),l.useEffect(()=>{typeof C<"u"&&U!==null&&ze.imageSizes(U,C)},[U,C]),l.useEffect(()=>{typeof I<"u"&&U!==null&&ze.maxZoom(U,I)},[U,I]),l.useEffect(()=>{typeof L<"u"&&U!==null&&ze.minimumClusterSize(U,L)},[U,L]),l.useEffect(()=>{typeof j<"u"&&U!==null&&ze.styles(U,j)},[U,j]),l.useEffect(()=>{typeof K<"u"&&U!==null&&ze.title(U,K)},[U,K]),l.useEffect(()=>{typeof $<"u"&&U!==null&&ze.zoomOnClick(U,$)},[U,$]),l.useEffect(()=>{if(X){var Ce=Pl({},r||Ol),ge=new Ys(X,[],Ce);return i&&ze.averageCenter(ge,i),a&&ze.batchSizeIE(ge,a),f&&ze.calculator(ge,f),p&&ze.clusterClass(ge,p),h&&ze.enableRetinaIcons(ge,h),m&&ze.gridSize(ge,m),x&&ze.ignoreHidden(ge,x),w&&ze.imageExtension(ge,w),b&&ze.imagePath(ge,b),C&&ze.imageSizes(ge,C),I&&ze.maxZoom(ge,I),L&&ze.minimumClusterSize(ge,L),j&&ze.styles(ge,j),K&&ze.title(ge,K),$&&ze.zoomOnClick(ge,$),B&&fe(google.maps.event.addListener(ge,ut.onMouseOut,B)),A&&Le(google.maps.event.addListener(ge,ut.onMouseOver,A)),W&&ue(google.maps.event.addListener(ge,ut.onClick,W)),te&&he(google.maps.event.addListener(ge,ut.onClusteringBegin,te)),F&&we(google.maps.event.addListener(ge,ut.onClusteringEnd,F)),ee(ge),T&&T(ge),()=>{ye!==null&&google.maps.event.removeListener(ye),ce!==null&&google.maps.event.removeListener(ce),oe!==null&&google.maps.event.removeListener(oe),pe!==null&&google.maps.event.removeListener(pe),ve!==null&&google.maps.event.removeListener(ve),H&&H(ge)}}},[]),U!==null&&e(U)||null}l.memo(_l);class Dl extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{markerClusterer:null}),N(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ys(this.context,[],this.props.options);this.registeredEvents=_e({updaterMap:ze,eventMap:ut,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ze,eventMap:ut,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),Ie(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}N(Dl,"contextType",ke);function jo(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Xs=(function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,r=function(w){w.returnValue=!1,w.preventDefault&&w.preventDefault(),e.enableEventPropagation||jo(w)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var f=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],p=0,h=f;p<h.length;p++){var m=h[p];this.eventListeners.push(google.maps.event.addListener(this.div,m,jo))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var r=this.getMap();if(r instanceof google.maps.Map){var i=0,a=0,f=r.getBounds();f&&!f.contains(this.position)&&r.setCenter(this.position);var p=r.getDiv(),h=p.offsetWidth,m=p.offsetHeight,x=this.pixelOffset.width,w=this.pixelOffset.height,b=this.div.offsetWidth,C=this.div.offsetHeight,I=this.infoBoxClearance.width,L=this.infoBoxClearance.height,j=this.getProjection(),K=j.fromLatLngToContainerPixel(this.position);K!==null&&(K.x<-x+I?i=K.x+x-I:K.x+b+x+I>h&&(i=K.x+b+x+I-h),this.alignBottom?K.y<-w+L+C?a=K.y+w-L-C:K.y+w+L>m&&(a=K.y+w+L-m):K.y<-w+L?a=K.y+w-L:K.y+C+w+L>m&&(a=K.y+C+w+L-m)),i===0&&a===0||r.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.div.style[r]=e[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var r=this.div.ownerDocument,i=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,r){var i=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){i.setMap(r.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,r=this.eventListeners;e<r.length;e++){var i=r[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,r){return(function(a){for(var f in a.prototype)Object.prototype.hasOwnProperty.call(this,f)||(this.prototype[f]=a.prototype[f]);return this}).apply(e,[r])},t})(),Il=["position"],jl=["position"];function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ro(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var To={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Ao={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Rl={};function Tl(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:x,onZindexChanged:w,onLoad:b,onUnmount:C}=t,I=l.useContext(ke),[L,j]=l.useState(null),[K,$]=l.useState(null),[W,te]=l.useState(null),[F,A]=l.useState(null),[B,T]=l.useState(null),[H,U]=l.useState(null),ee=l.useRef(null);return l.useEffect(()=>{I&&L!==null&&(L.close(),r?L.open(I,r):L.getPosition()&&L.open(I))},[I,L,r]),l.useEffect(()=>{i&&L!==null&&L.setOptions(i)},[L,i]),l.useEffect(()=>{if(a&&L!==null){var X=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);L.setPosition(X)}},[a]),l.useEffect(()=>{typeof f=="number"&&L!==null&&L.setZIndex(f)},[f]),l.useEffect(()=>{L&&p&&(K!==null&&google.maps.event.removeListener(K),$(google.maps.event.addListener(L,"closeclick",p)))},[p]),l.useEffect(()=>{L&&h&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(L,"domready",h)))},[h]),l.useEffect(()=>{L&&m&&(F!==null&&google.maps.event.removeListener(F),A(google.maps.event.addListener(L,"content_changed",m)))},[m]),l.useEffect(()=>{L&&x&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(L,"position_changed",x)))},[x]),l.useEffect(()=>{L&&w&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(L,"zindex_changed",w)))},[w]),l.useEffect(()=>{if(I){var X=i||Rl,{position:oe}=X,ue=Ii(X,Il),pe;oe&&!(oe instanceof google.maps.LatLng)&&(pe=new google.maps.LatLng(oe.lat,oe.lng));var he=new Xs(kr(kr({},ue),pe?{position:pe}:{}));ee.current=document.createElement("div"),j(he),p&&$(google.maps.event.addListener(he,"closeclick",p)),h&&te(google.maps.event.addListener(he,"domready",h)),m&&A(google.maps.event.addListener(he,"content_changed",m)),x&&T(google.maps.event.addListener(he,"position_changed",x)),w&&U(google.maps.event.addListener(he,"zindex_changed",w)),he.setContent(ee.current),r?he.open(I,r):he.getPosition()?he.open(I):We(!1,"You must provide either an anchor or a position prop for <InfoBox>."),b&&b(he)}return()=>{L!==null&&(K&&google.maps.event.removeListener(K),F&&google.maps.event.removeListener(F),W&&google.maps.event.removeListener(W),B&&google.maps.event.removeListener(B),H&&google.maps.event.removeListener(H),C&&C(L),L.close())}},[]),ee.current?Ln.createPortal(l.Children.only(e),ee.current):null}l.memo(Tl);class Al extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoBox:null}),N(this,"open",(e,r)=>{r?this.context!==null&&e.open(this.context,r):e.getPosition()?this.context!==null&&e.open(this.context):We(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),N(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:r}=e,i=Ii(e,jl),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var f=new Xs(kr(kr({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:Ao,eventMap:To,prevProps:{},nextProps:this.props,instance:f}),this.setState({infoBox:f},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:r}=this.state;r!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ao,eventMap:To,prevProps:e,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:r}=this.state;r!==null&&(e&&e(r),Ie(this.registeredEvents),r.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(Al,"contextType",ke);var pi,Bo;function Bl(){return Bo||(Bo=1,pi=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,a,f;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(a=i;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),i=f.length,i!==Object.keys(r).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[a]))return!1;for(a=i;a--!==0;){var p=f[a];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r}),pi}var Ul=Bl(),Uo=Zs(Ul),zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],hi=1,An=8;class ji{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==hi)throw new Error("Got v".concat(a," data when expected v").concat(hi,"."));var f=zo[i&15];if(!f)throw new Error("Unrecognized array type.");var[p]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new ji(h,p,f,e)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var f=zo.indexOf(this.ArrayType),p=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,m=(8-h%8)%8;if(f<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(An+p+h+m),this.ids=new this.IndexArrayType(this.data,An,e),this.coords=new this.ArrayType(this.data,An+h+m,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(hi<<4)+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return wi(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:f,coords:p,nodeSize:h}=this,m=[0,f.length-1,0],x=[];m.length;){var w=m.pop()||0,b=m.pop()||0,C=m.pop()||0;if(b-C<=h){for(var I=C;I<=b;I++){var L=p[2*I],j=p[2*I+1];L>=e&&L<=i&&j>=r&&j<=a&&x.push(f[I])}continue}var K=C+b>>1,$=p[2*K],W=p[2*K+1];$>=e&&$<=i&&W>=r&&W<=a&&x.push(f[K]),(w===0?e<=$:r<=W)&&(m.push(C),m.push(K-1),m.push(1-w)),(w===0?i>=$:a>=W)&&(m.push(K+1),m.push(b),m.push(1-w))}return x}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:f,nodeSize:p}=this,h=[0,a.length-1,0],m=[],x=i*i;h.length;){var w=h.pop()||0,b=h.pop()||0,C=h.pop()||0;if(b-C<=p){for(var I=C;I<=b;I++)Fo(f[2*I],f[2*I+1],e,r)<=x&&m.push(a[I]);continue}var L=C+b>>1,j=f[2*L],K=f[2*L+1];Fo(j,K,e,r)<=x&&m.push(a[L]),(w===0?e-i<=j:r-i<=K)&&(h.push(C),h.push(L-1),h.push(1-w)),(w===0?e+i>=j:r+i>=K)&&(h.push(L+1),h.push(b),h.push(1-w))}return m}}function wi(t,e,r,i,a,f){if(!(a-i<=r)){var p=i+a>>1;Js(t,e,p,i,a,f),wi(t,e,r,i,p-1,1-f),wi(t,e,r,p+1,a,1-f)}}function Js(t,e,r,i,a,f){for(;a>i;){if(a-i>600){var p=a-i+1,h=r-i+1,m=Math.log(p),x=.5*Math.exp(2*m/3),w=.5*Math.sqrt(m*x*(p-x)/p)*(h-p/2<0?-1:1),b=Math.max(i,Math.floor(r-h*x/p+w)),C=Math.min(a,Math.floor(r+(p-h)*x/p+w));Js(t,e,r,b,C,f)}var I=e[2*r+f],L=i,j=a;for(Bn(t,e,i,r),e[2*a+f]>I&&Bn(t,e,i,a);L<j;){for(Bn(t,e,L,j),L++,j--;e[2*L+f]<I;)L++;for(;e[2*j+f]>I;)j--}e[2*i+f]===I?Bn(t,e,i,j):(j++,Bn(t,e,j,a)),j<=r&&(i=j+1),r<=j&&(a=j-1)}}function Bn(t,e,r,i){gi(t,r,i),gi(e,2*r,2*i),gi(e,2*r+1,2*i+1)}function gi(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Fo(t,e,r,i){var a=t-r,f=e-i;return a*a+f*f}var zl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ko=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Xt=2,Kt=3,mi=4,Ft=5,Qs=6;class Fl{constructor(e){this.options=Object.assign(Object.create(zl),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:r,minZoom:i,maxZoom:a}=this.options;r&&console.time("total time");var f="prepare ".concat(e.length," points");r&&console.time(f),this.points=e;for(var p=[],h=0;h<e.length;h++){var m=e[h];if(m.geometry){var[x,w]=m.geometry.coordinates,b=Ko(vr(x)),C=Ko(yr(w));p.push(b,C,1/0,h,-1,1),this.options.reduce&&p.push(0)}}var I=this.trees[a+1]=this._createTree(p);r&&console.timeEnd(f);for(var L=a;L>=i;L--){var j=+Date.now();I=this.trees[L]=this._createTree(this._cluster(I,L)),r&&console.log("z%d: %d clusters in %dms",L,I.numItems,+Date.now()-j)}return r&&console.timeEnd("total time"),this}getClusters(e,r){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),f=e[2]===180?180:((e[2]+180)%360+360)%360-180,p=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,f=180;else if(i>f){var h=this.getClusters([i,a,180,p],r),m=this.getClusters([-180,a,f,p],r);return h.concat(m)}var x=this.trees[this._limitZoom(r)],w=x.range(vr(i),yr(p),vr(f),yr(a)),b=x.data,C=[];for(var I of w){var L=this.stride*I;C.push(b[L+Ft]>1?No(b,L,this.clusterProps):this.points[b[L+Kt]])}return C}getChildren(e){var r=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",f=this.trees[i];if(!f)throw new Error(a);var p=f.data;if(r*this.stride>=p.length)throw new Error(a);var h=this.options.radius/(this.options.extent*Math.pow(2,i-1)),m=p[r*this.stride],x=p[r*this.stride+1],w=f.within(m,x,h),b=[];for(var C of w){var I=C*this.stride;p[I+mi]===e&&b.push(p[I+Ft]>1?No(p,I,this.clusterProps):this.points[p[I+Kt]])}if(b.length===0)throw new Error(a);return b}getLeaves(e,r,i){r=r||10,i=i||0;var a=[];return this._appendLeaves(a,e,r,i,0),a}getTile(e,r,i){var a=this.trees[this._limitZoom(e)],f=Math.pow(2,e),{extent:p,radius:h}=this.options,m=h/p,x=(i-m)/f,w=(i+1+m)/f,b={features:[]};return this._addTileFeatures(a.range((r-m)/f,x,(r+1+m)/f,w),a.data,r,i,f,b),r===0&&this._addTileFeatures(a.range(1-m/f,x,1,w),a.data,f,i,f,b),r===f-1&&this._addTileFeatures(a.range(0,x,m/f,w),a.data,-1,i,f,b),b.features.length?b:null}getClusterExpansionZoom(e){for(var r=this._getOriginZoom(e)-1;r<=this.options.maxZoom;){var i=this.getChildren(e);if(r++,i.length!==1)break;e=i[0].properties.cluster_id}return r}_appendLeaves(e,r,i,a,f){var p=this.getChildren(r);for(var h of p){var m=h.properties;if(m&&m.cluster?f+m.point_count<=a?f+=m.point_count:f=this._appendLeaves(e,m.cluster_id,i,a,f):f<a?f++:e.push(h),e.length===i)break}return f}_createTree(e){for(var r=new ji(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)r.add(e[i],e[i+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,i,a,f,p){for(var h of e){var m=h*this.stride,x=r[m+Ft]>1,w=void 0,b=void 0,C=void 0;if(x)w=ea(r,m,this.clusterProps),b=r[m],C=r[m+1];else{var I=this.points[r[m+Kt]];w=I.properties;var[L,j]=I.geometry.coordinates;b=vr(L),C=yr(j)}var K={type:1,geometry:[[Math.round(this.options.extent*(b*f-i)),Math.round(this.options.extent*(C*f-a))]],tags:w},$=void 0;x||this.options.generateId?$=r[m+Kt]:$=this.points[r[m+Kt]].id,$!==void 0&&(K.id=$),p.features.push(K)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){for(var{radius:i,extent:a,reduce:f,minPoints:p}=this.options,h=i/(a*Math.pow(2,r)),m=e.data,x=[],w=this.stride,b=0;b<m.length;b+=w)if(!(m[b+Xt]<=r)){m[b+Xt]=r;var C=m[b],I=m[b+1],L=e.within(m[b],m[b+1],h),j=m[b+Ft],K=j;for(var $ of L){var W=$*w;m[W+Xt]>r&&(K+=m[W+Ft])}if(K>j&&K>=p){var te=C*j,F=I*j,A=void 0,B=-1,T=((b/w|0)<<5)+(r+1)+this.points.length;for(var H of L){var U=H*w;if(!(m[U+Xt]<=r)){m[U+Xt]=r;var ee=m[U+Ft];te+=m[U]*ee,F+=m[U+1]*ee,m[U+mi]=T,f&&(A||(A=this._map(m,b,!0),B=this.clusterProps.length,this.clusterProps.push(A)),f(A,this._map(m,U)))}}m[b+mi]=T,x.push(te/K,F/K,1/0,T,-1,K),f&&x.push(B)}else{for(var X=0;X<w;X++)x.push(m[b+X]);if(K>1)for(var oe of L){var ue=oe*w;if(!(m[ue+Xt]<=r)){m[ue+Xt]=r;for(var pe=0;pe<w;pe++)x.push(m[ue+pe])}}}}return x}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,i){if(e[r+Ft]>1){var a=this.clusterProps[e[r+Qs]];return i?Object.assign({},a):a}var f=this.points[e[r+Kt]].properties,p=this.options.map(f);return i&&p===f?Object.assign({},p):p}}function No(t,e,r){return{type:"Feature",id:t[e+Kt],properties:ea(t,e,r),geometry:{type:"Point",coordinates:[Kl(t[e]),Nl(t[e+1])]}}}function ea(t,e,r){var i=t[e+Ft],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,f=t[e+Qs],p=f===-1?{}:Object.assign({},r[f]);return Object.assign(p,{cluster:!0,cluster_id:t[e+Kt],point_count:i,point_count_abbreviated:a})}function vr(t){return t/360+.5}function yr(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Kl(t){return(t-.5)*360}function Nl(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ql(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(r[i[a]]=t[i[a]]);return r}class ot{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Li{constructor(e){var{markers:r,position:i}=e;this.markers=r,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)e.extend(ot.getPosition(r));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ot.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ot.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Wl{constructor(e){var{maxZoom:r=16}=e;this.maxZoom=r}noop(e){var{markers:r}=e;return Zl(r)}}var Zl=t=>{var e=t.map(r=>new Li({position:ot.getPosition(r),markers:[r]}));return e};class $l extends Wl{constructor(e){var{maxZoom:r,radius:i=60}=e,a=ql(e,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Fl(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var r=!1,i={zoom:e.map.getZoom()};if(!Uo(e.markers,this.markers)){r=!0,this.markers=[...e.markers];var a=this.markers.map(f=>{var p=ot.getPosition(f),h=[p.lng(),p.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:{marker:f}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(r=!Uo(this.state,i)),this.state=i,r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r}}cluster(e){var{map:r}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[r,i]},properties:a}=e;if(a.cluster)return new Li({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(p=>p.properties.marker),position:{lat:i,lng:r}});var f=a.marker;return new Li({markers:[f],position:ot.getPosition(f)})}}class Vl{constructor(e,r){this.markers={sum:e.length};var i=r.map(f=>f.count),a=i.reduce((f,p)=>f+p,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class Hl{render(e,r,i){var{count:a,position:f}=e,p=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",h='<svg fill="'.concat(p,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),m="Cluster of ".concat(a," markers"),x=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ot.isAdvancedMarkerAvailable(i)){var w=new DOMParser,b=w.parseFromString(h,"image/svg+xml").documentElement;b.setAttribute("transform","translate(0 25)");var C={map:i,position:f,zIndex:x,title:m,content:b};return new google.maps.marker.AdvancedMarkerElement(C)}var I={position:f,zIndex:x,title:m,icon:{url:"data:image/svg+xml;base64,".concat(btoa(h)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(I)}}function Gl(t,e){for(var r in e.prototype)t.prototype[r]=e.prototype[r]}class Ri{constructor(){Gl(Ri,google.maps.OverlayView)}}var zn;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(zn||(zn={}));var Yl=(t,e,r)=>{r.fitBounds(e.bounds)};class Xl extends Ri{constructor(e){var{map:r,markers:i=[],algorithmOptions:a={},algorithm:f=new $l(a),renderer:p=new Hl,onClusterClick:h=Yl}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=f,this.renderer=p,this.onClusterClick=h,r&&this.setMap(r)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(i=>{this.addMarker(i,!0)}),r||this.render()}removeMarker(e,r){var i=this.markers.indexOf(e);return i===-1?!1:(ot.setMap(e,null),this.markers.splice(i,1),r||this.render(),!0)}removeMarkers(e,r){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!r&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,zn.CLUSTERING_BEGIN,this);var{clusters:r,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var f of r)f.markers.length==1&&a.add(f.markers[0]);var p=[];for(var h of this.clusters)h.marker!=null&&(h.markers.length==1?a.has(h.marker)||ot.setMap(h.marker,null):p.push(h.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>p.forEach(m=>ot.setMap(m,null)))}google.maps.event.trigger(this,zn.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ot.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Vl(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,r),i.markers.forEach(a=>ot.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,zn.CLUSTER_CLICK,i),this.onClusterClick(a,i,r)})),ot.setMap(i.marker,r)})}}function qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Wo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Jl(t){var e=qa(),[r,i]=l.useState(null);return l.useEffect(()=>{if(e&&r===null){var a=new Xl(Wo(Wo({},t),{},{map:e}));i(a)}},[e]),r}function Ql(t){var{children:e,options:r}=t,i=Jl(r);return i!==null?e(i):null}l.memo(Ql);var Zo={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},$o={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function eu(t){var{children:e,anchor:r,options:i,position:a,zIndex:f,onCloseClick:p,onDomReady:h,onContentChanged:m,onPositionChanged:x,onZindexChanged:w,onLoad:b,onUnmount:C}=t,I=l.useContext(ke),[L,j]=l.useState(null),[K,$]=l.useState(null),[W,te]=l.useState(null),[F,A]=l.useState(null),[B,T]=l.useState(null),[H,U]=l.useState(null),ee=l.useRef(null);return l.useEffect(()=>{L!==null&&(L.close(),r?L.open(I,r):L.getPosition()&&L.open(I))},[I,L,r]),l.useEffect(()=>{i&&L!==null&&L.setOptions(i)},[L,i]),l.useEffect(()=>{a&&L!==null&&L.setPosition(a)},[a]),l.useEffect(()=>{typeof f=="number"&&L!==null&&L.setZIndex(f)},[f]),l.useEffect(()=>{L&&p&&(K!==null&&google.maps.event.removeListener(K),$(google.maps.event.addListener(L,"closeclick",p)))},[p]),l.useEffect(()=>{L&&h&&(W!==null&&google.maps.event.removeListener(W),te(google.maps.event.addListener(L,"domready",h)))},[h]),l.useEffect(()=>{L&&m&&(F!==null&&google.maps.event.removeListener(F),A(google.maps.event.addListener(L,"content_changed",m)))},[m]),l.useEffect(()=>{L&&x&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(L,"position_changed",x)))},[x]),l.useEffect(()=>{L&&w&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(L,"zindex_changed",w)))},[w]),l.useEffect(()=>{var X=new google.maps.InfoWindow(i);return j(X),ee.current=document.createElement("div"),p&&$(google.maps.event.addListener(X,"closeclick",p)),h&&te(google.maps.event.addListener(X,"domready",h)),m&&A(google.maps.event.addListener(X,"content_changed",m)),x&&T(google.maps.event.addListener(X,"position_changed",x)),w&&U(google.maps.event.addListener(X,"zindex_changed",w)),X.setContent(ee.current),a&&X.setPosition(a),f&&X.setZIndex(f),r?X.open(I,r):X.getPosition()?X.open(I):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),b&&b(X),()=>{K&&google.maps.event.removeListener(K),F&&google.maps.event.removeListener(F),W&&google.maps.event.removeListener(W),B&&google.maps.event.removeListener(B),H&&google.maps.event.removeListener(H),C&&C(X),X.close()}},[]),ee.current?Ln.createPortal(l.Children.only(e),ee.current):null}l.memo(eu);class tu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",null),N(this,"state",{infoWindow:null}),N(this,"open",(e,r)=>{r?e.open(this.context,r):e.getPosition()?e.open(this.context):We(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),N(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:$o,eventMap:Zo,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(Ie(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Ln.createPortal(l.Children.only(this.props.children),this.containerElement):null}}N(tu,"contextType",ke);function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Ho={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Go={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},nu={};function ru(t){var{options:e,draggable:r,editable:i,visible:a,path:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:x,onMouseMove:w,onMouseOut:b,onMouseOver:C,onMouseUp:I,onRightClick:L,onClick:j,onDrag:K,onLoad:$,onUnmount:W}=t,te=l.useContext(ke),[F,A]=l.useState(null),[B,T]=l.useState(null),[H,U]=l.useState(null),[ee,X]=l.useState(null),[oe,ue]=l.useState(null),[pe,he]=l.useState(null),[ve,we]=l.useState(null),[ye,fe]=l.useState(null),[ce,Le]=l.useState(null),[Ce,ge]=l.useState(null),[Re,Z]=l.useState(null),[Ae,Be]=l.useState(null);return l.useEffect(()=>{F!==null&&F.setMap(te)},[te]),l.useEffect(()=>{typeof e<"u"&&F!==null&&F.setOptions(e)},[F,e]),l.useEffect(()=>{typeof r<"u"&&F!==null&&F.setDraggable(r)},[F,r]),l.useEffect(()=>{typeof i<"u"&&F!==null&&F.setEditable(i)},[F,i]),l.useEffect(()=>{typeof a<"u"&&F!==null&&F.setVisible(a)},[F,a]),l.useEffect(()=>{typeof f<"u"&&F!==null&&F.setPath(f)},[F,f]),l.useEffect(()=>{F&&p&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(F,"dblclick",p)))},[p]),l.useEffect(()=>{F&&h&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(F,"dragend",h)))},[h]),l.useEffect(()=>{F&&m&&(ee!==null&&google.maps.event.removeListener(ee),X(google.maps.event.addListener(F,"dragstart",m)))},[m]),l.useEffect(()=>{F&&x&&(oe!==null&&google.maps.event.removeListener(oe),ue(google.maps.event.addListener(F,"mousedown",x)))},[x]),l.useEffect(()=>{F&&w&&(pe!==null&&google.maps.event.removeListener(pe),he(google.maps.event.addListener(F,"mousemove",w)))},[w]),l.useEffect(()=>{F&&b&&(ve!==null&&google.maps.event.removeListener(ve),we(google.maps.event.addListener(F,"mouseout",b)))},[b]),l.useEffect(()=>{F&&C&&(ye!==null&&google.maps.event.removeListener(ye),fe(google.maps.event.addListener(F,"mouseover",C)))},[C]),l.useEffect(()=>{F&&I&&(ce!==null&&google.maps.event.removeListener(ce),Le(google.maps.event.addListener(F,"mouseup",I)))},[I]),l.useEffect(()=>{F&&L&&(Ce!==null&&google.maps.event.removeListener(Ce),ge(google.maps.event.addListener(F,"rightclick",L)))},[L]),l.useEffect(()=>{F&&j&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(F,"click",j)))},[j]),l.useEffect(()=>{F&&K&&(Ae!==null&&google.maps.event.removeListener(Ae),Be(google.maps.event.addListener(F,"drag",K)))},[K]),l.useEffect(()=>{var Y=new google.maps.Polyline(Sr(Sr({},e||nu),{},{map:te}));return f&&Y.setPath(f),typeof a<"u"&&Y.setVisible(a),typeof i<"u"&&Y.setEditable(i),typeof r<"u"&&Y.setDraggable(r),p&&T(google.maps.event.addListener(Y,"dblclick",p)),h&&U(google.maps.event.addListener(Y,"dragend",h)),m&&X(google.maps.event.addListener(Y,"dragstart",m)),x&&ue(google.maps.event.addListener(Y,"mousedown",x)),w&&he(google.maps.event.addListener(Y,"mousemove",w)),b&&we(google.maps.event.addListener(Y,"mouseout",b)),C&&fe(google.maps.event.addListener(Y,"mouseover",C)),I&&Le(google.maps.event.addListener(Y,"mouseup",I)),L&&ge(google.maps.event.addListener(Y,"rightclick",L)),j&&Z(google.maps.event.addListener(Y,"click",j)),K&&Be(google.maps.event.addListener(Y,"drag",K)),A(Y),$&&$(Y),()=>{B!==null&&google.maps.event.removeListener(B),H!==null&&google.maps.event.removeListener(H),ee!==null&&google.maps.event.removeListener(ee),oe!==null&&google.maps.event.removeListener(oe),pe!==null&&google.maps.event.removeListener(pe),ve!==null&&google.maps.event.removeListener(ve),ye!==null&&google.maps.event.removeListener(ye),ce!==null&&google.maps.event.removeListener(ce),Ce!==null&&google.maps.event.removeListener(Ce),Re!==null&&google.maps.event.removeListener(Re),W&&W(Y),Y.setMap(null)}},[]),null}l.memo(ru);class iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{polyline:null}),N(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Sr(Sr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Go,eventMap:Ho,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),Ie(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}N(iu,"contextType",ke);function Yo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Xo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var Jo={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Qo={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function ou(t){var{options:e,draggable:r,editable:i,visible:a,path:f,paths:p,onDblClick:h,onDragEnd:m,onDragStart:x,onMouseDown:w,onMouseMove:b,onMouseOut:C,onMouseOver:I,onMouseUp:L,onRightClick:j,onClick:K,onDrag:$,onLoad:W,onUnmount:te,onEdit:F}=t,A=l.useContext(ke),[B,T]=l.useState(null),[H,U]=l.useState(null),[ee,X]=l.useState(null),[oe,ue]=l.useState(null),[pe,he]=l.useState(null),[ve,we]=l.useState(null),[ye,fe]=l.useState(null),[ce,Le]=l.useState(null),[Ce,ge]=l.useState(null),[Re,Z]=l.useState(null),[Ae,Be]=l.useState(null),[Y,G]=l.useState(null);return l.useEffect(()=>{B!==null&&B.setMap(A)},[A]),l.useEffect(()=>{typeof e<"u"&&B!==null&&B.setOptions(e)},[B,e]),l.useEffect(()=>{typeof r<"u"&&B!==null&&B.setDraggable(r)},[B,r]),l.useEffect(()=>{typeof i<"u"&&B!==null&&B.setEditable(i)},[B,i]),l.useEffect(()=>{typeof a<"u"&&B!==null&&B.setVisible(a)},[B,a]),l.useEffect(()=>{typeof f<"u"&&B!==null&&B.setPath(f)},[B,f]),l.useEffect(()=>{typeof p<"u"&&B!==null&&B.setPaths(p)},[B,p]),l.useEffect(()=>{B&&typeof h=="function"&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(B,"dblclick",h)))},[h]),l.useEffect(()=>{B&&(google.maps.event.addListener(B.getPath(),"insert_at",()=>{F?.(B)}),google.maps.event.addListener(B.getPath(),"set_at",()=>{F?.(B)}),google.maps.event.addListener(B.getPath(),"remove_at",()=>{F?.(B)}))},[B,F]),l.useEffect(()=>{B&&typeof m=="function"&&(ee!==null&&google.maps.event.removeListener(ee),X(google.maps.event.addListener(B,"dragend",m)))},[m]),l.useEffect(()=>{B&&typeof x=="function"&&(oe!==null&&google.maps.event.removeListener(oe),ue(google.maps.event.addListener(B,"dragstart",x)))},[x]),l.useEffect(()=>{B&&typeof w=="function"&&(pe!==null&&google.maps.event.removeListener(pe),he(google.maps.event.addListener(B,"mousedown",w)))},[w]),l.useEffect(()=>{B&&typeof b=="function"&&(ve!==null&&google.maps.event.removeListener(ve),we(google.maps.event.addListener(B,"mousemove",b)))},[b]),l.useEffect(()=>{B&&typeof C=="function"&&(ye!==null&&google.maps.event.removeListener(ye),fe(google.maps.event.addListener(B,"mouseout",C)))},[C]),l.useEffect(()=>{B&&typeof I=="function"&&(ce!==null&&google.maps.event.removeListener(ce),Le(google.maps.event.addListener(B,"mouseover",I)))},[I]),l.useEffect(()=>{B&&typeof L=="function"&&(Ce!==null&&google.maps.event.removeListener(Ce),ge(google.maps.event.addListener(B,"mouseup",L)))},[L]),l.useEffect(()=>{B&&typeof j=="function"&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(B,"rightclick",j)))},[j]),l.useEffect(()=>{B&&typeof K=="function"&&(Ae!==null&&google.maps.event.removeListener(Ae),Be(google.maps.event.addListener(B,"click",K)))},[K]),l.useEffect(()=>{B&&typeof $=="function"&&(Y!==null&&google.maps.event.removeListener(Y),G(google.maps.event.addListener(B,"drag",$)))},[$]),l.useEffect(()=>{var be=new google.maps.Polygon(Xo(Xo({},e),{},{map:A}));return f&&be.setPath(f),p&&be.setPaths(p),typeof a<"u"&&be.setVisible(a),typeof i<"u"&&be.setEditable(i),typeof r<"u"&&be.setDraggable(r),h&&U(google.maps.event.addListener(be,"dblclick",h)),m&&X(google.maps.event.addListener(be,"dragend",m)),x&&ue(google.maps.event.addListener(be,"dragstart",x)),w&&he(google.maps.event.addListener(be,"mousedown",w)),b&&we(google.maps.event.addListener(be,"mousemove",b)),C&&fe(google.maps.event.addListener(be,"mouseout",C)),I&&Le(google.maps.event.addListener(be,"mouseover",I)),L&&ge(google.maps.event.addListener(be,"mouseup",L)),j&&Z(google.maps.event.addListener(be,"rightclick",j)),K&&Be(google.maps.event.addListener(be,"click",K)),$&&G(google.maps.event.addListener(be,"drag",$)),T(be),W&&W(be),()=>{H!==null&&google.maps.event.removeListener(H),ee!==null&&google.maps.event.removeListener(ee),oe!==null&&google.maps.event.removeListener(oe),pe!==null&&google.maps.event.removeListener(pe),ve!==null&&google.maps.event.removeListener(ve),ye!==null&&google.maps.event.removeListener(ye),ce!==null&&google.maps.event.removeListener(ce),Ce!==null&&google.maps.event.removeListener(Ce),Re!==null&&google.maps.event.removeListener(Re),Ae!==null&&google.maps.event.removeListener(Ae),te&&te(be),be.setMap(null)}},[]),null}l.memo(ou);class su extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Qo,eventMap:Jo,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),Ie(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}N(su,"contextType",ke);function es(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Pr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?es(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var ts={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ns={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function au(t){var{options:e,bounds:r,draggable:i,editable:a,visible:f,onDblClick:p,onDragEnd:h,onDragStart:m,onMouseDown:x,onMouseMove:w,onMouseOut:b,onMouseOver:C,onMouseUp:I,onRightClick:L,onClick:j,onDrag:K,onBoundsChanged:$,onLoad:W,onUnmount:te}=t,F=l.useContext(ke),[A,B]=l.useState(null),[T,H]=l.useState(null),[U,ee]=l.useState(null),[X,oe]=l.useState(null),[ue,pe]=l.useState(null),[he,ve]=l.useState(null),[we,ye]=l.useState(null),[fe,ce]=l.useState(null),[Le,Ce]=l.useState(null),[ge,Re]=l.useState(null),[Z,Ae]=l.useState(null),[Be,Y]=l.useState(null),[G,be]=l.useState(null);return l.useEffect(()=>{A!==null&&A.setMap(F)},[F]),l.useEffect(()=>{typeof e<"u"&&A!==null&&A.setOptions(e)},[A,e]),l.useEffect(()=>{typeof i<"u"&&A!==null&&A.setDraggable(i)},[A,i]),l.useEffect(()=>{typeof a<"u"&&A!==null&&A.setEditable(a)},[A,a]),l.useEffect(()=>{typeof f<"u"&&A!==null&&A.setVisible(f)},[A,f]),l.useEffect(()=>{typeof r<"u"&&A!==null&&A.setBounds(r)},[A,r]),l.useEffect(()=>{A&&p&&(T!==null&&google.maps.event.removeListener(T),H(google.maps.event.addListener(A,"dblclick",p)))},[p]),l.useEffect(()=>{A&&h&&(U!==null&&google.maps.event.removeListener(U),ee(google.maps.event.addListener(A,"dragend",h)))},[h]),l.useEffect(()=>{A&&m&&(X!==null&&google.maps.event.removeListener(X),oe(google.maps.event.addListener(A,"dragstart",m)))},[m]),l.useEffect(()=>{A&&x&&(ue!==null&&google.maps.event.removeListener(ue),pe(google.maps.event.addListener(A,"mousedown",x)))},[x]),l.useEffect(()=>{A&&w&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(A,"mousemove",w)))},[w]),l.useEffect(()=>{A&&b&&(we!==null&&google.maps.event.removeListener(we),ye(google.maps.event.addListener(A,"mouseout",b)))},[b]),l.useEffect(()=>{A&&C&&(fe!==null&&google.maps.event.removeListener(fe),ce(google.maps.event.addListener(A,"mouseover",C)))},[C]),l.useEffect(()=>{A&&I&&(Le!==null&&google.maps.event.removeListener(Le),Ce(google.maps.event.addListener(A,"mouseup",I)))},[I]),l.useEffect(()=>{A&&L&&(ge!==null&&google.maps.event.removeListener(ge),Re(google.maps.event.addListener(A,"rightclick",L)))},[L]),l.useEffect(()=>{A&&j&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(A,"click",j)))},[j]),l.useEffect(()=>{A&&K&&(Be!==null&&google.maps.event.removeListener(Be),Y(google.maps.event.addListener(A,"drag",K)))},[K]),l.useEffect(()=>{A&&$&&(G!==null&&google.maps.event.removeListener(G),be(google.maps.event.addListener(A,"bounds_changed",$)))},[$]),l.useEffect(()=>{var De=new google.maps.Rectangle(Pr(Pr({},e),{},{map:F}));return typeof f<"u"&&De.setVisible(f),typeof a<"u"&&De.setEditable(a),typeof i<"u"&&De.setDraggable(i),typeof r<"u"&&De.setBounds(r),p&&H(google.maps.event.addListener(De,"dblclick",p)),h&&ee(google.maps.event.addListener(De,"dragend",h)),m&&oe(google.maps.event.addListener(De,"dragstart",m)),x&&pe(google.maps.event.addListener(De,"mousedown",x)),w&&ve(google.maps.event.addListener(De,"mousemove",w)),b&&ye(google.maps.event.addListener(De,"mouseout",b)),C&&ce(google.maps.event.addListener(De,"mouseover",C)),I&&Ce(google.maps.event.addListener(De,"mouseup",I)),L&&Re(google.maps.event.addListener(De,"rightclick",L)),j&&Ae(google.maps.event.addListener(De,"click",j)),K&&Y(google.maps.event.addListener(De,"drag",K)),$&&be(google.maps.event.addListener(De,"bounds_changed",$)),B(De),W&&W(De),()=>{T!==null&&google.maps.event.removeListener(T),U!==null&&google.maps.event.removeListener(U),X!==null&&google.maps.event.removeListener(X),ue!==null&&google.maps.event.removeListener(ue),he!==null&&google.maps.event.removeListener(he),we!==null&&google.maps.event.removeListener(we),fe!==null&&google.maps.event.removeListener(fe),Le!==null&&google.maps.event.removeListener(Le),ge!==null&&google.maps.event.removeListener(ge),Z!==null&&google.maps.event.removeListener(Z),Be!==null&&google.maps.event.removeListener(Be),G!==null&&google.maps.event.removeListener(G),te&&te(De),De.setMap(null)}},[]),null}l.memo(au);class lu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{rectangle:null}),N(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Pr(Pr({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ns,eventMap:ts,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),Ie(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}N(lu,"contextType",ke);function rs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Or(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var is={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},os={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},uu={};function cu(t){var{options:e,center:r,radius:i,draggable:a,editable:f,visible:p,onDblClick:h,onDragEnd:m,onDragStart:x,onMouseDown:w,onMouseMove:b,onMouseOut:C,onMouseOver:I,onMouseUp:L,onRightClick:j,onClick:K,onDrag:$,onCenterChanged:W,onRadiusChanged:te,onLoad:F,onUnmount:A}=t,B=l.useContext(ke),[T,H]=l.useState(null),[U,ee]=l.useState(null),[X,oe]=l.useState(null),[ue,pe]=l.useState(null),[he,ve]=l.useState(null),[we,ye]=l.useState(null),[fe,ce]=l.useState(null),[Le,Ce]=l.useState(null),[ge,Re]=l.useState(null),[Z,Ae]=l.useState(null),[Be,Y]=l.useState(null),[G,be]=l.useState(null),[De,Se]=l.useState(null),[Xe,Wt]=l.useState(null);return l.useEffect(()=>{T!==null&&T.setMap(B)},[B]),l.useEffect(()=>{typeof e<"u"&&T!==null&&T.setOptions(e)},[T,e]),l.useEffect(()=>{typeof a<"u"&&T!==null&&T.setDraggable(a)},[T,a]),l.useEffect(()=>{typeof f<"u"&&T!==null&&T.setEditable(f)},[T,f]),l.useEffect(()=>{typeof p<"u"&&T!==null&&T.setVisible(p)},[T,p]),l.useEffect(()=>{typeof i=="number"&&T!==null&&T.setRadius(i)},[T,i]),l.useEffect(()=>{typeof r<"u"&&T!==null&&T.setCenter(r)},[T,r]),l.useEffect(()=>{T&&h&&(U!==null&&google.maps.event.removeListener(U),ee(google.maps.event.addListener(T,"dblclick",h)))},[h]),l.useEffect(()=>{T&&m&&(X!==null&&google.maps.event.removeListener(X),oe(google.maps.event.addListener(T,"dragend",m)))},[m]),l.useEffect(()=>{T&&x&&(ue!==null&&google.maps.event.removeListener(ue),pe(google.maps.event.addListener(T,"dragstart",x)))},[x]),l.useEffect(()=>{T&&w&&(he!==null&&google.maps.event.removeListener(he),ve(google.maps.event.addListener(T,"mousedown",w)))},[w]),l.useEffect(()=>{T&&b&&(we!==null&&google.maps.event.removeListener(we),ye(google.maps.event.addListener(T,"mousemove",b)))},[b]),l.useEffect(()=>{T&&C&&(fe!==null&&google.maps.event.removeListener(fe),ce(google.maps.event.addListener(T,"mouseout",C)))},[C]),l.useEffect(()=>{T&&I&&(Le!==null&&google.maps.event.removeListener(Le),Ce(google.maps.event.addListener(T,"mouseover",I)))},[I]),l.useEffect(()=>{T&&L&&(ge!==null&&google.maps.event.removeListener(ge),Re(google.maps.event.addListener(T,"mouseup",L)))},[L]),l.useEffect(()=>{T&&j&&(Z!==null&&google.maps.event.removeListener(Z),Ae(google.maps.event.addListener(T,"rightclick",j)))},[j]),l.useEffect(()=>{T&&K&&(Be!==null&&google.maps.event.removeListener(Be),Y(google.maps.event.addListener(T,"click",K)))},[K]),l.useEffect(()=>{T&&$&&(G!==null&&google.maps.event.removeListener(G),be(google.maps.event.addListener(T,"drag",$)))},[$]),l.useEffect(()=>{T&&W&&(De!==null&&google.maps.event.removeListener(De),Se(google.maps.event.addListener(T,"center_changed",W)))},[K]),l.useEffect(()=>{T&&te&&(Xe!==null&&google.maps.event.removeListener(Xe),Wt(google.maps.event.addListener(T,"radius_changed",te)))},[te]),l.useEffect(()=>{var je=new google.maps.Circle(Or(Or({},e||uu),{},{map:B}));return typeof i=="number"&&je.setRadius(i),typeof r<"u"&&je.setCenter(r),typeof i=="number"&&je.setRadius(i),typeof p<"u"&&je.setVisible(p),typeof f<"u"&&je.setEditable(f),typeof a<"u"&&je.setDraggable(a),h&&ee(google.maps.event.addListener(je,"dblclick",h)),m&&oe(google.maps.event.addListener(je,"dragend",m)),x&&pe(google.maps.event.addListener(je,"dragstart",x)),w&&ve(google.maps.event.addListener(je,"mousedown",w)),b&&ye(google.maps.event.addListener(je,"mousemove",b)),C&&ce(google.maps.event.addListener(je,"mouseout",C)),I&&Ce(google.maps.event.addListener(je,"mouseover",I)),L&&Re(google.maps.event.addListener(je,"mouseup",L)),j&&Ae(google.maps.event.addListener(je,"rightclick",j)),K&&Y(google.maps.event.addListener(je,"click",K)),$&&be(google.maps.event.addListener(je,"drag",$)),W&&Se(google.maps.event.addListener(je,"center_changed",W)),te&&Wt(google.maps.event.addListener(je,"radius_changed",te)),H(je),F&&F(je),()=>{U!==null&&google.maps.event.removeListener(U),X!==null&&google.maps.event.removeListener(X),ue!==null&&google.maps.event.removeListener(ue),he!==null&&google.maps.event.removeListener(he),we!==null&&google.maps.event.removeListener(we),fe!==null&&google.maps.event.removeListener(fe),Le!==null&&google.maps.event.removeListener(Le),ge!==null&&google.maps.event.removeListener(ge),Z!==null&&google.maps.event.removeListener(Z),Be!==null&&google.maps.event.removeListener(Be),De!==null&&google.maps.event.removeListener(De),Xe!==null&&google.maps.event.removeListener(Xe),A&&A(je),je.setMap(null)}},[]),null}l.memo(cu);class fu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{circle:null}),N(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Or(Or({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:os,eventMap:is,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),Ie(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}N(fu,"contextType",ke);function ss(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ss(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var as={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},ls={add(t,e){t.add(e)},addgeojson(t,e,r){t.addGeoJson(e,r)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,r,i){t.loadGeoJson(e,r,i)},overridestyle(t,e,r){t.overrideStyle(e,r)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function du(t){var{options:e,onClick:r,onDblClick:i,onMouseDown:a,onMouseMove:f,onMouseOut:p,onMouseOver:h,onMouseUp:m,onRightClick:x,onAddFeature:w,onRemoveFeature:b,onRemoveProperty:C,onSetGeometry:I,onSetProperty:L,onLoad:j,onUnmount:K}=t,$=l.useContext(ke),[W,te]=l.useState(null),[F,A]=l.useState(null),[B,T]=l.useState(null),[H,U]=l.useState(null),[ee,X]=l.useState(null),[oe,ue]=l.useState(null),[pe,he]=l.useState(null),[ve,we]=l.useState(null),[ye,fe]=l.useState(null),[ce,Le]=l.useState(null),[Ce,ge]=l.useState(null),[Re,Z]=l.useState(null),[Ae,Be]=l.useState(null),[Y,G]=l.useState(null);return l.useEffect(()=>{W!==null&&W.setMap($)},[$]),l.useEffect(()=>{W&&i&&(F!==null&&google.maps.event.removeListener(F),A(google.maps.event.addListener(W,"dblclick",i)))},[i]),l.useEffect(()=>{W&&a&&(B!==null&&google.maps.event.removeListener(B),T(google.maps.event.addListener(W,"mousedown",a)))},[a]),l.useEffect(()=>{W&&f&&(H!==null&&google.maps.event.removeListener(H),U(google.maps.event.addListener(W,"mousemove",f)))},[f]),l.useEffect(()=>{W&&p&&(ee!==null&&google.maps.event.removeListener(ee),X(google.maps.event.addListener(W,"mouseout",p)))},[p]),l.useEffect(()=>{W&&h&&(oe!==null&&google.maps.event.removeListener(oe),ue(google.maps.event.addListener(W,"mouseover",h)))},[h]),l.useEffect(()=>{W&&m&&(pe!==null&&google.maps.event.removeListener(pe),he(google.maps.event.addListener(W,"mouseup",m)))},[m]),l.useEffect(()=>{W&&x&&(ve!==null&&google.maps.event.removeListener(ve),we(google.maps.event.addListener(W,"rightclick",x)))},[x]),l.useEffect(()=>{W&&r&&(ye!==null&&google.maps.event.removeListener(ye),fe(google.maps.event.addListener(W,"click",r)))},[r]),l.useEffect(()=>{W&&w&&(ce!==null&&google.maps.event.removeListener(ce),Le(google.maps.event.addListener(W,"addfeature",w)))},[w]),l.useEffect(()=>{W&&b&&(Ce!==null&&google.maps.event.removeListener(Ce),ge(google.maps.event.addListener(W,"removefeature",b)))},[b]),l.useEffect(()=>{W&&C&&(Re!==null&&google.maps.event.removeListener(Re),Z(google.maps.event.addListener(W,"removeproperty",C)))},[C]),l.useEffect(()=>{W&&I&&(Ae!==null&&google.maps.event.removeListener(Ae),Be(google.maps.event.addListener(W,"setgeometry",I)))},[I]),l.useEffect(()=>{W&&L&&(Y!==null&&google.maps.event.removeListener(Y),G(google.maps.event.addListener(W,"setproperty",L)))},[L]),l.useEffect(()=>{if($!==null){var be=new google.maps.Data(_r(_r({},e),{},{map:$}));i&&A(google.maps.event.addListener(be,"dblclick",i)),a&&T(google.maps.event.addListener(be,"mousedown",a)),f&&U(google.maps.event.addListener(be,"mousemove",f)),p&&X(google.maps.event.addListener(be,"mouseout",p)),h&&ue(google.maps.event.addListener(be,"mouseover",h)),m&&he(google.maps.event.addListener(be,"mouseup",m)),x&&we(google.maps.event.addListener(be,"rightclick",x)),r&&fe(google.maps.event.addListener(be,"click",r)),w&&Le(google.maps.event.addListener(be,"addfeature",w)),b&&ge(google.maps.event.addListener(be,"removefeature",b)),C&&Z(google.maps.event.addListener(be,"removeproperty",C)),I&&Be(google.maps.event.addListener(be,"setgeometry",I)),L&&G(google.maps.event.addListener(be,"setproperty",L)),te(be),j&&j(be)}return()=>{W&&(F!==null&&google.maps.event.removeListener(F),B!==null&&google.maps.event.removeListener(B),H!==null&&google.maps.event.removeListener(H),ee!==null&&google.maps.event.removeListener(ee),oe!==null&&google.maps.event.removeListener(oe),pe!==null&&google.maps.event.removeListener(pe),ve!==null&&google.maps.event.removeListener(ve),ye!==null&&google.maps.event.removeListener(ye),ce!==null&&google.maps.event.removeListener(ce),Ce!==null&&google.maps.event.removeListener(Ce),Re!==null&&google.maps.event.removeListener(Re),Ae!==null&&google.maps.event.removeListener(Ae),Y!==null&&google.maps.event.removeListener(Y),K&&K(W),W.setMap(null))}},[]),null}l.memo(du);class pu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{data:null}),N(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(_r(_r({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ls,eventMap:as,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),Ie(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}N(pu,"contextType",ke);function us(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function cs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?us(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):us(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var fs={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},ds={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class hu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{kmlLayer:null}),N(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(cs(cs({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ds,eventMap:fs,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),Ie(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}N(hu,"contextType",ke);function ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function gu(t,e){return new e(t.lat,t.lng)}function mu(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function vu(t,e,r){return t instanceof e?t:r(t,e)}function yu(t,e,r){return t instanceof e?t:r(t,e)}function bu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r.getNorthEast()),a=t&&t.fromLatLngToDivPixel(r.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function wu(t,e,r){var i=t&&t.fromLatLngToDivPixel(r);if(i){var{x:a,y:f}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(f+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function na(t,e,r,i){return r!==void 0?bu(t,e,yu(r,google.maps.LatLngBounds,mu)):wu(t,e,vu(i,google.maps.LatLng,gu))}function Lu(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Cu(t,e,r,i,a){class f extends google.maps.OverlayView{constructor(h,m,x,w){super(),this.container=h,this.pane=m,this.position=x,this.bounds=w}onAdd(){var h,m=(h=this.getPanes())===null||h===void 0?void 0:h[this.pane];m?.appendChild(this.container)}draw(){var h=this.getProjection(),m=xu({},this.container?ta(this.container,a):{x:0,y:0}),x=na(h,m,this.bounds,this.position);for(var[w,b]of Object.entries(x))this.container.style[w]=b}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new f(t,e,r,i)}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Eu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function gs(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function ms(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function Mu(t){var{position:e,bounds:r,mapPaneName:i,zIndex:a,onLoad:f,onUnmount:p,getPixelPositionOffset:h,children:m}=t,x=l.useContext(ke),w=l.useMemo(()=>{var C=document.createElement("div");return C.style.position="absolute",C},[]),b=l.useMemo(()=>Cu(w,i,e,r,h),[w,i,e,r]);return l.useEffect(()=>(f?.(b),b?.setMap(x),()=>{p?.(b),b?.setMap(null)}),[x,b]),l.useEffect(()=>{w.style.zIndex="".concat(a)},[a,w]),Ln.createPortal(m,w)}l.memo(Mu);class wt extends l.PureComponent{constructor(e){super(e),N(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),N(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();We(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),N(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),N(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=Eu({x:0,y:0},this.containerRef.current?ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),f=na(i,a,this.props.bounds,this.props.position);if(!Lu(f,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var p,h,m,x;this.setState({containerStyle:{top:(p=f.top)!==null&&p!==void 0?p:0,left:(h=f.left)!==null&&h!==void 0?h:0,width:(m=f.width)!==null&&m!==void 0?m:0,height:(x=f.height)!==null&&x!==void 0?x:0,position:"absolute"}})}}),N(this,"draw",()=>{this.onPositionElement()}),N(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=l.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var r=gs(e.position),i=gs(this.props.position),a=ms(e.bounds),f=ms(this.props.bounds);(r!==i||a!==f)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?Ln.createPortal(Q.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:l.Children.only(this.props.children)}),e):null}}N(wt,"FLOAT_PANE","floatPane");N(wt,"MAP_PANE","mapPane");N(wt,"MARKER_LAYER","markerLayer");N(wt,"OVERLAY_LAYER","overlayLayer");N(wt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");N(wt,"contextType",ke);function ku(){}function vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vs(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var bs={onDblClick:"dblclick",onClick:"click"},ws={opacity(t,e){t.setOpacity(e)}};function Su(t){var{url:e,bounds:r,options:i,visible:a}=t,f=l.useContext(ke),p=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),h=l.useMemo(()=>new google.maps.GroundOverlay(e,p,i),[]);return l.useEffect(()=>{h!==null&&h.setMap(f)},[f]),l.useEffect(()=>{typeof e<"u"&&h!==null&&(h.set("url",e),h.setMap(f))},[h,e]),l.useEffect(()=>{typeof a<"u"&&h!==null&&h.setOpacity(a?1:0)},[h,a]),l.useEffect(()=>{var m=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&h!==null&&(h.set("bounds",m),h.setMap(f))},[h,r]),null}l.memo(Su);class ra extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{groundOverlay:null}),N(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){We(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,ys(ys({},this.props.options),{},{map:this.context}));this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:ws,eventMap:bs,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}N(ra,"defaultProps",{onLoad:ku});N(ra,"contextType",ke);function Ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,i)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ls(Object(r),!0).forEach(function(i){N(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var xs={},Cs={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function Pu(t){var{data:e,onLoad:r,onUnmount:i,options:a}=t,f=l.useContext(ke),[p,h]=l.useState(null);return l.useEffect(()=>{google.maps.visualization||We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),l.useEffect(()=>{We(!!e,"data property is required in HeatmapLayer %s",e)},[e]),l.useEffect(()=>{p!==null&&p.setMap(f)},[f]),l.useEffect(()=>{a&&p!==null&&p.setOptions(a)},[p,a]),l.useEffect(()=>{var m=new google.maps.visualization.HeatmapLayer(Dr(Dr({},a),{},{data:e,map:f}));return h(m),r&&r(m),()=>{p!==null&&(i&&i(p),p.setMap(null))}},[]),null}l.memo(Pu);class Ou extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{heatmapLayer:null}),N(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){We(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),We(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Dr(Dr({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Cs,eventMap:xs,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),Ie(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}N(Ou,"contextType",ke);var Es={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Ms={register(t,e,r){t.registerPanoProvider(e,r)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class _u extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{streetViewPanorama:null}),N(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,r,i=(e=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=_e({updaterMap:Ms,eventMap:Es,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ms,eventMap:Es,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),Ie(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}N(_u,"contextType",ke);class Du extends l.PureComponent{constructor(){super(...arguments),N(this,"state",{streetViewService:null}),N(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}N(Du,"contextType",ke);var ks={onDirectionsChanged:"directions_changed"},Ss={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class Iu extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"state",{directionsRenderer:null}),N(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=_e({updaterMap:Ss,eventMap:ks,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ss,eventMap:ks,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),Ie(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}N(Iu,"contextType",ke);var Ps={onPlacesChanged:"places_changed"},Os={bounds(t,e){t.setBounds(e)}};class ju extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{searchBox:null}),N(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var r=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Os,eventMap:Ps,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),Ie(this.registeredEvents))}render(){return Q.jsx("div",{ref:this.containerElement,children:l.Children.only(this.props.children)})}}N(ju,"contextType",ke);var _s={onPlaceChanged:"place_changed"},Ds={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class ia extends l.PureComponent{constructor(){super(...arguments),N(this,"registeredEvents",[]),N(this,"containerElement",l.createRef()),N(this,"state",{autocomplete:null}),N(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;We(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(r){var i=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){Ie(this.registeredEvents),this.registeredEvents=_e({updaterMap:Ds,eventMap:_s,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&Ie(this.registeredEvents)}render(){return Q.jsx("div",{ref:this.containerElement,className:this.props.className,children:l.Children.only(this.props.children)})}}N(ia,"defaultProps",{className:""});N(ia,"contextType",ke);const Ut=5e-4,Ru=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=100;t.width=r,t.height=r;const i=e.createImageData(r,r),a=i.data;for(let f=0;f<a.length;f+=4){const p=Math.random()*100;a[f]=p,a[f+1]=p,a[f+2]=p,a[f+3]=5}return e.putImageData(i,0,0),e.createPattern(t,"repeat")},Tu=({map:t,zoom:e,claimedCells:r,exploredCells:i,hoveredCell:a,isAnimating:f,selectedCell:p,effects:h})=>{const m=l.useRef(null),x=l.useRef(null),[w,b]=l.useState({claimed:[],explored:[]}),C=l.useRef(),I=l.useRef(null);return l.useEffect(()=>{if(!t)return;class L extends window.google.maps.OverlayView{constructor(T){super(),this.props={},this.swPixel=null,this.nePixel=null,this.drawableClaimed=[],this.drawableExplored=[],this.noisePattern=T,this.fogCanvas=document.createElement("canvas"),this.fogCtx=this.fogCanvas.getContext("2d"),this.fogCanvas.style.position="absolute",this.fogCanvas.style.pointerEvents="none",this.effectsCanvas=document.createElement("canvas"),this.effectsCtx=this.effectsCanvas.getContext("2d"),this.effectsCanvas.style.position="absolute",this.effectsCanvas.style.pointerEvents="none",this.dynamicCanvas=document.createElement("canvas"),this.dynamicCtx=this.dynamicCanvas.getContext("2d"),this.dynamicCanvas.style.position="absolute",this.dynamicCanvas.style.pointerEvents="none"}setProps(T){this.props={...this.props,...T}}setDrawableCells(T,H){this.drawableClaimed=T,this.drawableExplored=H}onAdd(){const T=this.getPanes();T.overlayLayer.appendChild(this.fogCanvas),T.overlayMouseTarget.appendChild(this.effectsCanvas),T.overlayMouseTarget.appendChild(this.dynamicCanvas)}onRemove(){[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(T=>{T.parentElement&&T.parentElement.removeChild(T)})}draw(){const T=this.getProjection();if(!T)return;const H=.5,U=this.getMap().getBounds(),ee=U.getSouthWest(),X=U.getNorthEast(),oe=T.fromLatLngToDivPixel(ee),ue=T.fromLatLngToDivPixel(X);if(!oe||!ue)return;const pe=ue.x-oe.x,he=oe.y-ue.y,ve=Math.round(pe*H),we=Math.round(he*H),ye=pe+2*ve,fe=he+2*we;this.swPixel={x:oe.x-ve,y:oe.y+we},this.nePixel={x:ue.x+ve,y:ue.y-we},[this.fogCanvas,this.effectsCanvas,this.dynamicCanvas].forEach(ce=>{ce.style.left=`${oe.x-ve}px`,ce.style.top=`${ue.y-we}px`,ce.width=ye,ce.height=fe}),this.drawFog(),this.drawDynamic()}drawFog(){this.swPixel&&(this.fogCtx.clearRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.fogCanvas.style.opacity=this.props.isAnimating?"0.7":"1",this.fogCtx.fillStyle="rgba(26, 26, 26, 0.9)",this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height),this.noisePattern&&(this.fogCtx.fillStyle=this.noisePattern,this.fogCtx.fillRect(0,0,this.fogCanvas.width,this.fogCanvas.height)),this.fogCtx.globalCompositeOperation="destination-out",this.drawableExplored.forEach(T=>this.drawStaticReveal(T)),this.fogCtx.globalCompositeOperation="source-over")}drawStaticReveal(T){const H=this.getProjection();if(!H||!this.swPixel)return;const{south:U,west:ee}=T,X=new window.google.maps.LatLng(U,ee),oe=new window.google.maps.LatLng(U+Ut,ee+Ut),ue=H.fromLatLngToDivPixel(X),pe=H.fromLatLngToDivPixel(oe);if(!ue||!pe)return;const he=ue.x-this.swPixel.x,ve=pe.y-this.nePixel.y,we=pe.x-ue.x,ye=ue.y-pe.y,fe=he+we/2,ce=ve+ye/2,Le=we*2.5,Ce=ye*2.5,ge=this.fogCtx.createRadialGradient(fe,ce,0,fe,ce,Math.max(Le,Ce));ge.addColorStop(0,"rgba(0, 0, 0, 1)"),ge.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.fillStyle=ge,this.fogCtx.beginPath(),this.fogCtx.ellipse(fe,ce,Le,Ce,0,0,2*Math.PI),this.fogCtx.fill()}drawRevealEffect(T,H,U){const ee=new window.google.maps.LatLng(T.position.lat,T.position.lng),X=U.fromLatLngToDivPixel(ee);if(!X||!this.swPixel)return;const oe=X.x-this.swPixel.x,ue=X.y-this.nePixel.y,pe=new window.google.maps.LatLng(T.position.lat,T.position.lng),he=new window.google.maps.LatLng(T.position.lat+Ut,T.position.lng+Ut),ve=U.fromLatLngToDivPixel(pe),we=U.fromLatLngToDivPixel(he);if(!ve||!we)return;const ce=(we.x-ve.x)*2.5*H,Le=this.fogCtx.createRadialGradient(oe,ue,0,oe,ue,ce);Le.addColorStop(0,"rgba(0, 0, 0, 1)"),Le.addColorStop(1,"rgba(0, 0, 0, 0)"),this.fogCtx.globalCompositeOperation="destination-out",this.fogCtx.fillStyle=Le,this.fogCtx.beginPath(),this.fogCtx.arc(oe,ue,ce,0,2*Math.PI),this.fogCtx.fill(),this.fogCtx.globalCompositeOperation="source-over"}drawParticleEffect(T,H,U){const ee=new window.google.maps.LatLng(T.position.lat,T.position.lng),X=U.fromLatLngToDivPixel(ee);if(!X||!this.swPixel)return;const oe=X.x-this.swPixel.x,ue=X.y-this.nePixel.y,he=80*(.1+1.4*H),ve=.6*(1-H),we=this.effectsCtx.createRadialGradient(oe,ue,0,oe,ue,he);we.addColorStop(0,`rgba(255, 255, 255, ${ve*.5})`),we.addColorStop(.5,`rgba(255, 255, 255, ${ve*.5})`),we.addColorStop(1,"rgba(255, 255, 255, 0)"),this.effectsCtx.fillStyle=we,this.effectsCtx.filter="blur(20px)",this.effectsCtx.beginPath(),this.effectsCtx.arc(oe,ue,he,0,2*Math.PI),this.effectsCtx.fill(),this.effectsCtx.filter="none"}clearEffects(){this.effectsCtx&&this.effectsCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)}drawDynamic(){const T=this.getProjection();if(!T||!this.swPixel)return;const{hoveredCell:H,selectedCell:U}=this.props;this.dynamicCtx.clearRect(0,0,this.dynamicCanvas.width,this.dynamicCanvas.height);const ee=U?U.key:H;if(!ee)return;const[X,oe]=ee.split("_").map(Number),ue=X*Ut,pe=oe*Ut,he=new window.google.maps.LatLng(ue,pe),ve=new window.google.maps.LatLng(ue+Ut,pe+Ut),we=T.fromLatLngToDivPixel(he),ye=T.fromLatLngToDivPixel(ve);if(!we||!ye)return;const fe=we.x-this.swPixel.x,ce=ye.y-this.nePixel.y,Le=ye.x-we.x,Ce=we.y-ye.y;this.dynamicCtx.fillStyle="rgba(59, 130, 246, 0.4)",this.dynamicCtx.fillRect(fe,ce,Le,Ce)}}I.current=Ru();const j=new L(I.current);j.setMap(t),m.current=j;const K=new Worker(new URL("/chill-demo/assets/grid.worker-B6yfyZNM.js",import.meta.url),{type:"module"});x.current=K,K.onmessage=B=>{const{claimedCellsToDraw:T,exploredCellsToDraw:H}=B.data;b({claimed:T,explored:H})};let $=null;const W=100,te=()=>{if(x.current){const B=t.getBounds();B&&x.current.postMessage({bounds:{southwest:{lat:B.getSouthWest().lat(),lng:B.getSouthWest().lng()},northeast:{lat:B.getNorthEast().lat(),lng:B.getNorthEast().lng()}},zoom:t.getZoom(),claimedCells:r,exploredCells:i})}},F=t.addListener("bounds_changed",()=>{$||($=setTimeout(()=>{te(),$=null},W))}),A=t.addListener("idle",te);return()=>{K.terminate(),j.setMap(null),window.google.maps.event.removeListener(F),window.google.maps.event.removeListener(A),$&&clearTimeout($),C.current&&cancelAnimationFrame(C.current)}},[t,r,i]),l.useEffect(()=>{m.current&&(m.current.setDrawableCells(w.claimed,w.explored),m.current.drawFog())},[w]),l.useEffect(()=>{m.current&&(m.current.setProps({zoom:e,hoveredCell:a,isAnimating:f,selectedCell:p}),m.current.drawDynamic())},[e,a,f,p]),l.useEffect(()=>{const L=m.current;if(!L||h.length===0)return;const j=new Map,K=()=>{const $=L.getProjection();if(!$||!L.swPixel){C.current=requestAnimationFrame(K);return}L.effectsCtx.clearRect(0,0,L.effectsCanvas.width,L.effectsCanvas.height),L.drawFog();let W=!1;const te=Date.now();h.forEach(F=>{const A=te-F.startTime;A<F.particleDuration&&(W=!0,L.drawParticleEffect(F,A/F.particleDuration,$)),A<F.revealDuration&&(W=!0,L.drawRevealEffect(F,A/F.revealDuration,$)),A>=F.revealDuration&&!j.has(F.id)&&(F.onComplete?.(),j.set(F.id,!0))}),W?C.current=requestAnimationFrame(K):L.drawFog()};return C.current=requestAnimationFrame(K),()=>{C.current&&cancelAnimationFrame(C.current),L&&(L.clearEffects(),L.drawFog())}},[h]),null},Au="/chill-demo/assets/click-sound-BhgY4zY3.mp3",Is=new Audio(Au),xi=()=>{Is.currentTime=0,Is.play().catch(t=>{console.error("Audio playback failed:",t)})},rt={container:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"280px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",fontFamily:"system-ui, sans-serif"},closeButton:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",fontSize:"20px",color:"#9CA3AF",cursor:"pointer",padding:"4px",lineHeight:"1",zIndex:11},header:{display:"flex",alignItems:"center",padding:"16px",borderBottom:"1px solid #E5E7EB",gap:"12px"},flag:{width:"32px",height:"24px",borderRadius:"4px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},location:{display:"flex",flexDirection:"column"},country:{fontSize:"18px",fontWeight:"bold",color:"#1F2937"},region:{fontSize:"14px",color:"#6B7280"},coordinates:{fontSize:"12px",color:"#9CA3AF",marginTop:"2px"},body:{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},text:{fontSize:"15px",color:"#374151",margin:0},claimButton:{width:"100%",padding:"12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},cloudIcon:{fontSize:"20px"},loader:{border:"4px solid #f3f3f3",borderTop:"4px solid #3B82F6",borderRadius:"50%",width:"20px",height:"20px",animation:"spin 1s linear infinite",margin:"0 auto"}},Bu=({cellInfo:t,onClaim:e,onClose:r,isClaimDisabled:i})=>{const{countryName:a,regionName:f,flagUrl:p,isLoading:h}=t,m=w=>{w.stopPropagation(),xi(),e()},x=w=>{w.stopPropagation(),xi(),r()};return Q.jsxs("div",{style:rt.container,onClick:w=>w.stopPropagation(),children:[Q.jsx("button",{style:rt.closeButton,onClick:x,children:"×"}),Q.jsx("div",{style:rt.header,children:h?Q.jsx("div",{style:rt.loader}):Q.jsxs(Q.Fragment,{children:[p&&Q.jsx("img",{src:p,alt:"Flag",style:rt.flag}),Q.jsxs("div",{style:rt.location,children:[Q.jsx("span",{style:rt.country,children:a}),Q.jsx("span",{style:rt.region,children:f}),Q.jsxs("span",{style:rt.coordinates,children:[t.position.lat.toFixed(4),", ",t.position.lng.toFixed(4)]})]})]})}),Q.jsxs("div",{style:rt.body,children:[Q.jsx("p",{style:rt.text,children:"Do you want to claim this area?"}),Q.jsxs("button",{style:rt.claimButton,onClick:m,disabled:i,children:[Q.jsx("span",{style:rt.cloudIcon,children:"☁️"}),"Claim"]})]})]})},oa=l.memo(Bu),vi={pulseContainer:{position:"absolute",transform:"translate(-50%, -50%)"},dot:{width:"16px",height:"16px",backgroundColor:"#3B82F6",borderRadius:"50%",border:"2px solid white",boxShadow:"0 0 8px rgba(0,0,0,0.3)"},pulse:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#3B82F6",animation:"pulse-animation 2s infinite",opacity:0}},Uu=`
  @keyframes pulse-animation {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.7;
    }
    100% {
      transform: translate(-50%, -50%) scale(4);
      opacity: 0;
    }
  }
`,zu=()=>(en.useEffect(()=>{const t=document.createElement("style");return t.innerHTML=Uu,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),null),Fu=({position:t})=>Q.jsxs(Q.Fragment,{children:[Q.jsx(zu,{}),Q.jsx(wt,{position:t,mapPaneName:wt.MARKER_LAYER,children:Q.jsxs("div",{style:vi.pulseContainer,children:[Q.jsx("div",{style:vi.pulse}),Q.jsx("div",{style:vi.dot})]})})]}),Ku=l.memo(Fu),Nt=(t,e,r,i=null,a=null)=>new Promise(f=>{a&&a(!0);const p=t.getCenter(),h=t.getZoom(),m=Date.now(),x=()=>{const w=Date.now(),b=Math.min((w-m)/r,1),C=b*b*(3-2*b),I={lat:p.lat()+(e.lat-p.lat())*C,lng:p.lng()+(e.lng-p.lng())*C},L=i!==null?h+(i-h)*C:h;t.moveCamera({center:I,zoom:L}),b<1?requestAnimationFrame(x):(a&&a(!1),f())};x()});let Un=null;function Nu(){return Un||(Un=new Promise((t,e)=>{const r=new Worker(new URL("/chill-demo/assets/data.worker-CHrZMG89.js",import.meta.url),{type:"module"});r.onmessage=i=>{i.data.success?t(i.data.users):(console.error("Error message from worker:",i.data.error),e(new Error(i.data.error))),r.terminate()},r.onerror=i=>{console.error("Error with worker:",i),e(new Error(`Worker error: ${i.message}`)),r.terminate(),Un=null},r.postMessage({csvPath:"/chill-demo/user_location.csv"})}),Un)}const qu=()=>{const t=document.createElement("canvas"),e=t.getContext("2d"),r=64;t.width=r,t.height=r,e.fillStyle="#E0E0E0",e.beginPath(),e.arc(r/2,r/2,r/2,0,Math.PI*2),e.fill(),e.fillStyle="#A0A0A0",e.beginPath(),e.arc(r/2,r/2-8,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(r/2,r/2+15,15,Math.PI,Math.PI*2,!1),e.fill();const i=new Image;return i.src=t.toDataURL(),i},Wu=({user:t,onClose:e})=>{const r=(i,a)=>!i||!a?{x:0,y:0}:{x:-(i/2),y:-(a+40)};return Q.jsx(wt,{position:{lat:t.lat,lng:t.lng},mapPaneName:wt.FLOAT_PANE,getPixelPositionOffset:r,children:Q.jsxs("div",{onMouseDown:i=>i.stopPropagation(),style:{background:"white",padding:"10px 15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",width:"150px"},children:[Q.jsx("img",{src:t.avatarUrl,alt:t.name,style:{width:"50px",height:"50px",borderRadius:"50%"}}),Q.jsx("strong",{style:{fontSize:"14px"},children:t.name||"Anonymous"}),Q.jsx("button",{onClick:e,style:{position:"absolute",top:"8px",right:"8px",background:"#F0F0F0",border:"none",fontSize:"14px",cursor:"pointer",color:"#888",zIndex:10,width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]})})},Zu=({map:t,users:e,isVisible:r})=>{const i=l.useRef(null),a=l.useRef(new Map).current,f=l.useRef(new Map).current,p=l.useRef(null),[h,m]=l.useState(null),[x,w]=l.useState(null),b=l.useCallback((C,I,L,j)=>{const K=document.createElement("canvas"),$=K.getContext("2d");return K.width=I,K.height=I,$.beginPath(),$.arc(I/2,I/2,I/2-j/2,0,Math.PI*2,!0),$.clip(),$.drawImage(C,0,0,I,I),$.beginPath(),$.arc(I/2,I/2,I/2-j/2,0,Math.PI*2,!0),$.strokeStyle=L,$.lineWidth=j,$.stroke(),K},[]);return p.current||(p.current=qu()),l.useEffect(()=>{if(!e||e.length===0)return;const C="/chill-demo/vite.svg";if(!a.has(C)){const I=new Image;I.crossOrigin="Anonymous",I.src=C;const L={image:I,loaded:!1};a.set(C,L),I.onload=()=>{L.loaded=!0;const j=b(I,128,"red",4);f.set(C,j)},I.onerror=()=>{L.loaded="error",L.image=p.current;const j=b(p.current,128,"red",4);f.set("default",j)}}},[e,a,f,b]),l.useEffect(()=>{if(!t)return;class C extends window.google.maps.OverlayView{constructor(){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="5",this.props={},this.mapDiv=null,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this)}setProps(j){this.props={...this.props,...j},this.draw()}onAdd(){this.getPanes().overlayLayer.appendChild(this.canvas),this.mapDiv=this.getMap().getDiv(),this.mapDiv.addEventListener("mousemove",this.handleMouseMove),this.mapDiv.addEventListener("click",this.handleClick)}onRemove(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.mapDiv&&(this.mapDiv.removeEventListener("mousemove",this.handleMouseMove),this.mapDiv.removeEventListener("click",this.handleClick),this.mapDiv=null)}findUserAtPixel(j,K){const $=this.getProjection();if(!$||!this.props.users)return null;const W=this.props.users.filter(A=>{const B=$.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!B)return!1;const T=Math.sqrt(Math.pow(j-B.x,2)+Math.pow(K-B.y,2)),H=this.getMap().getZoom(),U=Math.max(16,Math.min(80,(H-12)*8));return T<=U/2});let te=null,F=1/0;for(const A of W){const B=$.fromLatLngToDivPixel(new window.google.maps.LatLng(A.lat,A.lng));if(!B)continue;const T=Math.sqrt(Math.pow(j-B.x,2)+Math.pow(K-B.y,2));T<F&&(F=T,te=A)}return te}handleMouseMove(j){const K=this.findUserAtPixel(j.offsetX,j.offsetY);this.props.onSetHoveredUser(K),this.getMap().getDiv().style.cursor=K?"pointer":""}handleClick(j){const K=this.findUserAtPixel(j.offsetX,j.offsetY);K&&this.props.onSetClickedUser(K)}draw(){const j=this.getProjection();if(!j)return;const K=this.getMap().getBounds();if(!K)return;const $=this.getMap().getZoom(),W=.1,te=K.getSouthWest(),F=K.getNorthEast(),A=(F.lng()-te.lng())*W,B=(F.lat()-te.lat())*W,T=new window.google.maps.LatLngBounds(new window.google.maps.LatLng(te.lat()-B,te.lng()-A),new window.google.maps.LatLng(F.lat()+B,F.lng()+A)),H=j.fromLatLngToDivPixel(te),U=j.fromLatLngToDivPixel(F),ee=U.x-H.x,X=H.y-U.y;if(this.canvas.style.left=`${H.x}px`,this.canvas.style.top=`${U.y}px`,(this.canvas.width!==ee||this.canvas.height!==X)&&(this.canvas.width=ee,this.canvas.height=X,this.canvas.style.width=`${ee}px`,this.canvas.style.height=`${X}px`),this.ctx.clearRect(0,0,ee,X),!this.props.isVisible)return;$<12?this.drawClusters(j,H,U,T):this.drawIndividualMarkers(j,H,U,T)}drawSingleMarker(j,K,$,W){const{renderedImageCache:te,hoveredUser:F}=this.props,A=K.fromLatLngToDivPixel(new window.google.maps.LatLng(j.lat,j.lng));if(!A)return;const B=A.x-$.x,T=A.y-W.y,H=this.getMap().getZoom(),U=Math.max(16,Math.min(80,(H-12)*8)),ee=F&&F.seq===j.seq;let oe=te.get("/chill-demo/vite.svg")||te.get("default");oe?this.ctx.drawImage(oe,B-U/2,T-U/2,U,U):(this.ctx.beginPath(),this.ctx.arc(B,T,U/2,0,Math.PI*2,!0),this.ctx.fillStyle=ee?"#007BFF":"#E0E0E0",this.ctx.fill()),this.ctx.beginPath(),this.ctx.arc(B,T,U/2,0,Math.PI*2,!0),this.ctx.strokeStyle=ee?"#007BFF":"red",this.ctx.lineWidth=ee?6:2,this.ctx.stroke()}drawClusters(j,K,$,W){const{users:te}=this.props,F=this.getMap().getZoom(),A=1/Math.pow(2,F-5),B=new Map,T=te.filter(H=>W.contains({lat:H.lat,lng:H.lng}));for(const H of T){const U=`${Math.floor(H.lat/A)}|${Math.floor(H.lng/A)}`;B.has(U)||B.set(U,{points:[],sumLat:0,sumLng:0});const ee=B.get(U);ee.points.push(H),ee.sumLat+=H.lat,ee.sumLng+=H.lng}for(const H of B.values()){const U=H.points.length;if(U>1){const ee=H.sumLat/U,X=H.sumLng/U,oe=j.fromLatLngToDivPixel(new window.google.maps.LatLng(ee,X));if(!oe)continue;const ue=oe.x-K.x,pe=oe.y-$.y,he=18+Math.log2(U)*2;this.ctx.beginPath(),this.ctx.arc(ue,pe,he,0,Math.PI*2),this.ctx.fillStyle="rgba(0, 123, 255, 0.7)",this.ctx.fill(),this.ctx.strokeStyle="rgba(0, 123, 255, 1)",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 18px sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(U,ue,pe)}else this.drawSingleMarker(H.points[0],j,K,$)}}drawIndividualMarkers(j,K,$,W){const{users:te}=this.props;for(const F of te)W.contains({lat:F.lat,lng:F.lng})&&this.drawSingleMarker(F,j,K,$)}}const I=new C;return I.setMap(t),i.current=I,()=>{i.current&&i.current.setMap(null)}},[t,b]),l.useEffect(()=>{i.current&&i.current.setProps({users:e,renderedImageCache:f,imageCache:a,isVisible:r,defaultAvatarRef:p.current,hoveredUser:h,clickedUser:x,onSetHoveredUser:m,onSetClickedUser:w})},[e,f,r,h,x,a]),Q.jsx(Q.Fragment,{children:x&&Q.jsx(Wu,{user:x,onClose:()=>w(null)})})},$u=({label:t,checked:e,onChange:r})=>{const i=l.useId(),a=f=>{r&&r(f.target.checked)};return Q.jsxs("div",{className:"toggle-switch-container",children:[t&&Q.jsx("label",{htmlFor:i,className:"toggle-switch-label",children:t}),Q.jsxs("label",{htmlFor:i,className:"toggle-switch",children:[Q.jsx("input",{type:"checkbox",id:i,checked:e,onChange:a}),Q.jsx("span",{className:"slider"})]})]})},zt=5e-4,Vu={width:"100%",height:"100%"},Hu={position:"absolute",inset:"0px",width:"100%",height:"100%"},Gu=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]}],Yu={topRightContainer:{position:"absolute",top:"20px",right:"70px",zIndex:50,display:"flex",flexDirection:"column",gap:"12px",alignItems:"flex-end"}},Xu=({center:t,onSelectCell:e,claimedCells:r,exploredCells:i,setMapRef:a,onZoomChanged:f,onCenterChanged:p,selectedCell:h,userLocation:m,onZoomOutLimit:x,effects:w})=>{const[b,C]=l.useState(null),[I,L]=l.useState(15),[j,K]=l.useState(null),$=l.useRef(null),W=l.useRef(!1),te=l.useRef(null),F=150,[A,B]=l.useState(!1),[T,H]=l.useState([]),[U,ee]=l.useState(!1);l.useEffect(()=>{Nu().then(H)},[]);const X=l.useCallback(fe=>{K(fe),a(fe)},[a]),oe=l.useCallback(()=>{if(!j||!W.current)return;const fe=j.getZoom(),ce=j.getCenter();fe<=5&&x(),f(fe),p({lat:ce.lat(),lng:ce.lng()}),L(fe)},[j,f,p,x]);l.useEffect(()=>{(async()=>{j&&t&&!W.current&&(await Nt(j,t,2e3,16,B),W.current=!0,oe())})()},[j,t,oe,B]);const ue=l.useCallback(fe=>{$.current||($.current=setTimeout(()=>{if($.current=null,I<15){b&&C(null);return}const ce=`${Math.floor(fe.latLng.lat()/zt)}_${Math.floor(fe.latLng.lng()/zt)}`;ce!==b&&C(ce)},50))},[I,b,C]),pe=l.useCallback(()=>{C(null)},[C]),he=l.useCallback(fe=>{const ce=fe.latLng.lat(),Le=fe.latLng.lng(),Ce=Math.floor(ce/zt),ge=Math.floor(Le/zt),Re=`${Ce}_${ge}`,Z=Ce*zt,Ae=ge*zt,Be=Z+zt/2,Y=Ae+zt/2;e(Re,{lat:Be,lng:Y})},[e]),ve=l.useCallback(async fe=>{fe.preventDefault(),!te.current&&(te.current=setTimeout(async()=>{if(te.current=null,!j)return;const ce=j.getZoom(),Le=fe.deltaY<0?ce+1:ce-1,Ce=Math.max(2,Math.min(20,Le));Ce!==ce&&await Nt(j,j.getCenter().toJSON(),300,Ce,B)},F))},[j,B]),we=l.useCallback(()=>{if(!j)return;const fe=j.getCenter();p({lat:fe.lat(),lng:fe.lng()})},[j,p]),ye=l.useRef(null);return l.useEffect(()=>{const fe=ye.current;if(fe)return fe.addEventListener("wheel",ve,{passive:!1}),()=>{fe.removeEventListener("wheel",ve)}},[ve]),Q.jsxs("div",{ref:ye,className:"view-container fade-in",style:Hu,children:[Q.jsx("div",{style:Yu.topRightContainer,children:Q.jsx($u,{label:"顯示佔領區域",checked:U,onChange:ee})}),Q.jsxs(Ya,{mapContainerStyle:Vu,center:t,zoom:3,options:{disableDefaultUI:!0,gestureHandling:"greedy",zoomControl:!1,tilt:0,mapTypeId:"roadmap",styles:Gu,minZoom:2,maxZoom:20,scrollwheel:!1},onLoad:X,onIdle:oe,onDragEnd:we,onMouseMove:ue,onMouseOut:pe,onClick:he,children:[Q.jsx(Tu,{map:j,zoom:I,claimedCells:U?r:[],exploredCells:U?i:[],hoveredCell:b,isAnimating:A,selectedCell:h,effects:w}),j&&T.length>0&&Q.jsx(Zu,{map:j,users:T,isVisible:!0}),h&&Q.jsx(oa,{cellInfo:h}),m&&Q.jsx(Ku,{position:m})]})]})},Ju=en.memo(Xu),js=t=>{let e;const r=new Set,i=(x,w)=>{const b=typeof x=="function"?x(e):x;if(!Object.is(b,e)){const C=e;e=w??(typeof b!="object"||b===null)?b:Object.assign({},e,b),r.forEach(I=>I(e,C))}},a=()=>e,h={setState:i,getState:a,getInitialState:()=>m,subscribe:x=>(r.add(x),()=>r.delete(x))},m=e=t(i,a,h);return h},Qu=(t=>t?js(t):js),ec=t=>t;function tc(t,e=ec){const r=en.useSyncExternalStore(t.subscribe,en.useCallback(()=>e(t.getState()),[t,e]),en.useCallback(()=>e(t.getInitialState()),[t,e]));return en.useDebugValue(r),r}const Rs=t=>{const e=Qu(t),r=i=>tc(e,i);return Object.assign(r,e),r},nc=(t=>t?Rs(t):Rs);var sa=Symbol.for("immer-nothing"),Ts=Symbol.for("immer-draftable"),st=Symbol.for("immer-state");function ft(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Nn=Object.getPrototypeOf;function wn(t){return!!t&&!!t[st]}function tn(t){return t?aa(t)||Array.isArray(t)||!!t[Ts]||!!t.constructor?.[Ts]||Zn(t)||Br(t):!1}var rc=Object.prototype.constructor.toString(),As=new WeakMap;function aa(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let i=As.get(r);return i===void 0&&(i=Function.toString.call(r),As.set(r,i)),i===rc}function Ir(t,e,r=!0){Ar(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((i,a)=>e(a,i,t))}function Ar(t){const e=t[st];return e?e.type_:Array.isArray(t)?1:Zn(t)?2:Br(t)?3:0}function Ci(t,e){return Ar(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function la(t,e,r){const i=Ar(t);i===2?t.set(e,r):i===3?t.add(r):t[e]=r}function ic(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Zn(t){return t instanceof Map}function Br(t){return t instanceof Set}function Jt(t){return t.copy_||t.base_}function Ei(t,e){if(Zn(t))return new Map(t);if(Br(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=aa(t);if(e===!0||e==="class_only"&&!r){const i=Object.getOwnPropertyDescriptors(t);delete i[st];let a=Reflect.ownKeys(i);for(let f=0;f<a.length;f++){const p=a[f],h=i[p];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&(i[p]={configurable:!0,writable:!0,enumerable:h.enumerable,value:t[p]})}return Object.create(Nn(t),i)}else{const i=Nn(t);if(i!==null&&r)return{...t};const a=Object.create(i);return Object.assign(a,t)}}function Ti(t,e=!1){return Ur(t)||wn(t)||!tn(t)||(Ar(t)>1&&Object.defineProperties(t,{set:br,add:br,clear:br,delete:br}),Object.freeze(t),e&&Object.values(t).forEach(r=>Ti(r,!0))),t}function oc(){ft(2)}var br={value:oc};function Ur(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var sc={};function nn(t){const e=sc[t];return e||ft(0,t),e}var qn;function ua(){return qn}function ac(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Bs(t,e){e&&(nn("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Mi(t){ki(t),t.drafts_.forEach(lc),t.drafts_=null}function ki(t){t===qn&&(qn=t.parent_)}function Us(t){return qn=ac(qn,t)}function lc(t){const e=t[st];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zs(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[st].modified_&&(Mi(e),ft(4)),tn(t)&&(t=jr(e,t),e.parent_||Rr(e,t)),e.patches_&&nn("Patches").generateReplacementPatches_(r[st].base_,t,e.patches_,e.inversePatches_)):t=jr(e,r,[]),Mi(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==sa?t:void 0}function jr(t,e,r){if(Ur(e))return e;const i=t.immer_.shouldUseStrictIteration(),a=e[st];if(!a)return Ir(e,(f,p)=>Fs(t,a,e,f,p,r),i),e;if(a.scope_!==t)return e;if(!a.modified_)return Rr(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const f=a.copy_;let p=f,h=!1;a.type_===3&&(p=new Set(f),f.clear(),h=!0),Ir(p,(m,x)=>Fs(t,a,f,m,x,r,h),i),Rr(t,f,!1),r&&t.patches_&&nn("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function Fs(t,e,r,i,a,f,p){if(a==null||typeof a!="object"&&!p)return;const h=Ur(a);if(!(h&&!p)){if(wn(a)){const m=f&&e&&e.type_!==3&&!Ci(e.assigned_,i)?f.concat(i):void 0,x=jr(t,a,m);if(la(r,i,x),wn(x))t.canAutoFreeze_=!1;else return}else p&&r.add(a);if(tn(a)&&!h){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===a&&h)return;jr(t,a),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Zn(r)?r.has(i):Object.prototype.propertyIsEnumerable.call(r,i))&&Rr(t,a)}}}function Rr(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ti(e,r)}function uc(t,e){const r=Array.isArray(t),i={type_:r?1:0,scope_:e?e.scope_:ua(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,f=Ai;r&&(a=[i],f=Wn);const{revoke:p,proxy:h}=Proxy.revocable(a,f);return i.draft_=h,i.revoke_=p,h}var Ai={get(t,e){if(e===st)return t;const r=Jt(t);if(!Ci(r,e))return cc(t,r,e);const i=r[e];return t.finalized_||!tn(i)?i:i===yi(t.base_,e)?(bi(t),t.copy_[e]=Pi(i,t)):i},has(t,e){return e in Jt(t)},ownKeys(t){return Reflect.ownKeys(Jt(t))},set(t,e,r){const i=ca(Jt(t),e);if(i?.set)return i.set.call(t.draft_,r),!0;if(!t.modified_){const a=yi(Jt(t),e),f=a?.[st];if(f&&f.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(ic(r,a)&&(r!==void 0||Ci(t.base_,e)))return!0;bi(t),Si(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return yi(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bi(t),Si(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Jt(t),i=Reflect.getOwnPropertyDescriptor(r,e);return i&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:i.enumerable,value:r[e]}},defineProperty(){ft(11)},getPrototypeOf(t){return Nn(t.base_)},setPrototypeOf(){ft(12)}},Wn={};Ir(Ai,(t,e)=>{Wn[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wn.deleteProperty=function(t,e){return Wn.set.call(this,t,e,void 0)};Wn.set=function(t,e,r){return Ai.set.call(this,t[0],e,r,t[0])};function yi(t,e){const r=t[st];return(r?Jt(r):t)[e]}function cc(t,e,r){const i=ca(e,r);return i?"value"in i?i.value:i.get?.call(t.draft_):void 0}function ca(t,e){if(!(e in t))return;let r=Nn(t);for(;r;){const i=Object.getOwnPropertyDescriptor(r,e);if(i)return i;r=Nn(r)}}function Si(t){t.modified_||(t.modified_=!0,t.parent_&&Si(t.parent_))}function bi(t){t.copy_||(t.copy_=Ei(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var fc=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,i)=>{if(typeof e=="function"&&typeof r!="function"){const f=r;r=e;const p=this;return function(m=f,...x){return p.produce(m,w=>r.call(this,w,...x))}}typeof r!="function"&&ft(6),i!==void 0&&typeof i!="function"&&ft(7);let a;if(tn(e)){const f=Us(this),p=Pi(e,void 0);let h=!0;try{a=r(p),h=!1}finally{h?Mi(f):ki(f)}return Bs(f,i),zs(a,f)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===sa&&(a=void 0),this.autoFreeze_&&Ti(a,!0),i){const f=[],p=[];nn("Patches").generateReplacementPatches_(e,a,f,p),i(f,p)}return a}else ft(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(p,...h)=>this.produceWithPatches(p,m=>e(m,...h));let i,a;return[this.produce(e,r,(p,h)=>{i=p,a=h}),i,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){tn(t)||ft(8),wn(t)&&(t=dc(t));const e=Us(this),r=Pi(t,void 0);return r[st].isManual_=!0,ki(e),r}finishDraft(t,e){const r=t&&t[st];(!r||!r.isManual_)&&ft(9);const{scope_:i}=r;return Bs(i,e),zs(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const i=nn("Patches").applyPatches_;return wn(t)?i(t,e):this.produce(t,a=>i(a,e))}};function Pi(t,e){const r=Zn(t)?nn("MapSet").proxyMap_(t,e):Br(t)?nn("MapSet").proxySet_(t,e):uc(t,e);return(e?e.scope_:ua()).drafts_.push(r),r}function dc(t){return wn(t)||ft(10,t),fa(t)}function fa(t){if(!tn(t)||Ur(t))return t;const e=t[st];let r,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ei(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else r=Ei(t,!0);return Ir(r,(a,f)=>{la(r,a,fa(f))},i),e&&(e.finalized_=!1),r}var pc=new fc,hc=pc.produce;const gc=t=>(e,r,i)=>(i.setState=(a,f,...p)=>{const h=typeof a=="function"?hc(a):a;return e(h,f,...p)},t(i.setState,r,i)),mc=gc;var xr={exports:{}},vc=xr.exports,Ks;function yc(){return Ks||(Ks=1,(function(t,e){(function(r,i){t.exports=i()})(vc,function(){var r=function(n,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(s[c]=u[c])})(n,o)},i=function(){return(i=Object.assign||function(n){for(var o,s=1,u=arguments.length;s<u;s++)for(var c in o=arguments[s])Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c]);return n}).apply(this,arguments)};function a(n,o,s){for(var u,c=0,d=o.length;c<d;c++)!u&&c in o||((u=u||Array.prototype.slice.call(o,0,c))[c]=o[c]);return n.concat(u||Array.prototype.slice.call(o))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ta,p=Object.keys,h=Array.isArray;function m(n,o){return typeof o!="object"||p(o).forEach(function(s){n[s]=o[s]}),n}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var x=Object.getPrototypeOf,w={}.hasOwnProperty;function b(n,o){return w.call(n,o)}function C(n,o){typeof o=="function"&&(o=o(x(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(o).forEach(function(s){L(n,s,o[s])})}var I=Object.defineProperty;function L(n,o,s,u){I(n,o,m(s&&b(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},u))}function j(n){return{from:function(o){return n.prototype=Object.create(o.prototype),L(n.prototype,"constructor",n),{extend:C.bind(null,n.prototype)}}}}var K=Object.getOwnPropertyDescriptor,$=[].slice;function W(n,o,s){return $.call(n,o,s)}function te(n,o){return o(n)}function F(n){if(!n)throw new Error("Assertion Failed")}function A(n){f.setImmediate?setImmediate(n):setTimeout(n,0)}function B(n,o){if(typeof o=="string"&&b(n,o))return n[o];if(!o)return n;if(typeof o!="string"){for(var s=[],u=0,c=o.length;u<c;++u){var d=B(n,o[u]);s.push(d)}return s}var g=o.indexOf(".");if(g!==-1){var v=n[o.substr(0,g)];return v==null?void 0:B(v,o.substr(g+1))}}function T(n,o,s){if(n&&o!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof o!="string"&&"length"in o){F(typeof s!="string"&&"length"in s);for(var u=0,c=o.length;u<c;++u)T(n,o[u],s[u])}else{var d,g,v=o.indexOf(".");v!==-1?(d=o.substr(0,v),(g=o.substr(v+1))===""?s===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=s:T(v=!(v=n[d])||!b(n,d)?n[d]={}:v,g,s)):s===void 0?h(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=s}}function H(n){var o,s={};for(o in n)b(n,o)&&(s[o]=n[o]);return s}var U=[].concat;function ee(n){return U.apply([],n)}var pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ee([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(o){return o+n+"Array"})}))).filter(function(n){return f[n]}),X=new Set(pt.map(function(n){return f[n]})),oe=null;function ue(n){return oe=new WeakMap,n=(function o(s){if(!s||typeof s!="object")return s;var u=oe.get(s);if(u)return u;if(h(s)){u=[],oe.set(s,u);for(var c=0,d=s.length;c<d;++c)u.push(o(s[c]))}else if(X.has(s.constructor))u=s;else{var g,v=x(s);for(g in u=v===Object.prototype?{}:Object.create(v),oe.set(s,u),s)b(s,g)&&(u[g]=o(s[g]))}return u})(n),oe=null,n}var pe={}.toString;function he(n){return pe.call(n).slice(8,-1)}var ve=typeof Symbol<"u"?Symbol.iterator:"@@iterator",we=typeof ve=="symbol"?function(n){var o;return n!=null&&(o=n[ve])&&o.apply(n)}:function(){return null};function ye(n,o){return o=n.indexOf(o),0<=o&&n.splice(o,1),0<=o}var fe={};function ce(n){var o,s,u,c;if(arguments.length===1){if(h(n))return n.slice();if(this===fe&&typeof n=="string")return[n];if(c=we(n)){for(s=[];!(u=c.next()).done;)s.push(u.value);return s}if(n==null)return[n];if(typeof(o=n.length)!="number")return[n];for(s=new Array(o);o--;)s[o]=n[o];return s}for(o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return s}var Le=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Pt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Pt),Ce={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ge(n,o){this.name=n,this.message=o}function Re(n,o){return n+". Errors: "+Object.keys(o).map(function(s){return o[s].toString()}).filter(function(s,u,c){return c.indexOf(s)===u}).join(`
`)}function Z(n,o,s,u){this.failures=o,this.failedKeys=u,this.successCount=s,this.message=Re(n,o)}function Ae(n,o){this.name="BulkError",this.failures=Object.keys(o).map(function(s){return o[s]}),this.failuresByPos=o,this.message=Re(n,this.failures)}j(ge).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j(Z).from(ge),j(Ae).from(ge);var Be=lt.reduce(function(n,o){return n[o]=o+"Error",n},{}),Y=ge,G=lt.reduce(function(n,o){var s=o+"Error";function u(c,d){this.name=s,c?typeof c=="string"?(this.message="".concat(c).concat(d?`
 `+d:""),this.inner=d||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=Ce[o]||s,this.inner=null)}return j(u).from(Y),n[o]=u,n},{});G.Syntax=SyntaxError,G.Type=TypeError,G.Range=RangeError;var be=Pt.reduce(function(n,o){return n[o+"Error"]=G[o],n},{}),De=lt.reduce(function(n,o){return["Syntax","Type","Range"].indexOf(o)===-1&&(n[o+"Error"]=G[o]),n},{});function Se(){}function Xe(n){return n}function Wt(n,o){return n==null||n===Xe?o:function(s){return o(n(s))}}function je(n,o){return function(){n.apply(this,arguments),o.apply(this,arguments)}}function $n(n,o){return n===Se?o:function(){var s=n.apply(this,arguments);s!==void 0&&(arguments[0]=s);var u=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var d=o.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?je(u,this.onsuccess):u),c&&(this.onerror=this.onerror?je(c,this.onerror):c),d!==void 0?d:s}}function rn(n,o){return n===Se?o:function(){n.apply(this,arguments);var s=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,o.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?je(s,this.onsuccess):s),u&&(this.onerror=this.onerror?je(u,this.onerror):u)}}function Vn(n,o){return n===Se?o:function(s){var u=n.apply(this,arguments);m(s,u);var c=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=o.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?je(c,this.onsuccess):c),d&&(this.onerror=this.onerror?je(d,this.onerror):d),u===void 0?s===void 0?void 0:s:m(u,s)}}function on(n,o){return n===Se?o:function(){return o.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function sn(n,o){return n===Se?o:function(){var s=n.apply(this,arguments);if(s&&typeof s.then=="function"){for(var u=this,c=arguments.length,d=new Array(c);c--;)d[c]=arguments[c];return s.then(function(){return o.apply(u,d)})}return o.apply(this,arguments)}}De.ModifyError=Z,De.DexieError=ge,De.BulkError=Ae;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xn(n){Je=n}var dt={},Cn=100,pt=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,x(n),n];var o=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[o,x(o),n]})(),Pt=pt[0],lt=pt[1],pt=pt[2],lt=lt&&lt.then,at=Pt&&Pt.constructor,an=!!pt,ht=function(n,o){mt.push([n,o]),Lt&&(queueMicrotask(fn),Lt=!1)},ln=!0,Lt=!0,gt=[],xt=[],un=Xe,et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},me=et,mt=[],vt=0,Ct=[];function le(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var o=this._PSD=me;if(typeof n!="function"){if(n!==dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ot(this,this._value))}this._state=null,this._value=null,++o.ref,(function s(u,c){try{c(function(d){if(u._state===null){if(d===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&Et();d&&typeof d.then=="function"?s(u,function(v,E){d instanceof le?d._then(v,E):d.then(v,E)}):(u._state=!0,u._value=d,Mn(u)),g&&Dt()}},Ot.bind(null,u))}catch(d){Ot(u,d)}})(this,n)}var cn={get:function(){var n=me,o=Xn;function s(u,c){var d=this,g=!n.global&&(n!==me||o!==Xn),v=g&&!jt(),E=new le(function(M,O){_t(d,new En(Ui(u,n,g,v),Ui(c,n,g,v),M,O,n))});return this._consoleTask&&(E._consoleTask=this._consoleTask),E}return s.prototype=dt,s},set:function(n){L(this,"then",n&&n.prototype===dt?cn:{get:function(){return n},set:cn.set})}};function En(n,o,s,u,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof o=="function"?o:null,this.resolve=s,this.reject=u,this.psd=c}function Ot(n,o){var s,u;xt.push(o),n._state===null&&(s=n._lib&&Et(),o=un(o),n._state=!1,n._value=o,u=n,gt.some(function(c){return c._value===u._value})||gt.push(u),Mn(n),s&&Dt())}function Mn(n){var o=n._listeners;n._listeners=[];for(var s=0,u=o.length;s<u;++s)_t(n,o[s]);var c=n._PSD;--c.ref||c.finalize(),vt===0&&(++vt,ht(function(){--vt==0&&Mt()},[]))}function _t(n,o){if(n._state!==null){var s=n._state?o.onFulfilled:o.onRejected;if(s===null)return(n._state?o.resolve:o.reject)(n._value);++o.psd.ref,++vt,ht(Hn,[s,n,o])}else n._listeners.push(o)}function Hn(n,o,s){try{var u,c=o._value;!o._state&&xt.length&&(xt=[]),u=Je&&o._consoleTask?o._consoleTask.run(function(){return n(c)}):n(c),o._state||xt.indexOf(c)!==-1||(function(d){for(var g=gt.length;g;)if(gt[--g]._value===d._value)return gt.splice(g,1)})(o),s.resolve(u)}catch(d){s.reject(d)}finally{--vt==0&&Mt(),--s.psd.ref||s.psd.finalize()}}function fn(){Zt(et,function(){Et()&&Dt()})}function Et(){var n=ln;return Lt=ln=!1,n}function Dt(){var n,o,s;do for(;0<mt.length;)for(n=mt,mt=[],s=n.length,o=0;o<s;++o){var u=n[o];u[0].apply(null,u[1])}while(0<mt.length);Lt=ln=!0}function Mt(){var n=gt;gt=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var o=Ct.slice(0),s=o.length;s;)o[--s]()}function xe(n){return new le(dt,!1,n)}function Ke(n,o){var s=me;return function(){var u=Et(),c=me;try{return Rt(s,!0),n.apply(this,arguments)}catch(d){o&&o(d)}finally{Rt(c,!1),u&&Dt()}}}C(le.prototype,{then:cn,_then:function(n,o){_t(this,new En(null,null,n,o,me))},catch:function(n){if(arguments.length===1)return this.then(null,n);var o=n,s=arguments[1];return typeof o=="function"?this.then(null,function(u){return(u instanceof o?s:xe)(u)}):this.then(null,function(u){return(u&&u.name===o?s:xe)(u)})},finally:function(n){return this.then(function(o){return le.resolve(n()).then(function(){return o})},function(o){return le.resolve(n()).then(function(){return xe(o)})})},timeout:function(n,o){var s=this;return n<1/0?new le(function(u,c){var d=setTimeout(function(){return c(new G.Timeout(o))},n);s.then(u,c).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&L(le.prototype,Symbol.toStringTag,"Dexie.Promise"),et.env=Bi(),C(le,{all:function(){var n=ce.apply(null,arguments).map(Jn);return new le(function(o,s){n.length===0&&o([]);var u=n.length;n.forEach(function(c,d){return le.resolve(c).then(function(g){n[d]=g,--u||o(n)},s)})})},resolve:function(n){return n instanceof le?n:n&&typeof n.then=="function"?new le(function(o,s){n.then(o,s)}):new le(dt,!0,n)},reject:xe,race:function(){var n=ce.apply(null,arguments).map(Jn);return new le(function(o,s){n.map(function(u){return le.resolve(u).then(o,s)})})},PSD:{get:function(){return me},set:function(n){return me=n}},totalEchoes:{get:function(){return Xn}},newPSD:It,usePSD:Zt,scheduler:{get:function(){return ht},set:function(n){ht=n}},rejectionMapper:{get:function(){return un},set:function(n){un=n}},follow:function(n,o){return new le(function(s,u){return It(function(c,d){var g=me;g.unhandleds=[],g.onunhandled=d,g.finalize=je(function(){var v,E=this;v=function(){E.unhandleds.length===0?c():d(E.unhandleds[0])},Ct.push(function M(){v(),Ct.splice(Ct.indexOf(M),1)}),++vt,ht(function(){--vt==0&&Mt()},[])},g.finalize),n()},o,s,u)})}}),at&&(at.allSettled&&L(le,"allSettled",function(){var n=ce.apply(null,arguments).map(Jn);return new le(function(o){n.length===0&&o([]);var s=n.length,u=new Array(s);n.forEach(function(c,d){return le.resolve(c).then(function(g){return u[d]={status:"fulfilled",value:g}},function(g){return u[d]={status:"rejected",reason:g}}).then(function(){return--s||o(u)})})})}),at.any&&typeof AggregateError<"u"&&L(le,"any",function(){var n=ce.apply(null,arguments).map(Jn);return new le(function(o,s){n.length===0&&s(new AggregateError([]));var u=n.length,c=new Array(u);n.forEach(function(d,g){return le.resolve(d).then(function(v){return o(v)},function(v){c[g]=v,--u||s(new AggregateError(c))})})})}),at.withResolvers&&(le.withResolvers=at.withResolvers));var Ze={awaits:0,echoes:0,id:0},da=0,Gn=[],Yn=0,Xn=0,pa=0;function It(n,o,s,u){var c=me,d=Object.create(c);return d.parent=c,d.ref=0,d.global=!1,d.id=++pa,et.env,d.env=an?{Promise:le,PromiseProp:{value:le,configurable:!0,writable:!0},all:le.all,race:le.race,allSettled:le.allSettled,any:le.any,resolve:le.resolve,reject:le.reject}:{},o&&m(d,o),++c.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},u=Zt(d,n,s,u),d.ref===0&&d.finalize(),u}function dn(){return Ze.id||(Ze.id=++da),++Ze.awaits,Ze.echoes+=Cn,Ze.id}function jt(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*Cn,!0)}function Jn(n){return Ze.echoes&&n&&n.constructor===at?(dn(),n.then(function(o){return jt(),o},function(o){return jt(),Ne(o)})):n}function ha(){var n=Gn[Gn.length-1];Gn.pop(),Rt(n,!1)}function Rt(n,o){var s,u=me;(o?!Ze.echoes||Yn++&&n===me:!Yn||--Yn&&n===me)||queueMicrotask(o?(function(c){++Xn,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Gn.push(me),Rt(c,!0)}).bind(null,n):ha),n!==me&&(me=n,u===et&&(et.env=Bi()),an&&(s=et.env.Promise,o=n.env,(u.global||n.global)&&(Object.defineProperty(f,"Promise",o.PromiseProp),s.all=o.all,s.race=o.race,s.resolve=o.resolve,s.reject=o.reject,o.allSettled&&(s.allSettled=o.allSettled),o.any&&(s.any=o.any))))}function Bi(){var n=f.Promise;return an?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Zt(n,o,s,u,c){var d=me;try{return Rt(n,!0),o(s,u,c)}finally{Rt(d,!1)}}function Ui(n,o,s,u){return typeof n!="function"?n:function(){var c=me;s&&dn(),Rt(o,!0);try{return n.apply(this,arguments)}finally{Rt(c,!1),u&&queueMicrotask(jt)}}}function zr(n){Promise===at&&Ze.echoes===0?Yn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+lt).indexOf("[native code]")===-1&&(dn=jt=Se);var Ne=le.reject,$t="￿",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",pn=[],Qn="__dbnames",Fr="readonly",Kr="readwrite";function Vt(n,o){return n?o?function(){return n.apply(this,arguments)&&o.apply(this,arguments)}:n:o}var Fi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function er(n){return typeof n!="string"||/\./.test(n)?function(o){return o}:function(o){return o[n]===void 0&&n in o&&delete(o=ue(o))[n],o}}function Ki(){throw G.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Te(n,o){try{var s=Ni(n),u=Ni(o);if(s!==u)return s==="Array"?1:u==="Array"?-1:s==="binary"?1:u==="binary"?-1:s==="string"?1:u==="string"?-1:s==="Date"?1:u!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return o<n?1:n<o?-1:0;case"binary":return(function(c,d){for(var g=c.length,v=d.length,E=g<v?g:v,M=0;M<E;++M)if(c[M]!==d[M])return c[M]<d[M]?-1:1;return g===v?0:g<v?-1:1})(qi(n),qi(o));case"Array":return(function(c,d){for(var g=c.length,v=d.length,E=g<v?g:v,M=0;M<E;++M){var O=Te(c[M],d[M]);if(O!==0)return O}return g===v?0:g<v?-1:1})(n,o)}}catch{}return NaN}function Ni(n){var o=typeof n;return o!="object"?o:ArrayBuffer.isView(n)?"binary":(n=he(n),n==="ArrayBuffer"?"binary":n)}function qi(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function tr(n,o,s){var u=n.schema.yProps;return u?(o&&0<s.numFailures&&(o=o.filter(function(c,d){return!s.failures[d]})),Promise.all(u.map(function(c){return c=c.updatesTable,o?n.db.table(c).where("k").anyOf(o).delete():n.db.table(c).clear()})).then(function(){return s})):s}var kn=(Wi.prototype.execute=function(n){var o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(h(s))return a(a([],h(n)?n:[],!0),s).sort();if(typeof s=="number")return(Number(n)||0)+s;if(typeof s=="bigint")try{return BigInt(n)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var u=o.remove;if(h(u))return h(n)?n.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return s=(s=o.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof n=="string"&&n.startsWith(s)?o.replacePrefix[1]+n.substring(s.length):n},Wi);function Wi(n){this["@@propmod"]=n}function Zi(n,o){for(var s=p(o),u=s.length,c=!1,d=0;d<u;++d){var g=s[d],v=o[g],E=B(n,g);v instanceof kn?(T(n,g,v.execute(E)),c=!0):E!==v&&(T(n,g,v),c=!0)}return c}var $i=(Fe.prototype._trans=function(n,o,s){var u=this._tx||me.trans,c=this.name,d=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(M,O,y){if(!y.schema[c])throw new G.NotFound("Table "+c+" not part of transaction");return o(y.idbtrans,y)}var v=Et();try{var E=u&&u.db._novip===this.db._novip?u===me.trans?u._promise(n,g,s):It(function(){return u._promise(n,g,s)},{trans:u,transless:me.transless||me}):(function M(O,y,D,k){if(O.idbdb&&(O._state.openComplete||me.letThrough||O._vip)){var S=O._createTransaction(y,D,O._dbSchema);try{S.create(),O._state.PR1398_maxLoop=3}catch(P){return P.name===Be.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return M(O,y,D,k)})):Ne(P)}return S._promise(y,function(P,_){return It(function(){return me.trans=S,k(P,_,S)})}).then(function(P){if(y==="readwrite")try{S.idbtrans.commit()}catch{}return y==="readonly"?P:S._completion.then(function(){return P})})}if(O._state.openComplete)return Ne(new G.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return Ne(new G.DatabaseClosed);O.open().catch(Se)}return O._state.dbReadyPromise.then(function(){return M(O,y,D,k)})})(this.db,n,[this.name],g);return d&&(E._consoleTask=d,E=E.catch(function(M){return console.trace(M),Ne(M)})),E}finally{v&&Dt()}},Fe.prototype.get=function(n,o){var s=this;return n&&n.constructor===Object?this.where(n).first(o):n==null?Ne(new G.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return s.core.get({trans:u,key:n}).then(function(c){return s.hook.reading.fire(c)})}).then(o)},Fe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(h(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var o=p(n);if(o.length===1)return this.where(o[0]).equals(n[o[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&o.every(function(M){return 0<=v.keyPath.indexOf(M)})){for(var E=0;E<o.length;++E)if(o.indexOf(v.keyPath[E])===-1)return!1;return!0}return!1}).sort(function(v,E){return v.keyPath.length-E.keyPath.length})[0];if(s&&this.db._maxKey!==$t){var d=s.keyPath.slice(0,o.length);return this.where(d).equals(d.map(function(E){return n[E]}))}!s&&Je&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var u=this.schema.idxByName;function c(v,E){return Te(v,E)===0}var g=o.reduce(function(y,E){var M=y[0],O=y[1],y=u[E],D=n[E];return[M||y,M||!y?Vt(O,y&&y.multi?function(k){return k=B(k,E),h(k)&&k.some(function(S){return c(D,S)})}:function(k){return c(D,B(k,E))}):O]},[null,null]),d=g[0],g=g[1];return d?this.where(d.name).equals(n[d.keyPath]).filter(g):s?this.filter(g):this.where(o).equals("")},Fe.prototype.filter=function(n){return this.toCollection().and(n)},Fe.prototype.count=function(n){return this.toCollection().count(n)},Fe.prototype.offset=function(n){return this.toCollection().offset(n)},Fe.prototype.limit=function(n){return this.toCollection().limit(n)},Fe.prototype.each=function(n){return this.toCollection().each(n)},Fe.prototype.toArray=function(n){return this.toCollection().toArray(n)},Fe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Fe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,h(n)?"[".concat(n.join("+"),"]"):n))},Fe.prototype.reverse=function(){return this.toCollection().reverse()},Fe.prototype.mapToClass=function(n){var o,s=this.db,u=this.name;function c(){return o!==null&&o.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Ki&&((function(E,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function O(){this.constructor=E}r(E,M),E.prototype=M===null?Object.create(M):(O.prototype=M.prototype,new O)})(c,o=n),Object.defineProperty(c.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),c.prototype.table=function(){return u},n=c);for(var d=new Set,g=n.prototype;g;g=x(g))Object.getOwnPropertyNames(g).forEach(function(E){return d.add(E)});function v(E){if(!E)return E;var M,O=Object.create(n.prototype);for(M in E)if(!d.has(M))try{O[M]=E[M]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),n},Fe.prototype.defineClass=function(){return this.mapToClass(function(n){m(this,n)})},Fe.prototype.add=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:o!=null?[o]:null,values:[g]})}).then(function(v){return v.numFailures?le.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{T(n,d,v)}catch{}return v})},Fe.prototype.upsert=function(n,o){var s=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return s.core.get({trans:c,key:n}).then(function(d){var g=d??{};return Zi(g,o),u&&T(g,u,n),s.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[o]}}).then(function(v){return v.numFailures?le.reject(v.failures[0]):!!d})})})},Fe.prototype.update=function(n,o){return typeof n!="object"||h(n)?this.where(":id").equals(n).modify(o):(n=B(n,this.schema.primKey.keyPath),n===void 0?Ne(new G.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(o))},Fe.prototype.put=function(n,o){var s=this,u=this.schema.primKey,c=u.auto,d=u.keyPath,g=n;return d&&c&&(g=er(d)(n)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[g],keys:o!=null?[o]:null})}).then(function(v){return v.numFailures?le.reject(v.failures[0]):v.lastResult}).then(function(v){if(d)try{T(n,d,v)}catch{}return v})},Fe.prototype.delete=function(n){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"delete",keys:[n]}).then(function(u){return tr(o,[n],u)}).then(function(u){return u.numFailures?le.reject(u.failures[0]):void 0})})},Fe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"deleteRange",range:Fi}).then(function(s){return tr(n,null,s)})}).then(function(o){return o.numFailures?le.reject(o.failures[0]):void 0})},Fe.prototype.bulkGet=function(n){var o=this;return this._trans("readonly",function(s){return o.core.getMany({keys:n,trans:s}).then(function(u){return u.map(function(c){return o.hook.reading.fire(c)})})})},Fe.prototype.bulkAdd=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var M=u.schema.primKey,v=M.auto,M=M.keyPath;if(M&&c)throw new G.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var E=n.length,M=M&&v?n.map(er(M)):n;return u.core.mutate({trans:g,type:"add",keys:c,values:M,wantResults:d}).then(function(S){var y=S.numFailures,D=S.results,k=S.lastResult,S=S.failures;if(y===0)return d?D:k;throw new Ae("".concat(u.name,".bulkAdd(): ").concat(y," of ").concat(E," operations failed"),S)})})},Fe.prototype.bulkPut=function(n,o,s){var u=this,c=Array.isArray(o)?o:void 0,d=(s=s||(c?void 0:o))?s.allKeys:void 0;return this._trans("readwrite",function(g){var M=u.schema.primKey,v=M.auto,M=M.keyPath;if(M&&c)throw new G.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var E=n.length,M=M&&v?n.map(er(M)):n;return u.core.mutate({trans:g,type:"put",keys:c,values:M,wantResults:d}).then(function(S){var y=S.numFailures,D=S.results,k=S.lastResult,S=S.failures;if(y===0)return d?D:k;throw new Ae("".concat(u.name,".bulkPut(): ").concat(y," of ").concat(E," operations failed"),S)})})},Fe.prototype.bulkUpdate=function(n){var o=this,s=this.core,u=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),d=[];return this._trans("readwrite",function(g){return s.getMany({trans:g,keys:u,cache:"clone"}).then(function(v){var E=[],M=[];n.forEach(function(y,D){var k=y.key,S=y.changes,P=v[D];if(P){for(var _=0,R=Object.keys(S);_<R.length;_++){var z=R[_],q=S[z];if(z===o.schema.primKey.keyPath){if(Te(q,k)!==0)throw new G.Constraint("Cannot update primary key in bulkUpdate()")}else T(P,z,q)}d.push(D),E.push(k),M.push(P)}});var O=E.length;return s.mutate({trans:g,type:"put",keys:E,values:M,updates:{keys:u,changeSpecs:c}}).then(function(y){var D=y.numFailures,k=y.failures;if(D===0)return O;for(var S=0,P=Object.keys(k);S<P.length;S++){var _,R=P[S],z=d[Number(R)];z!=null&&(_=k[R],delete k[R],k[z]=_)}throw new Ae("".concat(o.name,".bulkUpdate(): ").concat(D," of ").concat(O," operations failed"),k)})})})},Fe.prototype.bulkDelete=function(n){var o=this,s=n.length;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"delete",keys:n}).then(function(c){return tr(o,n,c)})}).then(function(g){var c=g.numFailures,d=g.lastResult,g=g.failures;if(c===0)return d;throw new Ae("".concat(o.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),g)})},Fe);function Fe(){}function Sn(n){function o(g,v){if(v){for(var E=arguments.length,M=new Array(E-1);--E;)M[E-1]=arguments[E];return s[g].subscribe.apply(null,M),n}if(typeof g=="string")return s[g]}var s={};o.addEventType=d;for(var u=1,c=arguments.length;u<c;++u)d(arguments[u]);return o;function d(g,v,E){if(typeof g!="object"){var M;v=v||on;var O={subscribers:[],fire:E=E||Se,subscribe:function(y){O.subscribers.indexOf(y)===-1&&(O.subscribers.push(y),O.fire=v(O.fire,y))},unsubscribe:function(y){O.subscribers=O.subscribers.filter(function(D){return D!==y}),O.fire=O.subscribers.reduce(v,E)}};return s[g]=o[g]=O}p(M=g).forEach(function(y){var D=M[y];if(h(D))d(y,M[y][0],M[y][1]);else{if(D!=="asap")throw new G.InvalidArgument("Invalid event config");var k=d(y,Xe,function(){for(var S=arguments.length,P=new Array(S);S--;)P[S]=arguments[S];k.subscribers.forEach(function(_){A(function(){_.apply(null,P)})})})}})}}function Pn(n,o){return j(o).from({prototype:n}),o}function hn(n,o){return!(n.filter||n.algorithm||n.or)&&(o?n.justLimit:!n.replayFilter)}function Nr(n,o){n.filter=Vt(n.filter,o)}function qr(n,o,s){var u=n.replayFilter;n.replayFilter=u?function(){return Vt(u(),o())}:o,n.justLimit=s&&!u}function nr(n,o){if(n.isPrimKey)return o.primaryKey;var s=o.getIndexByKeyPath(n.index);if(!s)throw new G.Schema("KeyPath "+n.index+" on object store "+o.name+" is not indexed");return s}function Vi(n,o,s){var u=nr(n,o.schema);return o.openCursor({trans:s,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function rr(n,o,s,u){var c=n.replayFilter?Vt(n.filter,n.replayFilter()):n.filter;if(n.or){var d={},g=function(v,E,M){var O,y;c&&!c(E,M,function(D){return E.stop(D)},function(D){return E.fail(D)})||((y=""+(O=E.primaryKey))=="[object ArrayBuffer]"&&(y=""+new Uint8Array(O)),b(d,y)||(d[y]=!0,o(v,E,M)))};return Promise.all([n.or._iterate(g,s),Hi(Vi(n,u,s),n.algorithm,g,!n.keysOnly&&n.valueMapper)])}return Hi(Vi(n,u,s),Vt(n.algorithm,c),o,!n.keysOnly&&n.valueMapper)}function Hi(n,o,s,u){var c=Ke(u?function(d,g,v){return s(u(d),g,v)}:s);return n.then(function(d){if(d)return d.start(function(){var g=function(){return d.continue()};o&&!o(d,function(v){return g=v},function(v){d.stop(v),g=Se},function(v){d.fail(v),g=Se})||c(d.value,d,function(v){return g=v}),g()})})}var ga=(Ue.prototype._read=function(n,o){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readonly",n).then(o)},Ue.prototype._write=function(n){var o=this._ctx;return o.error?o.table._trans(null,Ne.bind(null,o.error)):o.table._trans("readwrite",n,"locked")},Ue.prototype._addAlgorithm=function(n){var o=this._ctx;o.algorithm=Vt(o.algorithm,n)},Ue.prototype._iterate=function(n,o){return rr(this._ctx,n,o,this._ctx.table.core)},Ue.prototype.clone=function(n){var o=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return n&&m(s,n),o._ctx=s,o},Ue.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ue.prototype.each=function(n){var o=this._ctx;return this._read(function(s){return rr(o,n,s,o.table.core)})},Ue.prototype.count=function(n){var o=this;return this._read(function(s){var u=o._ctx,c=u.table.core;if(hn(u,!0))return c.count({trans:s,query:{index:nr(u,c.schema),range:u.range}}).then(function(g){return Math.min(g,u.limit)});var d=0;return rr(u,function(){return++d,!1},s,c).then(function(){return d})}).then(n)},Ue.prototype.sortBy=function(n,o){var s=n.split(".").reverse(),u=s[0],c=s.length-1;function d(E,M){return M?d(E[s[M]],M-1):E[u]}var g=this._ctx.dir==="next"?1:-1;function v(E,M){return Te(d(E,c),d(M,c))*g}return this.toArray(function(E){return E.sort(v)}).then(o)},Ue.prototype.toArray=function(n){var o=this;return this._read(function(s){var u=o._ctx;if(u.dir==="next"&&hn(u,!0)&&0<u.limit){var c=u.valueMapper,d=nr(u,u.table.core.schema);return u.table.core.query({trans:s,limit:u.limit,values:!0,query:{index:d,range:u.range}}).then(function(v){return v=v.result,c?v.map(c):v})}var g=[];return rr(u,function(v){return g.push(v)},s,u.table.core).then(function(){return g})},n)},Ue.prototype.offset=function(n){var o=this._ctx;return n<=0||(o.offset+=n,hn(o)?qr(o,function(){var s=n;return function(u,c){return s===0||(s===1?--s:c(function(){u.advance(s),s=0}),!1)}}):qr(o,function(){var s=n;return function(){return--s<0}})),this},Ue.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),qr(this._ctx,function(){var o=n;return function(s,u,c){return--o<=0&&u(c),0<=o}},!0),this},Ue.prototype.until=function(n,o){return Nr(this._ctx,function(s,u,c){return!n(s.value)||(u(c),o)}),this},Ue.prototype.first=function(n){return this.limit(1).toArray(function(o){return o[0]}).then(n)},Ue.prototype.last=function(n){return this.reverse().first(n)},Ue.prototype.filter=function(n){var o;return Nr(this._ctx,function(s){return n(s.value)}),(o=this._ctx).isMatch=Vt(o.isMatch,n),this},Ue.prototype.and=function(n){return this.filter(n)},Ue.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Ue.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ue.prototype.desc=function(){return this.reverse()},Ue.prototype.eachKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.key,u)})},Ue.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Ue.prototype.eachPrimaryKey=function(n){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(s,u){n(u.primaryKey,u)})},Ue.prototype.keys=function(n){var o=this._ctx;o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.key)}).then(function(){return s}).then(n)},Ue.prototype.primaryKeys=function(n){var o=this._ctx;if(o.dir==="next"&&hn(o,!0)&&0<o.limit)return this._read(function(u){var c=nr(o,o.table.core.schema);return o.table.core.query({trans:u,values:!1,limit:o.limit,query:{index:c,range:o.range}})}).then(function(u){return u.result}).then(n);o.keysOnly=!o.isMatch;var s=[];return this.each(function(u,c){s.push(c.primaryKey)}).then(function(){return s}).then(n)},Ue.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Ue.prototype.firstKey=function(n){return this.limit(1).keys(function(o){return o[0]}).then(n)},Ue.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Ue.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var o={};return Nr(this._ctx,function(c){var u=c.primaryKey.toString(),c=b(o,u);return o[u]=!0,!c}),this},Ue.prototype.modify=function(n){var o=this,s=this._ctx;return this._write(function(u){var c=typeof n=="function"?n:function(P){return Zi(P,n)},d=s.table.core,M=d.schema.primaryKey,g=M.outbound,v=M.extractKey,E=200,M=o.db._options.modifyChunkSize;M&&(E=typeof M=="object"?M[d.name]||M["*"]||200:M);function O(P,z){var R=z.failures,z=z.numFailures;D+=P-z;for(var q=0,V=p(R);q<V.length;q++){var ne=V[q];y.push(R[ne])}}var y=[],D=0,k=[],S=n===Gi;return o.clone().primaryKeys().then(function(P){function _(z){var q=Math.min(E,P.length-z),V=P.slice(z,z+q);return(S?Promise.resolve([]):d.getMany({trans:u,keys:V,cache:"immutable"})).then(function(ne){var se=[],J=[],re=g?[]:null,ae=S?V:[];if(!S)for(var ie=0;ie<q;++ie){var de=ne[ie],Me={value:ue(de),primKey:P[z+ie]};c.call(Me,Me.value,Me)!==!1&&(Me.value==null?ae.push(P[z+ie]):g||Te(v(de),v(Me.value))===0?(J.push(Me.value),g&&re.push(P[z+ie])):(ae.push(P[z+ie]),se.push(Me.value)))}return Promise.resolve(0<se.length&&d.mutate({trans:u,type:"add",values:se}).then(function(Pe){for(var Oe in Pe.failures)ae.splice(parseInt(Oe),1);O(se.length,Pe)})).then(function(){return(0<J.length||R&&typeof n=="object")&&d.mutate({trans:u,type:"put",keys:re,values:J,criteria:R,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<z}).then(function(Pe){return O(J.length,Pe)})}).then(function(){return(0<ae.length||R&&S)&&d.mutate({trans:u,type:"delete",keys:ae,criteria:R,isAdditionalChunk:0<z}).then(function(Pe){return tr(s.table,ae,Pe)}).then(function(Pe){return O(ae.length,Pe)})}).then(function(){return P.length>z+q&&_(z+E)})})}var R=hn(s)&&s.limit===1/0&&(typeof n!="function"||S)&&{index:s.index,range:s.range};return _(0).then(function(){if(0<y.length)throw new Z("Error modifying one or more objects",y,D,k);return P.length})})})},Ue.prototype.delete=function(){var n=this._ctx,o=n.range;return!hn(n)||n.table.schema.yProps||!n.isPrimKey&&o.type!==3?this.modify(Gi):this._write(function(s){var u=n.table.core.schema.primaryKey,c=o;return n.table.core.count({trans:s,query:{index:u,range:c}}).then(function(d){return n.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(E){var v=E.failures,E=E.numFailures;if(E)throw new Z("Could not delete some values",Object.keys(v).map(function(M){return v[M]}),d-E);return d-E})})})},Ue);function Ue(){}var Gi=function(n,o){return o.value=null};function ma(n,o){return n<o?-1:n===o?0:1}function va(n,o){return o<n?-1:n===o?0:1}function tt(n,o,s){return n=n instanceof Xi?new n.Collection(n):n,n._ctx.error=new(s||TypeError)(o),n}function gn(n){return new n.Collection(n,function(){return Yi("")}).limit(0)}function ir(n,o,s,u){var c,d,g,v,E,M,O,y=s.length;if(!s.every(function(S){return typeof S=="string"}))return tt(n,zi);function D(S){c=S==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},d=S==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},g=S==="next"?ma:va;var P=s.map(function(_){return{lower:d(_),upper:c(_)}}).sort(function(_,R){return g(_.lower,R.lower)});v=P.map(function(_){return _.upper}),E=P.map(function(_){return _.lower}),O=(M=S)==="next"?"":u}D("next"),n=new n.Collection(n,function(){return Tt(v[0],E[y-1]+u)}),n._ondirectionchange=function(S){D(S)};var k=0;return n._addAlgorithm(function(S,P,_){var R=S.key;if(typeof R!="string")return!1;var z=d(R);if(o(z,E,k))return!0;for(var q=null,V=k;V<y;++V){var ne=(function(se,J,re,ae,ie,de){for(var Me=Math.min(se.length,ae.length),Pe=-1,Oe=0;Oe<Me;++Oe){var nt=J[Oe];if(nt!==ae[Oe])return ie(se[Oe],re[Oe])<0?se.substr(0,Oe)+re[Oe]+re.substr(Oe+1):ie(se[Oe],ae[Oe])<0?se.substr(0,Oe)+ae[Oe]+re.substr(Oe+1):0<=Pe?se.substr(0,Pe)+J[Pe]+re.substr(Pe+1):null;ie(se[Oe],nt)<0&&(Pe=Oe)}return Me<ae.length&&de==="next"?se+re.substr(se.length):Me<se.length&&de==="prev"?se.substr(0,re.length):Pe<0?null:se.substr(0,Pe)+ae[Pe]+re.substr(Pe+1)})(R,z,v[V],E[V],g,M);ne===null&&q===null?k=V+1:(q===null||0<g(q,ne))&&(q=ne)}return P(q!==null?function(){S.continue(q+O)}:_),!1}),n}function Tt(n,o,s,u){return{type:2,lower:n,upper:o,lowerOpen:s,upperOpen:u}}function Yi(n){return{type:1,lower:n,upper:n}}var Xi=(Object.defineProperty($e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$e.prototype.between=function(n,o,s,u){s=s!==!1,u=u===!0;try{return 0<this._cmp(n,o)||this._cmp(n,o)===0&&(s||u)&&(!s||!u)?gn(this):new this.Collection(this,function(){return Tt(n,o,!s,!u)})}catch{return tt(this,kt)}},$e.prototype.equals=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Yi(n)})},$e.prototype.above=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!0)})},$e.prototype.aboveOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(n,void 0,!1)})},$e.prototype.below=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n,!1,!0)})},$e.prototype.belowOrEqual=function(n){return n==null?tt(this,kt):new this.Collection(this,function(){return Tt(void 0,n)})},$e.prototype.startsWith=function(n){return typeof n!="string"?tt(this,zi):this.between(n,n+$t,!0,!0)},$e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):ir(this,function(o,s){return o.indexOf(s[0])===0},[n],$t)},$e.prototype.equalsIgnoreCase=function(n){return ir(this,function(o,s){return o===s[0]},[n],"")},$e.prototype.anyOfIgnoreCase=function(){var n=ce.apply(fe,arguments);return n.length===0?gn(this):ir(this,function(o,s){return s.indexOf(o)!==-1},n,"")},$e.prototype.startsWithAnyOfIgnoreCase=function(){var n=ce.apply(fe,arguments);return n.length===0?gn(this):ir(this,function(o,s){return s.some(function(u){return o.indexOf(u)===0})},n,$t)},$e.prototype.anyOf=function(){var n=this,o=ce.apply(fe,arguments),s=this._cmp;try{o.sort(s)}catch{return tt(this,kt)}if(o.length===0)return gn(this);var u=new this.Collection(this,function(){return Tt(o[0],o[o.length-1])});u._ondirectionchange=function(d){s=d==="next"?n._ascending:n._descending,o.sort(s)};var c=0;return u._addAlgorithm(function(d,g,v){for(var E=d.key;0<s(E,o[c]);)if(++c===o.length)return g(v),!1;return s(E,o[c])===0||(g(function(){d.continue(o[c])}),!1)}),u},$e.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$e.prototype.noneOf=function(){var n=ce.apply(fe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return tt(this,kt)}var o=n.reduce(function(s,u){return s?s.concat([[s[s.length-1][1],u]]):[[-1/0,u]]},null);return o.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},$e.prototype.inAnyRange=function(R,o){var s=this,u=this._cmp,c=this._ascending,d=this._descending,g=this._min,v=this._max;if(R.length===0)return gn(this);if(!R.every(function(z){return z[0]!==void 0&&z[1]!==void 0&&c(z[0],z[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",G.InvalidArgument);var E=!o||o.includeLowers!==!1,M=o&&o.includeUppers===!0,O,y=c;function D(z,q){return y(z[0],q[0])}try{(O=R.reduce(function(z,q){for(var V=0,ne=z.length;V<ne;++V){var se=z[V];if(u(q[0],se[1])<0&&0<u(q[1],se[0])){se[0]=g(se[0],q[0]),se[1]=v(se[1],q[1]);break}}return V===ne&&z.push(q),z},[])).sort(D)}catch{return tt(this,kt)}var k=0,S=M?function(z){return 0<c(z,O[k][1])}:function(z){return 0<=c(z,O[k][1])},P=E?function(z){return 0<d(z,O[k][0])}:function(z){return 0<=d(z,O[k][0])},_=S,R=new this.Collection(this,function(){return Tt(O[0][0],O[O.length-1][1],!E,!M)});return R._ondirectionchange=function(z){y=z==="next"?(_=S,c):(_=P,d),O.sort(D)},R._addAlgorithm(function(z,q,V){for(var ne,se=z.key;_(se);)if(++k===O.length)return q(V),!1;return!S(ne=se)&&!P(ne)||(s._cmp(se,O[k][1])===0||s._cmp(se,O[k][0])===0||q(function(){y===c?z.continue(O[k][0]):z.continue(O[k][1])}),!1)}),R},$e.prototype.startsWithAnyOf=function(){var n=ce.apply(fe,arguments);return n.every(function(o){return typeof o=="string"})?n.length===0?gn(this):this.inAnyRange(n.map(function(o){return[o,o+$t]})):tt(this,"startsWithAnyOf() only works with strings")},$e);function $e(){}function yt(n){return Ke(function(o){return On(o),n(o.target.error),!1})}function On(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var _n="storagemutated",Wr="x-storagemutated-1",At=Sn(null,_n),ya=(bt.prototype._lock=function(){return F(!me.global),++this._reculock,this._reculock!==1||me.global||(me.lockOwnerFor=this),this},bt.prototype._unlock=function(){if(F(!me.global),--this._reculock==0)for(me.global||(me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Zt(n[1],n[0])}catch{}}return this},bt.prototype._locked=function(){return this._reculock&&me.lockOwnerFor!==this},bt.prototype.create=function(n){var o=this;if(!this.mode)return this;var s=this.db.idbdb,u=this.db._state.dbOpenError;if(F(!this.idbtrans),!n&&!s)switch(u&&u.name){case"DatabaseClosedError":throw new G.DatabaseClosed(u);case"MissingAPIError":throw new G.MissingAPI(u.message,u);default:throw new G.OpenFailed(u)}if(!this.active)throw new G.TransactionInactive;return F(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(c){On(c),o._reject(n.error)}),n.onabort=Ke(function(c){On(c),o.active&&o._reject(new G.Abort(n.error)),o.active=!1,o.on("abort").fire(c)}),n.oncomplete=Ke(function(){o.active=!1,o._resolve(),"mutatedParts"in n&&At.storagemutated.fire(n.mutatedParts)}),this},bt.prototype._promise=function(n,o,s){var u=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ne(new G.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new G.TransactionInactive);if(this._locked())return new le(function(d,g){u._blockedFuncs.push([function(){u._promise(n,o,s).then(d,g)},me])});if(s)return It(function(){var d=new le(function(g,v){u._lock();var E=o(g,v,u);E&&E.then&&E.then(g,v)});return d.finally(function(){return u._unlock()}),d._lib=!0,d});var c=new le(function(d,g){var v=o(d,g,u);v&&v.then&&v.then(d,g)});return c._lib=!0,c},bt.prototype._root=function(){return this.parent?this.parent._root():this},bt.prototype.waitFor=function(n){var o,s=this._root(),u=le.resolve(n);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return u}):(s._waitingFor=u,s._waitingQueue=[],o=s.idbtrans.objectStore(s.storeNames[0]),(function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(o.get(-1/0).onsuccess=d)})());var c=s._waitingFor;return new le(function(d,g){u.then(function(v){return s._waitingQueue.push(Ke(d.bind(null,v)))},function(v){return s._waitingQueue.push(Ke(g.bind(null,v)))}).finally(function(){s._waitingFor===c&&(s._waitingFor=null)})})},bt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new G.Abort))},bt.prototype.table=function(n){var o=this._memoizedTables||(this._memoizedTables={});if(b(o,n))return o[n];var s=this.schema[n];if(!s)throw new G.NotFound("Table "+n+" not part of transaction");return s=new this.db.Table(n,s,this),s.core=this.db.core.table(n),o[n]=s},bt);function bt(){}function Zr(n,o,s,u,c,d,g,v){return{name:n,keyPath:o,unique:s,multi:u,auto:c,compound:d,src:(s&&!g?"&":"")+(u?"*":"")+(c?"++":"")+Ji(o),type:v}}function Ji(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function $r(n,o,s){return{name:n,primKey:o,indexes:s,mappedClass:null,idxByName:(u=function(c){return[c.name,c]},s.reduce(function(c,d,g){return g=u(d,g),g&&(c[g[0]]=g[1]),c},{}))};var u}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return $t},$t}};function Vr(n){return n==null?function(){}:typeof n=="string"?(o=n).split(".").length===1?function(s){return s[o]}:function(s){return B(s,o)}:function(s){return B(s,n)};var o}function Qi(n){return[].slice.call(n)}var ba=0;function In(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function wa(n,o,E){function u(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var k=_.lower,S=_.upper,P=_.lowerOpen,_=_.upperOpen;return k===void 0?S===void 0?null:o.upperBound(S,!!_):S===void 0?o.lowerBound(k,!!P):o.bound(k,S,!!P,!!_)}function c(D){var k,S=D.name;return{name:S,schema:D,mutate:function(P){var _=P.trans,R=P.type,z=P.keys,q=P.values,V=P.range;return new Promise(function(ne,se){ne=Ke(ne);var J=_.objectStore(S),re=J.keyPath==null,ae=R==="put"||R==="add";if(!ae&&R!=="delete"&&R!=="deleteRange")throw new Error("Invalid operation type: "+R);var ie,de=(z||q||{length:1}).length;if(z&&q&&z.length!==q.length)throw new Error("Given keys array must have same length as given values array.");if(de===0)return ne({numFailures:0,failures:{},results:[],lastResult:void 0});function Me(Qe){++nt,On(Qe)}var Pe=[],Oe=[],nt=0;if(R==="deleteRange"){if(V.type===4)return ne({numFailures:nt,failures:Oe,results:[],lastResult:void 0});V.type===3?Pe.push(ie=J.clear()):Pe.push(ie=J.delete(u(V)))}else{var re=ae?re?[q,z]:[q,null]:[z,null],Ee=re[0],He=re[1];if(ae)for(var Ge=0;Ge<de;++Ge)Pe.push(ie=He&&He[Ge]!==void 0?J[R](Ee[Ge],He[Ge]):J[R](Ee[Ge])),ie.onerror=Me;else for(Ge=0;Ge<de;++Ge)Pe.push(ie=J[R](Ee[Ge])),ie.onerror=Me}function mr(Qe){Qe=Qe.target.result,Pe.forEach(function(Yt,fi){return Yt.error!=null&&(Oe[fi]=Yt.error)}),ne({numFailures:nt,failures:Oe,results:R==="delete"?z:Pe.map(function(Yt){return Yt.result}),lastResult:Qe})}ie.onerror=function(Qe){Me(Qe),mr(Qe)},ie.onsuccess=mr})},getMany:function(P){var _=P.trans,R=P.keys;return new Promise(function(z,q){z=Ke(z);for(var V,ne=_.objectStore(S),se=R.length,J=new Array(se),re=0,ae=0,ie=function(Pe){Pe=Pe.target,J[Pe._pos]=Pe.result,++ae===re&&z(J)},de=yt(q),Me=0;Me<se;++Me)R[Me]!=null&&((V=ne.get(R[Me]))._pos=Me,V.onsuccess=ie,V.onerror=de,++re);re===0&&z(J)})},get:function(P){var _=P.trans,R=P.key;return new Promise(function(z,q){z=Ke(z);var V=_.objectStore(S).get(R);V.onsuccess=function(ne){return z(ne.target.result)},V.onerror=yt(q)})},query:(k=M,function(P){return new Promise(function(_,R){_=Ke(_);var z,q,V,re=P.trans,ne=P.values,se=P.limit,ie=P.query,J=se===1/0?void 0:se,ae=ie.index,ie=ie.range,re=re.objectStore(S),ae=ae.isPrimaryKey?re:re.index(ae.name),ie=u(ie);if(se===0)return _({result:[]});k?((J=ne?ae.getAll(ie,J):ae.getAllKeys(ie,J)).onsuccess=function(de){return _({result:de.target.result})},J.onerror=yt(R)):(z=0,q=!ne&&"openKeyCursor"in ae?ae.openKeyCursor(ie):ae.openCursor(ie),V=[],q.onsuccess=function(de){var Me=q.result;return Me?(V.push(ne?Me.value:Me.primaryKey),++z===se?_({result:V}):void Me.continue()):_({result:V})},q.onerror=yt(R))})}),openCursor:function(P){var _=P.trans,R=P.values,z=P.query,q=P.reverse,V=P.unique;return new Promise(function(ne,se){ne=Ke(ne);var ae=z.index,J=z.range,re=_.objectStore(S),re=ae.isPrimaryKey?re:re.index(ae.name),ae=q?V?"prevunique":"prev":V?"nextunique":"next",ie=!R&&"openKeyCursor"in re?re.openKeyCursor(u(J),ae):re.openCursor(u(J),ae);ie.onerror=yt(se),ie.onsuccess=Ke(function(de){var Me,Pe,Oe,nt,Ee=ie.result;Ee?(Ee.___id=++ba,Ee.done=!1,Me=Ee.continue.bind(Ee),Pe=(Pe=Ee.continuePrimaryKey)&&Pe.bind(Ee),Oe=Ee.advance.bind(Ee),nt=function(){throw new Error("Cursor not stopped")},Ee.trans=_,Ee.stop=Ee.continue=Ee.continuePrimaryKey=Ee.advance=function(){throw new Error("Cursor not started")},Ee.fail=Ke(se),Ee.next=function(){var He=this,Ge=1;return this.start(function(){return Ge--?He.continue():He.stop()}).then(function(){return He})},Ee.start=function(He){function Ge(){if(ie.result)try{He()}catch(Qe){Ee.fail(Qe)}else Ee.done=!0,Ee.start=function(){throw new Error("Cursor behind last entry")},Ee.stop()}var mr=new Promise(function(Qe,Yt){Qe=Ke(Qe),ie.onerror=yt(Yt),Ee.fail=Yt,Ee.stop=function(fi){Ee.stop=Ee.continue=Ee.continuePrimaryKey=Ee.advance=nt,Qe(fi)}});return ie.onsuccess=Ke(function(Qe){ie.onsuccess=Ge,Ge()}),Ee.continue=Me,Ee.continuePrimaryKey=Pe,Ee.advance=Oe,Ge(),mr},ne(Ee)):ne(null)},se)})},count:function(P){var _=P.query,R=P.trans,z=_.index,q=_.range;return new Promise(function(V,ne){var se=R.objectStore(S),J=z.isPrimaryKey?se:se.index(z.name),se=u(q),J=se?J.count(se):J.count();J.onsuccess=Ke(function(re){return V(re.target.result)}),J.onerror=yt(ne)})}}}var d,g,v,O=(g=E,v=Qi((d=n).objectStoreNames),{schema:{name:d.name,tables:v.map(function(D){return g.objectStore(D)}).map(function(D){var k=D.keyPath,_=D.autoIncrement,S=h(k),P={},_={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:k==null,compound:S,keyPath:k,autoIncrement:_,unique:!0,extractKey:Vr(k)},indexes:Qi(D.indexNames).map(function(R){return D.index(R)}).map(function(V){var z=V.name,q=V.unique,ne=V.multiEntry,V=V.keyPath,ne={name:z,compound:h(V),keyPath:V,unique:q,multiEntry:ne,extractKey:Vr(V)};return P[In(V)]=ne}),getIndexByKeyPath:function(R){return P[In(R)]}};return P[":id"]=_.primaryKey,k!=null&&(P[In(k)]=_.primaryKey),_})},hasGetAll:0<v.length&&"getAll"in g.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),E=O.schema,M=O.hasGetAll,O=E.tables.map(c),y={};return O.forEach(function(D){return y[D.name]=D}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(D){if(!y[D])throw new Error("Table '".concat(D,"' not found"));return y[D]},MIN_KEY:-1/0,MAX_KEY:Dn(o),schema:E}}function La(n,o,s,u){var c=s.IDBKeyRange;return s.indexedDB,{dbcore:(u=wa(o,c,u),n.dbcore.reduce(function(d,g){return g=g.create,i(i({},d),g(d))},u))}}function or(n,u){var s=u.db,u=La(n._middlewares,s,n._deps,u);n.core=u.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(g){return g.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table&&(n[d].core=c.core))})}function sr(n,o,s,u){s.forEach(function(c){var d=u[c];o.forEach(function(g){var v=(function E(M,O){return K(M,O)||(M=x(M))&&E(M,O)})(g,c);(!v||"value"in v&&v.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?L(g,c,{get:function(){return this.table(c)},set:function(E){I(this,c,{value:E,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,d))})})}function Hr(n,o){o.forEach(function(s){for(var u in s)s[u]instanceof n.Table&&delete s[u]})}function xa(n,o){return n._cfg.version-o._cfg.version}function Ca(n,o,s,u){var c=n._dbSchema;s.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=$r("$meta",to("")[0],[]),n._storeNames.push("$meta"));var d=n._createTransaction("readwrite",n._storeNames,c);d.create(s),d._completion.catch(u);var g=d._reject.bind(d),v=me.transless||me;It(function(){return me.trans=d,me.transless=v,o!==0?(or(n,s),M=o,((E=d).storeNames.includes("$meta")?E.table("$meta").get("version").then(function(O){return O??M}):le.resolve(M)).then(function(O){return D=O,k=d,S=s,P=[],O=(y=n)._versions,_=y._dbSchema=lr(0,y.idbdb,S),(O=O.filter(function(R){return R._cfg.version>=D})).length!==0?(O.forEach(function(R){P.push(function(){var z=_,q=R._cfg.dbschema;ur(y,z,S),ur(y,q,S),_=y._dbSchema=q;var V=Gr(z,q);V.add.forEach(function(ae){Yr(S,ae[0],ae[1].primKey,ae[1].indexes)}),V.change.forEach(function(ae){if(ae.recreate)throw new G.Upgrade("Not yet support for changing primary key");var ie=S.objectStore(ae.name);ae.add.forEach(function(de){return ar(ie,de)}),ae.change.forEach(function(de){ie.deleteIndex(de.name),ar(ie,de)}),ae.del.forEach(function(de){return ie.deleteIndex(de)})});var ne=R._cfg.contentUpgrade;if(ne&&R._cfg.version>D){or(y,S),k._memoizedTables={};var se=H(q);V.del.forEach(function(ae){se[ae]=z[ae]}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],p(se),se),k.schema=se;var J,re=Le(ne);return re&&dn(),V=le.follow(function(){var ae;(J=ne(k))&&re&&(ae=jt.bind(null,null),J.then(ae,ae))}),J&&typeof J.then=="function"?le.resolve(J):V.then(function(){return J})}}),P.push(function(z){var q,V,ne=R._cfg.dbschema;q=ne,V=z,[].slice.call(V.db.objectStoreNames).forEach(function(se){return q[se]==null&&V.db.deleteObjectStore(se)}),Hr(y,[y.Transaction.prototype]),sr(y,[y.Transaction.prototype],y._storeNames,y._dbSchema),k.schema=y._dbSchema}),P.push(function(z){y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(y.idbdb.version/10)===R._cfg.version?(y.idbdb.deleteObjectStore("$meta"),delete y._dbSchema.$meta,y._storeNames=y._storeNames.filter(function(q){return q!=="$meta"})):z.objectStore("$meta").put(R._cfg.version,"version"))})}),(function R(){return P.length?le.resolve(P.shift()(k.idbtrans)).then(R):le.resolve()})().then(function(){eo(_,S)})):le.resolve();var y,D,k,S,P,_}).catch(g)):(p(c).forEach(function(O){Yr(s,O,c[O].primKey,c[O].indexes)}),or(n,s),void le.follow(function(){return n.on.populate.fire(d)}).catch(g));var E,M})}function Ea(n,o){eo(n._dbSchema,o),o.db.version%10!=0||o.objectStoreNames.contains("$meta")||o.db.createObjectStore("$meta").add(Math.ceil(o.db.version/10-1),"version");var s=lr(0,n.idbdb,o);ur(n,n._dbSchema,o);for(var u=0,c=Gr(s,n._dbSchema).change;u<c.length;u++){var d=(function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=o.objectStore(g.name);g.add.forEach(function(E){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(E.src)),ar(v,E)})})(c[u]);if(typeof d=="object")return d.value}}function Gr(n,o){var s,u={del:[],add:[],change:[]};for(s in n)o[s]||u.del.push(s);for(s in o){var c=n[s],d=o[s];if(c){var g={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||c.primKey.auto!==d.primKey.auto)g.recreate=!0,u.change.push(g);else{var v=c.idxByName,E=d.idxByName,M=void 0;for(M in v)E[M]||g.del.push(M);for(M in E){var O=v[M],y=E[M];O?O.src!==y.src&&g.change.push(y):g.add.push(y)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([s,d])}return u}function Yr(n,o,s,u){var c=n.db.createObjectStore(o,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return u.forEach(function(d){return ar(c,d)}),c}function eo(n,o){p(n).forEach(function(s){o.db.objectStoreNames.contains(s)||(Je&&console.debug("Dexie: Creating missing table",s),Yr(o,s,n[s].primKey,n[s].indexes))})}function ar(n,o){n.createIndex(o.name,o.keyPath,{unique:o.unique,multiEntry:o.multi})}function lr(n,o,s){var u={};return W(o.objectStoreNames,0).forEach(function(c){for(var d=s.objectStore(c),g=Zr(Ji(M=d.keyPath),M||"",!0,!1,!!d.autoIncrement,M&&typeof M!="string",!0),v=[],E=0;E<d.indexNames.length;++E){var O=d.index(d.indexNames[E]),M=O.keyPath,O=Zr(O.name,M,!!O.unique,!!O.multiEntry,!1,M&&typeof M!="string",!1);v.push(O)}u[c]=$r(c,g,v)}),u}function ur(n,o,s){for(var u=s.db.objectStoreNames,c=0;c<u.length;++c){var d=u[c],g=s.objectStore(d);n._hasGetAll="getAll"in g;for(var v=0;v<g.indexNames.length;++v){var E=g.indexNames[v],M=g.index(E).keyPath,O=typeof M=="string"?M:"["+W(M).join("+")+"]";!o[d]||(M=o[d].idxByName[O])&&(M.name=E,delete o[d].idxByName[O],o[d].idxByName[E]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function to(n){return n.split(",").map(function(o,s){var d=o.split(":"),u=(c=d[1])===null||c===void 0?void 0:c.trim(),c=(o=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Zr(c,d||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),h(d),s===0,u)})}var Ma=(mn.prototype._createTableSchema=$r,mn.prototype._parseIndexSyntax=to,mn.prototype._parseStoresSpec=function(n,o){var s=this;p(n).forEach(function(u){if(n[u]!==null){var c=s._parseIndexSyntax(n[u]),d=c.shift();if(!d)throw new G.Schema("Invalid schema for table "+u+": "+n[u]);if(d.unique=!0,d.multi)throw new G.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new G.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new G.Schema("Index must have a name and cannot be an empty string")}),c=s._createTableSchema(u,d,c),o[u]=c}})},mn.prototype.stores=function(s){var o=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,s):s;var s=o._versions,u={},c={};return s.forEach(function(d){m(u,d._cfg.storesSource),c=d._cfg.dbschema={},d._parseStoresSpec(u,c)}),o._dbSchema=c,Hr(o,[o._allTables,o,o.Transaction.prototype]),sr(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],p(c),c),o._storeNames=p(c),this},mn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=sn(this._cfg.contentUpgrade||Se,n),this},mn);function mn(){}function Xr(n,o){var s=n._dbNamesDB;return s||(s=n._dbNamesDB=new St(Qn,{addons:[],indexedDB:n,IDBKeyRange:o})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function Jr(n){return n&&typeof n.databases=="function"}function Qr(n){return It(function(){return me.letThrough=!0,n()})}function ei(n){return!("from"in n)}var Ve=function(n,o){if(!this){var s=new Ve;return n&&"d"in n&&m(s,n),s}m(this,arguments.length?{d:1,from:n,to:1<arguments.length?o:n}:{d:0})};function jn(n,o,s){var u=Te(o,s);if(!isNaN(u)){if(0<u)throw RangeError();if(ei(n))return m(n,{from:o,to:s,d:1});var c=n.l,u=n.r;if(Te(s,n.from)<0)return c?jn(c,o,s):n.l={from:o,to:s,d:1,l:null,r:null},ro(n);if(0<Te(o,n.to))return u?jn(u,o,s):n.r={from:o,to:s,d:1,l:null,r:null},ro(n);Te(o,n.from)<0&&(n.from=o,n.l=null,n.d=u?u.d+1:1),0<Te(s,n.to)&&(n.to=s,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Rn(n,c),u&&s&&Rn(n,u)}}function Rn(n,o){ei(o)||(function s(u,E){var d=E.from,g=E.to,v=E.l,E=E.r;jn(u,d,g),v&&s(u,v),E&&s(u,E)})(n,o)}function no(n,o){var s=cr(o),u=s.next();if(u.done)return!1;for(var c=u.value,d=cr(n),g=d.next(c.from),v=g.value;!u.done&&!g.done;){if(Te(v.from,c.to)<=0&&0<=Te(v.to,c.from))return!0;Te(c.from,v.from)<0?c=(u=s.next(v.from)).value:v=(g=d.next(c.from)).value}return!1}function cr(n){var o=ei(n)?null:{s:0,n};return{next:function(s){for(var u=0<arguments.length;o;)switch(o.s){case 0:if(o.s=1,u)for(;o.n.l&&Te(s,o.n.from)<0;)o={up:o,n:o.n.l,s:1};else for(;o.n.l;)o={up:o,n:o.n.l,s:1};case 1:if(o.s=2,!u||Te(s,o.n.to)<=0)return{value:o.n,done:!1};case 2:if(o.n.r){o.s=3,o={up:o,n:o.n.r,s:0};continue}case 3:o=o.up}return{done:!0}}}}function ro(n){var o,s,u=(((o=n.r)===null||o===void 0?void 0:o.d)||0)-(((s=n.l)===null||s===void 0?void 0:s.d)||0),c=1<u?"r":u<-1?"l":"";c&&(o=c=="r"?"l":"r",s=i({},n),u=n[c],n.from=u.from,n.to=u.to,n[c]=u[c],s[c]=u[o],(n[o]=s).d=io(s)),n.d=io(n)}function io(s){var o=s.r,s=s.l;return(o?s?Math.max(o.d,s.d):o.d:s?s.d:0)+1}function fr(n,o){return p(o).forEach(function(s){n[s]?Rn(n[s],o[s]):n[s]=(function u(c){var d,g,v={};for(d in c)b(c,d)&&(g=c[d],v[d]=!g||typeof g!="object"||X.has(g.constructor)?g:u(g));return v})(o[s])}),n}function ti(n,o){return n.all||o.all||Object.keys(n).some(function(s){return o[s]&&no(o[s],n[s])})}C(Ve.prototype,((lt={add:function(n){return Rn(this,n),this},addKey:function(n){return jn(this,n,n),this},addKeys:function(n){var o=this;return n.forEach(function(s){return jn(o,s,s)}),this},hasKey:function(n){var o=cr(this).next(n).value;return o&&Te(o.from,n)<=0&&0<=Te(o.to,n)}})[ve]=function(){return cr(this)},lt));var Ht={},ni={},ri=!1;function dr(n){fr(ni,n),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(n,o){o===void 0&&(o=!1);var s=new Set;if(n.all)for(var u=0,c=Object.values(Ht);u<c.length;u++)oo(g=c[u],n,s,o);else for(var d in n){var g,v=/^idb\:\/\/(.*)\/(.*)\//.exec(d);v&&(d=v[1],v=v[2],(g=Ht["idb://".concat(d,"/").concat(v)])&&oo(g,n,s,o))}s.forEach(function(E){return E()})}function oo(n,o,s,u){for(var c=[],d=0,g=Object.entries(n.queries.query);d<g.length;d++){for(var v=g[d],E=v[0],M=[],O=0,y=v[1];O<y.length;O++){var D=y[O];ti(o,D.obsSet)?D.subscribers.forEach(function(_){return s.add(_)}):u&&M.push(D)}u&&c.push([E,M])}if(u)for(var k=0,S=c;k<S.length;k++){var P=S[k],E=P[0],M=P[1];n.queries.query[E]=M}}function ka(n){var o=n._state,s=n._deps.indexedDB;if(o.isBeingOpened||n.idbdb)return o.dbReadyPromise.then(function(){return o.dbOpenError?Ne(o.dbOpenError):n});o.isBeingOpened=!0,o.dbOpenError=null,o.openComplete=!1;var u=o.openCanceller,c=Math.round(10*n.verno),d=!1;function g(){if(o.openCanceller!==u)throw new G.DatabaseClosed("db.open() was cancelled")}function v(){return new le(function(D,k){if(g(),!s)throw new G.MissingAPI;var S=n.name,P=o.autoSchema||!c?s.open(S):s.open(S,c);if(!P)throw new G.MissingAPI;P.onerror=yt(k),P.onblocked=Ke(n._fireOnBlocked),P.onupgradeneeded=Ke(function(_){var R;O=P.transaction,o.autoSchema&&!n._options.allowEmptyDB?(P.onerror=On,O.abort(),P.result.close(),(R=s.deleteDatabase(S)).onsuccess=R.onerror=Ke(function(){k(new G.NoSuchDatabase("Database ".concat(S," doesnt exist")))})):(O.onerror=yt(k),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,y=_<1,n.idbdb=P.result,d&&Ea(n,O),Ca(n,_/10,O,k))},k),P.onsuccess=Ke(function(){O=null;var _,R,z,q,V,ne=n.idbdb=P.result,se=W(ne.objectStoreNames);if(0<se.length)try{var J=ne.transaction((q=se).length===1?q[0]:q,"readonly");if(o.autoSchema)R=ne,z=J,(_=n).verno=R.version/10,z=_._dbSchema=lr(0,R,z),_._storeNames=W(R.objectStoreNames,0),sr(_,[_._allTables],p(z),z);else if(ur(n,n._dbSchema,J),((V=Gr(lr(0,(V=n).idbdb,J),V._dbSchema)).add.length||V.change.some(function(re){return re.add.length||re.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ne.close(),c=ne.version+1,d=!0,D(v());or(n,J)}catch{}pn.push(n),ne.onversionchange=Ke(function(re){o.vcFired=!0,n.on("versionchange").fire(re)}),ne.onclose=Ke(function(){n.close({disableAutoOpen:!1})}),y&&(V=n._deps,J=S,ne=V.indexedDB,V=V.IDBKeyRange,Jr(ne)||J===Qn||Xr(ne,V).put({name:J}).catch(Se)),D()},k)}).catch(function(D){switch(D?.name){case"UnknownError":if(0<o.PR1398_maxLoop)return o.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<c)return c=0,v()}return le.reject(D)})}var E,M=o.dbReadyResolve,O=null,y=!1;return le.race([u,(typeof navigator>"u"?le.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function k(){return indexedDB.databases().finally(D)}E=setInterval(k,100),k()}).finally(function(){return clearInterval(E)}):Promise.resolve()).then(v)]).then(function(){return g(),o.onReadyBeingFired=[],le.resolve(Qr(function(){return n.on.ready.fire(n.vip)})).then(function D(){if(0<o.onReadyBeingFired.length){var k=o.onReadyBeingFired.reduce(sn,Se);return o.onReadyBeingFired=[],le.resolve(Qr(function(){return k(n.vip)})).then(D)}})}).finally(function(){o.openCanceller===u&&(o.onReadyBeingFired=null,o.isBeingOpened=!1)}).catch(function(D){o.dbOpenError=D;try{O&&O.abort()}catch{}return u===o.openCanceller&&n._close(),Ne(D)}).finally(function(){o.openComplete=!0,M()}).then(function(){var D;return y&&(D={},n.tables.forEach(function(k){k.schema.indexes.forEach(function(S){S.name&&(D["idb://".concat(n.name,"/").concat(k.name,"/").concat(S.name)]=new Ve(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(k.name,"/")]=D["idb://".concat(n.name,"/").concat(k.name,"/:dels")]=new Ve(-1/0,[[[]]])}),At(_n).fire(D),ii(D,!0)),n})}function oi(n){function o(d){return n.next(d)}var s=c(o),u=c(function(d){return n.throw(d)});function c(d){return function(E){var v=d(E),E=v.value;return v.done?E:E&&typeof E.then=="function"?E.then(s,u):h(E)?Promise.all(E).then(s,u):s(E)}}return c(o)()}function pr(n,o,s){for(var u=h(n)?n.slice():[n],c=0;c<s;++c)u.push(o);return u}var Sa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema,c={},d=[];function g(y,D,k){var S=In(y),P=c[S]=c[S]||[],_=y==null?0:typeof y=="string"?1:y.length,R=0<D,R=i(i({},k),{name:R?"".concat(S,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:R,keyTail:D,keyLength:_,extractKey:Vr(y),unique:!R&&k.unique});return P.push(R),R.isPrimaryKey||d.push(R),1<_&&g(_===2?y[0]:y.slice(0,_-1),D+1,k),P.sort(function(z,q){return z.keyTail-q.keyTail}),R}o=g(u.primaryKey.keyPath,0,u.primaryKey),c[":id"]=[o];for(var v=0,E=u.indexes;v<E.length;v++){var M=E[v];g(M.keyPath,0,M)}function O(y){var D,k=y.query.index;return k.isVirtual?i(i({},y),{query:{index:k.lowLevelIndex,range:(D=y.query.range,k=k.keyTail,{type:D.type===1?2:D.type,lower:pr(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,k),lowerOpen:!0,upper:pr(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,k),upperOpen:!0})}}):y}return i(i({},s),{schema:i(i({},u),{primaryKey:o,indexes:d,getIndexByKeyPath:function(y){return(y=c[In(y)])&&y[0]}}),count:function(y){return s.count(O(y))},query:function(y){return s.query(O(y))},openCursor:function(y){var D=y.query.index,k=D.keyTail,S=D.isVirtual,P=D.keyLength;return S?s.openCursor(O(y)).then(function(R){return R&&_(R)}):s.openCursor(y);function _(R){return Object.create(R,{continue:{value:function(z){z!=null?R.continue(pr(z,y.reverse?n.MAX_KEY:n.MIN_KEY,k)):y.unique?R.continue(R.key.slice(0,P).concat(y.reverse?n.MIN_KEY:n.MAX_KEY,k)):R.continue()}},continuePrimaryKey:{value:function(z,q){R.continuePrimaryKey(pr(z,n.MAX_KEY,k),q)}},primaryKey:{get:function(){return R.primaryKey}},key:{get:function(){var z=R.key;return P===1?z[0]:z.slice(0,P)}},value:{get:function(){return R.value}}})}}})}})}};function si(n,o,s,u){return s=s||{},u=u||"",p(n).forEach(function(c){var d,g,v;b(o,c)?(d=n[c],g=o[c],typeof d=="object"&&typeof g=="object"&&d&&g?(v=he(d))!==he(g)?s[u+c]=o[c]:v==="Object"?si(d,g,s,u+c+"."):d!==g&&(s[u+c]=o[c]):d!==g&&(s[u+c]=o[c])):s[u+c]=void 0}),p(o).forEach(function(c){b(n,c)||(s[u+c]=o[c])}),s}function ai(n,o){return o.type==="delete"?o.keys:o.keys||o.values.map(n.extractKey)}var Pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(o){var s=n.table(o),u=s.schema.primaryKey;return i(i({},s),{mutate:function(c){var d=me.trans,g=d.table(o).hook,v=g.deleting,E=g.creating,M=g.updating;switch(c.type){case"add":if(E.fire===Se)break;return d._promise("readwrite",function(){return O(c)},!0);case"put":if(E.fire===Se&&M.fire===Se)break;return d._promise("readwrite",function(){return O(c)},!0);case"delete":if(v.fire===Se)break;return d._promise("readwrite",function(){return O(c)},!0);case"deleteRange":if(v.fire===Se)break;return d._promise("readwrite",function(){return(function y(D,k,S){return s.query({trans:D,values:!1,query:{index:u,range:k},limit:S}).then(function(P){var _=P.result;return O({type:"delete",keys:_,trans:D}).then(function(R){return 0<R.numFailures?Promise.reject(R.failures[0]):_.length<S?{failures:[],numFailures:0,lastResult:void 0}:y(D,i(i({},k),{lower:_[_.length-1],lowerOpen:!0}),S)})})})(c.trans,c.range,1e4)},!0)}return s.mutate(c);function O(y){var D,k,S,P=me.trans,_=y.keys||ai(u,y);if(!_)throw new Error("Keys missing");return(y=y.type==="add"||y.type==="put"?i(i({},y),{keys:_}):i({},y)).type!=="delete"&&(y.values=a([],y.values)),y.keys&&(y.keys=a([],y.keys)),D=s,S=_,((k=y).type==="add"?Promise.resolve([]):D.getMany({trans:k.trans,keys:S,cache:"immutable"})).then(function(R){var z=_.map(function(q,V){var ne,se,J,re=R[V],ae={onerror:null,onsuccess:null};return y.type==="delete"?v.fire.call(ae,q,re,P):y.type==="add"||re===void 0?(ne=E.fire.call(ae,q,y.values[V],P),q==null&&ne!=null&&(y.keys[V]=q=ne,u.outbound||T(y.values[V],u.keyPath,q))):(ne=si(re,y.values[V]),(se=M.fire.call(ae,ne,q,re,P))&&(J=y.values[V],Object.keys(se).forEach(function(ie){b(J,ie)?J[ie]=se[ie]:T(J,ie,se[ie])}))),ae});return s.mutate(y).then(function(q){for(var V=q.failures,ne=q.results,se=q.numFailures,q=q.lastResult,J=0;J<_.length;++J){var re=(ne||_)[J],ae=z[J];re==null?ae.onerror&&ae.onerror(V[J]):ae.onsuccess&&ae.onsuccess(y.type==="put"&&R[J]?y.values[J]:re)}return{failures:V,results:ne,numFailures:se,lastResult:q}}).catch(function(q){return z.forEach(function(V){return V.onerror&&V.onerror(q)}),Promise.reject(q)})})}}})}})}};function so(n,o,s){try{if(!o||o.keys.length<n.length)return null;for(var u=[],c=0,d=0;c<o.keys.length&&d<n.length;++c)Te(o.keys[c],n[d])===0&&(u.push(s?ue(o.values[c]):o.values[c]),++d);return u.length===n.length?u:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(n){return{table:function(o){var s=n.table(o);return i(i({},s),{getMany:function(u){if(!u.cache)return s.getMany(u);var c=so(u.keys,u.trans._cache,u.cache==="clone");return c?le.resolve(c):s.getMany(u).then(function(d){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ue(d):d},d})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),s.mutate(u)}})}}}};function ao(n,o){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!o.schema.primaryKey.outbound}function lo(n,o){switch(n){case"query":return o.values&&!o.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(n){var o=n.schema.name,s=new Ve(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(u,c,d){if(me.subscr&&c!=="readonly")throw new G.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(me.querier));return n.transaction(u,c,d)},table:function(u){var c=n.table(u),d=c.schema,g=d.primaryKey,y=d.indexes,v=g.extractKey,E=g.outbound,M=g.autoIncrement&&y.filter(function(k){return k.compound&&k.keyPath.includes(g.keyPath)}),O=i(i({},c),{mutate:function(k){function S(ie){return ie="idb://".concat(o,"/").concat(u,"/").concat(ie),q[ie]||(q[ie]=new Ve)}var P,_,R,z=k.trans,q=k.mutatedParts||(k.mutatedParts={}),V=S(""),ne=S(":dels"),se=k.type,ae=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[ai(g,k).filter(function(ie){return ie}),k.values]:[],J=ae[0],re=ae[1],ae=k.trans._cache;return h(J)?(V.addKeys(J),(ae=se==="delete"||J.length===re.length?so(J,ae):null)||ne.addKeys(J),(ae||re)&&(P=S,_=ae,R=re,d.indexes.forEach(function(ie){var de=P(ie.name||"");function Me(Oe){return Oe!=null?ie.extractKey(Oe):null}function Pe(Oe){return ie.multiEntry&&h(Oe)?Oe.forEach(function(nt){return de.addKey(nt)}):de.addKey(Oe)}(_||R).forEach(function(Oe,He){var Ee=_&&Me(_[He]),He=R&&Me(R[He]);Te(Ee,He)!==0&&(Ee!=null&&Pe(Ee),He!=null&&Pe(He))})}))):J?(re={from:(re=J.lower)!==null&&re!==void 0?re:n.MIN_KEY,to:(re=J.upper)!==null&&re!==void 0?re:n.MAX_KEY},ne.add(re),V.add(re)):(V.add(s),ne.add(s),d.indexes.forEach(function(ie){return S(ie.name).add(s)})),c.mutate(k).then(function(ie){return!J||k.type!=="add"&&k.type!=="put"||(V.addKeys(ie.results),M&&M.forEach(function(de){for(var Me=k.values.map(function(Ee){return de.extractKey(Ee)}),Pe=de.keyPath.findIndex(function(Ee){return Ee===g.keyPath}),Oe=0,nt=ie.results.length;Oe<nt;++Oe)Me[Oe][Pe]=ie.results[Oe];S(de.name).addKeys(Me)})),z.mutatedParts=fr(z.mutatedParts||{},q),ie})}}),y=function(S){var P=S.query,S=P.index,P=P.range;return[S,new Ve((S=P.lower)!==null&&S!==void 0?S:n.MIN_KEY,(P=P.upper)!==null&&P!==void 0?P:n.MAX_KEY)]},D={get:function(k){return[g,new Ve(k.key)]},getMany:function(k){return[g,new Ve().addKeys(k.keys)]},count:y,query:y,openCursor:y};return p(D).forEach(function(k){O[k]=function(S){var P=me.subscr,_=!!P,R=ao(me,c)&&lo(k,S)?S.obsSet={}:P;if(_){var z=function(re){return re="idb://".concat(o,"/").concat(u,"/").concat(re),R[re]||(R[re]=new Ve)},q=z(""),V=z(":dels"),P=D[k](S),_=P[0],P=P[1];if((k==="query"&&_.isPrimaryKey&&!S.values?V:z(_.name||"")).add(P),!_.isPrimaryKey){if(k!=="count"){var ne=k==="query"&&E&&S.values&&c.query(i(i({},S),{values:!1}));return c[k].apply(this,arguments).then(function(re){if(k==="query"){if(E&&S.values)return ne.then(function(Me){return Me=Me.result,q.addKeys(Me),re});var ae=S.values?re.result.map(v):re.result;(S.values?q:V).addKeys(ae)}else if(k==="openCursor"){var ie=re,de=S.values;return ie&&Object.create(ie,{key:{get:function(){return V.addKey(ie.primaryKey),ie.key}},primaryKey:{get:function(){var Me=ie.primaryKey;return V.addKey(Me),Me}},value:{get:function(){return de&&q.addKey(ie.primaryKey),ie.value}}})}return re})}V.add(s)}}return c[k].apply(this,arguments)}}),O}})}};function uo(n,o,s){if(s.numFailures===0)return o;if(o.type==="deleteRange")return null;var u=o.keys?o.keys.length:"values"in o&&o.values?o.values.length:1;return s.numFailures===u?null:(o=i({},o),h(o.keys)&&(o.keys=o.keys.filter(function(c,d){return!(d in s.failures)})),"values"in o&&h(o.values)&&(o.values=o.values.filter(function(c,d){return!(d in s.failures)})),o)}function li(n,o){return s=n,((u=o).lower===void 0||(u.lowerOpen?0<Te(s,u.lower):0<=Te(s,u.lower)))&&(n=n,(o=o).upper===void 0||(o.upperOpen?Te(n,o.upper)<0:Te(n,o.upper)<=0));var s,u}function co(n,o,D,u,c,d){if(!D||D.length===0)return n;var g=o.query.index,v=g.multiEntry,E=o.query.range,M=u.schema.primaryKey.extractKey,O=g.extractKey,y=(g.lowLevelIndex||g).extractKey,D=D.reduce(function(k,S){var P=k,_=[];if(S.type==="add"||S.type==="put")for(var R=new Ve,z=S.values.length-1;0<=z;--z){var q,V=S.values[z],ne=M(V);R.hasKey(ne)||(q=O(V),(v&&h(q)?q.some(function(ie){return li(ie,E)}):li(q,E))&&(R.addKey(ne),_.push(V)))}switch(S.type){case"add":var se=new Ve().addKeys(o.values?k.map(function(de){return M(de)}):k),P=k.concat(o.values?_.filter(function(de){return de=M(de),!se.hasKey(de)&&(se.addKey(de),!0)}):_.map(function(de){return M(de)}).filter(function(de){return!se.hasKey(de)&&(se.addKey(de),!0)}));break;case"put":var J=new Ve().addKeys(S.values.map(function(de){return M(de)}));P=k.filter(function(de){return!J.hasKey(o.values?M(de):de)}).concat(o.values?_:_.map(function(de){return M(de)}));break;case"delete":var re=new Ve().addKeys(S.keys);P=k.filter(function(de){return!re.hasKey(o.values?M(de):de)});break;case"deleteRange":var ae=S.range;P=k.filter(function(de){return!li(M(de),ae)})}return P},n);return D===n?n:(D.sort(function(k,S){return Te(y(k),y(S))||Te(M(k),M(S))}),o.limit&&o.limit<1/0&&(D.length>o.limit?D.length=o.limit:n.length===o.limit&&D.length<o.limit&&(c.dirty=!0)),d?Object.freeze(D):D)}function fo(n,o){return Te(n.lower,o.lower)===0&&Te(n.upper,o.upper)===0&&!!n.lowerOpen==!!o.lowerOpen&&!!n.upperOpen==!!o.upperOpen}function Da(n,o){return(function(s,u,c,d){if(s===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((u=Te(s,u))===0){if(c&&d)return 0;if(c)return 1;if(d)return-1}return u})(n.lower,o.lower,n.lowerOpen,o.lowerOpen)<=0&&0<=(function(s,u,c,d){if(s===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((u=Te(s,u))===0){if(c&&d)return 0;if(c)return-1;if(d)return 1}return u})(n.upper,o.upper,n.upperOpen,o.upperOpen)}function Ia(n,o,s,u){n.subscribers.add(s),u.addEventListener("abort",function(){var c,d;n.subscribers.delete(s),n.subscribers.size===0&&(c=n,d=o,setTimeout(function(){c.subscribers.size===0&&ye(d,c)},3e3))})}var ja={stack:"dbcore",level:0,name:"Cache",create:function(n){var o=n.schema.name;return i(i({},n),{transaction:function(s,u,c){var d,g,v=n.transaction(s,u,c);return u==="readwrite"&&(g=(d=new AbortController).signal,c=function(E){return function(){if(d.abort(),u==="readwrite"){for(var M=new Set,O=0,y=s;O<y.length;O++){var D=y[O],k=Ht["idb://".concat(o,"/").concat(D)];if(k){var S=n.table(D),P=k.optimisticOps.filter(function(de){return de.trans===v});if(v._explicit&&E&&v.mutatedParts)for(var _=0,R=Object.values(k.queries.query);_<R.length;_++)for(var z=0,q=(se=R[_]).slice();z<q.length;z++)ti((J=q[z]).obsSet,v.mutatedParts)&&(ye(se,J),J.subscribers.forEach(function(de){return M.add(de)}));else if(0<P.length){k.optimisticOps=k.optimisticOps.filter(function(de){return de.trans!==v});for(var V=0,ne=Object.values(k.queries.query);V<ne.length;V++)for(var se,J,re,ae=0,ie=(se=ne[V]).slice();ae<ie.length;ae++)(J=ie[ae]).res!=null&&v.mutatedParts&&(E&&!J.dirty?(re=Object.isFrozen(J.res),re=co(J.res,J.req,P,S,J,re),J.dirty?(ye(se,J),J.subscribers.forEach(function(de){return M.add(de)})):re!==J.res&&(J.res=re,J.promise=le.resolve({result:re}))):(J.dirty&&ye(se,J),J.subscribers.forEach(function(de){return M.add(de)})))}}}M.forEach(function(de){return de()})}}},v.addEventListener("abort",c(!1),{signal:g}),v.addEventListener("error",c(!1),{signal:g}),v.addEventListener("complete",c(!0),{signal:g})),v},table:function(s){var u=n.table(s),c=u.schema.primaryKey;return i(i({},u),{mutate:function(d){var g=me.trans;if(c.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return u.mutate(d);var v=Ht["idb://".concat(o,"/").concat(s)];return v?(g=u.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ai(c,d).some(function(E){return E==null}))?(v.optimisticOps.push(d),d.mutatedParts&&dr(d.mutatedParts),g.then(function(E){0<E.numFailures&&(ye(v.optimisticOps,d),(E=uo(0,d,E))&&v.optimisticOps.push(E),d.mutatedParts&&dr(d.mutatedParts))}),g.catch(function(){ye(v.optimisticOps,d),d.mutatedParts&&dr(d.mutatedParts)})):g.then(function(E){var M=uo(0,i(i({},d),{values:d.values.map(function(O,y){var D;return E.failures[y]?O:(O=(D=c.keyPath)!==null&&D!==void 0&&D.includes(".")?ue(O):i({},O),T(O,c.keyPath,E.results[y]),O)})}),E);v.optimisticOps.push(M),queueMicrotask(function(){return d.mutatedParts&&dr(d.mutatedParts)})}),g):u.mutate(d)},query:function(d){if(!ao(me,u)||!lo("query",d))return u.query(d);var g=((M=me.trans)===null||M===void 0?void 0:M.db._options.cache)==="immutable",y=me,v=y.requery,E=y.signal,M=(function(S,P,_,R){var z=Ht["idb://".concat(S,"/").concat(P)];if(!z)return[];if(!(P=z.queries[_]))return[null,!1,z,null];var q=P[(R.query?R.query.index.name:null)||""];if(!q)return[null,!1,z,null];switch(_){case"query":var V=q.find(function(ne){return ne.req.limit===R.limit&&ne.req.values===R.values&&fo(ne.req.query.range,R.query.range)});return V?[V,!0,z,q]:[q.find(function(ne){return("limit"in ne.req?ne.req.limit:1/0)>=R.limit&&(!R.values||ne.req.values)&&Da(ne.req.query.range,R.query.range)}),!1,z,q];case"count":return V=q.find(function(ne){return fo(ne.req.query.range,R.query.range)}),[V,!!V,z,q]}})(o,s,"query",d),O=M[0],y=M[1],D=M[2],k=M[3];return O&&y?O.obsSet=d.obsSet:(y=u.query(d).then(function(S){var P=S.result;if(O&&(O.res=P),g){for(var _=0,R=P.length;_<R;++_)Object.freeze(P[_]);Object.freeze(P)}else S.result=ue(P);return S}).catch(function(S){return k&&O&&ye(k,O),Promise.reject(S)}),O={obsSet:d.obsSet,promise:y,subscribers:new Set,type:"query",req:d,dirty:!1},k?k.push(O):(k=[O],(D=D||(Ht["idb://".concat(o,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=k)),Ia(O,k,v,E),O.promise.then(function(S){return{result:co(S.result,d,D?.optimisticOps,u,O,g)}})}})}})}};function hr(n,o){return new Proxy(n,{get:function(s,u,c){return u==="db"?o:Reflect.get(s,u,c)}})}var St=(qe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new G.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new G.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var o=this._versions,s=o.filter(function(u){return u._cfg.version===n})[0];return s||(s=new this.Version(n),o.push(s),o.sort(xa),s.stores({}),this._state.autoSchema=!1,s)},qe.prototype._whenReady=function(n){var o=this;return this.idbdb&&(this._state.openComplete||me.letThrough||this._vip)?n():new le(function(s,u){if(o._state.openComplete)return u(new G.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return void u(new G.DatabaseClosed);o.open().catch(Se)}o._state.dbReadyPromise.then(s,u)}).then(n)},qe.prototype.use=function(n){var o=n.stack,s=n.create,u=n.level,c=n.name;return c&&this.unuse({stack:o,name:c}),n=this._middlewares[o]||(this._middlewares[o]=[]),n.push({stack:o,create:s,level:u??10,name:c}),n.sort(function(d,g){return d.level-g.level}),this},qe.prototype.unuse=function(n){var o=n.stack,s=n.name,u=n.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(c){return u?c.create!==u:!!s&&c.name!==s})),this},qe.prototype.open=function(){var n=this;return Zt(et,function(){return ka(n)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,o=pn.indexOf(this);if(0<=o&&pn.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new le(function(s){n.dbReadyResolve=s}),n.openCanceller=new le(function(s,u){n.cancelOpen=u}))},qe.prototype.close=function(s){var o=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new G.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new G.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},qe.prototype.delete=function(n){var o=this;n===void 0&&(n={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",u=this._state;return new le(function(c,d){function g(){o.close(n);var v=o._deps.indexedDB.deleteDatabase(o.name);v.onsuccess=Ke(function(){var E,M,O;E=o._deps,M=o.name,O=E.indexedDB,E=E.IDBKeyRange,Jr(O)||M===Qn||Xr(O,E).delete(M).catch(Se),c()}),v.onerror=yt(d),v.onblocked=o._fireOnBlocked}if(s)throw new G.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(o){return n._allTables[o]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var n=(function(o,s,u){var c=arguments.length;if(c<2)throw new G.InvalidArgument("Too few arguments");for(var d=new Array(c-1);--c;)d[c-1]=arguments[c];return u=d.pop(),[o,ee(d),u]}).apply(this,arguments);return this._transaction.apply(this,n)},qe.prototype._transaction=function(n,o,s){var u=this,c=me.trans;c&&c.db===this&&n.indexOf("!")===-1||(c=null);var d,g,v=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(g=o.map(function(M){if(M=M instanceof u.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),n=="r"||n===Fr)d=Fr;else{if(n!="rw"&&n!=Kr)throw new G.InvalidArgument("Invalid transaction mode: "+n);d=Kr}if(c){if(c.mode===Fr&&d===Kr){if(!v)throw new G.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&g.forEach(function(M){if(c&&c.storeNames.indexOf(M)===-1){if(!v)throw new G.SubTransaction("Table "+M+" not included in parent transaction.");c=null}}),v&&c&&!c.active&&(c=null)}}catch(M){return c?c._promise(null,function(O,y){y(M)}):Ne(M)}var E=(function M(O,y,D,k,S){return le.resolve().then(function(){var P=me.transless||me,_=O._createTransaction(y,D,O._dbSchema,k);if(_.explicit=!0,P={trans:_,transless:P},k)_.idbtrans=k.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(q){return q.name===Be.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return M(O,y,D,null,S)})):Ne(q)}var R,z=Le(S);return z&&dn(),P=le.follow(function(){var q;(R=S.call(_,_))&&(z?(q=jt.bind(null,null),R.then(q,q)):typeof R.next=="function"&&typeof R.throw=="function"&&(R=oi(R)))},P),(R&&typeof R.then=="function"?le.resolve(R).then(function(q){return _.active?q:Ne(new G.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):P.then(function(){return R})).then(function(q){return k&&_._resolve(),_._completion.then(function(){return q})}).catch(function(q){return _._reject(q),Ne(q)})})}).bind(null,this,d,g,c,s);return c?c._promise(d,E,"lock"):me.trans?Zt(me.transless,function(){return u._whenReady(E)}):this._whenReady(E)},qe.prototype.table=function(n){if(!b(this._allTables,n))throw new G.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},qe);function qe(n,o){var s=this;this._middlewares={},this.verno=0;var u=qe.dependencies;this._options=o=i({addons:qe.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},u=o.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,d,g,v,E,M={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen};M.dbReadyPromise=new le(function(y){M.dbReadyResolve=y}),M.openCanceller=new le(function(y,D){M.cancelOpen=D}),this._state=M,this.name=n,this.on=Sn(this,"populate","blocked","versionchange","close",{ready:[sn,Se]}),this.once=function(y,D){var k=function(){for(var S=[],P=0;P<arguments.length;P++)S[P]=arguments[P];s.on(y).unsubscribe(k),D.apply(s,S)};return s.on(y,k)},this.on.ready.subscribe=te(this.on.ready.subscribe,function(y){return function(D,k){qe.vip(function(){var S,P=s._state;P.openComplete?(P.dbOpenError||le.resolve().then(D),k&&y(D)):P.onReadyBeingFired?(P.onReadyBeingFired.push(D),k&&y(D)):(y(D),S=s,k||y(function _(){S.on.ready.unsubscribe(D),S.on.ready.unsubscribe(_)}))})}}),this.Collection=(c=this,Pn(ga.prototype,function(R,_){this.db=c;var k=Fi,S=null;if(_)try{k=_()}catch(z){S=z}var P=R._ctx,_=P.table,R=_.hook.reading.fire;this._ctx={table:_,index:P.index,isPrimKey:!P.index||_.schema.primKey.keyPath&&P.index===_.schema.primKey.name,range:k,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:S,or:P.or,valueMapper:R!==Xe?R:null}})),this.Table=(d=this,Pn($i.prototype,function(y,D,k){this.db=d,this._tx=k,this.name=y,this.schema=D,this.hook=d._allTables[y]?d._allTables[y].hook:Sn(null,{creating:[$n,Se],reading:[Wt,Xe],updating:[Vn,Se],deleting:[rn,Se]})})),this.Transaction=(g=this,Pn(ya.prototype,function(y,D,k,S,P){var _=this;y!=="readonly"&&D.forEach(function(R){R=(R=k[R])===null||R===void 0?void 0:R.yProps,R&&(D=D.concat(R.map(function(z){return z.updatesTable})))}),this.db=g,this.mode=y,this.storeNames=D,this.schema=k,this.chromeTransactionDurability=S,this.idbtrans=null,this.on=Sn(this,"complete","error","abort"),this.parent=P||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new le(function(R,z){_._resolve=R,_._reject=z}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(R){var z=_.active;return _.active=!1,_.on.error.fire(R),_.parent?_.parent._reject(R):z&&_.idbtrans&&_.idbtrans.abort(),Ne(R)})})),this.Version=(v=this,Pn(Ma.prototype,function(y){this.db=v,this._cfg={version:y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(E=this,Pn(Xi.prototype,function(y,D,k){if(this.db=E,this._ctx={table:y,index:D===":id"?null:D,or:k},this._cmp=this._ascending=Te,this._descending=function(S,P){return Te(P,S)},this._max=function(S,P){return 0<Te(S,P)?S:P},this._min=function(S,P){return Te(S,P)<0?S:P},this._IDBKeyRange=E._deps.IDBKeyRange,!this._IDBKeyRange)throw new G.MissingAPI})),this.on("versionchange",function(y){0<y.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(y){!y.newVersion||y.newVersion<y.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(y.oldVersion/10))}),this._maxKey=Dn(o.IDBKeyRange),this._createTransaction=function(y,D,k,S){return new s.Transaction(y,D,k,s._options.chromeTransactionDurability,S)},this._fireOnBlocked=function(y){s.on("blocked").fire(y),pn.filter(function(D){return D.name===s.name&&D!==s&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(y)})},this.use(Oa),this.use(ja),this.use(_a),this.use(Sa),this.use(Pa);var O=new Proxy(this,{get:function(y,D,k){if(D==="_vip")return!0;if(D==="table")return function(P){return hr(s.table(P),O)};var S=Reflect.get(y,D,k);return S instanceof $i?hr(S,O):D==="tables"?S.map(function(P){return hr(P,O)}):D==="_createTransaction"?function(){return hr(S.apply(this,arguments),O)}:S}});this.vip=O,u.forEach(function(y){return y(s)})}var gr,lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ra=(ui.prototype.subscribe=function(n,o,s){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:o,complete:s})},ui.prototype[lt]=function(){return this},ui);function ui(n){this._subscribe=n}try{gr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{gr={indexedDB:null,IDBKeyRange:null}}function po(n){var o,s=!1,u=new Ra(function(c){var d=Le(n),g,v=!1,E={},M={},O={get closed(){return v},unsubscribe:function(){v||(v=!0,g&&g.abort(),y&&At.storagemutated.unsubscribe(k))}};c.start&&c.start(O);var y=!1,D=function(){return zr(S)},k=function(P){fr(E,P),ti(M,E)&&D()},S=function(){var P,_,R;!v&&gr.indexedDB&&(E={},P={},g&&g.abort(),g=new AbortController,R=(function(z){var q=Et();try{d&&dn();var V=It(n,z);return V=d?V.finally(jt):V}finally{q&&Dt()}})(_={subscr:P,signal:g.signal,requery:D,querier:n,trans:null}),Promise.resolve(R).then(function(z){s=!0,o=z,v||_.signal.aborted||(E={},(function(q){for(var V in q)if(b(q,V))return;return 1})(M=P)||y||(At(_n,k),y=!0),zr(function(){return!v&&c.next&&c.next(z)}))},function(z){s=!1,["DatabaseClosedError","AbortError"].includes(z?.name)||v||zr(function(){v||c.error&&c.error(z)})}))};return setTimeout(D,0),O});return u.hasValue=function(){return s},u.getValue=function(){return o},u}var Gt=St;function ci(n){var o=Bt;try{Bt=!0,At.storagemutated.fire(n),ii(n,!0)}finally{Bt=o}}C(Gt,i(i({},De),{delete:function(n){return new Gt(n,{addons:[]}).delete()},exists:function(n){return new Gt(n,{addons:[]}).open().then(function(o){return o.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return o=Gt.dependencies,s=o.indexedDB,o=o.IDBKeyRange,(Jr(s)?Promise.resolve(s.databases()).then(function(u){return u.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Xr(s,o).toCollection().primaryKeys()).then(n)}catch{return Ne(new G.MissingAPI)}var o,s},defineClass:function(){return function(n){m(this,n)}},ignoreTransaction:function(n){return me.trans?Zt(me.transless,n):n()},vip:Qr,async:function(n){return function(){try{var o=oi(n.apply(this,arguments));return o&&typeof o.then=="function"?o:le.resolve(o)}catch(s){return Ne(s)}}},spawn:function(n,o,s){try{var u=oi(n.apply(s,o||[]));return u&&typeof u.then=="function"?u:le.resolve(u)}catch(c){return Ne(c)}},currentTransaction:{get:function(){return me.trans||null}},waitFor:function(n,o){return o=le.resolve(typeof n=="function"?Gt.ignoreTransaction(n):n).timeout(o||6e4),me.trans?me.trans.waitFor(o):o},Promise:le,debug:{get:function(){return Je},set:function(n){xn(n)}},derive:j,extend:m,props:C,override:te,Events:Sn,on:At,liveQuery:po,extendObservabilitySet:fr,getByKeyPath:B,setByKeyPath:T,delByKeyPath:function(n,o){typeof o=="string"?T(n,o,void 0):"length"in o&&[].map.call(o,function(s){T(n,s,void 0)})},shallowClone:H,deepClone:ue,getObjectDiff:si,cmp:Te,asap:A,minKey:-1/0,addons:[],connections:pn,errnames:Be,dependencies:gr,cache:Ht,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,o,s){return n+o/Math.pow(10,2*s)})})),Gt.maxKey=Dn(Gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(At(_n,function(n){Bt||(n=new CustomEvent(Wr,{detail:n}),Bt=!0,dispatchEvent(n),Bt=!1)}),addEventListener(Wr,function(n){n=n.detail,Bt||ci(n)}));var vn,Bt=!1,ho=function(){};return typeof BroadcastChannel<"u"&&((ho=function(){(vn=new BroadcastChannel(Wr)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof vn.unref=="function"&&vn.unref(),At(_n,function(n){Bt||vn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!St.disableBfCache&&n.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),vn?.close();for(var o=0,s=pn;o<s.length;o++)s[o].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!St.disableBfCache&&n.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),ho(),ci({all:new Ve(-1/0,[[]])}))})),le.rejectionMapper=function(n,o){return!n||n instanceof ge||n instanceof TypeError||n instanceof SyntaxError||!n.name||!be[n.name]?n:(o=new be[n.name](o||n.message,n),"stack"in n&&L(o,"stack",{get:function(){return this.inner.stack}}),o)},xn(Je),i(St,Object.freeze({__proto__:null,Dexie:St,liveQuery:po,Entity:Ki,cmp:Te,PropModification:kn,replacePrefix:function(n,o){return new kn({replacePrefix:[n,o]})},add:function(n){return new kn({add:n})},remove:function(n){return new kn({remove:n})},default:St,RangeSet:Ve,mergeRanges:Rn,rangesOverlap:no}),{default:St}),St})})(xr)),xr.exports}var bc=yc();const Oi=Aa(bc),Ns=Symbol.for("Dexie"),Tr=globalThis[Ns]||(globalThis[Ns]=Oi);if(Oi.semVer!==Tr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Oi.semVer} and ${Tr.semVer}`);const{liveQuery:Tc,mergeRanges:Ac,rangesOverlap:Bc,RangeSet:Uc,cmp:zc,Entity:Fc,PropModification:Kc,replacePrefix:Nc,add:qc,remove:Wc,DexieYProvider:Zc}=Tr,it=new Tr("ChillGameDB");it.version(1).stores({exploredCells:"id",claimedCells:"id",gameState:"key"});it.open().catch(t=>{console.error("Failed to open IndexedDB:",t)});const qs=5e-4,Ye=nc(mc((t,e)=>({clouds:10,claimedCells:[],exploredCells:[],selectedCell:null,userLocation:null,isHydrated:!1,lastCloudIncrease:Date.now(),hydrate:async()=>{try{const[r,i,a,f]=await Promise.all([it.exploredCells.toArray(),it.claimedCells.toArray(),it.gameState.get("clouds"),it.gameState.get("lastCloudIncrease")]);t(p=>{p.exploredCells=r,p.claimedCells=i,p.clouds=a?a.value:10,p.lastCloudIncrease=f?f.value:Date.now(),p.isHydrated=!0})}catch(r){console.error("Failed to hydrate store from IndexedDB:",r),t(i=>{i.isHydrated=!0})}},increaseCloud:()=>{const r=Date.now();t(i=>{i.clouds<10&&(i.clouds+=1,i.lastCloudIncrease=r)}),it.gameState.put({key:"clouds",value:e().clouds}),it.gameState.put({key:"lastCloudIncrease",value:r})},initializeGeolocation:()=>{navigator.geolocation.watchPosition(r=>{const{latitude:i,longitude:a}=r.coords,f=new Set(e().exploredCells.map(p=>p.id));t(p=>{p.userLocation={lat:i,lng:a};const h=Math.floor(i/qs),m=Math.floor(a/qs),x=[],w=2;for(let b=-w;b<=w;b++)for(let C=-w;C<=w;C++)if(b*b+C*C<=w*w){const I=`${h+b}_${m+C}`;if(!f.has(I)){const L={id:I};p.exploredCells.push(L),x.push(L),f.add(I)}}x.length>0&&it.exploredCells.bulkAdd(x).catch(b=>console.error("Failed to bulkAdd explored cells:",b))})},r=>console.error("Geolocation watch error:",r),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},selectCell:r=>{const i=e().selectedCell,a=e().claimedCells.some(f=>f.id===r?.key);!r||i&&i.key===r.key||a?t({selectedCell:null}):t({selectedCell:r})},updateSelectedCellInfo:r=>{t(i=>{i.selectedCell&&(i.selectedCell={...i.selectedCell,...r,isLoading:!1})})},claimSelectedCell:()=>{const{selectedCell:r,clouds:i}=e();if(!r)return"no-cell";if(i<=0)return"no-clouds";const{key:a}=r,p={id:a,data:{owner:"user",color:"#3B82F6"}},h=new Set(e().exploredCells.map(C=>C.id)),[m,x]=a.split("_").map(Number),w=[],b=1;for(let C=-b;C<=b;C++)for(let I=-b;I<=b;I++){const L=`${m+C}_${x+I}`;h.has(L)||w.push({id:L})}return t(C=>{C.clouds-=1,C.claimedCells.push(p),C.exploredCells.push(...w),C.selectedCell=null}),it.claimedCells.put(p),it.gameState.put({key:"clouds",value:e().clouds}),w.length>0&&it.exploredCells.bulkAdd(w),"claimed"},register:()=>{t({clouds:10}),it.gameState.put({key:"clouds",value:10})}}))),wc={backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 20px",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"18px"},Lc={fontSize:"24px"};function xc(){const t=Ye(e=>e.clouds);return Q.jsxs("div",{style:wc,children:[Q.jsx("span",{style:Lc,children:"☁️"}),Q.jsx("span",{children:t})]})}const Cc=en.memo(xc),Ec={width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"50%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",border:"none",transition:"transform 0.2s ease-in-out"},Mc={fontSize:"28px"};function kc({onClick:t}){const[e,r]=l.useState(!1),i={...Ec,transform:e?"scale(1.1)":"scale(1)"};return Q.jsx("button",{onClick:t,title:"Reset View",style:i,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:Q.jsx("span",{style:Mc,children:"🧭"})})}const Sc=l.memo(kc),wr={container:{backgroundColor:"white",borderRadius:"8px",padding:"10px 16px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"bold",color:"#374151"},icon:{fontSize:"22px"},timer:{minWidth:"35px",textAlign:"center",fontSize:"18px"}},Pc=()=>{const t=Ye(f=>f.clouds),e=Ye(f=>f.lastCloudIncrease),r=Ye(f=>f.increaseCloud),[i,a]=l.useState(0);return l.useEffect(()=>{let f;return t<10?f=setInterval(()=>{const m=6e4-(Date.now()-e);m<=0?(r(),a(60)):a(Math.ceil(m/1e3))},1e3):(clearInterval(f),a(0)),()=>clearInterval(f)},[t,e,r]),Q.jsxs("div",{style:wr.container,children:[Q.jsx("span",{style:wr.icon,children:"☁️"}),t<10?Q.jsxs("span",{style:wr.timer,children:[i,"s"]}):Q.jsx("span",{style:wr.timer,children:"⏰"})]})},Oc=l.memo(Pc),Lr=new Map,Ws=.5;function _c(t){const e=Ye(r=>r.updateSelectedCellInfo);l.useEffect(()=>{if(!t||!t.isLoading)return;const{position:r}=t,i=`${Math.floor(r.lat/Ws)}_${Math.floor(r.lng/Ws)}`;(async()=>{if(Lr.has(i)){e(Lr.get(i));return}try{const p=await new window.google.maps.Geocoder().geocode({location:r});let h;if(p.results&&p.results[0]){const m=p.results[0].address_components,x=m.find(j=>j.types.includes("country")),w=m.find(j=>j.types.includes("administrative_area_level_1")),b=x?x.long_name:"未知領域",C=x?x.short_name.toLowerCase():null,I=w?w.long_name:"",L=C?`https://flagcdn.com/w40/${C}.png`:null;h={countryName:b,regionName:I,flagUrl:L}}else h={countryName:"無法取得地點資訊",regionName:"",flagUrl:null};Lr.set(i,h),e(h)}catch(f){console.error("Geocoding failed:",f);const p={countryName:"地理資訊查詢失敗",regionName:"",flagUrl:null};Lr.set(i,p),e(p)}})()},[t,e])}const Dc=l.lazy(()=>_i(()=>import("./Leaderboard-B99Tzgs7.js").then(t=>t.d),__vite__mapDeps([0,1,2,3]))),Ic=l.lazy(()=>_i(()=>import("./RegistrationModal-BVvYDjvE.js"),__vite__mapDeps([4,1,2]))),jc=l.lazy(()=>_i(()=>import("./InfoModal-CsiP-cMl.js"),__vite__mapDeps([5,1,2]))),ct={app:{position:"relative",width:"100vw",height:"100vh"},topLeftControls:{position:"absolute",top:"16px",left:"16px",display:"flex",flexDirection:"column",gap:"8px",zIndex:50},controlButton:{width:"40px",height:"40px",backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer"},topCenterContainer:{position:"absolute",top:"16px",left:"50%",transform:"translateX(-50%)",zIndex:50},topRightContainer:{position:"absolute",top:"16px",right:"16px",zIndex:50,display:"flex",flexDirection:"column",gap:"8px"},bottomRightContainer:{position:"absolute",bottom:"16px",right:"16px",zIndex:50},bottomLeftContainer:{position:"absolute",bottom:"4px",left:"8px",zIndex:50}};function $c(){const{lat:t,lng:e}=Ba(),r=Ua(),[i,a]=l.useState(()=>t&&e?{lat:parseFloat(t),lng:parseFloat(e)}:null),[f,p]=l.useState(!1),h=l.useRef(null),m=Ye(Y=>Y.claimedCells),x=Ye(Y=>Y.exploredCells),w=Ye(Y=>Y.selectedCell),b=Ye(Y=>Y.userLocation),C=Ye(Y=>Y.clouds),I=Ye(Y=>Y.initializeGeolocation),L=Ye(Y=>Y.selectCell),j=Ye(Y=>Y.claimSelectedCell),K=Ye(Y=>Y.register),$=Ye(Y=>Y.isHydrated),W=Ye(Y=>Y.hydrate);_c(w);const{isLoaded:te}=ll({id:"google-map-script",googleMapsApiKey:"AIzaSyDAFahAqynfP1teNNM03cWaUBtwZMEm8ZM"});l.useEffect(()=>{I()},[I]),l.useEffect(()=>{W()},[W]),l.useEffect(()=>{i||navigator.geolocation.getCurrentPosition(Y=>{a({lat:Y.coords.latitude,lng:Y.coords.longitude})},()=>{a({lat:25.033,lng:121.5654})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},[i]);const[F,A]=l.useState(!1),[B,T]=l.useState(!1),[H,U]=l.useState(!1),[ee,X]=l.useState(!1),[oe,ue]=l.useState([]),pe=l.useCallback(Y=>{h.current=Y},[]),he=l.useCallback((Y,G)=>{xi(),L(Y?{key:Y,position:G,isLoading:!0}:null)},[L]),ve=l.useCallback(()=>{if(!w)return;const Y={id:Date.now()+Math.random(),position:w.position,startTime:Date.now(),particleDuration:2500,revealDuration:1e3,onComplete:()=>{j()==="no-clouds"&&A(!0)}};ue(G=>[...G,Y]),setTimeout(()=>{ue(G=>G.filter(be=>be.id!==Y.id))},2500)},[j,w]),we=l.useCallback(()=>{L(null)},[L]),ye=l.useCallback(()=>{K(),A(!1)},[K]),fe=l.useCallback(async()=>{if(!h.current)return;const Y=h.current.getCenter(),G=Y.lat(),be=Y.lng();p(!0),await Nt(h.current,{lat:G,lng:be},1500,2,X),r("/",{state:{lat:G,lng:be}})},[r,X]),ce=l.useCallback(async()=>{if(b&&h.current){const Y=h.current,G=Y.getCenter(),be={lat:G.lat(),lng:G.lng()};await Nt(Y,be,1e3,5,X),await Nt(Y,b,1500,5,X),await Nt(Y,b,1e3,15,X)}else alert("無法取得您的位置資訊。請確認已授權瀏覽器存取您的位置。")},[b,X]),Le=l.useCallback(Y=>{r(`/map/${Y.lat.toFixed(7)}/${Y.lng.toFixed(7)}`,{replace:!0})},[r]),Ce=l.useCallback(async()=>{if(h.current){const Y=h.current.getZoom(),G=Math.min(20,Y+1);G!==Y&&await Nt(h.current,h.current.getCenter().toJSON(),300,G,X)}},[X]),ge=l.useCallback(async()=>{if(h.current){const Y=h.current.getZoom(),G=Math.max(2,Y-1);G!==Y&&await Nt(h.current,h.current.getCenter().toJSON(),300,G,X)}},[X]),Re=l.useCallback(()=>U(!0),[]),Z=l.useCallback(()=>A(!1),[]),Ae=l.useCallback(()=>T(!1),[]),Be=l.useCallback(()=>U(!1),[]);return!te||!i||!$?Q.jsx(go,{}):Q.jsxs("div",{style:ct.app,className:f?"map-container-fade-out":"",children:[Q.jsx(Ju,{center:i,onSelectCell:he,claimedCells:m,exploredCells:x,setMapRef:pe,onZoomChanged:()=>{},onCenterChanged:Le,selectedCell:w,userLocation:b,isAnimating:ee,effects:oe}),w&&Q.jsx(oa,{cellInfo:w,onClaim:ve,onClose:we,isClaimDisabled:C<=0&&F}),Q.jsxs("div",{style:ct.topLeftControls,children:[Q.jsx("button",{style:ct.controlButton,onClick:Ce,children:"+"}),Q.jsx("button",{style:ct.controlButton,onClick:ge,children:"-"}),Q.jsx("button",{style:ct.controlButton,onClick:Re,children:"i"})]}),Q.jsx("div",{style:ct.topCenterContainer,children:Q.jsx(Cc,{})}),Q.jsxs("div",{style:ct.topRightContainer,children:[Q.jsx("button",{style:ct.controlButton,onClick:()=>T(!0),children:"🏆"}),Q.jsx("button",{style:ct.controlButton,onClick:fe,title:"Return to Globe",children:"🌍"})]}),Q.jsx("div",{style:ct.bottomLeftContainer,children:Q.jsx(Oc,{})}),Q.jsx("div",{style:ct.bottomRightContainer,children:Q.jsx(Sc,{onClick:ce})}),Q.jsxs(l.Suspense,{fallback:Q.jsx(go,{}),children:[F&&Q.jsx(Ic,{onClose:Z,onRegister:ye}),B&&Q.jsx(Dc,{onClose:Ae}),H&&Q.jsx(jc,{onClose:Be})]})]})}export{$c as default};
